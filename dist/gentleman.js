(()=>{"use strict";var e={513:e=>{e.exports=JSON.parse('{"concept":[{"name":"model element","nature":"prototype","attributes":[{"name":"name","target":{"name":"name"},"required":true},{"name":"description","target":{"name":"string"},"required":true}]},{"name":"model concept","description":"A prototype of a concept.","nature":"prototype","prototype":"model element","attributes":[{"name":"properties","target":{"name":"set","accept":{"name":"property"},"min":0},"required":true,"description":"The list of properties of your concept."}]},{"name":"prototype concept","description":"A prototype creates a base skeleton to provide reusability and extension to concepts of the model. Any concept can reuse a prototype and would inherit its structure.","nature":"concrete","prototype":"model concept","attributes":[{"name":"attributes","target":{"name":"set","accept":{"name":"attribute"},"min":0},"required":true,"description":"The list of attributes of your concept."},{"name":"prototype","target":{"name":"reference","accept":{"name":"prototype concept"}}}],"build":{"nature":"prototype"}},{"name":"concrete concept","description":"A concrete concept represents the model\'s actual concepts. Projections can be defined against its structure.","nature":"concrete","prototype":"model concept","attributes":[{"name":"attributes","target":{"name":"set","accept":{"name":"attribute"},"min":0},"required":true,"description":"The list of attributes of your concept."},{"name":"prototype","target":{"name":"reference","accept":{"name":"prototype concept"}}}],"build":{"nature":"concrete"}},{"name":"derivative concept","description":"A derivative concept represents...","nature":"concrete","prototype":"model concept","attributes":[{"name":"base","target":{"name":"primitive","accept":[{"name":"string primitive"},{"name":"number primitive"}]},"required":true}],"build":{"nature":"derivative"}},{"name":"structure","nature":"prototype","prototype":"model element","attributes":[{"name":"alias","target":{"name":"string"},"required":false,"description":"The alias of the structure."}]},{"name":"attribute","nature":"concrete","prototype":"structure","attributes":[{"name":"required","target":{"name":"boolean"},"required":true,"description":"The value indicating whether the structure is required for the parent concept."},{"name":"target","target":{"name":"primitive"},"required":true,"description":"The target concept of the attribute structure."}]},{"name":"property","nature":"concrete","prototype":"structure","attributes":[{"name":"target","target":{"name":"value"},"required":true,"description":"The target concept of the property structure."}]},{"name":"primitive","nature":"prototype","attributes":[]},{"name":"string primitive","nature":"concrete","prototype":"primitive","attributes":[{"name":"default","target":{"name":"string"},"description":"Default value."},{"name":"length","target":{"name":"number constraint"},"required":false},{"name":"pattern","target":{"name":"string"},"required":false},{"name":"values","target":{"name":"set","accept":{"name":"string"},"min":0},"required":false,"description":"The list of string values accepted by the string instance."}],"build":{"name":"string"}},{"name":"number primitive","nature":"concrete","prototype":"primitive","attributes":[{"name":"default","target":{"name":"number"}},{"name":"value","target":{"name":"number constraint"},"required":false},{"name":"values","target":{"name":"set","accept":{"name":"number"},"min":1},"required":false}],"build":{"name":"number"}},{"name":"boolean primitive","nature":"concrete","prototype":"primitive","attributes":[{"name":"default","target":{"name":"boolean"}}],"build":{"name":"boolean"}},{"name":"reference primitive","nature":"concrete","prototype":"primitive","attributes":[{"name":"accept","target":{"name":"primitive"},"required":true}],"build":{"name":"reference"}},{"name":"set primitive","nature":"concrete","prototype":"primitive","attributes":[{"name":"accept","target":{"name":"primitive"},"required":true},{"name":"ordered","target":{"name":"boolean"},"required":true},{"name":"cardinality","target":{"name":"number constraint"},"required":true}],"build":{"name":"set"}},{"name":"concept primitive","nature":"concrete","prototype":"primitive","attributes":[{"name":"concept","target":{"name":"reference","accept":{"prototype":"model concept"}},"required":true}],"build":{"name":"concept"}},{"name":"constraint","nature":"prototype","attributes":[]},{"name":"number constraint","nature":"prototype","attributes":[]},{"name":"number constraint value","nature":"concrete","prototype":"number constraint","attributes":[{"name":"value","target":{"name":"number"}}]},{"name":"number constraint range","nature":"concrete","prototype":"number constraint","attributes":[{"name":"min","target":{"name":"number constraint range value"},"description":"Defines the minimum number of characters the user must input. This must be an integer value 0 or higher. If no minlength is specified, or an invalid value is specified, the input has no minimum length."},{"name":"max","target":{"name":"number constraint range value"},"description":"Defines the maximum number of characters the user can input. This must be an integer value 0 or higher. If no maxlength is specified, or an invalid value is specified, the input has no maximum length."}]},{"name":"number constraint range value","nature":"concrete","attributes":[{"name":"value","target":{"name":"number"},"description":"Value of a range"},{"name":"included","target":{"name":"boolean"},"description":"Value is included in the range"}]},{"name":"value","nature":"prototype","attributes":[]},{"name":"string value","nature":"concrete","prototype":"value","attributes":[{"name":"value","target":{"name":"string"}}],"properties":[{"name":"type","type":"string","value":"string"}]},{"name":"number value","nature":"concrete","prototype":"value","attributes":[{"name":"value","target":{"name":"number"}}],"properties":[{"name":"type","type":"string","value":"number"}]},{"name":"boolean value","nature":"concrete","prototype":"value","attributes":[{"name":"value","target":{"name":"boolean"}}],"properties":[{"name":"type","type":"string","value":"boolean"}]},{"name":"name","nature":"derivative","base":"string","length":{"min":{"value":1},"max":{"value":80}}}]}')},3:e=>{e.exports=JSON.parse('{"editor":{"name":"Gentleman concept","root":["prototype concept","concrete concept","derivative concept"],"header":{"tabs":[{}],"css":["editor-header"]},"body":{"concept":{"actions":[{"name":"build"}],"css":["concept-section"]},"css":["editor-body"]},"menu":{"actions":[{"name":"build-concept","handler":"gentleman_concept","content":"Build","downloadable":true},{"name":"export"},{"name":"ecore"}],"css":["model-concept-list"]}}}')},438:e=>{e.exports=JSON.parse('{"projection":[{"name":"concept-definition","type":"template","param":[{"name":"conceptType","type":"string"}],"content":[{"type":"static","static":{"type":"text","content":"Define","style":{"css":["keyword","model-concept__keyword"]}}},{"type":"static","static":{"type":"text","content":{"type":"param","name":"conceptType"},"style":{"css":["keyword","model-concept__keyword"],"text":{"bold":true}}}},{"type":"attribute","name":"name","tag":"textual"}]},{"name":"attribute-definition","type":"template","content":[{"type":"static","static":{"type":"text","content":"Attribute definition","style":{"css":["title","model-projection__line"]}}},{"type":"attribute","name":"attributes","tag":"attribute-set","style":{"css":["model-projection__line"]}}]},{"type":"template","name":"property-definition","content":[{"type":"static","static":{"type":"text","content":"Property definition","style":{"css":["title","model-projection__line"]}}},{"type":"attribute","name":"properties","tag":"property-set","style":{"css":["model-projection__line"]}}]},{"concept":{"name":"prototype concept"},"type":"layout","tags":["textual"],"content":{"type":"stack","orientation":"vertical","disposition":[{"type":"layout","layout":{"type":"wrap","disposition":[{"type":"template","name":"concept-definition","param":[{"name":"conceptType","value":"prototype concept"}]}],"style":{"css":["line","model-concept__line"]}}},{"type":"template","name":"attribute-definition"}],"style":{"css":["model-concept","model-concept--textual"]}}},{"concept":{"name":"concrete concept"},"type":"layout","tags":["textual"],"content":{"type":"stack","orientation":"vertical","disposition":[{"type":"layout","layout":{"type":"wrap","disposition":[{"type":"template","name":"concept-definition","param":[{"name":"conceptType","value":"concrete concept"}]},{"type":"static","static":{"type":"text","content":"as","style":{"css":["keyword","model-concept__keyword"]}}},{"type":"attribute","name":"prototype","tag":"textual"}],"style":{"css":["line","model-concept__line"]}}},{"type":"template","name":"attribute-definition"},{"type":"template","name":"property-definition"}],"style":{"css":["model-concept","model-concept--textual"]}}},{"concept":{"name":"derivative concept"},"type":"layout","tags":["textual"],"content":{"type":"stack","orientation":"vertical","disposition":[{"type":"layout","layout":{"type":"wrap","disposition":[{"type":"template","name":"concept-definition","param":[{"name":"conceptType","value":"derivative concept"}]}],"style":{"css":["line","model-concept__line"]}}},{"type":"static","static":{"type":"text","content":"Base definition","style":{"css":["title"]}}},{"type":"attribute","name":"base"},{"type":"template","name":"property-definition"}],"style":{"css":["model-concept","model-concept--textual"]}}},{"concept":{"prototype":"model concept"},"type":"layout","tags":["choice","choice-selection"],"content":{"type":"wrap","focusable":false,"disposition":[{"type":"attribute","name":"name","tag":"readonly-string"}]}},{"concept":{"name":"attribute"},"type":"layout","tags":["attribute-list-item--textual"],"content":{"type":"stack","orientation":"vertical","disposition":[{"type":"layout","layout":{"type":"wrap","disposition":[{"type":"static","static":{"type":"text","content":"Define ","style":{"css":["keyword"]}}},{"type":"attribute","name":"required","tag":"field-binary-state"},{"type":"static","static":{"type":"text","content":"attribute ","style":{"css":["keyword"]}}},{"type":"attribute","name":"name","tag":"textual"},{"type":"static","static":{"type":"text","content":"of type ","style":{"css":["keyword"]}}}],"style":{"css":["line"]}}},{"type":"attribute","name":"target","tag":"textual"}],"style":{"css":["attribute-list-item-container"]}}},{"concept":{"name":"property"},"type":"layout","tags":["property-list-item--textual"],"content":{"type":"stack","orientation":"vertical","disposition":[{"type":"layout","layout":{"type":"wrap","disposition":[{"type":"static","static":{"type":"text","content":"Define property","style":{"css":["keyword"]}}},{"type":"attribute","name":"name","tag":"textual"},{"type":"static","static":{"type":"text","content":"of type ","style":{"css":["keyword"]}}}],"style":{"css":["line"]}}},{"type":"attribute","name":"target","tag":"textual"}],"style":{"css":["attribute-list-item-container"]}}},{"concept":{"name":"primitive"},"type":"field","tags":["textual"],"content":{"type":"choice","content":[{"type":"input","input":{"placeholder":"concept","style":{"css":["target-choice--textual__input"]}}},{"type":"choice","choice":{"style":{"css":["target-choice--textual__list"]},"option":{"style":{"css":["target-choice--textual__list-option"]}}}}],"style":{"css":["target-choice--textual"]}}},{"concept":{"name":"primitive"},"type":"field","tags":["textual-reference"],"content":{"type":"choice","content":[{"type":"input","input":{"placeholder":"concept\'s name","style":{"css":["target-choice--textual__input"]}}},{"type":"choice","choice":{"style":{"css":["target-choice--textual__list"]},"option":{"style":{"css":["target-choice--textual__list-option"]}}}}],"selection":{"template":{"tag":"choice-selection--name"}},"style":{"css":["target-choice--textual"]}}},{"concept":{"name":"string primitive"},"type":"layout","tags":["choice-selection"],"content":{"type":"stack","orientation":"vertical","disposition":[{"type":"attribute","name":"default","tag":"default-string"},{"type":"static","static":{"type":"text","content":"Constraint","style":{"css":["title","primitive-constraint__title"]}}},{"type":"attribute","name":"length"},{"type":"attribute","name":"pattern","tag":"label-string"}]}},{"concept":{"name":"string primitive"},"type":"layout","tags":["choice","choice-selection--name"],"content":{"type":"wrap","focusable":false,"disposition":[{"type":"static","static":{"type":"text","content":"String","focusable":false}}]}},{"concept":{"name":"number constraint"},"type":"field","tags":["length"],"content":{"type":"choice","content":[{"type":"static","static":{"type":"text","content":"Restrict length with","style":{"css":["keyword","constraint-choice--textual__keyword"]}}},{"type":"input","input":{"placeholder":"type","style":{"css":["constraint-choice--textual__input"]}}},{"type":"choice","choice":{"style":{"css":["constraint-choice--textual__list"]},"option":{"style":{"css":["constraint-choice--textual__list-option"]}}}}],"style":{"css":["constraint-choice--textual"]}}},{"concept":{"name":"number constraint"},"type":"field","tags":["value"],"content":{"type":"choice","content":[{"type":"static","static":{"type":"text","content":"Restrict value with","style":{"css":["keyword","constraint-choice--textual__keyword"]}}},{"type":"input","input":{"placeholder":"type","style":{"css":["constraint-choice--textual__input"]}}},{"type":"choice","choice":{"style":{"css":["constraint-choice--textual__list"]},"option":{"style":{"css":["constraint-choice--textual__list-option"]}}}}],"style":{"css":["constraint-choice--textual"]}}},{"concept":{"name":"number constraint"},"type":"field","tags":["cardinality"],"content":{"type":"choice","content":[{"type":"static","static":{"type":"text","content":"Restrict cardinality with","style":{"css":["keyword","constraint-choice--textual__keyword"]}}},{"type":"input","input":{"placeholder":"type","style":{"css":["constraint-choice--textual__input"]}}},{"type":"choice","choice":{"style":{"css":["constraint-choice--textual__list"]},"option":{"style":{"css":["constraint-choice--textual__list-option"]}}}}],"style":{"css":["constraint-choice--textual"]}}},{"concept":{"name":"number constraint value"},"type":"layout","tags":["choice-selection"],"content":{"type":"stack","orientation":"horizontal","disposition":[{"type":"attribute","name":"value","tag":"label-number"}]}},{"concept":{"name":"number constraint value"},"type":"layout","tags":["choice"],"content":{"type":"wrap","focusable":false,"disposition":[{"type":"static","static":{"type":"text","content":"Fixed value","focusable":false}}]}},{"concept":{"name":"number constraint range"},"type":"layout","tags":["choice-selection"],"content":{"type":"stack","orientation":"vertical","disposition":[{"type":"layout","layout":{"type":"wrap","disposition":[{"type":"static","static":{"type":"text","content":"Minimum:"}},{"type":"attribute","name":"min"}],"style":{"css":["constraint-range"]}}},{"type":"layout","layout":{"type":"wrap","disposition":[{"type":"static","static":{"type":"text","content":"Maximum:"}},{"type":"attribute","name":"max"}],"style":{"css":["constraint-range"]}}}]}},{"concept":{"name":"number constraint range"},"type":"layout","tags":["choice"],"content":{"type":"wrap","focusable":false,"disposition":[{"type":"static","static":{"type":"text","content":"Range","focusable":false}}]}},{"concept":{"name":"number constraint range value"},"type":"layout","tags":[],"content":{"type":"wrap","disposition":[{"type":"attribute","name":"value","tag":"textual"},{"type":"attribute","name":"included","tag":"field-binary-state--included"}],"style":{"css":["constraint-range-value"]}}},{"concept":{"name":"number primitive"},"type":"layout","tags":["choice-selection"],"content":{"type":"stack","orientation":"vertical","disposition":[{"type":"attribute","name":"default","tag":"default-number"},{"type":"static","static":{"type":"text","content":"Constraint","style":{"css":["title","primitive-constraint__title"]}}},{"type":"attribute","name":"value","tag":"value"}]}},{"concept":{"name":"number primitive"},"type":"layout","tags":["choice","choice-selection--name"],"content":{"type":"wrap","focusable":false,"disposition":[{"type":"static","static":{"type":"text","content":"Number","focusable":false}}]}},{"concept":{"name":"boolean primitive"},"type":"layout","tags":["choice-selection","choice-selection--name"],"content":{"type":"wrap","disposition":[{"type":"attribute","name":"default","tag":"default-boolean"}]}},{"concept":{"name":"boolean primitive"},"type":"layout","tags":["choice"],"content":{"type":"wrap","focusable":false,"disposition":[{"type":"static","static":{"type":"text","content":"Boolean","focusable":false}}]}},{"concept":{"name":"reference primitive"},"type":"layout","tags":["choice-selection"],"content":{"type":"stack","orientation":"vertical","disposition":[{"type":"static","static":{"type":"text","content":"Reference target","style":{"css":["title","primitive-constraint__title"]}}},{"type":"attribute","name":"accept","tag":"textual-reference"}]}},{"concept":{"name":"reference primitive"},"type":"layout","tags":["choice"],"content":{"type":"wrap","focusable":false,"disposition":[{"type":"static","static":{"type":"text","content":"Reference","focusable":false}}]}},{"concept":{"name":"set primitive"},"type":"layout","tags":["choice-selection"],"content":{"type":"stack","orientation":"vertical","disposition":[{"type":"attribute","name":"ordered"},{"type":"static","static":{"type":"text","content":"Constraint","style":{"css":["title","primitive-constraint__title"]}}},{"type":"attribute","name":"cardinality","tag":"cardinality"},{"type":"static","static":{"type":"text","content":"Element target","style":{"css":["title","primitive-constraint__title"]}}},{"type":"attribute","name":"accept","tag":"textual"}]}},{"concept":{"name":"set primitive"},"type":"layout","tags":["choice","choice-selection--name"],"content":{"type":"wrap","focusable":false,"disposition":[{"type":"static","static":{"type":"text","content":"Set","focusable":false}}]}},{"concept":{"name":"concept primitive"},"type":"layout","tags":["choice-selection","choice-selection--name"],"content":{"type":"wrap","disposition":[{"type":"attribute","name":"concept","tag":"textual"}]}},{"concept":{"name":"concept primitive"},"type":"layout","tags":["choice"],"content":{"type":"wrap","focusable":false,"disposition":[{"type":"static","static":{"type":"text","content":"Containment","focusable":false}}]}},{"concept":{"name":"value"},"type":"field","tags":["textual"],"content":{"type":"choice","content":[{"type":"input","input":{"placeholder":"primitive","style":{"css":["target-choice--textual__input"]}}},{"type":"choice","choice":{"style":{"css":["target-choice--textual__list"]},"option":{"style":{"css":["target-choice--textual__list-option"]}}}}],"style":{"css":["target-choice--textual"]}}},{"concept":{"name":"number value"},"type":"layout","tags":["choice-selection"],"content":{"type":"wrap","disposition":[{"type":"attribute","name":"value","tag":"textual"}]}},{"concept":{"name":"number value"},"type":"layout","tags":["choice"],"content":{"type":"wrap","focusable":false,"disposition":[{"type":"static","static":{"type":"text","content":"Number"}}]}},{"concept":{"name":"string value"},"type":"layout","tags":["choice-selection"],"content":{"type":"stack","orientation":"horizontal","disposition":[{"type":"attribute","name":"value","tag":"textual"}]}},{"concept":{"name":"string value"},"type":"layout","tags":["choice"],"content":{"type":"wrap","focusable":false,"disposition":[{"type":"static","static":{"type":"text","content":"String","focusable":false}}]}},{"concept":{"name":"boolean value"},"type":"layout","tags":["choice-selection"],"content":{"type":"stack","orientation":"horizontal","disposition":[{"type":"attribute","name":"value","tag":"choice-boolean"}]}},{"concept":{"name":"boolean value"},"type":"layout","tags":["choice"],"projection":{"type":"wrap","focusable":false,"disposition":[{"type":"static","static":{"type":"text","content":"Boolean"}}]}},{"concept":{"name":"boolean"},"type":"field","tags":["field-binary-state"],"content":{"type":"binary","style":{"css":["yesno-field"]},"label":{"style":{"css":["yesno-field__value"]}},"state":[{"rule":{"type":"eq","eq":[{"prop":"value"},true]},"result":{"label":{"projection":{"type":"static","static":{"type":"text","content":"required","focusable":false}}}}},{"rule":{"type":"eq","eq":[{"prop":"value"},false]},"result":{"label":{"projection":{"type":"static","static":{"type":"text","content":"optional","focusable":false}}}}}],"input":{"style":{"css":["yesno-field__input"]}}}},{"concept":{"name":"boolean"},"type":"field","tags":["default-boolean"],"content":{"type":"binary","state":[{"rule":{"type":"eq","eq":[{"prop":"value"},true]},"result":{"label":{"projection":[{"type":"static","static":{"type":"text","content":{"type":"property","name":"refname"},"style":{"css":["label","yesno-field__label"]}}},{"type":"static","static":{"type":"text","content":"true","focusable":false,"style":{"css":["yesno-field__value"]}}}]}}},{"rule":{"type":"eq","eq":[{"prop":"value"},false]},"result":{"label":{"projection":[{"type":"static","static":{"type":"text","content":{"type":"property","name":"refname"},"style":{"css":["label","yesno-field__label"]}}},{"type":"static","static":{"type":"text","content":"false","focusable":false,"style":{"css":["yesno-field__value"]}}}]}}}],"input":{"style":{"css":["yesno-field__input"]}},"style":{"css":["yesno-field"]}}},{"concept":{"name":"boolean"},"type":"field","tags":["choice-boolean"],"content":{"type":"choice","content":[{"type":"choice","choice":{"option":{"style":{"css":["boolean-choice-option"]}},"style":{"css":["boolean-choice-list"]}}}],"style":{"css":["boolean-choice"]}}},{"concept":{"name":"boolean"},"type":"field","tags":["field-binary-state--included"],"content":{"type":"binary","style":{"css":["yesno-field"]},"label":{"style":{"css":["yesno-field__value"]}},"state":[{"rule":{"type":"eq","eq":[{"prop":"value"},true]},"result":{"label":{"projection":{"type":"static","static":{"type":"text","content":"included","focusable":false}}}}},{"rule":{"type":"eq","eq":[{"prop":"value"},false]},"result":{"label":{"projection":{"type":"static","static":{"type":"text","content":"excluded","focusable":false}}}}}],"input":{"style":{"css":["yesno-field__input"]}}}},{"concept":{"name":"number"},"type":"field","tags":["default-number"],"content":{"type":"text","content":[{"type":"static","static":{"type":"text","content":"Default value: ","focusable":false,"style":{"css":["textfield--labeled__label","label"]}}},{"type":"input","input":{"placeholder":"null","style":{"css":["textfield--labeled__input"]}}}],"style":{"css":["textfield--labeled"]}}},{"concept":{"name":"number"},"type":"field","tags":["list-item"],"projection":{"type":"text","content":[{"type":"input","input":{"type":"number"}}]}},{"concept":{"name":"number"},"type":"field","tags":["textual"],"content":{"type":"text","resizable":true,"content":[{"type":"input","input":{"placeholder":"number","style":{"css":["name-field--textual__input"]}}}],"style":{"css":["name-field","name-field--textual"]}}},{"concept":{"name":"number"},"type":"field","tags":["label-number"],"content":{"type":"text","resizable":true,"content":[{"type":"static","static":{"type":"text","content":{"type":"property","name":"refname"},"style":{"css":["name-field--textual__label"]}}},{"type":"input","input":{"style":{"css":["name-field--textual__input"]}}}],"style":{"css":["name-field","name-field--textual"]}}},{"concept":{"name":"reference"},"type":"field","tags":["textual"],"content":{"type":"choice","content":[{"type":"input","input":{"placeholder":"name","style":{"css":["reference-choice--textual__input"]}}},{"type":"choice","choice":{"style":{"css":["reference-choice--textual__list"]},"option":{"style":{"css":["reference-choice--textual__list-option"]}}}}],"style":{"css":["reference-choice--textual"]}}},{"concept":{"name":"set"},"type":"field","tags":["attribute-set"],"content":{"type":"list","content":[{"type":"list","list":{"style":{"css":["attribute-list--textual__list"]},"item":{"template":{"tag":"attribute-list-item--textual"},"style":{"css":["attribute-list--textual__list-item"]}}}},{"type":"action","name":"add","content":{"type":"static","static":{"type":"text","help":"Add an attribute","content":"New attribute","focusable":false}},"style":{"css":["attribute-list--textual__btn-add"]}}],"action":{"remove":{"content":{"type":"static","static":{"type":"text","help":"Remove attribute","content":""}},"style":{"css":["attribute-list--textual__btn-remove"]}}},"style":{"css":["attribute-list--textual"]}}},{"concept":{"name":"set"},"type":"field","tags":["property-set"],"content":{"type":"list","content":[{"type":"list","list":{"style":{"css":["property-list--textual__list"]},"item":{"template":{"tag":"property-list-item--textual"},"style":{"css":["property-list--textual__list-item"]}}}},{"type":"action","name":"add","content":{"type":"static","static":{"type":"text","help":"Add an property","content":"New property","focusable":false}},"style":{"css":["property-list--textual__btn-add"]}}],"action":{"remove":{"content":{"type":"static","static":{"type":"text","help":"Remove property","content":""}},"style":{"css":["property-list--textual__btn-remove"]}}},"style":{"css":["property-list--textual"]}}},{"concept":{"name":"string"},"type":"field","tags":["readonly-string"],"content":{"type":"text","readonly":true,"content":[{"type":"input"}]}},{"concept":{"name":"name"},"type":"field","tags":["textual","list-item"],"content":{"type":"text","resizable":true,"content":[{"type":"input","input":{"placeholder":"name","style":{"css":["textfield--labeled__input"]}}}],"style":{"css":["textfield--labeled"]}}},{"concept":{"name":"string"},"type":"field","tags":["textual","list-item"],"content":{"type":"text","resizable":true,"content":[{"type":"input","input":{"placeholder":"null","style":{"css":["textfield--labeled__input"]}}}],"style":{"css":["textfield--labeled"]}}},{"concept":{"name":"string"},"type":"field","tags":["default-string"],"content":{"type":"text","resizable":true,"content":[{"type":"static","static":{"type":"text","content":"Default value: ","focusable":false,"style":{"css":["textfield--labeled__label","label"]}}},{"type":"input","input":{"placeholder":"null","style":{"css":["textfield--labeled__input"]}}}],"style":{"css":["textfield--labeled"]}}},{"concept":{"name":"string"},"type":"field","tags":["label-string"],"content":{"type":"text","resizable":true,"content":[{"type":"static","static":{"type":"text","content":{"type":"property","name":"refname"},"style":{"css":["name-field--textual__label"]}}},{"type":"input","input":{"style":{"css":["name-field--textual__input"]}}}],"style":{"css":["name-field","name-field--textual"]}}}]}')},76:e=>{e.exports=JSON.parse('{"concept":[{"name":"projection","nature":"concrete","attributes":[{"name":"concept","target":{"name":"concept"},"required":true},{"name":"name","target":{"name":"name"},"required":false},{"name":"content","target":{"name":"component"},"required":true},{"name":"tags","target":{"name":"set","accept":{"name":"tag"},"min":0},"required":true}],"build":{"handler":"projection"}},{"name":"template","nature":"concrete","attributes":[{"name":"name","target":{"name":"name"},"required":true},{"name":"content","target":{"name":"set","accept":{"name":"element"},"min":1}}],"build":{"handler":"template"}},{"name":"component","nature":"prototype","attributes":[]},{"name":"layout component","nature":"concrete","prototype":"component","attributes":[{"name":"layout","target":{"name":"layout"}}],"build":{"type":"layout"}},{"name":"field component","nature":"concrete","prototype":"component","attributes":[{"name":"field","target":{"name":"field"}}],"build":{"type":"field"}},{"name":"concept","nature":"concrete","attributes":[{"name":"name","target":{"name":"name"}},{"name":"prototype","target":{"name":"string","length":{"min":{"value":1}}}}]},{"name":"tag","nature":"derivative","base":"string","pattern":"^\\\\w+(-\\\\w+)*$"},{"name":"render","nature":"prototype","attributes":[{"name":"style","target":{"name":"style"},"required":false}]},{"name":"field","nature":"prototype","prototype":"render","attributes":[{"name":"readonly","target":{"name":"boolean","default":false}},{"name":"disabled","target":{"name":"boolean","default":false}}]},{"name":"text field","nature":"concrete","prototype":"field","attributes":[{"name":"content","target":{"name":"set","accept":{"name":"element"},"min":1}},{"name":"multiline","target":{"name":"boolean","default":false}}],"build":{"contentType":"field","elementType":"text"}},{"name":"binary field","nature":"concrete","prototype":"field","attributes":[{"name":"content","target":{"name":"set","accept":{"name":"state element"},"min":1,"max":2}}],"build":{"contentType":"field","elementType":"binary"}},{"name":"state element","nature":"concrete","attributes":[{"name":"state","target":{"name":"boolean"},"required":false},{"name":"content","target":{"name":"element"}}]},{"name":"choice field","nature":"concrete","prototype":"field","attributes":[{"name":"choice template","target":{"name":"template reference"}},{"name":"selection template","target":{"name":"template reference"}}],"build":{"contentType":"field","elementType":"choice"}},{"name":"template reference","nature":"concrete","attributes":[{"name":"tag","target":{"name":"tag"}},{"name":"name","target":{"name":"string"}}]},{"name":"list field","nature":"concrete","prototype":"field","attributes":[{"name":"orientation","target":{"name":"string","values":["horizontal","vertical"]}},{"name":"action","target":{"name":"list field action"}},{"name":"item template","target":{"name":"template reference"}}],"build":{"contentType":"field","elementType":"list"}},{"name":"list field action","nature":"concrete","attributes":[{"name":"add","target":{"name":"action"}},{"name":"remove","target":{"name":"action"}}]},{"name":"action","nature":"concrete","prototype":"render","attributes":[{"name":"content","target":{"name":"set","accept":{"name":"static element"}}}]},{"name":"table field","nature":"concrete","prototype":"field","attributes":[{"name":"orientation","target":{"name":"string","values":["column","row"]}},{"name":"template","target":{"name":"reference","accept":{"name":"template"}}},{"name":"table","target":{"name":"table"}}],"build":{"contentType":"field","elementType":"table"}},{"name":"table","nature":"concrete","prototype":"render","attributes":[{"name":"header","target":{"name":"style"},"required":false},{"name":"body","target":{"name":"style"},"required":true},{"name":"footer","target":{"name":"style"},"required":false}]},{"name":"element","nature":"prototype","prototype":"render","attributes":[{"name":"name","target":{"name":"string"}}]},{"name":"layout","nature":"prototype","prototype":"element","attributes":[{"name":"elements","target":{"name":"set","accept":{"name":"element"},"min":1}}]},{"name":"stack layout","nature":"concrete","prototype":"layout","attributes":[{"name":"orientation","target":{"name":"string","values":["horizontal","vertical"],"default":"vertical"}}],"build":{"contentType":"layout","elementType":"stack"}},{"name":"wrap layout","nature":"concrete","prototype":"layout","build":{"contentType":"layout","elementType":"wrap"}},{"name":"cell layout","nature":"concrete","prototype":"layout","attributes":[{"name":"orientation","target":{"name":"string","values":["row","column"]}},{"name":"rows","target":{"name":"set","accept":{"name":"row"},"min":1}}],"build":{"contentType":"layout","elementType":"table"}},{"name":"relative layout","nature":"concrete","prototype":"$layout","attributes":[{"name":"elements","target":{"name":"set","accept":{"name":"position element"},"min":1}}],"build":{"contentType":"layout","elementType":"relative"}},{"name":"position element","nature":"concrete","attributes":[{"name":"tag","target":{"name":"tag"}},{"name":"element","target":{"name":"element"}}]},{"name":"position","nature":"concrete","attributes":[{"name":"top","target":{"name":"number"}},{"name":"right","target":{"name":"number"}},{"name":"bottom","target":{"name":"number"}},{"name":"left","target":{"name":"number"}}]},{"name":"row","nature":"concrete","prototype":"render","attributes":[{"name":"cells","target":{"name":"set","accept":{"name":"cell"},"min":1}}]},{"name":"cell","nature":"concrete","prototype":"render","attributes":[{"name":"span","target":{"name":"number","value":{"min":0}}},{"name":"content","target":{"name":"element"}}]},{"name":"$template","nature":"prototype","attributes":[{"name":"style","target":{"name":"style"},"required":false}]},{"name":"table template","nature":"concrete","prototype":"$template","attributes":[{"name":"row","target":{"name":"set","accept":{"name":"table cell"},"min":1}}]},{"name":"table cell","nature":"concrete","attributes":[{"name":"header","target":{"name":"static element"}},{"name":"body","target":{"name":"attribute element"}}]},{"name":"table header cell","nature":"concrete","prototype":"render","attributes":[{"name":"content","target":{"name":"static element"}}]},{"name":"table body cell","nature":"concrete","prototype":"render","attributes":[{"name":"content","target":{"name":"attribute element"}}]},{"name":"static element","nature":"prototype","prototype":"element","attributes":[]},{"name":"atomic element","nature":"prototype","prototype":"static element","attributes":[{"name":"content","target":{"name":"string"}}]},{"name":"static text","nature":"concrete","prototype":"atomic element","attributes":[{"name":"content type","alias":"contentType","target":{"name":"string","values":["text","html"]},"value":"text"}],"build":{"contentType":"static","elementType":"text"}},{"name":"static image","nature":"concrete","prototype":"atomic element","attributes":[{"name":"height","target":{"name":"number"}},{"name":"width","target":{"name":"number"}},{"name":"url","alias":"src","target":{"name":"string"}},{"name":"alternative text","alias":"alt","target":{"name":"string"}}],"build":{"contentType":"static","elementType":"image"}},{"name":"static HTML","nature":"concrete","prototype":"atomic element","attributes":[{"name":"selector","target":{"name":"string"}}],"build":{"contentType":"static","elementType":"html"}},{"name":"static link","nature":"concrete","prototype":"static element","attributes":[{"name":"url","alias":"href","target":{"name":"string"}},{"name":"url type","alias":"urlType","target":{"name":"string","values":["link","email","phone"]}},{"name":"content","target":{"name":"set","accept":{"name":"static element"}}},{"name":"download","target":{"name":"boolean"}}],"build":{"contentType":"static","elementType":"link"}},{"name":"dynamic element","nature":"prototype","prototype":"element","attributes":[]},{"name":"input","nature":"concrete","prototype":"dynamic element","attributes":[{"name":"placeholder","target":{"name":"string"}}],"build":{"contentType":"dynamic","elementType":"input"}},{"name":"checkbox","nature":"concrete","prototype":"dynamic element","attributes":[{"name":"label","target":{"name":"string"}}],"build":{"contentType":"dynamic","elementType":"checkbox"}},{"name":"attribute element","nature":"concrete","prototype":"element","attributes":[{"name":"value","target":{"name":"string"}},{"name":"tag","target":{"name":"tag"},"required":true}],"build":{"contentType":"attribute"}},{"name":"template element","nature":"concrete","prototype":"element","attributes":[{"name":"value","target":{"name":"reference","accept":{"name":"template"}}}],"build":{"contentType":"template"}},{"name":"style","nature":"concrete","attributes":[{"name":"css","target":{"name":"set","accept":{"name":"string"},"min":1}}]},{"name":"name","nature":"derivative","base":"string","length":{"min":{"value":1},"max":{"value":80}}}]}')},678:e=>{e.exports=JSON.parse('{"editor":{"name":"Gentleman projection","root":["projection","template"],"header":{"tabs":[{}],"css":["editor-header"]},"body":{"concept":{"actions":[{"name":"build"}],"css":["concept-section"]},"css":["editor-body"]},"menu":{"actions":[{"name":"build-projection","content":"Build","downloadable":true},{"name":"preview-projection","content":"Preview"},{"name":"export"}],"css":["editor-menu"]}}}')},230:e=>{e.exports=JSON.parse('{"projection":[{"concept":{"name":"template"},"type":"layout","tags":[],"projection":{"type":"stack","orientation":"vertical","style":{"css":["model-projection"]},"disposition":[{"type":"layout","layout":{"type":"wrap","style":{"css":["line","model-projection__line"]},"disposition":[{"type":"static","static":{"type":"text","content":"Define template","style":{"css":["keyword"]}}},{"type":"attribute","name":"name","tag":"textual"}]}},{"type":"layout","layout":{"type":"wrap","style":{"css":["line","model-projection__line"]},"disposition":[{"type":"static","static":{"type":"text","content":"TEMPLATE CONTENT","style":{"css":["title"]}}}]}},{"type":"attribute","name":"content","tag":"element-set"}]}},{"concept":{"name":"template"},"type":"layout","tags":["choice","choice-selection"],"projection":{"type":"wrap","disposition":[{"type":"attribute","name":"name"}]}},{"concept":{"name":"projection"},"type":"layout","tags":[],"projection":{"type":"stack","orientation":"vertical","style":{"css":["model-projection"]},"disposition":[{"type":"layout","layout":{"type":"wrap","style":{"css":["line","model-projection__line"]},"disposition":[{"type":"static","static":{"type":"text","content":"Define projection as","style":{"css":["keyword"]}}},{"type":"attribute","name":"name","tag":"textual"}]}},{"type":"attribute","name":"concept"},{"type":"attribute","name":"tags","tag":"tag-set"},{"type":"layout","layout":{"type":"wrap","style":{"css":["line","model-projection__line"]},"disposition":[{"type":"static","static":{"type":"text","content":"PROJECTION COMPONENT","style":{"css":["title"]}}}]}},{"type":"attribute","name":"content"}]}},{"type":"template","name":"style section","content":[{"type":"static","static":{"type":"text","content":"Define style","style":{"css":["keyword"]}}},{"type":"attribute","name":"style"}]},{"concept":{"name":"component"},"type":"field","tags":[],"projection":{"type":"choice","content":[{"type":"static","static":{"type":"text","content":"Define main as","style":{"css":["keyword"]}}},{"type":"input","input":{"placeholder":"layout or field","style":{"css":["bracket-choice__input"]}}},{"type":"choice","choice":{"style":{"css":["bracket-choice__list"]},"option":{"style":{"css":["bracket-choice__list-option"]}}}}],"selection":{"style":{"css":["bracket-choice__selection"]}},"style":{"css":["bracket-choice"]}}},{"concept":{"name":"layout component"},"type":"layout","tags":["choice-selection"],"projection":{"type":"wrap","disposition":[{"type":"attribute","name":"layout"}],"style":{"css":["layout-component"]}}},{"concept":{"name":"layout component"},"type":"layout","tags":["choice"],"projection":{"type":"wrap","focusable":false,"disposition":[{"type":"static","static":{"type":"text","help":"Layout","content":"Layout","focusable":false}}]}},{"concept":{"name":"field component"},"type":"layout","tags":["choice-selection"],"projection":{"type":"wrap","disposition":[{"type":"attribute","name":"field"}],"style":{"css":["field-component"]}}},{"concept":{"name":"field component"},"type":"layout","tags":["choice"],"projection":{"type":"wrap","focusable":false,"disposition":[{"type":"static","static":{"type":"text","help":"Field component","content":"Field","focusable":false}}]}},{"concept":{"name":"concept"},"type":"layout","tags":[],"projection":{"type":"stack","orientation":"vertical","style":{"css":["block"]},"disposition":[{"type":"static","static":{"type":"text","content":"For concept with ","help":"Projection target concept","style":{"css":["keyword","block__line"]}}},{"type":"layout","layout":{"type":"wrap","style":{"css":["block__content"]},"disposition":[{"type":"attribute","name":"name","tag":"label-string"},{"type":"attribute","name":"prototype","tag":"label-string"}]}}]}},{"concept":{"name":"style"},"type":"layout","tags":[],"projection":{"type":"wrap","style":{"css":["projection-style-container"]},"disposition":[{"type":"attribute","name":"css","tag":"css-set"}]}},{"concept":{"name":"field"},"type":"field","tags":[],"projection":{"type":"choice","content":[{"type":"static","static":{"type":"text","help":"Layout component","content":"Define field as","style":{"css":["keyword"]}}},{"type":"input","input":{"placeholder":"type","style":{"css":["bracket-choice__input"]}}},{"type":"choice","choice":{"style":{"css":["bracket-choice__list"]},"option":{"style":{"css":["bracket-choice__list-option"]}}}}],"selection":{"style":{"css":["bracket-choice__selection"]}},"style":{"css":["bracket-choice"]}}},{"concept":{"name":"text field"},"type":"layout","tags":["choice-selection"],"projection":{"type":"stack","orientation":"vertical","style":{"css":["field-config","field-config--text"]},"disposition":[{"type":"attribute","name":"disabled","tag":"field-binary-state"},{"type":"attribute","name":"readonly","tag":"field-binary-state"},{"type":"attribute","name":"multiline","tag":"field-binary-state"},{"type":"attribute","name":"content","tag":"element-set"},{"type":"attribute","name":"style","state":[{"rule":{"type":"and","and":[{"type":"eq","eq":[{"prop":"required"},false]},{"type":"eq","eq":[{"prop":"created"},false]}]},"result":{"content":{"type":"layout","layout":{"type":"wrap","style":{"css":["model-concept-option","model-concept-option--prototype"]},"disposition":[{"type":"static","static":{"type":"text","content":"Use a prototype"}}]}}}}]}]}},{"concept":{"name":"text field"},"type":"layout","tags":["choice"],"projection":{"type":"wrap","focusable":false,"disposition":[{"type":"static","static":{"type":"text","help":"Text Field","content":"Text","focusable":false}}]}},{"concept":{"name":"binary field"},"type":"layout","tags":["choice-selection"],"projection":{"type":"stack","orientation":"vertical","style":{"css":["field-config","field-config--binary"]},"disposition":[{"type":"attribute","name":"disabled","tag":"field-binary-state"},{"type":"attribute","name":"readonly","tag":"field-binary-state"},{"type":"attribute","name":"content","tag":"state-element-set"}]}},{"concept":{"name":"binary field"},"type":"layout","tags":["choice"],"projection":{"type":"wrap","focusable":false,"disposition":[{"type":"static","static":{"type":"text","help":"Binary Field","content":"Binary","focusable":false}}]}},{"concept":{"name":"choice field"},"type":"layout","tags":["choice-selection"],"projection":{"type":"stack","orientation":"vertical","style":{"css":["field-config"]},"disposition":[{"type":"layout","layout":{"type":"wrap","style":{"css":["field-state-properties"]},"disposition":[{"type":"attribute","name":"disabled","tag":"field-binary-state"},{"type":"attribute","name":"readonly","tag":"field-binary-state"},{"type":"static","static":{"type":"text","content":"Use choice option template with ","style":{"css":["keyword","block__line"]}}},{"type":"attribute","name":"choice template"},{"type":"static","static":{"type":"text","content":"Use choice selection template with ","style":{"css":["keyword","block__line"]}}},{"type":"attribute","name":"selection template"}]}}]}},{"concept":{"name":"choice field"},"type":"layout","tags":["choice"],"projection":{"type":"wrap","focusable":false,"disposition":[{"type":"static","static":{"type":"text","help":"Choice Field","content":"Choice","focusable":false}}]}},{"concept":{"name":"list field"},"type":"layout","tags":["choice-selection"],"projection":{"type":"stack","orientation":"vertical","style":{"css":["listfield-config"]},"disposition":[{"type":"static","static":{"type":"text","content":"Use item template with ","style":{"css":["keyword","block__line"]}}},{"type":"attribute","name":"item template"}]}},{"concept":{"name":"list field"},"type":"layout","tags":["choice"],"projection":{"type":"wrap","focusable":false,"disposition":[{"type":"static","static":{"type":"text","help":"List Field","content":"List"}}]}},{"concept":{"name":"list field action"},"type":"layout","tags":["choice-selection"],"projection":{"type":"stack","orientation":"vertical","style":{"css":["field-action-config"]},"disposition":[{"type":"static","static":{"type":"text","content":"List actions","style":{"css":["title"]}}},{"type":"static","static":{"type":"text","content":"Define \'add\' action:","style":{"css":["keyword"]}}},{"type":"attribute","name":"add"},{"type":"static","static":{"type":"text","content":"Define \'remove\' action:","style":{"css":["keyword"]}}},{"type":"attribute","name":"remove"}]}},{"concept":{"name":"action"},"type":"layout","tags":["choice-selection"],"projection":{"type":"stack","orientation":"vertical","style":{"css":["action-config"]},"disposition":[{"type":"attribute","name":"content","tag":"element-set"}]}},{"concept":{"name":"table field"},"type":"layout","tags":["choice-selection"],"projection":{"type":"stack","orientation":"vertical","style":{"css":["field-config"]},"disposition":[{"type":"layout","layout":{"type":"wrap","style":{"css":["field-state-properties"]},"disposition":[{"type":"attribute","name":"disabled","tag":"field-binary-state"},{"type":"attribute","name":"readonly","tag":"field-binary-state"}]}},{"type":"attribute","name":"concept","tag":"concept-string"},{"type":"attribute","name":"template","tag":"template-string"}]}},{"concept":{"name":"table field"},"type":"layout","tags":["choice"],"projection":{"type":"wrap","focusable":false,"disposition":[{"type":"static","static":{"type":"text","help":"Table Field","content":"Table"}}]}},{"concept":{"name":"input"},"type":"layout","tags":["choice-selection"],"projection":{"type":"stack","orientation":"vertical","style":{"css":["input-config"]},"disposition":[{"type":"attribute","name":"placeholder","tag":"label-string"}]}},{"concept":{"name":"input"},"type":"layout","tags":["choice"],"projection":{"type":"wrap","focusable":false,"disposition":[{"type":"static","static":{"type":"text","help":"HTML input","content":"Input"}}]}},{"concept":{"name":"checkbox"},"type":"layout","tags":["choice-selection"],"projection":{"type":"stack","orientation":"vertical","style":{"css":["checkbox-config"]},"disposition":[{"type":"attribute","name":"label","tag":"concept-string"}]}},{"concept":{"name":"checkbox"},"type":"layout","tags":["choice"],"projection":{"type":"wrap","focusable":false,"disposition":[{"type":"static","static":{"type":"text","help":"HTML checkbox","content":"Checkbox"}}]}},{"concept":{"name":"layout"},"type":"field","tags":[],"projection":{"type":"choice","content":[{"type":"static","static":{"type":"text","help":"Layout component","content":"Begin layout with","style":{"css":["keyword"]}}},{"type":"input","input":{"placeholder":"type","style":{"css":["bracket-choice__input"]}}},{"type":"choice","choice":{"style":{"css":["bracket-choice__list"]},"option":{"style":{"css":["bracket-choice__list-option"]}}}}],"selection":{"style":{"css":["bracket-choice__selection"]}},"style":{"css":["bracket-choice"]}}},{"concept":{"name":"stack layout"},"type":"layout","tags":["choice-selection","choice-selection--content"],"projection":{"type":"stack","orientation":"vertical","style":{"css":["stack-layout"]},"disposition":[{"type":"attribute","name":"orientation","tag":"label-string"},{"type":"attribute","name":"elements","tag":"element-set"},{"type":"template","name":"style section"}]}},{"concept":{"name":"stack layout"},"type":"layout","tags":["choice-selection","choice-selection--style"],"projection":{"type":"stack","orientation":"vertical","style":{"css":["stack-layout"]},"disposition":[{"type":"projection","tag":"choice-selection--content","content":{"type":"static","static":{"type":"text","content":"Return to content"}},"style":{"css":["projection-style","projection-style--hide"]}},{"type":"attribute","name":"style"}]}},{"concept":{"name":"stack layout"},"type":"layout","tags":["choice"],"projection":{"type":"wrap","focusable":false,"disposition":[{"type":"static","static":{"type":"text","help":"Stack Layout","content":"Stack"}}]}},{"concept":{"name":"wrap layout"},"type":"layout","tags":["choice-selection"],"projection":{"type":"stack","orientation":"vertical","style":{"css":["stack-layout"]},"disposition":[{"type":"layout","layout":{"type":"wrap","style":{"css":["stack-layout-body"]},"disposition":[{"type":"attribute","name":"elements","tag":"element-set"}]}}]}},{"concept":{"name":"wrap layout"},"type":"layout","tags":["choice-selection"],"projection":{"type":"stack","orientation":"vertical","style":{"css":["stack-layout"]},"disposition":[{"type":"layout","layout":{"type":"wrap","style":{"css":["stack-layout-body"]},"disposition":[{"type":"attribute","name":"elements","tag":"element-set"}]}}]}},{"concept":{"name":"wrap layout"},"type":"layout","tags":["choice"],"projection":{"type":"wrap","focusable":false,"disposition":[{"type":"static","static":{"type":"text","help":"Wrap Layout","content":"Wrap"}}]}},{"concept":{"name":"cell layout"},"type":"layout","tags":["choice-selection"],"projection":{"type":"stack","orientation":"vertical","style":{"css":["cell-layout"]},"disposition":[{"type":"attribute","name":"orientation","tag":"concept-string"},{"type":"attribute","name":"rows","tag":"row-set"}]}},{"concept":{"name":"cell layout"},"type":"layout","tags":["choice"],"projection":{"type":"wrap","focusable":false,"disposition":[{"type":"static","static":{"type":"text","help":"Cell Layout","content":"Cell"}}]}},{"concept":{"name":"row"},"type":"layout","tags":["list-item"],"projection":{"type":"wrap","style":{"css":["field-config"]},"disposition":[{"type":"attribute","name":"cells","tag":"cell-set"}]}},{"concept":{"name":"cell"},"type":"layout","tags":["list-item"],"projection":{"type":"stack","orientation":"vertical","style":{"css":["field-config"]},"disposition":[{"type":"attribute","name":"span"},{"type":"attribute","name":"content"}]}},{"concept":{"name":"template"},"type":"field","tags":[],"projection":{"type":"choice","content":[{"type":"choice","choice":{"style":{"css":["template-choice"]},"option":{"style":{"css":["template-choice-option"]}}}}]}},{"concept":{"name":"table template"},"type":"layout","tags":["choice-selection"],"projection":{"type":"stack","orientation":"vertical","style":{"css":["stack-layout"]},"disposition":[{"type":"layout","layout":{"type":"wrap","style":{"css":["stack-layout-body"]},"disposition":[{"type":"text","style":{"css":["table-section-title"]},"content":"Header"},{"type":"attribute","name":"header","tag":"cell-set"},{"type":"text","style":{"css":["table-section-title"]},"content":"Body"},{"type":"attribute","name":"body","tag":"cell-set"}]}}]}},{"concept":{"name":"table template"},"type":"layout","tags":["choice"],"projection":{"type":"wrap","focusable":false,"disposition":[{"type":"text","content":"Table template"}]}},{"concept":{"name":"table header cell"},"type":"layout","tags":["list-item"],"projection":{"type":"wrap","disposition":[{"type":"attribute","name":"projection"}]}},{"concept":{"name":"table cell"},"type":"layout","tags":["list-item"],"projection":{"type":"wrap","disposition":[{"type":"attribute","name":"projection"}]}},{"concept":{"name":"template reference"},"type":"layout","tags":[],"projection":{"type":"wrap","disposition":[{"type":"attribute","name":"tag","tag":"label-string"},{"type":"attribute","name":"name","tag":"label-string"}],"style":{"css":["block__content"]}}},{"concept":{"name":"state element"},"type":"layout","tags":["list-item"],"projection":{"type":"stack","orientation":"vertical","disposition":[{"type":"attribute","name":"state"},{"type":"attribute","name":"content"}]}},{"concept":{"name":"element"},"type":"field","tags":["list-item"],"projection":{"type":"choice","content":[{"type":"input","input":{"placeholder":"select","style":{"css":["bracket-choice__input"]}}},{"type":"choice","choice":{"style":{"css":["bracket-choice__list"]},"option":{"style":{"css":["bracket-choice__list-option"]}}}}],"action":{"filter":{"projection":{"type":"text","content":"Filter"}},"reset":{"projection":{"type":"text","content":"Reset"}}},"selection":{"style":{"css":["bracket-choice__selection"]}},"style":{"css":["bracket-choice"]}}},{"concept":{"name":"static element"},"type":"field","tags":["list-item"],"projection":{"type":"choice","content":[{"type":"choice","choice":{"style":{"css":["static-choice"]},"option":{"style":{"css":["static-choice-option"]}}}}],"style":{"css":["static-choice-field"]}}},{"concept":{"name":"static element"},"type":"field","tags":["field-extra"],"projection":{"type":"choice","content":[{"type":"choice","choice":{"style":{"css":["static-choice"]},"option":{"style":{"css":["static-choice-option"]}}}}],"style":{"css":["static-choice-field"]}}},{"concept":{"name":"static text"},"type":"layout","tags":["choice-selection","choice-selection--content"],"projection":{"type":"stack","orientation":"vertical","disposition":[{"type":"attribute","name":"content","tag":"text-string"},{"type":"attribute","name":"content type","tag":"label-string"}],"style":{"css":["static-text"]}}},{"concept":{"name":"static text"},"type":"layout","tags":["choice-selection","choice-selection--style"],"projection":{"type":"stack","orientation":"vertical","disposition":[{"type":"projection","tag":"choice-selection--content","content":{"type":"static","static":{"type":"text","content":"Back"}},"style":{"css":["projection-style","projection-style--hide"]}},{"type":"attribute","name":"style"}]}},{"concept":{"name":"static text"},"type":"layout","tags":["choice","stack-choice"],"projection":{"type":"wrap","focusable":false,"disposition":[{"type":"static","static":{"type":"text","content":"Text"}}]}},{"concept":{"name":"static HTML"},"type":"layout","tags":["choice-selection"],"projection":{"type":"wrap","style":{"css":["text-element"]},"disposition":[{"type":"attribute","name":"selector","tag":"label-string"}]}},{"concept":{"name":"static HTML"},"type":"layout","tags":["choice","stack-choice"],"projection":{"type":"wrap","focusable":false,"disposition":[{"type":"static","static":{"type":"text","content":"HTML"}}]}},{"concept":{"name":"static image"},"type":"layout","tags":["choice-selection"],"projection":{"type":"stack","orientation":"vertical","style":{"css":["static-image"]},"disposition":[{"type":"attribute","name":"url","tag":"label-string"},{"type":"attribute","name":"alternative text","tag":"label-string"}]}},{"concept":{"name":"static image"},"type":"layout","tags":["choice","stack-choice"],"projection":{"type":"wrap","focusable":false,"disposition":[{"type":"static","static":{"type":"text","content":"Image"}}]}},{"concept":{"name":"static link"},"type":"layout","tags":["choice-selection"],"projection":{"type":"stack","orientation":"vertical","style":{"css":["text-element"]},"disposition":[{"type":"attribute","name":"url","tag":"label-string"},{"type":"attribute","name":"url type","tag":"label-string"},{"type":"attribute","name":"content","tag":"element-set"}]}},{"concept":{"name":"static link"},"type":"layout","tags":["choice","stack-choice"],"projection":{"type":"wrap","focusable":false,"disposition":[{"type":"static","static":{"type":"text","content":"Link"}}]}},{"concept":{"name":"attribute element"},"type":"layout","tags":["choice-selection"],"projection":{"type":"stack","orientation":"vertical","style":{"css":["attribute-element"]},"disposition":[{"type":"attribute","name":"value","tag":"label-string"},{"type":"attribute","name":"tag","tag":"label-string"}]}},{"concept":{"name":"attribute element"},"type":"layout","tags":["choice","stack-choice"],"projection":{"type":"wrap","focusable":false,"disposition":[{"type":"static","static":{"type":"text","content":"Attribute"}}]}},{"concept":{"name":"template element"},"type":"layout","tags":["choice-selection"],"projection":{"type":"stack","orientation":"vertical","style":{"css":["attribute-element"]},"disposition":[{"type":"attribute","name":"value","tag":"template-reference"}]}},{"concept":{"name":"template element"},"type":"layout","tags":["choice","stack-choice"],"projection":{"type":"wrap","focusable":false,"disposition":[{"type":"static","static":{"type":"text","content":"Template"}}]}},{"concept":{"name":"boolean"},"type":"field","tags":["field-binary-state"],"projection":{"type":"binary","style":{"css":["yesno-field"]},"state":[{"rule":{"type":"eq","eq":[{"prop":"value"},true]},"result":{"label":{"projection":[{"type":"static","static":{"type":"text","content":{"type":"property","name":"refname"},"style":{"css":["label","yesno-field__label"]}}},{"type":"static","static":{"type":"text","content":"yes","focusable":false,"style":{"css":["yesno-field__value"]}}}]}}},{"rule":{"type":"eq","eq":[{"prop":"value"},false]},"result":{"label":{"projection":[{"type":"static","static":{"type":"text","content":{"type":"property","name":"refname"},"style":{"css":["label","yesno-field__label"]}}},{"type":"static","static":{"type":"text","content":"no","focusable":false,"style":{"css":["yesno-field__value"]}}}]}}}],"input":{"style":{"css":["yesno-field__input"]}}}},{"concept":{"name":"number"},"type":"field","tags":[],"projection":{"type":"text","content":[{"type":"input","input":{"type":"number"}}]}},{"concept":{"name":"reference"},"type":"field","tags":["template-reference"],"projection":{"type":"choice","content":[{"type":"input","input":{"placeholder":"null","style":{"css":["reference-choice--textual__input"]}}},{"type":"choice","choice":{"style":{"css":["reference-choice--textual__list"]},"option":{"style":{"css":["reference-choice--textual__list-option"]}}}}],"style":{"css":["reference-choice--textual"]}}},{"concept":{"name":"set"},"tags":["tag-set"],"type":"field","projection":{"type":"list","content":[{"type":"static","static":{"type":"text","content":"Tags","style":{"css":["tag-list-title"]}}},{"type":"list","list":{"item":{"template":{"tag":"tag-item"},"style":{"css":["tag-list-item"]}},"style":{"css":["tag-list"]}}},{"type":"action","name":"add","content":{"type":"static","static":{"type":"text","content":"Add"}}}],"action":{"remove":{"content":{"type":"static","static":{"type":"text","style":{"css":["tag-list__btn-remove"]},"content":""}}}},"style":{"css":["tag-list-container"]}}},{"concept":{"name":"set"},"tags":["css-set"],"type":"field","projection":{"type":"list","content":[{"type":"static","static":{"type":"text","style":{"css":["title","css-list-title"]},"content":"CSS class"}},{"type":"list","list":{"item":{"template":{"tag":"css-string"},"style":{"css":["css-list-item"]}},"style":{"css":["css-list"]}}},{"type":"action","name":"add","content":{"type":"static","static":{"type":"text","content":"Add class","focusable":false}}}],"action":{"remove":{"content":{"type":"static","static":{"type":"text","content":"✖","style":{"css":["css-list__btn-remove"]},"focusable":false}}}},"style":{"css":["css-list-container"]}}},{"concept":{"name":"set"},"type":"field","tags":["element-set"],"projection":{"type":"list","content":[{"type":"list","list":{"item":{"template":{"tag":"list-item"},"style":{"css":["element-list-item"]}},"style":{"css":["element-list"]}}},{"type":"action","name":"add","content":{"type":"static","static":{"type":"text","content":"+","focusable":false,"style":{"css":["element-list__btn-add"]}}}}],"style":{"css":["element-list-container"]},"action":{"remove":{"content":{"type":"static","static":{"type":"text","style":{"css":["element-list__btn-remove"]},"content":""}}}}}},{"concept":{"name":"set"},"type":"field","tags":["row-set"],"projection":{"type":"list","content":[{"type":"static","static":{"type":"text","content":"Rows","style":{"css":["title","row-list__title"]}}},{"type":"list","list":{"item":{"template":{"tag":"list-item"},"style":{"css":["row-list-item"]}},"style":{"css":["row-list"]}}},{"type":"action","name":"add","content":{"type":"static","static":{"type":"text","content":"+","focusable":false,"style":{"css":["row-list__btn-add"]}}}}],"style":{"css":["row-list-container"]},"action":{"remove":{"content":{"type":"static","static":{"type":"text","style":{"css":["row-list__btn-remove"]},"content":""}}}}}},{"concept":{"name":"set"},"type":"field","tags":["cell-set"],"projection":{"type":"list","content":[{"type":"list","list":{"item":{"template":{"tag":"list-item"},"style":{"css":["cell-list-item"]}},"style":{"css":["cell-list"]}}},{"type":"action","name":"add","content":{"type":"static","static":{"type":"text","content":"+","focusable":false,"style":{"css":["cell-list__btn-add"]}}}}],"style":{"css":["cell-list-container"]},"action":{"remove":{"content":{"type":"static","static":{"type":"text","style":{"css":["cell-list__btn-remove"]},"content":""}}}}}},{"concept":{"name":"set"},"type":"field","tags":["state-element-set"],"projection":{"type":"list","content":[{"type":"list","list":{"item":{"template":{"tag":"list-item"},"style":{"css":["element-list-item"]}},"style":{"css":["element-list"]}}},{"type":"action","name":"add","content":{"type":"static","static":{"type":"text","content":"+","focusable":false,"style":{"css":["element-list__btn-add"]}}}}],"action":{"remove":{"content":{"type":"static","static":{"type":"text","style":{"css":["element-list__btn-remove"]},"content":""}}}},"style":{"css":["element-list-container"]}}},{"concept":{"name":"name"},"type":"field","tags":["textual","list-item"],"content":{"type":"text","resizable":true,"content":[{"type":"input","input":{"placeholder":"name","style":{"css":["textfield--labeled__input"]}}}],"style":{"css":["textfield--labeled"]}}},{"concept":{"name":"string"},"type":"field","tags":["simple-string"],"projection":{"type":"text","resizable":true,"content":[{"type":"input","input":{"style":{"css":["textfield--labeled__input"]}}}],"style":{"css":["textfield--labeled"]}}},{"concept":{"name":"string"},"type":"field","tags":["tag-string"],"projection":{"type":"text","content":[{"type":"input","input":{"placeholder":"Tag","style":{"css":["textfield--tag__input"]}}}],"style":{"css":["textfield--tag"]}}},{"concept":{"name":"string"},"type":"field","tags":["css-string"],"projection":{"type":"text","resizable":true,"content":[{"type":"input","input":{"placeholder":"class","style":{"css":["textfield--labeled__input"]}}}],"style":{"css":["textfield--labeled"]}}},{"concept":{"name":"string"},"type":"field","tags":["concept-string"],"projection":{"type":"text","placeholder":"name","content":[{"type":"static","static":{"type":"text","content":{"type":"property","name":"refname"},"style":{"css":["label","textfield--concept__label"]}}},{"type":"input","input":{"style":{"css":["textfield--concept__input"]},"placeholder":"null"}}],"style":{"css":["textfield--concept"]}}},{"concept":{"name":"string"},"type":"field","tags":["label-string"],"projection":{"type":"text","resizable":true,"content":[{"type":"static","static":{"type":"text","content":{"type":"property","name":"refname"},"style":{"css":["name-field--textual__label"]}}},{"type":"input","input":{"placeholder":"null","style":{"css":["name-field--textual__input"]}}}],"style":{"css":["name-field","name-field--textual"]}}},{"concept":{"name":"string"},"type":"field","tags":["text-string"],"projection":{"type":"text","resizable":true,"content":[{"type":"input","input":{"placeholder":"text...","style":{"css":["name-field--textual__input"]}}}],"style":{"css":["name-field","name-field--textual"]}}},{"concept":{"name":"string"},"type":"field","tags":["table-concept-string"],"projection":{"type":"text","content":[{"type":"static","static":{"type":"text","content":"Table concept","style":{"css":["textfield--template__label"]}}},{"type":"input","input":{"style":{"css":["textfield--template__input"]}}}],"style":{"css":["textfield--template"]}}},{"concept":{"name":"tag"},"type":"field","tags":["tag-item"],"projection":{"type":"text","content":[{"type":"input","input":{"placeholder":"Tag","style":{"css":["textfield--tag__input"]}}}],"style":{"css":["textfield--tag"]}}},{"concept":{"name":"tag"},"type":"field","tags":["tag-string"],"projection":{"type":"text","content":[{"type":"static","static":{"type":"text","content":{"type":"property","name":"refname"},"style":{"css":["label","textfield--concept__label"]}}},{"type":"input","input":{"placeholder":"Tag","style":{"css":["textfield--concept__input"]}}}],"style":{"css":["textfield--concept"]}}}]}')}},t={};function i(n){if(t[n])return t[n].exports;var s=t[n]={exports:{}};return e[n](s,s.exports,i),s.exports}(()=>{function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function t(e){return function(e){if(Array.isArray(e))return s(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||n(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t){if(e){if("string"==typeof e)return s(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?s(e,t):void 0}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function a(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return i?m(e)?t:e:y(e)?t:e}function r(e){return h(e)&&0===e.length}function o(e){return"string"==typeof e||e instanceof String}function l(e){return"function"==typeof e}function c(t){return!y(t)&&"object"===e(t)}function h(e){return!y(e)&&"function"==typeof e[Symbol.iterator]}function u(e){return h(e)&&!o(e)}function d(e){return null===e}function p(e){return!e||o(e)&&(0===e.length||/^\s*$/.test(e))}function m(e){return void 0===e}function y(e){return d(e)||m(e)}var f=Object.prototype.hasOwnProperty,b=(Object.prototype.isPrototypeOf,function(e,t){return f.call(e,t)});function g(e){if(y(e)||!c(e))return e;var t=e.constructor();for(var i in e)b(e,i)&&(e.isActiveClone=null,t[i]=g(e[i]),delete e.isActiveClone);return t}function v(e){return p(e)?e:e.toLowerCase().replace(/\b\w/g,(function(e){return e.toUpperCase()}))}function w(e){return p(e)?e:v(e.replace(/[_-]+/g," ").replace(/\s+/g," ").trim()).replace(/\s+/g,"")}function E(e){var t=a(e,!1);return o(t)&&"true"===t.toLowerCase()||Number.isInteger(t)&&1===t||!0===t}var x=function(e,i){if(!Array.isArray(e)||!l(i))throw new TypeError("Bad argument");for(var n=0;n<e.length;n++){var s=e[n];if(!i.apply(void 0,t(Array.isArray(s)?s:[s])))return!1}return!0},_=function(e){return!y(e)&&e.nodeType===Node.ELEMENT_NODE},C=function(e){return e instanceof Node},j=function(e){return _(e)&&e instanceof Element},L=function(e,t){return!!(_(e)&&e instanceof HTMLElement)&&(!h(t)||(i=e,s=Array.isArray(t)?t:[t],a=function(e){return i instanceof e},o=function(e){return i.tagName===e.toUpperCase()},l=function(e){return Array.isArray(e)?e.includes(i.type):i.type===e},s.some((function(e){if(!h(e))return!1;var t,i,s=e,c=null;if(Array.isArray(e)){var d=(i=2,function(e){if(Array.isArray(e))return e}(t=e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var i=[],n=!0,s=!1,a=void 0;try{for(var r,o=e[Symbol.iterator]();!(n=(r=o.next()).done)&&(i.push(r.value),!t||i.length!==t);n=!0);}catch(e){s=!0,a=e}finally{try{n||null==o.return||o.return()}finally{if(s)throw a}}return i}}(t,i)||n(t,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}());s=d[0],c=d[1]}s=s.toLowerCase();var p="HTML".concat(b(T,s)?T[s]:w(s),"Element");return!(!a(window[p])&&!o(s))&&(!(u(c)&&!r(c))||l(c))}))));var i,s,a,o,l},T={a:"Anchor",br:"BR",dl:"DList",datalist:"DataList",fieldset:"FieldSet",frameset:"FrameSet",hr:"HR",h1:"Heading",h2:"Heading",h3:"Heading",h4:"Heading",h5:"Heading",h6:"Heading",li:"LI",ol:"OList",optgroup:"OptGroup",p:"Paragraph",q:"Quote",blockquote:"Quote",caption:"TableCaption",td:"TableCell",th:"TableCell",col:"TableCol",tr:"TableRow",tbody:"TableSection",thead:"TableSection",tfoot:"TableSection",textarea:"TextArea",ul:"UList"},k=function(e){return function(e){return!y(e)&&e.nodeType===Node.DOCUMENT_FRAGMENT_NODE}(e)&&e instanceof DocumentFragment};function A(e,t){if(!o(t))return null;var i=document.createElement("template");return i.innerHTML=t.trim(),i.content[e]}var O=A.bind(null,"firstChild");function M(e,t,i){e[t]=i}function V(e,t,i){e.setAttribute(t,i)}A.bind(null,"childNodes");var S="accesskey,autocapitalize,class,dataset,editable,draggable,hidden,id,inputmode,lang,html,style,tabindex,text,title",N={accesskey:[M,"accessKey"],autocapitalize:[M,"autocapitalize"],class:[function(e,i){var n;if(!L(e))throw new Error("Bad argument: The passed `element` argument is not a valid HTML Element");return(n=e.classList).add.apply(n,t(Array.isArray(i)?i:[i])),e}],dataset:[function(e,t,i){Object.assign(e[t],i)},"dataset"],draggable:[M,"draggable"],editable:[M,"contentEditable"],hidden:[M,"hidden"],id:[M,"id"],inputmode:[M,"inputMode"],lang:[M,"lang"],html:[M,"innerHTML"],style:[M,"style"],tabindex:[M,"tabIndex"],text:[M,"textContent"],title:[M,"title"],data:[M,"data"],cite:[M,"cite"],download:[M,"download"],ping:[M,"ping"],target:[M,"target"],coords:[M,"coords"],shape:[M,"shape"],autoplay:[M,"autoplay"],buffered:[M,"buffered"],controls:[M,"controls"],loop:[M,"loop"],muted:[M,"muted"],playsinline:[V,"playsinline"],poster:[M,"poster"],preload:[M,"preload"],crossorigin:[M,"crossOrigin"],decoding:[M,"decoding"],height:[M,"height"],ismap:[M,"isMap"],loading:[M,"loading"],srcset:[M,"srcset"],width:[M,"width"],alt:[M,"alt"],as:[M,"as"],media:[M,"media"],rel:[M,"rel"],src:[M,"src"],sizes:[M,"sizes"],reversed:[M,"reversed"],start:[M,"start"],accept:[M,"accept"],"accept-charset":[M,"acceptCharset"],action:[M,"action"],autocomplete:[M,"autocomplete"],autofocus:[M,"autofocus"],capture:[M,"capture"],checked:[M,"checked"],cols:[M,"cols"],disabled:[M,"disabled"],dirname:[M,"dirName"],enctype:[M,"enctype"],for:[M,"for"],form:[M,"form"],formaction:[M,"formAction"],formenctype:[M,"formEnctype"],formmethod:[M,"formMethod"],formnovalidate:[M,"formNoValidate"],formtarget:[M,"formTarget"],high:[M,"high"],label:[M,"label"],list:[M,"list"],low:[M,"low"],max:[M,"max"],maxlength:[M,"maxLength"],method:[M,"method"],min:[M,"min"],minlength:[M,"minLength"],multiple:[M,"multiple"],name:[M,"name"],novalidate:[M,"noValidate"],optimum:[M,"optimum"],pattern:[M,"pattern"],placeholder:[M,"placeholder"],readonly:[M,"readOnly"],required:[M,"required"],rows:[M,"rows"],selected:[M,"selected"],size:[M,"size"],spellcheck:[V,"spellcheck"],step:[M,"step"],wrap:[M,"wrap"],default:[M,"default"],kind:[M,"kind"],srclang:[M,"srclang"],abbr:[M,"abbr"],colspan:[M,"colSpan"],span:[M,"span"],rowspan:[M,"rowSpan"],scope:[M,"scope"],href:[M,"href"],hreflang:[M,"hreflang"],datetime:[M,"dateTime"],type:[M,"type"],value:[M,"value"],usemap:[M,"useMap"]};function R(e,i,n){var s=document.createElement(e);return L(s)?(c(n)&&function(e,i){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(!L(e))throw new Error("Bad argument: The given element argument is not a valid HTML Element");if(!c(i))return e;for(var s=function(e){return S.includes(e)||n.includes(e)},a=0,r=Object.keys(i);a<r.length;a++){var o=r[a];if(s(o)){var l=i[o],h=N[o].slice(0);h.shift().apply(void 0,[e].concat(t(h),[l]))}}}(s,n,a(i,"")),s):null}function I(e,t,i,n){var s=R(e,t,i);return L(s)?(y(n)||fe(s,n),s):null}function P(e,t,i,n,s){var a=R(e,t,n);return L(a)?(y(s)||fe(a,s,i),a):null}function H(e){var t=document.createDocumentFragment();return y(e)||fe(t,e),t}R.bind(null,"link","as,crossorigin,disabled,href,hreflang,media,rel,sizes,type"),I.bind(null,"template","");var $=I.bind(null,"header",""),q=(I.bind(null,"footer",""),I.bind(null,"main",""),I.bind(null,"article",""),I.bind(null,"section","")),D=(I.bind(null,"nav",""),I.bind(null,"aside",""),I.bind(null,"h1",""),I.bind(null,"h2",""),I.bind(null,"h3","")),B=I.bind(null,"h4",""),F=(I.bind(null,"h5",""),I.bind(null,"h6",""),I.bind(null,"div","")),z=(I.bind(null,"object","data,height,name,type,usemap,width"),R.bind(null,"embed","height,src,type,width"),R.bind(null,"br",""),R.bind(null,"hr",""),I.bind(null,"p","")),W=(I.bind(null,"blockquote","cite"),function(e){return L(e,"li")?e:J(null,e)}),U=P.bind(null,"ul","",W),J=(P.bind(null,"ol","reversed,start,type",W),I.bind(null,"li","value")),G=(I.bind(null,"dl",""),I.bind(null,"dt",""),I.bind(null,"dd",""),I.bind(null,"a","download,href,hreflang,ping,rel,target,type")),K=(R.bind(null,"area","alt,coords,download,href,hreflang,media,ping,rel,shape,target"),R.bind(null,"base","href,target"),R.bind(null,"img","alt,crossorigin,decoding,height,ismap,loading,sizes,src,srcset,usemap,width")),X=I.bind(null,"audio","autoplay,controls,crossorigin,loop,muted,preload,src"),Y=(I.bind(null,"video","autoplay,controls,crossorigin,height,loop,muted,playsinline,poster,preload,src,width"),R.bind(null,"source","media,sizes,src,srcset,type"),R.bind(null,"track","default,kind,label,src,srclang"),I.bind(null,"picture",""),I.bind(null,"figure",""),I.bind(null,"figcaption",""),I.bind(null,"span","")),Q=I.bind(null,"strong",""),Z=I.bind(null,"em",""),ee=(I.bind(null,"mark",""),I.bind(null,"samp",""),I.bind(null,"sub",""),I.bind(null,"sup",""),I.bind(null,"del","cite,datetime"),I.bind(null,"ins","cite,datetime"),I.bind(null,"q","cite"),I.bind(null,"abbr",""),I.bind(null,"b",""),I.bind(null,"i","")),te=(I.bind(null,"s",""),I.bind(null,"u",""),I.bind(null,"cite",""),I.bind(null,"time","datetime"),I.bind(null,"code",""),I.bind(null,"form","accept-charset,action,autocomplete,enctype,method,name,novalidate,rel,target"),R.bind(null,"input","accept,alt,autocomplete,autofocus,capture,checked,dirname,disabled,height,max,maxlength,minlength,min,multiple,name,pattern,placeholder,readonly,required,size,src,step,type,value,width")),ie=I.bind(null,"textarea","autocomplete,autofocus,cols,disabled,maxlength,minlength,name,placeholder,readonly,required,rows,spellcheck,value,wrap"),ne=I.bind(null,"label","for"),se=(P.bind(null,"select","autocomplete,autofocus,disabled,multiple,name,required,size",(function(e){return L(e,["option","optgroup"])?e:Array.isArray(e)?re(null,e):se(null,e)})),I.bind(null,"option","disabled,label,selected,value")),ae=function(e){return L(e,"option")?e:se(null,e)},re=P.bind(null,"optgroup","disabled,label",ae),oe=(I.bind(null,"fieldset","disabled,name"),I.bind(null,"legend",""),P.bind(null,"datalist","",ae),I.bind(null,"meter","high,low,max,min,optimum,value"),I.bind(null,"progress","max,value"),I.bind(null,"output","name,value"),I.bind(null,"button","autofocus,disabled,formaction,formenctype,formmethod,formnovalidate,formtarget,name,type,value")),le=I.bind(null,"table",""),ce=(I.bind(null,"caption",""),function(e){return L(e,"tr")?e:pe(null,e)}),he=P.bind(null,"thead","",ce),ue=P.bind(null,"tbody","",ce),de=P.bind(null,"tfoot","",ce),pe=(R.bind(null,"col","span"),P.bind(null,"colgroup","span",(function(e){return L(e,"col")?e:null})),P.bind(null,"tr","",(function(e){return L(e,["th","td"])?e:ye(null,e)}))),me=I.bind(null,"th","abbr,colspan,rowspan,scope"),ye=I.bind(null,"td","colspan,rowspan");function fe(e,t,i){var n=Array.isArray(t)?t:[t];return l(i)&&(n=n.map((function(e){return i(e)}))),function(e,t){if(!C(e))throw new TypeError("Bad argument: The given `parent` is not a valid Node");if(!(t instanceof HTMLCollection||u(t)))throw new TypeError("Bad argument: The given `children` is not a valid HTMLCollection/HTMLElement array");var i=k(e)?e:document.createDocumentFragment();Array.from(t).forEach((function(e){var t;y(e)||i.appendChild(C(e)?e:(t=e.toString(),document.createTextNode(t.toString())))})),e!==i&&e.appendChild(i)}(e,n),e}function be(e,t){var i=a(t,document);return p(e)?null:k(i)?i.querySelector(e):function(e){return/^#[a-zA-Z0-9_-]+$/.test(e)}(e)?document.getElementById(e.substring(1)):function(e){return/^\.[a-zA-Z0-9_-]+$/.test(e)}(e)?i.getElementsByClassName(e.substring(1))[0]:i.querySelector(e)}function ge(e,t,i){if(!L(t))return null;var n=t[e];if(l(i))for(;j(n)&&!i(n);)n=n[e];return n}var ve=ge.bind(null,"previousElementSibling"),we=ge.bind(null,"nextElementSibling");function Ee(e,t,i){if(!j(e))throw new TypeError("Bad argument: The given target parameter is not a valid HTML Element");if(!l(t))throw new TypeError("Bad argument: The given pred parameter is not a valid Function");var n=e.parentElement;return i>0?_e(n,t,i-1):xe(n,t)}function xe(e,t){return y(e)?null:t(e)?e:xe(e.parentElement,t)}function _e(e,t,i){return y(e)||0===i?null:t(e)?e:_e(e.parentElement,t,i-1)}function Ce(e,t){if(!C(e))throw new TypeError("Bad argument: The given `node` is not a valid Node");return l(t)?(Array.from(e.childNodes).forEach((function(i){t(i)&&e.removeChild(i)})),e):function(e){for(;e.hasChildNodes();)e.removeChild(e.lastChild);return e}(e)}var je=function(e){return e.dataset.state},Le=function(e,t){return e.dataset.state=t},Te=function(e,t){return Le(e,a(t,"checked"))},ke=function(e,t){return Le(e,a(t,"unchecked"))},Ae={name:"form-selector",container:null,items:null,selectedIndex:null,selectedItem:null,beforeChange:null,afterChange:null,get value(){return this.selectedItem.value},setSelectedItem:function(e){return this.items.includes(e)?(this.selectedItem&&this.selectedItem.setChecked(!1),this.selectedItem=e,this.selectedItem.setChecked(!0),!0):null},init:function(){for(var e=this.container.dataset.value,t=null,i=0;i<this.items.length;i++){var n=this.items[i];n.isChecked()&&this.setSelectedItem(n),n.value===e&&(t=n)}return d(this.selectedItem)&&!d(t)&&this.setSelectedItem(t),this.bindEvents(),this},bindEvents:function(){var e=this;this.container.addEventListener("change",(function(t){var i=t.target,n=!1;if(l(e.beforeChange)&&(n=!1===e.beforeChange(e,t)),n)return i.checked=!1,void e.items[e.selectedIndex].setChecked(!0);var s=e.items.find((function(e){return e.index===+a(i.dataset.selectorIndex,-1)}));y(s)||(e.setSelectedItem(s),l(e.afterChange)&&e.afterChange(e,t))}))}},Oe=function(e){return'[data-type="'.concat(e.name,'"]')},Me={BaseSelector:Oe({name:"selector",container:null,items:null,selectedIndex:null,selectedItem:null,beforeChange:null,afterChange:null,get value(){return this.selectedItem.value},setSelectedItem:function(e){return this.items.includes(e)?(this.selectedItem&&this.selectedItem.setChecked(!1),this.selectedItem=e,this.selectedItem.setChecked(!0),!0):null},init:function(){for(var e=this.container.dataset.value,t=null,i=0;i<this.items.length;i++){var n=this.items[i];n.isChecked()&&this.setSelectedItem(n),n.value===e&&(t=n)}return d(this.selectedItem)&&!d(t)&&this.setSelectedItem(t),this.bindEvents(),this},bindEvents:function(){var e=this;this.container.addEventListener("click",(function(t){var i=t.target;if(b(i.dataset,"selector")){var n=!1;if(l(e.beforeChange)&&(n=!1===e.beforeChange(e,t)),!n){var s=e.items.find((function(e){return e.index===+a(i.dataset.selectorIndex,-1)}));y(s)||(e.setSelectedItem(s),l(e.afterChange)&&e.afterChange(e,t))}}}))}}),FormSelector:Oe(Ae)};new Error("Missing container: A selector requires a container"),new Error("Missing input: FormSelector requires an input in the container"),[Me.BaseSelector,Me.FormSelector].join(","),new Error("Missing container: A switch requires a container"),new Error("Missing input: FormSwitch requires an input in the container");var Ve="on",Se=function(e){return'[data-type="'.concat(e.name,'"]')},Ne={name:"form-switch",container:null,input:null,beforeChange:null,afterChange:null,get value(){return this.input.value},isChecked:function(){return je(this.container)===Ve},setChecked:function(e){return!y(e)&&(this.input.checked=e,e?Te(this.container,Ve):ke(this.container,"off"),!0)},toggle:function(){this.isChecked()?this.setChecked(!1):this.setChecked(!0)},init:function(e){return Object.assign(this,e),this.input.checked&&this.setChecked(!0),this.bindEvents(),this},bindEvents:function(){var e=this;this.input.addEventListener("change",(function(t){var i=!1;l(e.beforeChange)&&(i=!1===e.beforeChange(e,t)),i?e.input.checked=!e.input.checked:(e.toggle(),l(e.afterChange)&&e.afterChange(e,t))}))}};function Re(e){let t=0;if(0!==window.getSelection().rangeCount){const i=window.getSelection().getRangeAt(0),n=i.cloneRange();n.selectNodeContents(e),n.setEnd(i.endContainer,i.endOffset),t=n.toString().length}return t}[Se({name:"switch",container:null,beforeChange:null,afterChange:null,get value(){return this.container.dataset.value},isChecked:function(){return je(this.container)===Ve},setChecked:function(e){return!y(e)&&(e?Te(this.container,Ve):ke(this.container,"off"),!0)},toggle:function(){this.isChecked()?this.setChecked(!1):this.setChecked(!0)},init:function(e){return Object.assign(this,e),this.isChecked()&&Te(this.container,Ve),this.bindEvents(),this},bindEvents:function(){var e=this;this.container.addEventListener("click",(function(t){var i=!1;l(e.beforeChange)&&(i=!1===e.beforeChange(e,t)),i||(e.toggle(),l(e.afterChange)&&e.afterChange(e,t))}))}}),Se(Ne)].join(","),new Error("Missing container: A collapsible requires a container"),new Error("Missing container: An accordion requires a container"),encodeURIComponent;const Ie="hidden",Pe="shake";function He(e){return L(e)&&e.classList.remove(Ie),e}function $e(e){return L(e)&&e.classList.add(Ie),e}function qe(e){return L(e)&&e.classList.toggle(Ie),e}const De=e=>{e.classList.contains(Pe)||(e.classList.add(Pe),setTimeout((()=>{e.classList.remove(Pe)}),1e3))},Be="Backspace",Fe="Enter",ze="Control",We="Escape",Ue="ArrowUp",Je="ArrowRight",Ge="ArrowDown",Ke="Delete",Xe={NORMAL:"normal",WARNING:"warning",SUCCESS:"success",ERROR:"error"};function Ye(e){const t=e=>!b(e.dataset,"ignore");return t(e)?e:Ee(e,t,10)}function Qe(e){if(!L)throw new TypeError("Bad parameter");return e.hidden||"none"===window.getComputedStyle(e).display}const Ze=e=>+e.substring(0,e.indexOf("px")),et={top:e=>e.marginTop,right:e=>e.marginRight,bottom:e=>e.marginBottom,left:e=>e.marginLeft},tt={top:e=>e.paddingTop,right:e=>e.paddingRight,bottom:e=>e.paddingBottom,left:e=>e.paddingLeft},it={top:e=>e.borderTopWidth,right:e=>e.borderRightWidth,bottom:e=>e.borderBottomWidth,left:e=>e.borderLeftWidth};function nt(e,t,i){const n=window.getComputedStyle(e),s=window.getComputedStyle(t),a=et[i](n),r=tt[i](s),o=it[i](s);return l=e.getBoundingClientRect()[i]+Ze(a),c=t.getBoundingClientRect()[i]-Ze(r)-Ze(o),Math.abs(l-c)<2;var l,c}function st(e,t){const i=t.children,{top:n,left:s}=e.getBoundingClientRect();if(nt(e,t,"top"))return null;let a=null,r=99999,o=99999;for(let t=0;t<i.length;t++){const l=i[t];if(Qe(l)||l===e)continue;const{bottom:c,left:h}=l.getBoundingClientRect();let u=Math.abs(n-c),d=Math.abs(s-h);n>=c-1&&(u<r||u===r&&d<o)&&(a=l,r=u,o=d)}return a}function at(e,t){const i=t.children,{top:n,left:s}=e.getBoundingClientRect();if(nt(e,t,"left"))return null;let a=null,r=99999,o=99999;for(let t=0;t<i.length;t++){const l=i[t];if(Qe(l)||l===e)continue;const{top:c,right:h}=l.getBoundingClientRect();let u=Math.abs(n-c),d=Math.abs(s-h);s>=h-1&&(d<o||d===o&&u<r)&&(a=l,r=u,o=d)}return a}function rt(e,t){const i=t.children,{top:n,right:s}=e.getBoundingClientRect();if(nt(e,t,"right"))return null;let a=null,r=99999,o=99999;for(let t=0;t<i.length;t++){const l=i[t];if(Qe(l)||l===e)continue;const{top:c,left:h}=l.getBoundingClientRect();let u=Math.abs(n-c),d=Math.abs(s-h);s<=h+1&&(d<o||d===o&&u<r)&&(a=l,r=u,o=d)}return a}function ot(e,t){const i=t.children,{bottom:n,left:s}=e.getBoundingClientRect();if(nt(e,t,"bottom"))return null;let a=null,r=99999,o=99999;for(let t=0;t<i.length;t++){const l=i[t];if(Qe(l)||l===e)continue;const{top:c,left:h}=l.getBoundingClientRect();let u=Math.abs(n-c),d=Math.abs(s-h);n<=c+1&&(u<r||u===r&&d<o)&&(a=l,r=u,o=d)}return a}var lt={};const ct=function(e,t){if(!l(t))return!1;lt[e]=lt[e]||[],lt[e].push(t)},ht=function(e,t){b(lt,e)&&lt[e].forEach((function(e){e(t)}))},ut=function(){var e={},t=[];for(let e=0;e<256;e++)t[e]=e<16?"0"+e.toString(16):e.toString(16);return e.generate=function(){var e=4294967296*Math.random()>>>0,i=4294967296*Math.random()>>>0,n=4294967296*Math.random()>>>0,s=4294967296*Math.random()>>>0;return t[255&e]+t[e>>8&255]+t[e>>16&255]+t[e>>24&255]+"-"+t[255&i]+t[i>>8&255]+"-"+t[i>>16&15|64]+t[i>>24&255]+"-"+t[63&n|128]+t[n>>8&255]+"-"+t[n>>16&255]+t[n>>24&255]+t[255&s]+t[s>>8&255]+t[s>>16&255]+t[s>>24&255]},e}(),dt=[{concept:{name:"set"},type:"field",tags:[],content:{type:"list"}},{concept:{name:"string"},type:"field",tags:[],content:{type:"text",content:[{type:"input"}]}},{concept:{name:"boolean"},type:"field",tags:[],content:{type:"binary"}},{concept:{name:"number"},type:"field",tags:[],content:{type:"text"}},{concept:{name:"reference"},type:"field",tags:[],content:{type:"link"}},{concept:{name:"prototype"},type:"field",tags:[],content:{type:"choice"}}],pt="content",mt="name",yt="prototype",ft="tags",bt=(e,t)=>e.getAttributeByName(t).target,gt=(e,t,i=!1)=>bt(e,t).getValue(i),vt=(e,t)=>bt(e,t).hasValue(),wt=(e,t)=>e.isAttributeCreated(t),Et=e=>gt(e,mt).toLowerCase(),xt={projection:e=>function(e){const t=[],i=wt(e,ft)?bt(e,ft).build():[];if(vt(e,pt)||t.push("The projection is missing a content."),!r(t))return{success:!1,message:"Validation failed: The projection could not be built.",errors:t};const n=gt(e,pt),s=n.getBuildProperty("type");let a={id:e.id,concept:jt(bt(e,"concept")),type:s,tags:i,content:_t[s](n),metadata:JSON.stringify(e.export())};return wt(e,mt)&&vt(e,mt)&&(a.name=Et(e)),{success:!0,message:a}}(e),template:e=>function(e){const t=[],i=Et(e);if(p(i)&&t.push("The template is missing a name."),vt(e,pt)||t.push("The template is missing a content."),!r(t))return{success:!1,message:"Validation failed: The template could not be built.",errors:t};const n=[];return gt(e,pt).filter((e=>e.hasValue())).forEach((e=>{const t=e.getValue();n.push(Tt(t))})),{success:!0,message:{id:e.id,type:"template",name:i,content:n}}}(e)},_t={layout:e=>Lt(gt(e,"layout")),field:e=>function(e){var t={readonly:gt(e,"readonly"),disabled:gt(e,"disabled")};if(e.isAttributeCreated("style")&&(t.style=At(bt(e,"style"))),"text field"===e.name)t.type="text",t.multiline=gt(e,"multiline"),t.content=[],gt(e,"content").filter((e=>e.hasValue())).forEach((e=>{const i=e.getValue();t.content.push(Tt(i))}));else if("binary field"===e.name)t.type="binary",t.state=[],gt(e,"content").forEach((e=>{wt(e,"state")?t.state.push({rule:{type:"eq",eq:[{prop:"value"},gt(e,"state")]},result:{label:{projection:Tt(gt(e,"content"))}}}):t.label={projection:Tt(gt(e,"content"))}}));else if("choice field"===e.name){t.type="choice";let i=bt(e,"choice template"),n=bt(e,"selection template");t.choice={option:{template:{tag:gt(i,"tag"),name:gt(i,"name")}},selection:{template:{tag:gt(n,"tag"),name:gt(n,"name")}}}}else if("link field"===e.name){t.type="link";let i=bt(e,"choice template"),n=bt(e,"value template");t.choice={option:{template:{tag:gt(i,"tag"),name:gt(i,"name")}},selection:{template:{tag:gt(n,"tag"),name:gt(n,"name")}}}}else if("list field"===e.name){t.type="list",wt("orientation")&&(t.orientation=gt(e,"orientation"));let i=bt(e,"item template");t.list={item:{template:{tag:gt(i,"tag"),name:gt(i,"name")}}}}else if("table field"===e.name){let i={};e.isAttributeCreated("template")&&(i.name=bt(e,"template").getValue()),e.isAttributeCreated("concept")&&(i.concept=bt(e,"concept").getValue()),t.template=i,t.type="table"}return t}(gt(e,"field")),element:e=>Tt(gt(e,"element"))};function Ct(e){const t=[...dt],i=[],n=e.getConcepts(["projection","template"]);return r(n)?(this.notify("<strong>Empty model</strong>: There was no projection found to be built.",Xe.WARNING),!1):(n.forEach((e=>{const n=xt[a(e.getBuildProperty("handler"),"")];if(!l(n))throw new Error("The projection's is missing a build handler.");const{success:s,errors:r,message:o}=n(e);s?t.find((e=>e.name&&e.name===o.name))?i.push(`The model has two projections with the same name: ${o.name}`):t.push(o):i.push(...r)})),r(i)?(this.notify("<strong>Build succeeded</strong>: The projection model was successfully built",Xe.SUCCESS),console.log(t),t):(this.notify("<strong>Validation failed</strong>: The model could not be built.<br> <em>See Log for more details</em>.",Xe.ERROR),console.error(i),!1))}function jt(e){const t={};return wt(e,mt)&&(t.name=vt(e,mt)?gt(e,mt).toLowerCase():null),wt(e,yt)&&(t.prototype=vt(e,yt)?gt(e,yt).toLowerCase():null),t}function Lt(e){var t={},i=[];return"stack layout"===e.name?(t.type="stack",t.orientation=gt(e,"orientation"),gt(e,"elements").filter((e=>e.hasValue())).forEach((e=>{const t=e.getValue();i.push(Tt(t))}))):"wrap layout"===e.name?(t.type="wrap",gt(e,"elements").filter((e=>e.hasValue())).forEach((e=>{const t=e.getValue();i.push(Tt(t))}))):"cell layout"===e.name?(t.type="table",t.orientation=gt(e,"orientation"),gt(e,"rows").forEach((e=>{const t=[];gt(e,"cells").forEach((e=>{let i=gt(e,"span"),n=gt(e,"content");t.push({type:"cell",span:i,content:Tt(n)})})),i.push(t)}))):"relative layout"===e.name&&(t.type="relative"),e.isAttributeCreated("style")&&(t.style=At(bt(e,"style"))),t.disposition=i,t}function Tt(e){const t=e.getBuildProperty("contentType"),i=e.getBuildProperty("elementType");if("static"===t)return{type:t,static:kt(e,i)};if("dynamic"===t)return function(e,t){let i={type:t};return"input"===t?i.placeholder=gt(e,"placeholder"):"checkbox"===t?i.label=gt(e,"label"):"list"===t&&(i.selector=gt(e,"item")),wt(e,"style")&&(i.style=At(bt(e,"style"))),i}(e,i);if("attribute"===t){let i={type:t,name:gt(e,"value")};return e.isAttributeCreated("tag")&&(i.tag=gt(e,"tag")),i}return"layout"===t?{type:t,layout:Lt(e)}:"template"===t?{type:t,name:Et((n=e,"value",bt(n,"value").getReference()))}:null;var n}function kt(e,t){let i={type:t};return"text"===t?(i.content=gt(e,"content"),i.contentType=gt(e,"content type")):"image"===t?(i.url=gt(e,"url"),i.alt=gt(e,"alternative text"),i.width=gt(e,"width"),i.height=gt(e,"height")):"html"===t?i.selector=gt(e,"selector"):"link"===t&&(i.url=gt(e,"url"),i.urlType=gt(e,"url type"),i.content=[],gt(e,"content").filter((e=>e.hasValue())).forEach((e=>{const t=e.getValue();i.content.push(Tt(t))}))),wt(e,"style")&&(i.style=At(bt(e,"style"))),i}function At(e){return e.isAttributeCreated("css")?{css:bt(e,"css").build()}:null}const Ot="attributes",Mt="base",Vt="required",St="properties",Nt="prototype",Rt=(e,t)=>e.getAttributeByName(t).target,It=(e,t)=>Rt(e,t).getReference(),Pt=(e,t,i=!1)=>Rt(e,t).getValue(i),Ht=(e,t)=>Rt(e,t).hasValue(),$t=(e,t)=>e.isAttributeCreated(t),qt=e=>Pt(e,"name").toLowerCase(),Dt=e=>Pt(e,"description");function Bt(e){const t=[],i=[],n=e.getConcepts(["prototype concept","concrete concept","derivative concept"]);return r(n)?(this.notify("<strong>Empty model</strong>: There was no concept found to be built.",Xe.WARNING),!1):(n.forEach((e=>{const{success:n,errors:s,message:a}=function(e){const t=[],i=qt(e),n=Dt(e),s=e.getBuildProperty("nature"),a=[],o=[];if(p(i)&&t.push(`The ${s} concept's 'name' is missing a value.`),e.isAttributeCreated(Ot)&&Pt(e,Ot).forEach((e=>{const{success:i,errors:n,message:s}=function(e){const t=qt(e),i=Dt(e),n=!$t(e,Vt)||!Ht(e,Vt)||Pt(e,Vt),s=[];return p(t)&&s.push("The attribute's 'name' is missing a value."),$t(e,"target")&&Ht(e,"target")||s.push(`The attribute '${t}' 'target' is missing a value.`),r(s)?{success:!0,message:{name:t,target:Ft(Pt(e,"target")),required:n,description:i}}:{success:!1,message:"Validation failed: The attribute could not be built.",errors:s}}(e);i?a.find((e=>e.name===s.name))?t.push(`The concept has two attributes with the same name: ${s.name}`):a.push(s):t.push(...n)})),e.isAttributeCreated(St)&&Pt(e,St).forEach((e=>{const{success:i,errors:n,message:s}=function(e){const t=[],i=qt(e),n=Dt(e);p(i)&&t.push("The property's 'name' is missing a value."),$t(e,"target")&&Ht(e,"target")||t.push(`The property '${i}' 'target' is missing a value.`);const s=Pt(e,"target"),a=s.getProperty("type");return y(a)&&t.push(`The property '${i}' target's type is missing a value.`),r(t)?{success:!0,message:{name:qt(e),type:a,value:Pt(s,"value"),description:n}}:{success:!1,message:"Validation failed: The property could not be built.",errors:t}}(e);i?o.find((e=>e.name===s.name))?t.push(`The concept has two properties with the same name: ${s.name}`):o.push(s):t.push(...n)})),!r(t))return{success:!1,message:"Validation failed: The concept could not be built.",errors:t};let l={id:e.id,name:i,description:n,nature:s,attributes:a,properties:o,metadata:JSON.stringify(e.export())};return e.isAttributeCreated(Nt)&&Ht(e,Nt)&&(l.prototype=qt(It(e,Nt))),e.isAttributeCreated(Mt)&&Ht(e,Mt)&&(l.base=Ft(Pt(e,Mt))),{success:!0,message:l}}(e);n?t.find((e=>e.name===a.name))?i.push(`The model has two concepts with the same name: ${a.name}`):t.push(a):i.push(...s)})),r(i)?(this.notify("<strong>Build succeeded</strong>: The concept model was successfully built",Xe.SUCCESS),console.log(t),t):(this.notify("<strong>Validation failed</strong>: The model could not be built.<br> <em>See Log for more details</em>.",Xe.ERROR),console.error(i),!1))}function Ft(e){let t=e.getBuildProperty("name");"concept"===t&&(t=qt(It(e,"concept")));const i={name:t};if(e.isAttributeCreated("accept")){let t=Pt(e,"accept");i.accept=Ft(t)}return["default","ordered","pattern"].filter((t=>$t(e,t)&&Ht(e,t))).forEach((t=>{i[t]=Pt(e,t)})),["length","value","cardinality"].filter((t=>$t(e,t)&&Ht(e,t))).forEach((t=>{let n=Pt(e,t),s={};if("number constraint value"===n.name)Ht(n,"value")&&(s.value=Pt(n,"value"));else if("number constraint range"===n.name){let e=Rt(n,"min");Ht(e,"value")&&(s.min={value:Pt(e,"value"),included:Pt(e,"included")});let t=Rt(n,"max");Ht(t,"value")&&(s.max={value:Pt(t,"value"),included:Pt(t,"included")})}i[t]=s})),$t(e,"values")&&Ht(e,"values")&&(i.values=Pt(e,"values",!0)),i}const zt={create(e,t){const i=Object.create(this);return i.concept=e,i.schema=t,i},model:null,schema:null,source:null,id:null,value:null,object:"structure",init(e){throw new Error("This function has not been implemented")}};Object.defineProperty(zt,"model",{get(){return this.concept.model}}),Object.defineProperty(zt,"alias",{get(){return this.schema.alias}}),Object.defineProperty(zt,"name",{get(){return this.schema.name}}),Object.defineProperty(zt,"description",{get(){return this.schema.description}}),Object.defineProperty(zt,"required",{get(){return a(this.schema.required,!0)}});const Wt={object:"attribute",target:null,init(e){return this.target=this.model.createConcept(this.schema.target,{value:a(e,this.schema.value),parent:this.concept,ref:this}),this},getValue(){return this.target.value},copy(){if(!this.target.hasValue())return null;const{nature:e}=this.target;let t={name:this.target.name},i=this.target.exportValue();return"primitive"===e?t.value=i:"prototype"===e?t.value={name:this.target.value.name,attributes:i}:t.attributes=i,t},export(){const{nature:e}=this.target;let t={name:this.target.name},i=this.target.exportValue();return"primitive"===e?t.value=i:"prototype"===e?t.value={name:this.target.value.name,attributes:i}:t.attributes=i,t},toString(){return{[`attribute.${this.name}`]:this.target.toString()}}},Ut=Object.assign(Object.create(zt),Wt),Jt={attributes:null,initAttribute(){return this.attributes=[],this.attributes._created=new Set,this.attributes._updated=new Set,this.attributes._deleted=new Set,this},getAttributes(){return this.attributes},getAttribute(e){if(y(e))throw new TypeError("Bad argument");return"id"===e.type?this.getAttributeById(e.value):this.getAttributeByName(e)},getAttributeSchema(e){if(p(e))throw new TypeError("Bad argument");if(!this.hasAttribute(e))throw new Error(`Attribute '${e}' does not exist`);return g(this.attributeSchema.find((t=>t.name===e)))},getAttributeByName(e){if(p(e))throw new TypeError("Bad argument");var t=this.attributes.find((t=>t.name===e));return y(t)&&(t=this.createAttribute(e)),t},getAttributeById(e){if(p(e))throw new TypeError("Bad argument");return this.attributes.find((t=>t.id===e))},createAttribute(e,t){if(!this.hasAttribute(e))throw new Error(`Attribute not found: The concept '${this.name}' does not contain an attribute named ${e}`);const i=this.attributeSchema.find((t=>t.name===e));let n=this.model.getValue(t);var s=Ut.create(this,i).init(n);return this.addAttribute(s),s},addAttribute(e){if(y(e)||"attribute"!==e.object)throw new Error("Bad argument: 'attribute' must be an attribute object");return this.attributes.push(e),this.attributes._created.add(e.name),this.notify("attribute.added",e),this},hasAttributes(){return!r(this.attributeSchema)||!r(this.attributes)},hasAttribute(e){return-1!==this.attributeSchema.findIndex((t=>t.name===e))},isAttributeRequired(e){return a(this.attributeSchema.find((t=>t.name===e)).required,!0)},isAttributeCreated(e){return this.attributes._created.has(e)},listAttributes(){const e=[];return this.attributeSchema.forEach((t=>{e.push({type:"attribute",name:t.name,alias:t.alias,description:t.description,target:t.target,accept:t.accept,required:this.isAttributeRequired(name),created:this.isAttributeCreated(name)})})),e},removeAttribute(e){if(this.isAttributeRequired(e))return{message:`The attribute '${e}' is required.`,success:!1};var t=this.attributes.findIndex((t=>t.name===e));if(-1===t)return{message:`The attribute '${e}' was not found.`,success:!1};var i=this.attributes.splice(t,1)[0];return this.attributes._created.delete(e),this.notify("attribute.removed",i),{message:`The attribute '${e}' was successfully removed.`,success:!0}}},Gt={listeners:null,initObserver(){return this.listeners=[],this},register(e){return this.listeners.includes(e)||this.listeners.push(e),!0},unregister(e){var t=this.listeners.indexOf(e);return-1!==t&&(this.listeners.splice(t,1),!0)},unregisterAll(){this.listeners=[]},notify(e,t){this.listeners.forEach((i=>{i.update(e,t)}))}},Kt={model:null,schema:null,source:null,id:null,name:null,description:null,alias:null,ref:null,actions:null,operations:null,accept:null,parent:null,references:null,value:null,values:null,action:null,shadows:null,history:null,kind:"concept",init(e={}){return this.accept=e.accept,this.parent=e.parent,this.ref=e.ref,this.values=a(e.values,a(this.schema.values,[])),this.alias=a(e.alias,this.schema.alias),this.description=a(e.description,this.schema.description),this.min=a(e.min,a(this.schema.min,1)),this.max=a(e.max,this.schema.max),this.initObserver(),"fake"!==this.nature&&(this.initAttribute(),this.initValue(e.value)),this},initValue(){throw new Error("This function has not been implemented")},getName(){return a(this.ref.name,this.name)},getAlias(){return a(this.alias,this.getName())},getAcceptedValues(){return!h(this.accept)&&y(this.accept.name)?"":o(this.accept)?this.accept:b(this.accept,"name")?this.accept.name:Array.isArray(this.accept)?this.accept.map((e=>this.getAcceptedValues.call({accept:e}))).join(" or "):void 0},getCandidates(){return this.values.forEach((e=>{c(e)&&(e.type="value")})),this.values},getStructure(){return[...this.listAttributes()]},exportValue(){return this.getValue()},getBuildProperty(e){const{build:t}=this.schema;return y(t)||!b(t,e)?null:t[e]},getProperty(e){if("refname"===e)return this.ref.name;let t=a(this.schema.properties,[]).find((t=>t.name===e));if(y(t))return;const{type:i,value:n}=t;return"string"===i?n.toString():"number"===i?+n:"boolean"===i?E(n):n},hasParent(){return!this.isRoot()},getParent(e){if(this.isRoot())return null;if(p(e))return this.parent;const t=this.parent;return t.name===e?t:t.getParent(e)},getParentWith(e){if(this.isRoot())return null;if(p(e))return this.parent;const t=this.parent;return t.hasPrototype(e)?t:t.getParentWith(e)},hasPrototype(e){if(y(this.schema.prototype))return!1;let t=this.model.getConceptSchema(this.schema.prototype);for(;!y(t);){if(t.name===e)return!0;t=this.model.getConceptSchema(t.prototype)}return!1},getAncestor(e){const t=[];for(var i=this.getParent(e);i;)t.push(i),i=i.getParent(e);return t},getChildren(e){const t=[];return y(e)?this.getAttributes().forEach((e=>{t.push(e.target)})):this.getAttributes().forEach((i=>{i.target.name===e?t.push(...i.target):t.push(...i.target.getChildren(e))})),t},getDescendant(e){const t=[];return this.getChildren(e).forEach((i=>{t.push(i),t.push(...i.getDescendant(e))})),t},delete(e=!1){if(!e){const e=this.getParent().removeAttribute(this.ref.name);if(!e.success)return e}return this.getChildren().forEach((e=>{e.delete(!0)})),this.model.removeConcept(this.id),this.notify("delete"),{message:`The concept '${name}' was successfully deleted.`,success:!0}},isRoot(){return y(this.parent)},copy(){var e={name:this.name},t=[];return this.getAttributes().forEach((e=>{t.push({name:e.name,value:e.copy(!1)})})),e.attributes=t,this.model.addValue(e),e},export(){var e={id:this.id,root:this.isRoot(),name:this.name},t=[];return this.getAttributes().forEach((e=>{t.push({name:e.name,value:e.export()})})),e.attributes=t,e},toString(){var e={};return this.attributes.forEach((t=>{Object.assign(e,t.toString())})),e}},Xt=Object.assign(Kt,Gt,Jt);Object.defineProperty(Xt,"attributeSchema",{get(){return this.schema.attributes}}),Object.defineProperty(Xt,"_prototype",{get(){return this.schema.prototype}});function Yt(e){switch(e){case 400:return{success:!1,message:"The value is not a boolean."};case 401:return{success:!1,message:"The value is not included in the list of valid values."}}}const Qt={nature:"primitive",init(e={}){return this.parent=e.parent,this.ref=e.ref,this.alias=this.schema.alias,this.default=a(this.schema.default,!0),this.description=this.schema.description,this.initObserver(),this.initAttribute(),this.initValue(e.value),this},initValue(e){return y(e)?(this.value=this.default,this):(c(e)?this.setValue(e.value):this.setValue(e),this)},hasValue(){return!y(this.value)},getValue(){return this.value},setValue(e){var t=this.validate(e);return 200!==t?{success:!1,message:"Validation failed: The value could not be updated.",errors:[Yt(t).message]}:(this.value=E(e),this.notify("value.changed",e),{success:!0,message:"The value has been successfully updated."})},update:(e,t)=>!0,getCandidates:()=>[!0,!1],getChildren:e=>[],validate:e=>o(e)&&["true","false"].includes(e.toLowerCase())||Number.isInteger(e)&&[1,0].includes(e)||[!0,!1].includes(e)?200:400,build(){return this.getValue()},copy(){var e={name:this.name,value:this.getValue()};return this.model.addValue(e),e},export(){return{id:this.id,name:this.name,root:this.isRoot(),value:this.getValue()}},toString(){return this.value}},Zt=Object.assign(Object.create(Xt),Qt);function ei(e){switch(e){case 400:return{success:!1,message:"The value is not a number."};case 401:return{success:!1,message:"The value is not included in the list of valid values."};case 403:return{success:!1,message:`The value is greater than the maximum allowed: ${this.schema.max.value}.`};case 402:return{success:!1,message:`The value is less than the minimum allowed: ${this.schema.min.value}.`};case 404:return{success:!1,message:`The value is different from the value allowed: ${this.schema.value.value}.`}}}const ti={nature:"primitive",init(e={}){return this.parent=e.parent,this.ref=e.ref,this.values=a(this.schema.values,[]),this.default=a(this.schema.default,null),this.alias=this.schema.alias,this.description=this.schema.description,this.min=this.schema.min,this.max=this.schema.max,this.initObserver(),this.initAttribute(),this.initValue(e.value),this},initValue(e){return y(e)?(this.value=this.default,this):(c(e)?(this.id=e.id,this.setValue(e.value)):this.setValue(e),this)},hasValue(){return!(p(this.value)||isNaN(this.value))},getValue(){return this.hasValue()?+this.value:null},setValue(e){var t=this.validate(e);return 200!==t?{success:!1,message:"Validation failed: The value could not be updated.",errors:[ei.call(this,t).message]}:(this.value=e,this.notify("value.changed",e),{success:!0,message:"The value has been successfully updated."})},getCandidates(){return this.values.forEach((e=>{c(e)&&(e.type="value")})),this.values},getChildren:e=>[],update:(e,t)=>!0,validate(e){if(isNaN(e))return 400;if(this.schema.value){const{min:t,max:i}=this.schema.value;if(this.length.value&&e.length!==this.length.value)return 404;if(t){if(t.included&&e.length<t.value)return 402;if(!t.included&&e.length<=t.value)return 402}if(i){if(i.included&&e.length>i.value)return 403;if(!i.included&&e.length>=i.value)return 403}}if(p(e)||r(this.values))return 200;var t=!1;for(let i=0;!t&&i<this.values.length;i++){const n=this.values[i];t=c(n)?n.value==e:n==e}return t?200:401},build(){return this.getValue()},copy(e=!0){if(!this.hasValue())return null;var t={name:this.name,root:this.isRoot(),value:this.getValue()};return e&&this.model.addValue(t),t},export(){return{name:this.name,value:this.getValue()}},toString(){return this.value}},ii=Object.assign(Object.create(Xt),ti);function ni(e){switch(e){case 401:return{success:!1,message:"The value is not included in the list of valid values."}}}const si={nature:"primitive",reference:null,path:null,init(e={}){return this.parent=e.parent,this.ref=e.ref,this.accept=this.schema.accept,this.path=this.schema.path,this.values=a(this.schema.values,[]),this.alias=this.schema.alias,this.description=this.schema.description,this.initObserver(),this.initAttribute(),this.initValue(e.value),this},initValue(e){return y(e)||this.setValue(e.value),this},hasValue(){return!p(this.value)},getValue(){return y(this.value)?null:this.value},getReference(){return y(this.reference)?null:this.reference},setValue(e){let t=c(e)?e.id:e;var i=this.validate(t);return 200!==i?{success:!1,message:"Validation failed: The value could not be updated.",errors:[ni(i).message]}:y(t)||this.value===t?void 0:(this.reference&&this.reference.unregister(this),this.reference=this.model.getConcept(t),this.reference.register(this),this.value=t,this.notify("value.changed",this.reference),{success:!0,message:"The value has been successfully updated."})},getCandidates(){if(y(this.accept))throw new Error("Bad reference: 'accept' property is not defined");var e=ai.call(this,this.accept);return this.path&&ri(this,this.path).map((e=>({type:this.accept.type,value:e}))),e},getChildren(e){return y(this.reference)||e&&this.reference.name!==e?[]:[this.reference]},delete(e=!1){if(!e){let e=this.getParent().remove(this);if(!e.success)return e}return this.reference&&this.reference.unregister(this),this.model.removeConcept(this.id),this.notify("delete"),{message:`The concept '${name}' was successfully deleted.`,success:!0}},update(e,t){switch(e){case"delete":this.reference.unregister(this),this.value=null,this.reference=null,this.notify("value.changed",this.reference)}return!0},validate(e){return p(e)||r(this.values),200},build(){return this.getValue()},copy(e=!0){var t={name:this.name,value:this.getValue()};return e&&this.model.addValue(t),t},export(){return{id:this.id,name:this.name,root:this.isRoot(),value:this.getValue()}},toString(){var e=[];return this.value.forEach((t=>{e.push(t.toString())})),e}};function ai(e){const{name:t,prototype:i,scope:n,rel:s}=e;return"parent"===s?this.getParent(n).getChildren(t):i?this.model.getConceptsByPrototype(i):this.model.getConcepts(t)}function ri(e,t){if(y(t))return e;const{target:i,value:n,rel:s}=t;var a=[];return"parent"===s?a.push(e.getParentWith(i)):"children"===s?a.push(...e.getChildren(i)):"property"===s&&a.push(e.getProperty(i)),a.map((e=>ri(e,n))).flat()}const oi=Object.assign({},Xt,si),li={nature:"primitive",init(e={}){return this.parent=e.parent,this.ref=e.ref,this.accept=this.schema.accept,this.path=this.schema.path,this.values=a(this.schema.values,[]),this.alias=this.schema.alias,this.description=this.schema.description,this.cardinality=this.schema.cardinality,this.value=[],this.initObserver(),this.initAttribute(),this.initValue(e.value),this},initValue(e){if(this.removeAllElement(),y(e)){if(this.cardinality){const{min:e=0}=this.cardinality;for(let t=0;t<e;t++)this.createElement()}return this}const{id:t,value:i}=e;for(let e=0;e<i.length;e++)this.createElement(i[e]);if(this.cardinality){const{min:e=0}=this.cardinality;let t=e-i.length;for(let e=0;e<t;e++)this.createElement()}return this},hasValue(){return!r(this.value)},getValue(e=!1){const t=this.value.map((e=>this.model.getConcept(e)));return e?t.map((e=>e.getValue())):t},exportValue(){return this.value.map((e=>this.model.getConcept(e))).map((e=>{if("primitive"===e.nature)return{name:e.name,value:e.exportValue()};if("prototype"===e.nature){let t=e.exportValue();return{name:e.name,value:{name:e.value.name,attributes:t}}}return{name:e.name,attributes:e.exportValue()}}))},setValue(e){if(Array.isArray(e)){this.removeAllElement();for(let t=0;t<e.length;t++)this.createElement(e[t]);this.notify("value.changed",e)}},getElements(){return this.value.map((e=>this.model.getConcept(e)))},getElement(e){var t=this.value.find((t=>t===e));if(!y(t))return this.model.getConcept(t)},getElementAt(e){if(!(e<0||e>=this.value.length))return this.model.getConcept(this.value[e])},getFirstElement(){return this.getElementAt(0)},getLastElement(){return this.getElementAt(this.count-1)},addElement(e){return!y(e)&&(this.value.push(e.id),e.index=this.value.length-1,this.notify("value.added",e),!0)},addElementAt(e,t=0){return y(e)&&(e=this.createElement()),this.value.splice(t,0,e.id),this},removeElement(e){var t=this.value.indexOf(e.id);return-1!==t&&this.removeElementAt(t)},removeElementAt(e){if(!Number.isInteger(e)||e<0)return{message:"The element was not removed. The given 'index' is not valid.",success:!1};var t=this.getElementAt(e);if(y(t))return{message:`The element at index '${e}' was not found.`,success:!1};t.delete(!0),this.value.splice(e,1);const i=this.getValue();for(let t=e;t<i.length;t++)i[t].index=t;return this.notify("value.removed",t),{message:`The element '${t.name}' was successfully removed.`,success:!0}},removeAllElement(){return this.value.forEach((e=>{this.model.removeConcept(e)})),this.value=[],this.notify("value.changed",this.value),this},createElement(e){const t={value:this.model.getValue(e),parent:this,ref:this},i=this.model.createConcept(this.accept,t);return this.addElement(i),i},getCandidates(){return ci.call(this,this.accept)},getChildren(e){if(!this.hasValue())return[];const t=this.getElements();return y(e)?t:t.filter((t=>t.name===e))},build(){return this.getValue().map((e=>e.build()))},copy(e=!0){var t={name:this.name,value:this.exportValue()};return e&&this.model.addValue(t),t},export(){return{id:this.id,name:this.name,root:this.isRoot(),value:this.getValue().map((e=>e.export()))}},toString(){var e=[];return this.value.forEach((t=>{e.push(t.toString())})),e}};function ci(e){return this.model.getConceptSchema(e)}const hi=Object.assign(Object.create(Xt),li);Object.defineProperty(hi,"count",{get(){return this.value.length}}),Object.defineProperty(hi,"canAddValue",{get:()=>!0});const ui=200;function di(e){switch(e){case 401:return{success:!1,message:"The value is not included in the list of valid values."};case 403:return{success:!1,message:`The length of the value exceeds the maximum allowed: ${this.length.max.value}.`};case 402:return{success:!1,message:`The length of the value is beneath the minimum allowed: ${this.length.min.value}.`};case 404:return{success:!1,message:`The length of the value is different from the fixed value: ${this.length.value}.`};case 405:return{success:!1,message:"The value does not match the valid pattern."}}}const pi={nature:"primitive",pattern:null,init(e={}){return this.parent=e.parent,this.ref=e.ref,this.values=a(this.schema.values,[]),this.alias=this.schema.alias,this.default=a(this.schema.default,""),this.description=this.schema.description,this.length=this.schema.length,this.pattern=this.schema.pattern,this.initObserver(),this.initAttribute(),this.initValue(e.value),this},initValue(e){return y(e)?(this.value=this.default,this):(c(e)?this.setValue(e.value):this.setValue(e),this)},hasValue(){return!p(this.value)},getValue(){return this.value},setValue(e){var t=this.validate(e);return t!==ui?{success:!1,message:"Validation failed: The value could not be updated.",errors:[di.call(this,t).message]}:(this.value=e,this.notify("value.changed",e),{success:!0,message:"The value has been successfully updated."})},getCandidates(){return this.values.forEach((e=>{c(e)&&(e.type="value")})),this.values},getChildren:e=>[],update:(e,t)=>!0,validate(e){if(p(e))return ui;if(this.length){const{min:t,max:i}=this.length;if(this.length.value&&e.length!==this.length.value)return 404;if(t){if(t.included&&e.length<t.value)return 402;if(!t.included&&e.length<=t.value)return 402}if(i){if(i.included&&e.length>i.value)return 403;if(!i.included&&e.length>=i.value)return 403}}if(this.pattern&&!new RegExp(this.pattern,"gi").test(e))return 405;if(r(this.values))return ui;var t=!1;for(let i=0;!t&&i<this.values.length;i++){const n=this.values[i];t=c(n)?n.value===e:n===e}return t?ui:401},build(){return this.getValue()},copy(e=!0){if(!this.hasValue())return null;var t={name:this.name,value:this.getValue()};return e&&this.model.addValue(t),t},export(){return{id:this.id,name:this.name,root:this.isRoot(),value:this.getValue()}},toString(){return this.value}},mi=Object.assign(Object.create(Xt),pi),yi={nature:"concrete",initValue(e){if(y(e))return!1;const{id:t="",attributes:i=[]}=e;return t.length>10&&(this.id=t),i.forEach((e=>{const{name:t,id:i,value:n}=e;let s=this.getAttributeByName(t);if(n)s.target.initValue(n);else if(i){let e=this.model.getValue(i);e&&s.target.initValue(e)}})),!0},hasValue:()=>!0,getValue(){return this.getAttributes().map((e=>({name:e.name,value:e.copy(!1)})))},build(){}},fi=Object.assign(Object.create(Xt),yi),bi=200;function gi(e){switch(e){case 401:return{success:!1,message:"The value is not included in the list of valid values."}}}const vi={name:"prototype",nature:"prototype",initValue(e){if(y(e))return this;const{id:t,value:i}=e;if(i){let e=this.createConcept(i.name,i);this.setValue(e)}else if(e.name){let t=this.createConcept(e.name,e);this.setValue(t)}return this},getValue(){return this.value},exportValue(){return this.hasValue()?this.getValue().exportValue():null},setValue(e){let t="fake"===e.nature?e.name:e,i=this.validate(t);if(i!==bi)return{success:!1,message:"Validation failed: The value could not be updated.",errors:[gi(i).message]};var n=t;return o(t)&&(n=this.createConcept(t),c(e)&&(n.id=e.id)),this.value&&(this.value.getChildren().forEach((e=>{e.delete(!0)})),this.model.removeConcept(this.value.id),this.value.notify("delete")),this.value=n,this.notify("value.changed",this.value),{success:!0,message:"The value has been successfully updated."}},hasValue(){return!y(this.value)},getCandidates(){return this.candidates||(this.candidates=wi.call(this,this.schema.accept).map((e=>Object.create(Xt,{object:{value:"concept"},nature:{value:"fake"},model:{value:this.model},id:{value:this.hasValue()&&this.value.name===e.name?this.value.id:ut.generate()},name:{value:e.name},schema:{value:e}}).init(this)))),this.candidates},getChildren(e){if(!this.hasValue())return[];const t=[],i=this.getValue();return(y(e)||i.name===e)&&t.push(i),t},getDescendant:e=>[],createConcept(e,t){let i=this.model.getValue(t);const n={parent:this.parent,ref:this.ref};i&&(n.value=i);const s=this.model.getCompleteModelConcept({name:e}),a=this._createConcept(this.model,s,n);return a.prototype=this,a},validate(e){if(p(e))return bi;if(r(this.values))return bi;var t=!1;for(let i=0;!t&&i<this.values.length;i++){const n=this.values[i];t=c(n)?n.value===e:n===e}return t?bi:401},export(){let e=null;if(this.hasValue()){let t=this.getValue();e={id:t.id,name:t.name}}return{id:this.id,name:this.name,root:this.isRoot(),value:e}}};function wi(e){const t=this.model.getConcreteConcepts(this.name);return y(e)?t:Array.isArray(e)?t.filter((t=>e.some((e=>e.name===t.name)))):t.filter((t=>e===t.name))}const Ei=Object.assign({},Xt,vi);function xi(e){switch(e){case 401:return{success:!1,message:"The value is not included in the list of valid values."}}}const _i={name:"meta",reference:null,initValue(e){return y(e)||this.setValue(e.value),this},hasValue(){return!p(this.value)},getValue(){return y(this.value)?null:this.value},getProperty(e){const t=this.schema[e];if(c(t)){const e=[];for(const i in t){const n=t[i];e.push(Object.assign({},{name:i},n))}return e}return t},setValue(e){var t=this.validate(e);return 200!==t?{success:!1,message:"Validation failed: The value could not be updated.",errors:[xi(t).message]}:y(e)||this.value===e?void 0:(this.reference&&this.reference.unregister(this),this.reference=this.model.getConcept(e),this.reference.register(this),this.value=e,this.notify("value.changed",this.reference),{success:!0,message:"The value has been successfully updated."})},getChildren:e=>[],delete(e=!1){if(!e){let e=this.getParent().remove(this);if(!e.success)return e}return this.reference&&this.reference.unregister(this),this.model.removeConcept(this.id),this.notify("delete"),{message:`The concept '${name}' was successfully deleted.`,success:!0}},update(e,t){switch(e){case"delete":this.reference.unregister(this),this.value=null,this.reference=null,this.notify("value.changed",this.reference)}return!0},validate(e){return p(e)||r(this.values),200},export(){return{id:this.id,name:this.name,value:this.value}},toString(){var e=[];return this.value.forEach((t=>{e.push(t.toString())})),e}},Ci=Object.assign({},Xt,_i);function ji(e,t){return{object:{value:"concept"},model:{value:e},name:{value:t.name},schema:{value:t,writable:!0}}}const Li={boolean:(e,t)=>Object.create(Zt,ji(e,t)),number:(e,t)=>Object.create(ii,ji(e,t)),reference:(e,t)=>Object.create(oi,ji(e,t)),set:(e,t)=>Object.create(hi,ji(e,t)),string:(e,t)=>Object.create(mi,ji(e,t)),meta:(e,t)=>Object.create(Ci,ji(e,t))},Ti={primitive:(e,t)=>Li[t.name](e,t),prototype:(e,t)=>Object.create(Ei,ji(e,t)),concrete:(e,t)=>Object.create(fi,ji(e,t)),derivative:(e,t)=>Li[t.base](e,t)},ki={createConcept(e,t,i){const{name:n,nature:s}=t,a=Ti[s];if(y(a))throw new Error(`Missing handler: The '${n}' concept could not be handled`);const r=a(e,t);if(y(r))throw new Error(`Bad request: The '${n}' concept could not be created`);return r._createConcept=this.createConcept,r.init(i),y(r.id)&&(r.id=ut.generate()),r}};var Ai=0;const Oi={concepts:null,values:null,init(e){return this.concepts=[],this.values=[],Array.isArray(e)&&(this.values=e,e.filter((e=>e.root)).forEach((e=>{this.createConcept({name:e.name},{value:e})}))),this},done(){return this.concepts.forEach((e=>{e.unregisterAll()})),this.concepts=[],!0},createConcept(e,t){const i=this.getCompleteModelConcept(e);var n=ki.createConcept(this,i,t);return this.addConcept(n),n},getConcepts(e){if(h(e)){const t=Array.isArray(e)?t=>e.includes(t.name):t=>t.name===e;return this.concepts.filter((e=>t(e)))}return this.concepts.slice()},getRootConcepts(){return this.concepts.filter((e=>e.isRoot()))},getConceptsByPrototype(e){return this.concepts.filter((t=>t.schema.prototype===e))},getConcept(e){if(!o(e)||r(e))throw new TypeError("Bad request: The 'id' argument must be a non-empty string");return this.concepts.find((t=>t.id===e))},addConcept(e){if(y(e))throw new TypeError("Bad request: The 'concept' argument must be a Concept");return this.concepts.push(e),ht("concept.added",e),this},removeConcept(e){if(!c(e)&&!o(e))throw new TypeError("Bad request: The 'id' argument must be a non-empty string");var t=this.concepts.findIndex((t=>t.id===e));if(-1===t)return null;let i=this.concepts.splice(t,1)[0];return ht("concept.removed",i),i},getValues(e){if(h(e)){const t=Array.isArray(e)?t=>e.includes(t.name):t=>t.name===e;return this.values.filter((e=>t(e)))}return this.values.slice()},getValue(e){return y(e)?null:b(e,"value")||b(e,"attributes")?e:b(e,"id")?this.values.find((t=>t.id===e.id)):this.values.find((t=>t.id===e))},addValue(e){if(y(e))throw new TypeError("Bad request: The 'value' argument must be a Value");return this.values.some((t=>{return n=e,(i=t).name===n.name&&(i.value?i.value===n.value:JSON.stringify(i.attributes)===JSON.stringify(n.attributes));var i,n}))||(e.id="value"+Ai++,this.values.push(e),ht("value.added",e)),this},removeValue(e){if(!c(e)&&!o(e))throw new TypeError("Bad request: The 'id' argument must be a non-empty string");var t=this.values.findIndex((t=>t.id===e));if(-1===t)return null;let i=this.values.splice(t,1)[0];return ht("value.removed",i),i},isConcept(e){return!!o(e)&&-1!==this.schema.findIndex((t=>t.name===e))},isConcrete(e){if(!o(e))return!1;const t=this.schema.find((t=>t.name===e));return!y(t)&&"concrete"===t.nature},isPrototype(e){if(!o(e))return!1;const t=this.schema.find((t=>t.name===e));return!y(t)&&"prototype"===t.nature},getSchema(e){if(h(e)){const t=Array.isArray(e)?t=>e.includes(t.nature):t=>t.nature===e;return this.schema.filter((e=>t(e)))}return this.schema.slice()},getConceptSchema(e){const t=Si(this.schema,e);var i;if(!y(t))return i=t,JSON.parse(JSON.stringify(i))},getCompleteModelConcept(e){let t=e;o(e)&&(t={name:e});const i=this.getConceptSchema(t.name);if(y(i))return;Object.assign(i,t),b(i,"attributes")||(i.attributes=[]);const n=Mi.call(this,i.prototype);return i.attributes.push(...n.attributes),i},getConcreteConcepts(e){const t=t=>{for(var i=t.prototype;!y(i);){if(i===e)return!0;i=a(Si(this.schema,i),{}).prototype}return!1},i=this.schema.filter((e=>"concrete"===e.nature));return e?i.filter((e=>t(e))):i},getDerivedConcepts(e){if(y(e))throw new TypeError("Bad argument");return this.schema.filter((t=>t.base===e))},export(){const e=[];return this.getConcepts().forEach((t=>{e.push(t.export())})),e},toString(){return JSON.stringify({[this.root.name]:this.root.toString()})}};function Mi(e){var t=e;const i=[];for(;!y(t);){const e=a(this.getConceptSchema(t),{});n=e.attributes,Array.isArray(n)&&n.forEach((e=>{const t=i.find((t=>t.name===e.name));y(t)?i.push(e):(e.required&&(t.required=e.required),e.description&&(t.description=e.description))})),t=e.prototype}var n;return{attributes:i}}const Vi=[{name:"string",nature:"primitive"},{name:"number",nature:"primitive"},{name:"boolean",nature:"primitive"},{name:"reference",nature:"primitive"},{name:"set",nature:"primitive"}];function Si(e,t){let i=e.find((e=>e.name===t));return y(i)&&(i=Vi.find((e=>e.name===t))),i}const Ni=[],Ri={createModel(e){var t=Object.create(Oi,{schema:{value:e}});return Ni.push(t),t}},Ii={text:function(e,t){for(const i in t){const n=t[i];switch(i){case"bold":e.style.fontWeight=qi(n);break;case"italic":e.style.fontStyle="italic";break;case"underline":e.style.textDecoration="underline";break;case"strikethrough":e.style.textDecoration="line-through";break;case"color":e.style.color=$i(n);break;case"font":e.style.fontFamily=n;break;case"highlight":e.style.backgroundColor=$i(n);break;case"size":e.style.fontSize=Di(n);break;case"align":e.style.textAlign=n;break;case"space":e.style.lineHeight=Di(n)}}return e},box:function(e,t){for(const i in t){const n=t[i];switch(i){case"space":Bi(e,n);break;case"border":zi(e,n);break;case"background":Fi(e,n);break;case"width":e.style.width=Di(n,"%");break;case"height":e.style.height=Di(n,"%");break;case"overflow":e.style.overflow=n}}return e},css:function(e,t){return h(t)?(Hi(e,t),e):e},size:function(e,t){for(const e in t)t[e];return e}};function Pi(e,t){if(!c(t))return e;for(const i in t){const n=t[i];Ii[i](e,n)}return e}function Hi(e,t){if(Array.isArray(t))e.classList.add(...t);else{let i=t.replace(/\s+/g," ").trim();p(e.className)?e.className=i:Hi(e,i.split(" "))}return e}function $i(e){const{type:t,value:i}=e;switch(t){case"rgb":return c(i)?`rgb(${i.red}, ${i.green}, ${i.blue})`:i;default:return e}}function qi(e){const{type:t,value:i}=e;return Number.isInteger(e)?`${e}`:"bold"}function Di(e,t="px"){const{type:i,value:n}=e;return Number.isInteger(e)?`${e}${t}`:0}function Bi(e,t){const{inner:i={},outer:n={}}=t;if(Number.isInteger(i))e.style.padding=`${i}px`;else for(const t in i){const n=i[t];switch(t){case"top":e.style.paddingTop=`${n}px`;break;case"right":e.style.paddingRight=`${n}px`;break;case"bottom":e.style.paddingBottom=`${n}px`;break;case"left":e.style.paddingLeft=`${n}px`}}if(Number.isInteger(n))e.style.margin=`${n}px`;else for(const t in n){const i=n[t];switch(t){case"top":e.style.marginTop=`${i}px`;break;case"right":e.style.marginRight=`${i}px`;break;case"bottom":e.style.marginBottom=`${i}px`;break;case"left":e.style.marginLeft=`${i}px`}}}function Fi(e,t){e.style.backgroundColor=$i(t)}function zi(e,t){if(t.size)e.style.borderStyle="solid",e.style.borderWidth=Di(t.size),e.style.borderColor=$i(t.color);else for(const i in t){const n=t[i];switch(i){case"top":e.style.borderTopStyle="solid",e.style.borderTopWidth=Di(n.size),e.style.borderTopColor=$i(n.color);break;case"right":e.style.borderRightStyle="solid",e.style.borderRightWidth=Di(n.size),e.style.borderRightColor=$i(n.color);break;case"bottom":e.style.borderBottomStyle="solid",e.style.borderBottomWidth=Di(n.size),e.style.borderBottomColor=$i(n.color);break;case"left":e.style.borderLeftStyle="solid",e.style.borderLeftWidth=Di(n.size),e.style.borderLeftColor=$i(n.color)}}t.radius&&function(e,t){if(Number.isInteger(t))e.style.borderRadius=Di(t);else for(const i in t){const n=t[i];switch(i){case"top":e.style.borderTopLeftRadius=Di(n);break;case"right":e.style.borderTopRightRadius=Di(n);break;case"bottom":e.style.borderBottomRightRadius=Di(n);break;case"left":e.style.borderBottomLeftRadius=Di(n)}}}(e,t.radius)}function Wi(e,t){if(!Array.isArray(t))return!1;e.currentState=null;for(let i=0;i<t.length;i++){const n=t[i],{rule:s,result:a}=n;let r=!1,o=Ui[s.type];if(l(o)&&(r=o.call(this,s[s.type])),r)return e.currentState=i,a}return null}const Ui={eq:function(e){if(!Array.isArray(e))throw new TypeError("Terms need to be an array");if(e.length<2)return null;return Ji.call(this,e[0])==Ji.call(this,e[1])},ne:function(e){if(!Array.isArray(e))throw new TypeError("Terms need to be an array");if(e.length<2)return null;return Ji.call(this,e[0])!=Ji.call(this,e[1])},lt:function(e){if(!Array.isArray(e))throw new TypeError("Terms need to be an array");if(e.length<2)return null;return Ji.call(this,e[0])<Ji.call(this,e[1])},le:function(e){if(!Array.isArray(e))throw new TypeError("Terms need to be an array");if(e.length<2)return null;return Ji.call(this,e[0])<=Ji.call(this,e[1])},gt:function(e){if(!Array.isArray(e))throw new TypeError("Terms need to be an array");if(e.length<2)return null;return Ji.call(this,e[0])>Ji.call(this,e[1])},ge:function(e){if(!Array.isArray(e))throw new TypeError("Terms need to be an array");if(e.length<2)return null;return Ji.call(this,e[0])>=Ji.call(this,e[1])},and:function(e){return Gi.call(this,e[0])&&Gi.call(this,e[1])},or:function(e){return Gi.call(this,e[0])||Gi.call(this,e[1])},not:function(e){return!Gi.call(this,e[0])},no:function(e){let t=Ji.call(this,e);return h(t)?r(t):y(t)}};function Ji(e,t){if(c(e)){let t=`get${w(e.prop)}`;return this[t]?this[t]():this[e.prop]}return t||e}function Gi(e){let t=Ui[e.type];return l(t)?t.call(this,e[e.type]):E(Ji.call(this,e))}function Ki(e,t){const{name:i,tag:n,state:s}=e;if(!t.hasAttribute(i))throw new Error(`Attribute '${i}' does not exist in the concept '${t.name}'`);let a={name:i,schema:e,required:t.isAttributeRequired(i),created:t.isAttributeCreated(i),placeholder:null,element:null};this.projection.attributes.push(a);let r=null,o=Wi.call(a,e,s);if(o)r=o.content?ts.call(this,o.content,t):ee({class:["projection-element","projection-element--placeholder"],dataset:{object:"attribute",id:i}},`Add ${i}`),r.tabIndex=0,r.addEventListener("click",(e=>{t.createAttribute(i)})),a.placeholder=r;else{let{target:e,description:s,schema:o}=t.getAttributeByName(i);var l=this.projection.model.createProjection(e,n).init();l.parent=this.projection,r=l.render(),l.element.parent=this,a.element=r}return r}const Xi={init(){throw new Error("This function has not been implemented")},element:null,statusElement:null,attached:null,errors:null,readonly:!1,visible:!1,disabled:!1,active:!1,focused:!1,get hasError(){return!r(this.errors)},get hasAttached(){return!r(this.attached)},attach(e,t){this.attached.push(e)},detach(e){this.attached.slice(this.attached.indexOf(e),1)},getAttached(e){return l(e)?this.attached.filter((t=>e(t))):this.attached},show(){return He(this.element),this.visible=!0,this.active=!0,this},hide(){return $e(this.element),this.visible=!1,this},toggle(){return qe(this.container),this.visible=!this.visible,this},focus(e){return this.element.contentEditable=!1,this.element.focus(),this.focused=!0,this},_focusIn:e=>!1,enable(){return this.disabled=!1,this},disable(){return this.disabled=!0,this},clear:()=>!0,delete(){var e=this.source.delete();e.success?(this.clear(),Ce(this.element),this.element.remove()):(this.environment.notify(e.message),De(this.element))},spaceHandler(e){return console.warn(`SPACE_HANDLER NOT IMPLEMENTED FOR ${this.name}`),!1},_spaceHandler(e){return console.warn(`CTRL_SPACE_HANDLER NOT IMPLEMENTED FOR ${this.name}`),!1},escapeHandler(e){return console.warn(`ESCAPE_HANDLER NOT IMPLEMENTED FOR ${this.name}`),!1},enterHandler(e){this.focusOut()},deleteHandler(e){console.warn(`DELETE_HANDLER NOT IMPLEMENTED FOR ${this.name}`),this.focusOut()},backspaceHandler:e=>(console.warn("BACKSPACE_HANDLER NOT IMPLEMENTED"),!1),arrowHandler:(e,t)=>(console.warn("ARROW_HANDLER NOT IMPLEMENTED"),!1),clickHandler:e=>(console.warn("CLICK_HANDLER NOT IMPLEMENTED"),!1)},Yi=Object.assign(Xi),Qi={input:null,label:null,value:"",state:null,init(){const{focusable:e=!0}=this.schema;return this.focusable=e,this},render(){const e=H(),{before:t={},label:i={},input:n={},after:s={}}=this.schema;var a,r;if(L(this.element)||(this.element=(a=this.id,F({id:a,class:["field","field--binary"],tabindex:-1,dataset:{nature:"field",view:"binary",id:a}})),this.readonly&&this.element.classList.add("readonly"),Pi(this.element,this.schema.style)),L(this.notification)||(this.notification=function(e){return F({class:["field-notification"],dataset:{nature:"field-component",view:"binary",id:e}})}(this.id),e.appendChild(this.notification)),L(this.statusElement)||(this.statusElement=function(e){return ee({class:["field-status"],dataset:{nature:"field-component",view:"binary",id:e}})}(this.id),this.notification.appendChild(this.statusElement)),!L(this.input)){const{before:t,projection:i,after:s,style:a}=n;this.input=function(e){return te({id:`checkbox${e}`,type:"checkbox",class:["field--binary__input"],tabindex:0,dataset:{nature:"field-component",view:"binary",id:e}})}(this.id),this.input.checked=!("concept"!==(r=this.source).object||!r.hasValue())&&r.getValue(),this.value=this.input.checked,this.readonly&&(this.input.classList.add("readonly"),this.input.disabled=!0),Pi(this.input,a),e.appendChild(this.input)}if(!L(this.label)){const{style:t,projection:n,value:s}=i;this.label=ne({class:["field--checkbox__label"],for:this.input.id,tabindex:0,dataset:{nature:"field-component",view:"binary",id:this.id}}),this.label.htmlFor=this.input.id,Array.isArray(n)?n.forEach((e=>{this.label.append(ts.call(this,e))})):n&&this.label.append(ts.call(this,n)),Pi(this.label,t),e.appendChild(this.label)}return e.hasChildNodes()&&(this.element.appendChild(e),this.bindEvents()),this.refresh(),this.element},focusIn(){return this.focused=!0,this.value=this.input.checked,this.element.classList.add("active"),this},focusOut(){if(!this.readonly)return this.hasChanges()&&this.setValue(this.input.checked),this.messageElement&&($e(this.messageElement),Ce(this.messageElement)),this.choice&&$e(this.choice),this.input.blur(),this.element.classList.remove("active"),this.refresh(),this.focused=!1,this},hasChanges(){return this.value!==this.input.checked},hasValue(){return this.input.checked},getValue(){return this.input.checked},setValue(e,t=!1){var i;i=t?this.source.setValue(e):{success:!0},this.errors=[],i.success||(this.environment.notify(i.message,"error"),this.errors.push(...i.errors)),this.input.checked=e,this.value=e,this.refresh()},getCandidates(){return this.source.getCandidates()},enable(){this.input.disabled=!1,this.input.tabIndex=0,this.disabled=!1},disable(){this.input.disabled=!0,this.input.tabIndex=-1,this.disabled=!0},refresh(){const e=a(Wi.call(this,this.schema,this.schema.state),this.schema);if(this.hasChanges()?this.statusElement.classList.add("change"):this.statusElement.classList.remove("change"),e){const{label:t}=e;if(Ce(this.label),t){const{style:e,projection:i,value:n}=t;Array.isArray(i)?i.forEach((e=>{this.label.append(ts.call(this,e))})):i&&this.label.append(ts.call(this,i)),Pi(this.label,e)}}var t,i;this.input.checked?this.element.dataset.state="on":this.element.dataset.state="off",Ce(this.statusElement),this.hasError?(this.element.classList.add("error"),this.input.classList.add("error"),this.statusElement.classList.add("error"),this.statusElement.appendChild(("error",t=this.errors,i=Y({class:["notification-message","notification-message--error"]},t),Array.isArray(t)?i.style.minWidth=`${Math.min(.5*t[0].length,30)}em`:i.style.minWidth=`${Math.min(.5*t.length,30)}em`,i))):(this.element.classList.remove("error"),this.input.classList.remove("error"),this.statusElement.classList.remove("error"))},append(e){if(!L(e))throw new TypeError("Bad argument: The 'element' argument must be an HTML Element");return this.element.appendChild(e),this},escapeHandler(e){this.input.focus(),this.messageElement&&$e(this.messageElement),this.choice&&$e(this.choice)},enterHandler(e){this.setValue(!this.input.checked,!0)},arrowHandler(e,t){return!!this.parent&&this.parent.arrowHandler(e,this.element)},bindEvents(){this.element.addEventListener("change",(e=>{this.setValue(this.getValue(),!0)}))}},Zi=Object.assign(Object.create(Yi),Qi);function en(e,t){var i=Y({class:["notification-message",`notification-message--${e}`]},t);return Array.isArray(t)?i.style.minWidth=`${Math.min(.5*t[0].length,30)}em`:i.style.minWidth=`${Math.min(.5*t.length,30)}em`,i}function tn(e){const t=e=>e.parentElement===this.choices;return t(e)?e:Ee(e,t,5)}function nn(e){return e.textContent}const sn={value:null,values:null,choices:null,input:null,items:null,selection:null,selectionPlaceholder:null,selectionElement:null,content:null,init(){const{focusable:e=!0}=this.schema;return this.items=new Map,this.content=this.schema.content,this.focusable=e,b(this.schema,"choice")||(this.schema.choice={}),b(this.schema,"selection")||(this.schema.selection={}),this},hasChanges(){return this.value!==this.selected},reset(){this.setValue(null,!0)},hasValue(){return!y(this.value)},getValue(){return this.selection},setValue(e,t=!1){var i=null;if(t)i=this.source.setValue(e);else{if(y(e))He(this.selectionPlaceholder),Ce(this.selectionElement).remove(),this.selection=null;else if("concept"===e.object){const{template:t={}}=this.schema.selection;let i=this.model.createProjection(e,a(t.tag,"choice-selection")).init();i.parent=this.projection,this.setChoice(e),this.setSelection(i.render()),i.element.parent=this}else this.setChoice(e);i={success:!0}}this.errors=[],i.success||(this.environment.notify(i.message,"error"),this.errors.push(...i.errors)),this.value=e,this.refresh()},setInputValue(e){L(this.input)&&(this.input.value=e)},render(){const e=H(),{choice:t,content:i=[],selection:n={},input:s={},style:r}=this.schema;if(L(this.element)||(this.element=F({id:this.id,class:["field","field--choice"],tabindex:-1,dataset:{nature:"field",view:"choice",input:"",id:this.id}}),Pi(this.element,r)),L(this.notification)||(this.notification=F({class:["field-notification","hidden"],dataset:{nature:"field-component",view:"choice",id:this.id}}),e.appendChild(this.notification)),L(this.statusElement)||(this.statusElement=ee({class:["field-status"],dataset:{nature:"field-component",view:"choice",id:this.id}}),this.notification.appendChild(this.statusElement)),L(this.messageElement)||(this.messageElement=ee({class:["field-message","hidden"],dataset:{nature:"field-component",view:"choice",id:this.id}}),this.notification.appendChild(this.messageElement)),i.forEach((t=>{if("input"===t.type)this.input=ts.call(this,t),this.input.classList.add("field--textbox__input"),e.append(this.input);else if("choice"===t.type){const{style:i}=a(t.choice,{});this.choices=U({class:["bare-list","field--choice__choices"],tabindex:-1,dataset:{nature:"field-component",view:"choice",id:this.id}}),Pi(this.choices,i),e.appendChild(this.choices)}else{let i=ts.call(this,t);e.appendChild(i)}})),!L(this.choices)){const{style:i}=t;this.choices=U({class:["bare-list","field--choice__choices"],tabindex:-1,dataset:{nature:"field-component",view:"choice",id:this.id}}),Pi(this.choices,i),e.appendChild(this.choices)}return L(this.selectionPlaceholder)||(this.selectionPlaceholder=ee({class:["field--choice__selection"],dataset:{nature:"field-component",view:"choice",id:this.id}}),e.appendChild(this.selectionPlaceholder)),e.hasChildNodes()&&(this.element.appendChild(e),this.bindEvents()),Ce(this.choices),this.values=this.source.getCandidates(),this.values.forEach((e=>{this.choices.appendChild(this.createChoiceOption(e))})),this.source.hasValue()&&this.setValue(this.source.getValue()),this.refresh(),this.element},focus(e){return this.input&&!Qe(this.input)?this.input.focus():this.selection&&this.selection.focus(),this},focusIn(){this.focused=!0,this.element.classList.add("active");const e=H();return this.source.getCandidates().filter((e=>!this.values.some((t=>t.id===e.id)))).forEach((t=>{e.append(this.createChoiceOption(t)),this.values.push(t)})),this.choices.append(e),this},focusOut(){if(!this.readonly){if(this.input&&p(this.input.value)&&(this.input.value=""),this.messageElement&&($e(this.messageElement),Ce(this.messageElement)),this.input&&this.input.blur(),this.element.classList.remove("active"),this.element.classList.remove("querying"),L(this.selection)){const{children:e}=this.choices;for(let t=0;t<e.length;t++){const i=e[t];i===this.selection?(He(i),i.hidden=!1):($e(i),i.hidden=!0)}this.setInputValue(nn(this.selection))}return this.focused=!1,this}},enable(){return this.input&&(this.input.disabled=!1,this.input.tabIndex=0),this.disabled=!1,this},disable(){return this.input&&(this.input.disabled=!0,this.input.tabIndex=-1),this.disabled=!0,this},refresh(){return this.hasValue()?this.element.classList.remove("empty"):this.element.classList.add("empty"),this.hasChanges()?this.statusElement.classList.add("change"):this.statusElement.classList.remove("change"),this.element.classList.remove("querying"),Ce(this.statusElement),this.hasError?(this.element.classList.add("error"),this.input&&this.input.classList.add("error"),this.statusElement.classList.add("error"),this.statusElement.appendChild(en("error",this.errors))):(this.element.classList.remove("error"),this.input&&this.input.classList.remove("error"),this.statusElement.classList.remove("error")),this},filterChoice(e){const{children:t}=this.choices;if(this.element.dataset.input=e.trim(),p(e)){for(let e=0;e<t.length;e++){const i=t[e];He(i),i.hidden=!1}return}this.element.classList.add("querying");let i=e.trim().toLowerCase().replace(/\s+/g," ").split(" ");for(let e=0;e<t.length;e++){const n=t[e];let s=nn(n);i.some((e=>s.toLowerCase().includes(e)))?(He(n),n.hidden=!1):($e(n),n.hidden=!0)}return!0},createChoiceOption(e){const t=c(e),i=J({class:["field--choice__choice"],tabindex:0,dataset:{nature:"field-component",view:"choice",id:this.id,type:t?"concept":"value",value:t?e.id:e}}),n=this.content.find((e=>"choice"===e.type)),{template:s={},style:r}=n.choice.option;if(t){let t=this.model.createProjection(e,a(s.tag,"choice")).init({focusable:!1});t.parent=this.projection;const{context:n}=t.getSchema();if(n)for(const e in n){const t=n[e];i.dataset[`choice${o=e,p(o)?o:o.charAt(0).toUpperCase()+o.slice(1)}`]=t}i.append(t.render())}else i.append(e.toString());var o;return Pi(i,r),this.items.set(e.id,i),i},setChoice(e){const{children:t}=this.choices,i=e=>{const{type:t,value:i}=e.dataset;return"concept"===t?this.values.find((e=>e.id===i)):"value"===t?i:void 0};let n=!1;for(let r=0;r<t.length;r++){const o=t[r];a=e,(c(s=i(o))?s.id===a.id:s===a)?(o.classList.add("selected"),o.dataset.selected="selected",this.selection=o,He(o),n=!0):(o.classList.remove("selected"),delete o.dataset.selected,$e(o))}var s,a;return n&&this.setInputValue(e.name),this},setSelection(e){if(!L(e))throw new TypeError("Bad parameter");const{style:t={}}=this.schema.selection;$e(this.selectionPlaceholder),this.selectionElement=e,this.selectionElement.classList.add("field--choice__selection"),Pi(this.selectionElement,t),this.selectionPlaceholder.after(e)},_spaceHandler(e){const t=H();this.source.getCandidates().forEach((e=>{t.appendChild(this.createChoiceOption(e))})),Ce(this.choices).appendChild(t),this.filterChoice(this.input.value),He(this.choices),this.element.classList.add("querying"),this.messageElement.appendChild(en("info","Select an element from the list.")),He(this.messageElement)},escapeHandler(e){if(e===this.input){let t=Ee(e,(e=>0===e.tabIndex));return this.environment.resolveElement(t).focus(t),!0}this.input&&this.input.focus(),this.messageElement&&$e(this.messageElement)},enterHandler(e){const t=tn.call(this,e);L(t)&&this.selection!==t&&this.setValue((e=>{const{type:t,value:i}=e.dataset;return"concept"===t?this.values.find((e=>e.id===i)):"value"===t?i:void 0})(t),!0)},backspaceHandler(e){tn.call(this,e)&&this.input&&this.input.focus()},clickHandler(e){const t=tn.call(this,e);L(t)&&this.selection!==t&&(this.setValue((e=>{const{type:t,value:i}=e.dataset;return"concept"===t?this.values.find((e=>e.id===i)):"value"===t?i:void 0})(t),!0),this.focusOut())},arrowHandler(e,t){if(t.parentElement===this.choices){let i=null;return"up"===e?i=st(t,this.choices):"down"===e?i=ot(t,this.choices):"left"===e?i=at(t,this.choices):"right"===e&&(i=rt(t,this.choices)),L(i)?(i.focus(),!0):this.arrowHandler(e,t.parentElement)}if(t.parentElement===this.element){let i=null;if("up"===e?i=st(t,this.element):"down"===e?i=ot(t,this.element):"left"===e?i=at(t,this.element):"right"===e&&(i=rt(t,this.element)),L(i)){if(i===this.choices&&this.choices.hasChildNodes()){let e=function(e){for(let t=0;t<e.children.length;t++){const i=e.children[t];if(!Qe(i))return i}return null}(i);e&&e.focus()}else if(i===this.selectionElement){let e=this.environment.resolveElement(i);e&&e.focus()}else i.focus();return!0}}return!!this.parent&&this.parent.arrowHandler(e,this.element)},bindEvents(){L(this.input)&&this.element.addEventListener("input",(e=>{this.filterChoice(this.input.value)}))}},an=Object.assign(Object.create(Yi),sn),rn={content:{type:"static",static:{type:"text",content:"Remove"}}};function on(e){const{action:t={}}=this.schema,i=this.content.find((e=>"list"===e.type)),{template:n,style:s}=i.list.item,r=J({class:["field--list-item"],tabindex:0,dataset:{nature:"field-component",view:"list",id:this.id,value:e.id,name:e.name,index:a(e.index,this.items.size)}});var{content:o,style:l}=a(t.remove,rn),c=ts.call(this,o),h=oe({class:["btn","btn-remove"],tabindex:-1,dataset:{nature:"field-component",view:"list",id:this.id,action:"remove",index:r.dataset.index}},c);Pi(h,l),r.appendChild(h);var u=this.model.createProjection(e,n.tag);return u.parent=this.projection,r.appendChild(u.init().render()),this.items.set(e.id,r),Pi(r,s),r}const ln={list:null,items:null,selection:null,content:null,init(){return this.source.register(this),this.items=new Map,this.content=this.schema.content,this},update(e,t){switch(e){case"value.added":this.addItem(t);break;case"value.removed":this.removeItem(t);break;case"value.changed":Ce(this.list),this.source.getValue().forEach((e=>{var t=on.call(this,e);this.list.appendChild(t)}));break;case"delete":this.source.unregister(this),Ce(this.element),this.element.remove();break;default:console.warn(`The message '${e}' was not handled for list field`)}this.refresh()},render(){const e=H(),{content:t,style:i,action:n={}}=this.schema;if(!Array.isArray(t))throw new Error("Empty content for listfield");return L(this.element)||(this.element=F({id:this.id,class:["field","field--list"],tabindex:-1,dataset:{nature:"field",view:"list",id:this.id}}),this.readonly&&this.element.classList.add("readonly"),Pi(this.element,this.schema.style)),L(this.notification)||(this.notification=F({class:["field-notification"],dataset:{nature:"field-component",view:"list",id:this.id}}),e.appendChild(this.notification)),L(this.statusElement)||(this.statusElement=ee({class:["field-status"],dataset:{nature:"field-component",view:"list",id:this.id}}),this.notification.appendChild(this.statusElement)),t.forEach((e=>{})),this.source.getValue().forEach((e=>{var t=on.call(this,e);this.list.appendChild(t)})),e.hasChildNodes()&&(this.element.appendChild(e),this.bindEvents()),this.refresh(),this.element},hasChanges:()=>!1,getValue(){return this.list.children},hasValue(){return this.items.size>0},clear(){this.items.clear(),Ce(this.list)},focusIn(e){this.focused=!0,this.element.classList.add("active")},focusOut(e){if(!this.readonly)return this.messageElement&&($e(this.messageElement),Ce(this.messageElement)),this.element.classList.remove("active"),this.refresh(),this.focused=!1,this},refresh(){var e,t;this.hasValue()?(this.element.classList.remove("empty"),this.list.classList.remove("empty")):(this.element.classList.add("empty"),this.list.classList.add("empty")),this.hasChanges()?this.statusElement.classList.add("change"):this.statusElement.classList.remove("change"),Ce(this.statusElement),this.hasError?(this.element.classList.add("error"),this.list.classList.add("error"),this.statusElement.classList.add("error"),this.statusElement.appendChild(("error",e=this.errors,t=Y({class:["notification-message","notification-message--error"]},e),Array.isArray(e)?t.style.minWidth=`${Math.min(.5*e[0].length,30)}em`:t.style.minWidth=`${Math.min(.5*e.length,30)}em`,t))):(this.element.classList.remove("error"),this.list.classList.remove("error"),this.statusElement.classList.remove("error"))},createElement(){return this.source.createElement()},getNode(e){return this.items.get(e)},addNode(e){const t=on.call(this,e);e.index?this.list.children[e.index-1].after(t):this.list.appendChild(t)},removeNode(e){let t=this.getItem(e.id);if(!L(t))throw new Error("List error: Item not found")},append(e){if(!L(e))throw new TypeError("Bad argument: The 'element' argument must be an HTML Element");return this.element.appendChild(e),this},delete(e){if(e===this.element)return void this.source.remove();const{index:t}=e.dataset;this.source.removeElementAt(+t)?this.environment.notify("The element was successfully deleted"):(this.environment.notify("This element cannot be deleted"),De(e))},escapeHandler(e){return!!this.messageElement&&($e(this.messageElement),!0)},enterHandler:e=>!1,backspaceHandler:e=>!1,clickHandler:e=>!1,arrowHandler:(e,t)=>!1,bindEvents(){}},cn=Object.assign(Object.create(Yi),ln),hn={content:{type:"static",static:{type:"text",content:"Add"}}},un={content:{type:"static",static:{type:"text",content:"Remove"}}};function dn(){return L(this.messageElement)||(this.messageElement=ee({class:["field-message","hidden"],dataset:{nature:"field-component",view:"text",id:this.id}}),this.notification.appendChild(this.messageElement)),this.messageElement}function pn(e){const{action:t={}}=this.schema,i=this.content.find((e=>"list"===e.type)),{template:n,style:s}=i.list.item,r=J({class:["field--list-item"],tabindex:0,dataset:{nature:"field-component",view:"list",component:"list-item",id:this.id,value:e.id,name:e.name,index:a(e.index,this.items.size)}});var{content:o,style:l}=a(t.remove,un),c=ts.call(this,o),h=oe({class:["btn","field-action","btn-remove"],tabindex:-1,title:"Remove",dataset:{nature:"field-component",view:"list",component:"action",id:this.id,action:"remove",index:r.dataset.index}},c);Pi(h,l),r.appendChild(h);var u=this.model.createProjection(e,n.tag);return u.parent=this.projection,r.appendChild(u.init().render()),this.items.set(e.id,r),Pi(r,s),r}function mn(e,t){var i=Y({class:["notification-message",`notification-message--${e}`]},t);return Array.isArray(t)?i.style.minWidth=`${Math.min(.5*t[0].length,30)}em`:i.style.minWidth=`${Math.min(.5*t.length,30)}em`,i}function yn(e){if(!L(e))return!1;const{nature:t,id:i}=e.dataset;return"field-component"===t&&i===this.id}const fn={list:null,items:null,elements:null,selection:null,content:null,init(){const{content:e=[],focusable:t=!0}=this.schema;return this.items=new Map,this.elements=new Map,this.focusable=t,this.content=e,this},render(){const e=H(),{content:t,style:i,action:n={}}=this.schema;if(!Array.isArray(t))throw new Error("Empty content for listfield");return L(this.element)||(this.element=F({id:this.id,class:["field","field--list"],tabindex:-1,dataset:{nature:"field",view:"list",id:this.id}}),this.readonly&&this.element.classList.add("readonly"),Pi(this.element,this.schema.style)),L(this.notification)||(this.notification=F({class:["field-notification"],dataset:{nature:"field-component",view:"list",id:this.id}}),e.appendChild(this.notification)),L(this.statusElement)||(this.statusElement=ee({class:["field-status"],dataset:{nature:"field-component",view:"list",id:this.id}}),this.notification.appendChild(this.statusElement)),t.forEach((t=>{if("list"===t.type){let i=a(t.list,{});const{style:n}=i;this.list=U({class:["bare-list","field--list__list"],dataset:{nature:"field-component",view:"list",id:this.id}}),this.source.hasValue()||this.list.classList.add("empty"),i.currentState=null,this.elements.set(i,this.list),Pi(this.list,n),e.appendChild(this.list)}else if("action"===t.type){let i=a(t,hn);const{content:n,style:s}=i;let r=ts.call(this,n,null),o=oe({class:["field-action","field--list__add"],tabindex:0,dataset:{nature:"field-component",view:"list",component:"action",id:this.id,action:"add"}},[r]);i.currentState=null,this.elements.set(i,o),Pi(o,s),e.appendChild(o)}else{let i=ts.call(this,t);this.elements.set(t,i),e.appendChild(i)}})),this.source.getValue().forEach((e=>{var t=pn.call(this,e);this.list.appendChild(t)})),Pi(this.element,i),e.hasChildNodes()&&(this.element.appendChild(e),this.bindEvents()),this.refresh(),this.element},hasChanges:()=>!1,hasValue(){return this.items.size>0},getValue(){return this.list.children},setValue(e,t=!1){t&&this.source.setValue(e),Ce(this.list),e.forEach((e=>{var t=pn.call(this,e);this.list.appendChild(t)})),this.refresh()},clear(){this.items.clear(),Ce(this.list)},focus(e){if(yn.call(this,e))this.focusIn(e),this.selection.focus();else if(L(this.selection))this.selection.focus();else if(this.hasValue())this.list.firstElementChild.focus();else{let e=function(e){const t=e.children,{top:i,left:n}=e.getBoundingClientRect();if(0===t.length)return null;let s=null,a=99999,r=99999;for(let e=0;e<t.length;e++){const o=t[e];if(Qe(o))continue;const{top:l,left:c}=o.getBoundingClientRect();let h=Math.abs(i-l),u=Math.abs(n-c);i<=l+1&&(h<a||h===a&&u<r)&&(s=o,a=h,r=u)}return s}(this.element);if(!L(e))return this;if(e===this.list){if(!this.list.hasChildNodes())return this.arrowHandler("down",this.list);e.children[0].focus()}else e.focus()}return this},focusIn(e){this.focused=!0,this.element.classList.add("active");const{component:t}=e.dataset;"list-item"===t&&(this.selection=e)},_focusIn(e){const{component:t}=e.dataset;"list-item"===t&&(this.selection=e)},focusOut(){if(!this.readonly)return this.messageElement&&($e(this.messageElement),Ce(this.messageElement)),this.element.classList.remove("active"),this.refresh(),this.focused=!1,this},refresh(){this.hasValue()?(this.element.classList.remove("empty"),this.list.classList.remove("empty")):(this.element.classList.add("empty"),this.list.classList.add("empty")),this.hasChanges()?this.statusElement.classList.add("change"):this.statusElement.classList.remove("change"),this.elements.forEach(((e,t)=>{if(!Array.isArray(t.state))return;const{currentState:i}=t,n=Wi.call(this,t,t.state);if(i===t.currentState)return;let s=null;s=n?ts.call(this,n.content,null):ts.call(this,t.content,null),Ce(e).append(s)})),Ce(this.statusElement),this.hasError?(this.element.classList.add("error"),this.list.classList.add("error"),this.statusElement.classList.add("error"),this.statusElement.appendChild(mn(Xe.ERROR,this.errors))):(this.element.classList.remove("error"),this.list.classList.remove("error"),this.statusElement.classList.remove("error"))},createElement(){return this.source.createElement()},getItem(e){return this.items.get(e)},addItem(e){const t=pn.call(this,e);e.index?this.list.children[e.index-1].after(t):this.list.appendChild(t),this.refresh()},removeItem(e){let t=this.getItem(e.id);if(!L(t))throw new Error("List error: Item not found");const i=+t.dataset.index;this.items.delete(e.id),Ce(t),t.remove();for(let e=i;e<this.list.children.length;e++){const t=this.list.children[e],{index:i}=t.dataset;t.dataset.index=+i-1}this.refresh()},append(e){if(!L(e))throw new TypeError("Bad argument: The 'element' argument must be an HTML Element");return this.element.appendChild(e),this},delete(e){if(e===this.element)return void this.source.remove();const{index:t}=e.dataset;var i=this.source.removeElementAt(+t);if(i.success){if(this.hasValue()){let e=+t<this.list.childElementCount?+t:this.list.childElementCount-1;this.list.children[e].focus()}}else this.environment.notify(`This element cannot be deleted: ${i.message}`),De(e)},_spaceHandler(e){dn.call(this),Ce(this.messageElement),this.messageElement.appendChild(mn(Xe.INFO,"Enter any text.")),He(this.messageElement)},spaceHandler(e){return!(!yn.call(this,e)||e.parentElement!==this.list||(this.createElement(),0))},deleteHandler(e){return!(!yn.call(this,e)||e.parentElement!==this.list||(this.selection=e,this.delete(e),0))},escapeHandler(e){return!!this.messageElement&&($e(this.messageElement),!0)},enterHandler(e){const t=(e=>yn.call(this,e)?e:Ee(e,(e=>yn.call(this,e)),5))(e);if(y(t))return!1;const{action:i,index:n,component:s}=t.dataset;if("list-item"===s){let e=t.firstElementChild;for(;e&&e.dataset.id===this.id;)e=e.nextElementSibling;let i=this.environment.resolveElement(e);return i&&i.focus(),!0}return"add"===i?(this.selection=t,this.createElement(),!0):"remove"===i&&(this.selection=t.parentElement,this.delete(t.parentElement),!0)},backspaceHandler:e=>!1,clickHandler(e){const t=(e=>yn.call(this,e)?e:Ee(e,(e=>yn.call(this,e)),5))(e);if(y(t))return;const{action:i,index:n,name:s}=t.dataset;"add"===i?(this.selection=t,this.createElement()):"remove"===i&&(this.selection=t.parentElement,this.delete(t.parentElement))},arrowHandler(e,t){if(!L(t))return!1;if(t.parentElement===this.list){let i=null;return"up"===e?i=st(t,this.list):"down"===e?i=ot(t,this.list):"left"===e?i=at(t,this.list):"right"===e&&(i=rt(t,this.list)),L(i)?(i.focus(),this.selection=i,!0):this.arrowHandler(e,t.parentElement)}if(t.parentElement===this.element){let i=null;if("up"===e?i=st(t,this.element):"down"===e?i=ot(t,this.element):"left"===e?i=at(t,this.element):"right"===e&&(i=rt(t,this.element)),L(i)){if(i===this.list){if(!this.list.hasChildNodes())return this.arrowHandler(e,this.list);i.children[0].focus()}else i.focus();return!0}}return!!this.parent&&this.parent.arrowHandler(e,this.element)},bindEvents(){}},bn=Object.assign(Object.create(Yi),fn);Object.defineProperty(bn,"size",{get(){return this.items.size}});var gn=0;const vn={content:{type:"static",static:{type:"text",content:"Add"}}},wn={content:{type:"static",static:{type:"text",content:"Remove"}}},En={table:null,header:null,body:null,footer:null,elements:null,contentElements:null,content:null,init(){const{content:e=[],template:t,focusable:i=!0}=this.schema;return this.elements=new Map,this.focusable=i,this.content=e,this.contentElements=new Map,this.template=this.model.getModelProjection(this.source.accept,t.tag)[0].projection,this},render(){const{content:e,action:t={}}=this.schema,{disposition:i}=this.template,n=H();if(!Array.isArray(e))throw new Error("Empty content for listfield");if(L(this.element)||(this.element=F({class:["field","field--table"],id:this.id,tabindex:-1,dataset:{nature:"field",view:"table",id:this.id}}),this.readonly&&this.element.classList.add("readonly"),Pi(this.element,this.schema.style)),L(this.notification)||(this.notification=F({class:["field-notification"],dataset:{nature:"field-component",view:"table",id:this.id}}),n.appendChild(this.notification)),L(this.statusElement)||(this.statusElement=ee({class:["field-status"],dataset:{nature:"field-component",view:"table",id:this.id}}),this.notification.appendChild(this.statusElement)),e.forEach((e=>{if("table"===e.type){let t=a(e.table,{});const{style:i,header:s,body:r={},footer:o}=t;if(this.table=le({class:["field--table__table"],tabindex:0,dataset:{nature:"field-component",view:"table",id:this.id}}),s){const{style:e}=s;this.header=he({class:["field--table-header"],dataset:{nature:"field-component",view:"table",id:this.id}}),Pi(this.header,e),this.table.append(this.header)}if(r){const{style:e}=r;this.body=ue({class:["field--table-body"],dataset:{nature:"field-component",view:"table",id:this.id}}),Pi(this.body,e),this.table.append(this.body)}if(o){const{style:e}=o;this.footer=de({class:["field--table-footer"],dataset:{nature:"field-component",view:"table",id:this.id}}),Pi(this.footer,e),this.table.append(this.footer)}t.currentState=null,this.contentElements.set(t,this.table),Pi(this.table,i),n.appendChild(this.table)}else if("action"===e.type){let t=a(e,vn);const{content:i,style:s}=t;let r=ts.call(this,i,null),o=oe({class:["field-action","field--table__add"],tabindex:0,dataset:{nature:"field-component",view:"table",component:"action",id:this.id,action:"add"}},[r]);t.currentState=null,this.contentElements.set(t,o),Pi(o,s),n.appendChild(o)}else{let t=ts.call(this,e);this.contentElements.set(e,t),n.appendChild(t)}})),this.header){let e=pe({class:["field--table-header-row"],tabindex:-1,dataset:{nature:"field-component",view:"table",id:this.id}});i.forEach((t=>{const{header:i}=t,{style:n,content:s}=i;var a=ts.call(this,s),r=me({class:["field--table-header-cell"],dataset:{nature:"field-component",view:"table",id:this.id}},a);Pi(r,n),e.appendChild(r)}));let t=ye({class:["field--table-header-cell","field--table-header-cell--action"]},"Action");e.appendChild(t),this.header.appendChild(e)}return this.source.hasValue()&&this.source.getValue().forEach((e=>{this.addRow(e)})),n.hasChildNodes()&&(this.element.appendChild(n),this.bindEvents()),this.refresh(),this.element},hasChanges:()=>!1,hasValue(){return this.body.rows.length>0},getValue(){return this.body.rows},focusIn(){return this.focused=!0,this.element.classList.add("active"),this},focusOut(){if(!this.readonly)return this.messageElement&&($e(this.messageElement),Ce(this.messageElement)),this.element.classList.remove("active"),this.refresh(),this.focused=!1,this},refresh(){var e,t,i;this.hasValue()?(this.element.classList.remove("empty"),this.table.classList.remove("empty")):(this.element.classList.add("empty"),this.table.classList.add("empty")),this.hasChanges()?this.statusElement.classList.add("change"):this.statusElement.classList.remove("change"),this.contentElements.forEach(((e,t)=>{if(!Array.isArray(t.state))return;const{currentState:i}=t,n=Wi.call(this,t,t.state);if(i===t.currentState)return;let s=null;s=n?ts.call(this,n.content,null):ts.call(this,t.content,null),Ce(e).append(s)})),Ce(this.statusElement),this.hasError?(this.element.classList.add("error"),this.statusElement.classList.add("error"),this.statusElement.appendChild((e=Xe.ERROR,t=this.errors,i=Y({class:["notification-message",`notification-message--${e}`]},t),Array.isArray(t)?i.style.minWidth=`${Math.min(.5*t[0].length,30)}em`:i.style.minWidth=`${Math.min(.5*t.length,30)}em`,i))):(this.element.classList.remove("error"),this.statusElement.classList.remove("error"))},createElement(){return this.source.createElement()},addRow(e){const{action:t={},before:i={},after:n={}}=this.schema,{disposition:s}=this.template,r=a(e.index,this.table.rows.length),o="row"+gn++,l=pe({class:["field--table-row"],tabindex:-1,dataset:{nature:"field-component",view:"table",id:this.id,index:r,elementId:o}});this.elements.set(o,l),s.forEach((t=>{const{body:i}=t,{style:n,content:s}=i;var a=ts.call(this,s,e),r=ye({class:["field--table-cell"],dataset:{nature:"field-component",view:"table",id:this.id}},a);Pi(r,n),l.appendChild(r)}));var c=ye({class:["field--table__cell-action"]}),{content:h,style:u}=a(t.remove,wn),d=ts.call(this,h),p=oe({class:["btn","field--table__button"],dataset:{nature:"field-component",view:"list",component:"action",id:this.id,action:"remove",rowId:o}},d),m=oe({class:["btn","field--table__button"],dataset:{nature:"field-component",id:this.id,action:"move-up",rowId:o}},"Move up"),y=oe({class:["btn","field--table__button"],dataset:{nature:"field-component",id:this.id,action:"move-down",rowId:o}},"Move down");Pi(p,u),c.append(p,m,y),l.appendChild(c),this.body.appendChild(l),this.refresh()},removeRow(e){var t=this.body.rows.item(e.index);if(!L(t))throw new Error("Table error: Row not found");Ce(t),t.remove();for(let t=e.index;t<this.body.rows.length;t++){const e=this.body.rows.item(t),{index:i}=e.dataset;e.dataset.index=+i-1}this.refresh()},removeElement(e){return this.source.removeElement(e)},delete(e){if(e===this.element||e===this.table)return void this.source.delete();const{index:t}=e.dataset;this.source.removeElementAt(+t)||(this.environment.notify("This element cannot be deleted"),De(e))},bindEvents(){this.element.addEventListener("click",(e=>{const{target:t}=e,i=function(e){const t="field-component";return e.dataset.nature===t?e:Ee(e,(e=>e.dataset.nature===t))}(t);if(!L(i))return;const{id:n,action:s}=i.dataset;if(n===this.id)if("add"===s)this.createElement();else if("remove"===s){const{rowId:e}=i.dataset;let t=this.elements.get(e);this.delete(t)}else if("move-up"===s){const{rowId:e}=i.dataset;let t=this.elements.get(e),n=t.previousElementSibling;n&&n.before(t)}else if("move-down"===s){const{rowId:e}=i.dataset;let t=this.elements.get(e),n=t.nextElementSibling;n&&n.after(t)}}),!0),this.projection.registerHandler("value.added",(e=>{this.addRow(e)})),this.projection.registerHandler("value.removed",(e=>{this.removeRow(e)})),this.projection.registerHandler("value.changed",(e=>{Ce(this.body),this.source.getValue().forEach((e=>{this.addRow(e)}))}))}},xn=Object.assign(Object.create(Yi),En),_n=e=>L(e,["input","textarea"]);function Cn(){return L(this.messageElement)||(this.messageElement=ee({class:["field-message","hidden"],dataset:{nature:"field-component",view:"text",id:this.id}}),this.notification.appendChild(this.messageElement)),this.messageElement}function jn(){return L(this.choice)||(this.choice=U({class:["bare-list","field--textbox__choices"],dataset:{nature:"field-component",view:"text",component:"choice",id:this.id}}),this.append(this.choice)),this.choice}function Ln(e){return J({class:["field--textbox__choice"],tabindex:0,dataset:{nature:"field-component",view:"text",component:"choice-item",value:e,id:this.id}},e)}function Tn(e,t){var i=Y({class:["notification-message",`notification-message--${e}`]},t);return Array.isArray(t)?i.style.minWidth=`${Math.min(.5*t[0].length,30)}em`:i.style.minWidth=`${Math.min(.5*t.length,30)}em`,i}function kn(e){return e.parentElement===this.choice?e:Ee(e,(e=>e.parentElement===this.choice),3)}const An={input:null,choice:null,value:"",placeholder:null,multiline:!1,resizable:!1,content:null,init(){const{multiline:e=!1,content:t=[],resizable:i=!1,focusable:n=!0}=this.schema;return this.multiline=e,this.focusable=n,this.resizable=i,this.content=t,b(this.schema,"choice")||(this.schema.choice={}),this},focus(e){return this.input.focus(),this},focusIn(){return this.focused=!0,this.value=this.getValue(),this.element.classList.add("active"),this.element.classList.add("focus"),this},focusOut(){return this.hasChanges()&&this.setValue(this.getValue(),!0),p(this.getValue())&&(this.input.textContent=""),this.messageElement&&($e(this.messageElement),Ce(this.messageElement)),this.choice&&$e(this.choice),this.input.blur(),this.element.classList.remove("active"),this.element.classList.remove("focus"),this.refresh(),this.focused=!1,this},hasChanges(){return this.value!==this.getValue()},hasValue(){return!r(this.getValue())},getValue(){return _n(this.input)?this.input.value:this.input.textContent},setValue(e,t=!1){var i;i=t?this.source.setValue(e):{success:!0},this.errors=[],i.success||(this.environment.notify(i.message,"error"),this.errors.push(...i.errors)),_n(this.input)?this.input.value=e:this.input.textContent=e,this.value=e,this.refresh()},getCandidates(){return this.source.getCandidates()},enable(){return this.input.disabled=!1,this.input.tabIndex=0,this.disabled=!1,this.element.classList.add("disabled"),this},disable(){return this.input.disabled=!0,this.input.tabIndex=-1,this.disabled=!0,this.element.classList.remove("disabled"),this},refresh(){Wi.call(this,this.schema,this.schema.state),this.hasValue()?this.element.classList.remove("empty"):this.element.classList.add("empty"),this.element.dataset.value=this.value,this.hasChanges()?this.statusElement.classList.add("change"):this.statusElement.classList.remove("change"),Ce(this.statusElement),this.hasError?(this.element.classList.add("error"),this.input.classList.add("error"),this.statusElement.classList.add("error"),this.statusElement.appendChild(Tn(Xe.ERROR,this.errors))):(this.element.classList.remove("error"),this.input.classList.remove("error"),this.statusElement.classList.remove("error")),this.choice&&this.filterChoice(this.getValue())},render(){const e=H(),{content:t,style:i}=this.schema;if(!Array.isArray(t))throw new Error("Empty content for textfield");return L(this.element)||(this.element=F({id:this.id,class:["field","field--textbox"],dataset:{nature:"field",view:"text",id:this.id,disabled:this.disabled,readonly:this.readonly,value:""}}),this.readonly&&this.element.classList.add("readonly"),this.disabled&&this.element.classList.add("disabled"),Pi(this.element,this.schema.style)),L(this.notification)||(this.notification=F({class:["field-notification"],dataset:{nature:"field-component",view:"text",id:this.id}}),e.appendChild(this.notification)),L(this.statusElement)||(this.statusElement=ee({class:["field-status"],dataset:{nature:"field-component",view:"text",id:this.id}}),this.notification.appendChild(this.statusElement)),t.forEach((t=>{if("input"===t.type){this.input=ts.call(this,t),this.input.classList.add("field--textbox__input"),this.multiline&&this.input.classList.add("field--textbox__input--multiline");let i="";this.source.hasValue()&&(i=this.source.getValue()),this.input.textContent=i,this.value=i,e.appendChild(this.input)}else{let i=ts.call(this,t);e.appendChild(i)}})),Pi(this.element,i),e.hasChildNodes()&&(this.element.appendChild(e),this.bindEvents()),this.source.hasValue()&&this.setValue(this.source.getValue()),this.refresh(),this.element},filterChoice(e){const{children:t}=this.choice;if(p(e)){for(let e=0;e<t.length;e++){const i=t[e];He(i),i.hidden=!1}return!0}let i=e.trim().toLowerCase().replace(/\s+/g," ").split(" ");for(let e=0;e<t.length;e++){const n=t[e],{value:s}=n.dataset;i.some((e=>s.toLowerCase().includes(e)))?(He(n),n.hidden=!1):($e(n),n.hidden=!0)}return!0},selectChoice(e){if(!L(e))return;const t=function(e){return e.dataset.value}(e);return this.setValue(t,!0),this.input.focus(),$e(this.choice),this},append(e){if(!L(e))throw new TypeError("Bad argument: The 'element' argument must be an HTML Element");return this.element.appendChild(e),this},_spaceHandler(e){const t=this.getCandidates();if(!Array.isArray(t))throw new TypeError("Bad values");if(Cn.call(this),Ce(this.messageElement),r(t))this.messageElement.appendChild(Tn(Xe.INFO,"Enter any text.")),He(this.messageElement);else{jn.call(this);const e=H();t.forEach((t=>e.appendChild(Ln.call(this,t)))),Ce(this.choice).appendChild(e),this.filterChoice(this.getValue()),He(this.choice),this.messageElement.appendChild(Tn(Xe.INFO,"Select an element from the list.")),He(this.messageElement)}},escapeHandler(e){let t=!0;if(this.messageElement&&!Qe(this.messageElement)&&($e(this.messageElement),t=!1),this.choice&&!Qe(this.choice)&&($e(this.choice),t=!1),t){let t=Ee(e,(e=>0===e.tabIndex));return this.environment.resolveElement(t).focus(t),!0}this.input.focus()},enterHandler(e){const t=kn.call(this,e);if(t)this.selectChoice(t);else if(this.multiline);else if(e===this.input)return this.setValue(this.getValue(),!0),!0},backspaceHandler(e){kn.call(this,e)&&this.input.focus()},clickHandler(e){const t=kn.call(this,e);L(t)&&this.selectChoice(t)},arrowHandler(e,t){const i=kn.call(this,t);if(L(i)){let t=null;return"up"===e?t=ve(i,(e=>!e.hidden)):"down"===e&&(t=we(i,(e=>!e.hidden))),L(t)&&t.focus(),!0}let n=null;return"up"===e&&this.parent?n=st(t,this.element):"down"===e&&this.parent?n=ot(t,this.element):"right"===e?t===this.input?this.getValue().length<Re(this.input)+1&&this.parent&&(n=rt(t,this.element)):n=rt(t,this.element):"left"===e&&(t===this.input?0===Re(this.input)&&(n=at(t,this.element)):n=at(t,this.element)),L(n)?(n.focus(),!0):!!this.parent&&this.parent.arrowHandler(e,this.element)},controlHandler(e){this.toolbar&&this.toolbar.remove()},bindEvents(){this.element.addEventListener("input",(e=>{this.refresh()}))}},On=Object.assign(Object.create(Yi),An),Mn={binary:(e,t,i)=>Object.create(Zi,{object:{value:"field"},name:{value:"binary-field"},type:{value:"binary"},id:{value:Sn()},model:{value:e},schema:{value:t},projection:{value:i},source:{value:i.concept}}),choice:(e,t,i)=>Object.create(an,{object:{value:"field"},name:{value:"choice-field"},type:{value:"choice"},id:{value:Sn()},model:{value:e},schema:{value:t},projection:{value:i},source:{value:i.concept}}),graph:(e,t,i)=>Object.create(cn,{object:{value:"field"},name:{value:"graph-field"},type:{value:"graph"},id:{value:Sn()},model:{value:e},schema:{value:t},projection:{value:i},source:{value:i.concept}}),list:(e,t,i)=>Object.create(bn,{object:{value:"field"},name:{value:"list-field"},type:{value:"list"},id:{value:Sn()},model:{value:e},schema:{value:t},projection:{value:i},source:{value:i.concept}}),table:(e,t,i)=>Object.create(xn,{object:{value:"field"},name:{value:"table-field"},type:{value:"table"},id:{value:Sn()},model:{value:e},schema:{value:t},projection:{value:i},source:{value:i.concept}}),text:(e,t,i)=>Object.create(On,{object:{value:"field"},name:{value:"text-field"},type:{value:"text"},id:{value:Sn()},model:{value:e},schema:{value:t},projection:{value:i},source:{value:i.concept}})};var Vn=0;const Sn=()=>"field"+Vn++,Nn={createField(e,t,i){const{type:n}=t,s=Mn[n];if(y(s))throw new Error(`Missing handler: The '${n}' field could not be handled`);var r=s(e,t,i);if(y(r))throw new Error(`Bad request: The '${n}' field could not be created`);return r.errors=[],r.readonly=a(t.readonly,!1),y(r.id)&&(r.id=Sn()),r}},Rn={init(){throw new Error("This function has not been implemented")},element:null,statusElement:null,attached:null,readonly:!1,visible:!1,disabled:!1,active:!1,focused:!1,get hasAttached(){return!r(this.attached)},attach(e,t){this.attached.push(e)},detach(e){this.attached.slice(this.attached.indexOf(e),1)},getAttached(e){return l(e)?this.attached.filter((t=>e(t))):this.attached},show(){return He(this.element),this.visible=!0,this.active=!0,this},hide(){return $e(this.element),this.visible=!1,this},toggle(){return qe(this.container),this.visible=!this.visible,this},focus(){return this.element.focus(),this.focused=!0,this.active=!0,this},_focusIn:e=>!1,clear:()=>!0,delete(){this.clear(),Ce(this.element),this.element.remove()},spaceHandler(e){return console.warn(`SPACE_HANDLER NOT IMPLEMENTED FOR ${this.name}`),!1},_spaceHandler(e){return console.warn(`CTRL_SPACE_HANDLER NOT IMPLEMENTED FOR ${this.name}`),!1},escapeHandler(e){return console.warn(`ESCAPE_HANDLER NOT IMPLEMENTED FOR ${this.name}`),!1},enterHandler(e){this.focusOut()},deleteHandler(e){console.warn(`DELETE_HANDLER NOT IMPLEMENTED FOR ${this.name}`),this.focusOut()},backspaceHandler:e=>(console.warn("BACKSPACE_HANDLER NOT IMPLEMENTED"),!1),arrowHandler:(e,t)=>(console.warn("ARROW_HANDLER NOT IMPLEMENTED"),!1),clickHandler:e=>(console.warn("CLICK_HANDLER NOT IMPLEMENTED"),!1)},In=Object.assign(Rn,Gt),Pn={init(){return this},render(){const e=H(),{help:t,style:i,content:n}=this.schema;return L(this.element)||(this.element=X({class:["audio"],src:n,dataset:{ignore:"all"}})),y(t)||(this.element.title=t),Pi(this.element,i),e.hasChildNodes()&&(this.element.appendChild(e),this.bindEvents()),this.refresh(),this.element},focusIn(){return this.focused=!0,this.element.classList.add("active"),this},focusOut(){return this.messageElement&&($e(this.messageElement),Ce(this.messageElement)),this.element.classList.remove("active"),this.refresh(),this.focused=!1,this},refresh(){return this},bindEvents(){}},Hn=Object.assign(Object.create(In),Pn);function $n(e){return e.startsWith("http://")||e.startsWith("https://")?new URL(e).href:$n(`https://${e}`)}const qn={url:null,alt:null,width:null,height:null,init(){const{url:e,width:t,height:i,alt:n}=this.schema;return this.url=$n(e),this.width=t,this.height=i,this.alt=n,this},render(){const{help:e,style:t}=this.schema;return L(this.element)||(this.element=K({class:["image"],src:this.url,alt:this.alt,dataset:{ignore:"all"}})),y(this.width)||isNaN(this.width)||(this.element.width=this.width),y(this.height)||isNaN(this.height)||(this.element.height=this.height),y(e)||(this.element.title=e),Pi(this.element,t),this.refresh(),this.element},focusIn(){return this.focused=!0,this.element.classList.add("active"),this},focusOut(){return this.messageElement&&($e(this.messageElement),Ce(this.messageElement)),this.element.classList.remove("active"),this.refresh(),this.focused=!1,this},refresh(){return this}},Dn=Object.assign(Object.create(In),qn),Bn={email:e=>`mailto:${e}`,phone:e=>`tel:${e}`,link:e=>`${e}`};function Fn(e){return e.startsWith("http://")||e.startsWith("https://")?new URL(e).href:Fn(`https://${e}`)}const zn={url:null,urlType:null,href:null,content:null,init(){const{url:e,content:t=[],urlType:i="link"}=this.schema;this.url=Fn(e),this.content=t,this.urlType=i;const n=Bn[this.urlType];if(!l(n))throw new TypeError("type not handled");return this.href=n(this.url),this},render(){if(p(this.url))throw new Error("There is no URL defined for this link");if(r(this.content))throw new Error("There is no content defined for this link");const e=H(),{help:t,style:i}=this.schema;return L(this.element)||(this.element=G({class:["link"],href:this.href,target:"_blank",dataset:{ignore:"all"}})),this.content.forEach((t=>{let i=ts.call(this,t);e.appendChild(i)})),y(t)||(this.element.title=t),Pi(this.element,i),e.hasChildNodes()&&this.element.appendChild(e),this.refresh(),this.element},focusIn(){return this.focused=!0,this.element.classList.add("active"),this},focusOut(){return this.messageElement&&($e(this.messageElement),Ce(this.messageElement)),this.element.classList.remove("active"),this.refresh(),this.focused=!1,this},refresh(){return this}},Wn=Object.assign(Object.create(In),zn);function Un(e){const{type:t,name:i}=e;return"property"===t?this.projection.concept.getProperty(i):"param"===t?this.projection.getParam(i):e}const Jn={contentType:null,editable:null,focusable:null,init(){const{contentType:e="text",editable:t=!1,focusable:i=a(this.parent.schema.focusable,!0)}=this.schema;return this.contentType=e,this.editable=t,this.focusable=i,this},render(){const e=H(),{help:t,style:i,content:n}=this.schema;if(!L(this.element)){this.element=Y({class:["text"],editable:this.editable,dataset:{nature:"static",view:"text",id:this.id,ignore:"all"}}),this.focusable&&(this.element.tabIndex=0);let e=Un.call(this,n);"html"===this.contentType?this.element.append(O(e)):this.element.textContent=e.trim()}return y(t)||(this.element.title=t),Pi(this.element,i),e.hasChildNodes()&&(this.element.appendChild(e),this.bindEvents()),this.refresh(),this.element},focusIn(){return this.focused=!0,this.element.classList.add("active"),this},focusOut(){return this.messageElement&&($e(this.messageElement),Ce(this.messageElement)),this.element.classList.remove("active"),this.refresh(),this.focused=!1,this},getLength(){return this.element.textContent.length},arrowHandler(e,t){if(!this.editable&&this.parent)return this.parent.arrowHandler(e,t);if("right"===e){if(this.getLength()<Re(this.element)+1&&this.parent)return this.parent.arrowHandler(e,t)}else if("left"===e){if(0===Re(this.element)&&this.parent)return this.parent.arrowHandler(e,t)}else if(this.parent)return this.parent.arrowHandler(e,t);return!1},escapeHandler(e){let t=Ee(e,(e=>0===e.tabIndex));this.environment.resolveElement(t).focus(t)},refresh(){return this},bindEvents(){}},Gn=Object.assign(Object.create(In),Jn),Kn={template:null,selector:null,content:null,init(){var e;return this.selector=this.schema.selector,this.template=(e=this.selector,"content"in document.createElement("template")?be(e,undefined):null),this},render(){const{style:e,content:t}=this.schema;var i;return C(this.element)||(this.element=(i=this.template)?document.importNode(i.content,a(undefined,!0)):i),this.refresh(),this.element},focusIn(){return this.focused=!0,this.element.classList.add("active"),this},focusOut(){return this.element.classList.remove("active"),this.refresh(),this.focused=!1,this},refresh(){return this}},Xn=Object.assign(Object.create(In),Kn);var Yn=0;const Qn=()=>"static"+Yn++,Zn={audio:(e,t,i)=>Object.create(Hn,{object:{value:"static"},name:{value:"audio-static"},type:{value:"audio"},id:{value:Qn()},model:{value:e},schema:{value:t},projection:{value:i}}),image:(e,t,i)=>Object.create(Dn,{object:{value:"static"},name:{value:"image-static"},type:{value:"image"},id:{value:Qn()},model:{value:e},schema:{value:t},projection:{value:i}}),link:(e,t,i)=>Object.create(Wn,{object:{value:"field"},name:{value:"image-static"},type:{value:"image"},id:{value:Qn()},model:{value:e},schema:{value:t},projection:{value:i}}),text:(e,t,i)=>Object.create(Gn,{object:{value:"static"},name:{value:"text-static"},type:{value:"text"},id:{value:Qn()},model:{value:e},schema:{value:t},projection:{value:i}}),html:(e,t,i)=>Object.create(Xn,{object:{value:"static"},name:{value:"html-static"},type:{value:"html"},id:{value:Qn()},model:{value:e},schema:{value:t},projection:{value:i}})},es={createStatic(e,t,i){const{type:n}=t,s=Zn[n];if(y(s))throw new Error(`Missing handler: The '${n}' static could not be handled`);var a=s(e,t,i);if(y(a))throw new Error(`Bad request: The '${n}' static could not be created`);return a.initObserver(),y(a.id)&&(a.id=Qn()),a}};function ts(e,t,i){const n=a(t,this.projection.concept);if("layout"===e.type){let t=ds.createLayout(this.model,e.layout,this.projection);return t.parent=this,t.init(i),this.model.registerLayout(t),t.render()}if("field"===e.type){let t=Nn.createField(this.model,e,this.projection);return t.model=this.model,t.parent=this,t.init(i),t.render()}if("static"===e.type){let t=es.createStatic(this.model,e.static,this.projection);return t.parent=this,t.init(i),this.model.registerStatic(t),t.render()}if("input"===e.type){const{placeholder:t,type:i,style:n}=a(e.input,{});let s=null;return s=this.readonly||this.resizable?Y({editable:!this.readonly,title:t,dataset:{placeholder:t,nature:"field-component",view:this.type,id:this.id}}):this.multiline?ie({placeholder:t,title:t,dataset:{nature:"field-component",view:this.type,id:this.id}}):te({type:a(i,"text"),placeholder:t,title:t,dataset:{nature:"field-component",view:this.type,id:this.id}}),this.disabled&&(s.disabled=!0),this.focusable?s.tabIndex=0:s.dataset.ignore="all",Pi(s,n),s}if("attribute"===e.type)return Ki.call(this,e,n);if("template"===e.type){let n=this.model.getModelTemplate(e.name);n.param&&this.projection.addParam(e.param);const s=H();return n.content.forEach((e=>{s.append(ts.call(this,e,t,i))})),s}if("projection"===e.type){const{tag:n,style:s}=e,a=this.projection.schema.findIndex((e=>e.tags.includes(n))),r=oe({class:["btn"]},ts.call(this,e.content,t,i));return r.addEventListener("click",(()=>{this.projection.changeView(a)})),Pi(r,s),r}if("property"===e.type){const{name:t}=e;return this.projection.concept.getProperty(t)}throw console.error(e),new TypeError("Bad argument: The type is not recognized")}const is={focusable:null,readonly:!1,visible:!1,active:!1,container:null,getStyle(){return this.schema.style},setStyle(e){return this.schema.style=e,Pi.call(this,this.container,e),this.refresh(),!0},getField(e){return this.projection.getField(e)},getStatic(e){return this.projection.getStatic(e)},getLayout(e){return this.environment.getLayout(e)},show(){return He(this.element),this.visible=!0,this.active=!0,this},hide(){return $e(this.element),this.visible=!1,this},toggle(){return qe(this.container),this.visible=!this.visible,this},spaceHandler(e){return console.warn(`SPACE_HANDLER NOT IMPLEMENTED FOR ${this.name}`),!1},_spaceHandler(e){return console.warn(`CTRL_SPACE_HANDLER NOT IMPLEMENTED FOR ${this.name}`),!1},escapeHandler(e){return console.warn(`ESCAPE_HANDLER NOT IMPLEMENTED FOR ${this.name}`),!1},enterHandler(e){this.focusOut()},deleteHandler(e){console.warn(`DELETE_HANDLER NOT IMPLEMENTED FOR ${this.name}`),this.focusOut()},backspaceHandler:e=>(console.warn("BACKSPACE_HANDLER NOT IMPLEMENTED"),!1),arrowHandler:(e,t)=>(console.warn("ARROW_HANDLER NOT IMPLEMENTED"),!1),clickHandler:e=>(console.warn("CLICK_HANDLER NOT IMPLEMENTED"),!1)},ns={orientation:null,elements:null,edit:!1,btnEdit:!1,menu:!1,init(e={}){const{orientation:t="horizontal",focusable:i=!1}=this.schema;return this.orientation=t,this.focusable=i,this.elements=[],Object.assign(this,e),this},getOrientation(){return this.orientation},setOrientation(e){["horizontal","vertical"].includes(e)&&(this.orientation=e)},render(){const{disposition:e,style:t,help:i}=this.schema;if(!Array.isArray(e))throw new SyntaxError("Bad disposition");const n=H();L(this.container)||(this.container=F({class:["layout-container"],title:i,dataset:{nature:"layout",layout:"stack",id:this.id}})),this.focusable?this.container.tabIndex=0:this.container.dataset.ignore="all";for(let t=0;t<e.length;t++){let i=ts.call(this,e[t]),s=this.environment.resolveElement(i);s&&(s.parent=this),this.elements.push(i),n.appendChild(i)}return Pi.call(this,this.container,t),n.hasChildNodes()&&(this.container.appendChild(n),this.bindEvents()),this.container.style.display="flex",this.refresh(),this.container},refresh(){return"vertical"===this.orientation&&(this.container.style.flexDirection="column"),"horizontal"===this.orientation&&(this.container.style.flexDirection="row"),this},focus(e){if(this.focusable)this.container.focus();else{let t=this.environment.resolveElement(a(e,this.container.children[0]));t&&t.focus()}},focusIn(){return this.focused=!0,this.container.classList.add("active"),this.container.classList.add("focus"),this},focusOut(){return this.container.classList.remove("active"),this.container.classList.remove("focus"),this.focused=!1,this},enterHandler(e){let t=this.environment.resolveElement(this.elements[0]);return t&&t.focus(),!1},escapeHandler(e){let t=Ee(e,(e=>0===e.tabIndex));this.environment.resolveElement(t).focus(t)},arrowHandler(e,t){if(t===this.container)return!!this.parent&&this.parent.arrowHandler(e,this.container);let i=null;if("up"===e?i=st(t,this.container):"down"===e?i=ot(t,this.container):"left"===e?i=at(t,this.container):"right"===e&&(i=rt(t,this.container)),L(i)){let e=this.environment.resolveElement(i);return e&&e.focus(),!0}return!!this.parent&&this.parent.arrowHandler(e,this.container)},bindEvents(){this.container.addEventListener("change",(e=>{const{target:t}=e,{prop:i}=t.dataset;"orientation"===i&&(this.setOrientation(t.value),this.refresh())}))}},ss=Object.assign({},is,ns),as={elements:null,init(e={}){const{focusable:t=!1}=this.schema;return this.focusable=t,this.elements=[],Object.assign(this,e),this},render(){const{disposition:e,style:t,help:i}=this.schema;if(!Array.isArray(e))throw new SyntaxError("Bad disposition");const n=H();L(this.container)||(this.container=F({class:["layout-container"],title:i,dataset:{nature:"layout",layout:"wrap",id:this.id}})),this.focusable?this.container.tabIndex=0:this.container.dataset.ignore="all";for(let t=0;t<e.length;t++){let i=ts.call(this,e[t]),s=this.environment.resolveElement(i);s&&(s.parent=this),this.elements.push(i),n.appendChild(i)}return Pi.call(this,this.container,t),n.hasChildNodes()&&(this.container.appendChild(n),this.bindEvents()),this.refresh(),this.container},refresh(){return this},focusIn(){return this.focused=!0,this.container.classList.add("active"),this.container.classList.add("focus"),this},focusOut(){return this.container.classList.remove("active"),this.container.classList.remove("focus"),this.focused=!1,this},focus(e){if(this.focusable)this.container.focus();else{let t=this.environment.resolveElement(a(e,this.container.children[0]));t&&t.focus()}},enterHandler(e){let t=this.environment.resolveElement(this.elements[0]);return t&&t.focus(),!1},escapeHandler(e){let t=Ee(e,(e=>0===e.tabIndex));this.environment.resolveElement(t).focus(t)},arrowHandler(e,t){if(t===this.container)return!!this.parent&&this.parent.arrowHandler(e,this.container);let i=null;if("up"===e?i=st(t,this.container):"down"===e?i=ot(t,this.container):"left"===e?i=at(t,this.container):"right"===e&&(i=rt(t,this.container)),L(i)){let e=this.environment.resolveElement(i);return e&&e.focus(),!0}return!!this.parent&&this.parent.arrowHandler(e,this.container)},bindEvents(){}},rs=Object.assign({},is,as),os={init(e={}){const{orientation:t="row",focusable:i=!1}=this.schema;return this.orientation=t,this.focusable=i,this.elements=[],Object.assign(this,e),this},refresh(){return this},render(){const{disposition:e,style:t,help:i}=this.schema;if(!Array.isArray(e))throw new SyntaxError("Bad disposition");const n=H();L(this.container)||(this.container=F({class:["layout-container"],dataset:{nature:"layout",layout:"table"}})),this.focusable?this.container.tabIndex=-1:this.container.dataset.ignore="all";for(let t=0;t<e.length;t++){let i=e[t],s=F({class:["table-row"]});s.style.display="table-row";for(let e=0;e<i.length;e++){const t=i[e];let n=F({class:["table-cell"]},ts.call(this,t.content));n.style.display="table-cell",s.append(n)}n.appendChild(s)}return Pi.call(this,this.container,t),n.hasChildNodes()&&(this.container.appendChild(n),this.bindEvents()),this.container.style.display="table",this.refresh(),this.container},bindEvents(){}},ls=Object.assign({},is,os);var cs=0;const hs=()=>"layout"+cs++,us={stack:(e,t,i)=>Object.create(ss,{object:{value:"layout"},name:{value:"stack-layout"},type:{value:"stack"},id:{value:hs()},model:{value:e},schema:{value:t},projection:{value:i},source:{value:i.concept}}),wrap:(e,t,i)=>Object.create(rs,{object:{value:"layout"},name:{value:"wrap-layout"},type:{value:"wrap"},id:{value:hs()},model:{value:e},schema:{value:t},projection:{value:i},source:{value:i.concept}}),table:(e,t,i)=>Object.create(ls,{object:{value:"layout"},name:{value:"table-layout"},type:{value:"table"},id:{value:hs()},model:{value:e},schema:{value:t},projection:{value:i},source:{value:i.concept}})},ds={createLayout(e,t,i){const{type:n}=t,s=us[n];if(y(s))throw new TypeError(`Missing handler: The '${n}' layout could not be handled`);const a=s(e,t,i);if(y(a))throw new Error(`Bad request: The '${n}' layout could not be created`);return a.createLayout=this.createLayout,y(a.id)&&(a.id=hs()),a}};var ps=0;const ms={createProjection(e,t,i,n){var s=Object.create(ys,{id:{value:a(t.id,"projection"+ps++)},model:{value:e},schema:{value:t,writable:!0},environment:{value:n}});return s.concept=i,s}},ys={handlers:null,init(e){return this.containers=[],this.attributes=[],this.params=[],this.handlers={},this.args=a(e,{}),this.concept.register(this),this},schema:null,concept:null,environment:null,parent:null,containers:null,element:null,attributes:null,params:null,index:0,editing:!1,get hasMultipleViews(){return this.schema.length>1},get isReadOnly(){return a(this.getSchema().readonly,!1)},isRoot(){return y(this.parent)},getSchema(e){return this.schema[a(e,this.index)]},getContainer(e){return this.containers[a(e,this.index)]},getStyle(){const{style:e}=this.getSchema();return e},addParam(e){this.params.push(...Array.isArray(e)?e:[e])},getParam(e){let t=this.params.find((t=>t.name===e));if(y(t))return;const{type:i="string",value:n}=t;return"string"===i?n.toString():"number"===i?+n:"boolean"===i?E(n):void 0},getAttributes(e){return this.attributes.filter((t=>t.name===e))},getField(e){return this.environment.getField(e)},getStatic(e){return this.environment.getStatic(e)},getLayout(e){return this.environment.getLayout(e)},getHandlers(e){return a(this.handlers[e],[])},update(e,t){if(r(this.containers))return;if("delete"===e)return this.concept.unregister(this),this.concept=null,this.containers.forEach((e=>{Ce(e),e.remove()})),void this.model.removeProjection(this.id);const i=this.getHandlers(e);if(r(i))switch(e){case"value.changed":return void this.element.setValue(t);case"value.added":return void this.element.addItem(t);case"value.removed":return void this.element.removeItem(t);case"attribute.added":return void this.getAttributes(t.name).forEach((e=>{const{schema:i}=e,n=this.model.createProjection(t.target,i.tag).init();n.parent=this,n.optional=!0;const s=n.render();Pi(s,i.style),e.element=s,e.placeholder&&(e.placeholder.after(s),$e(e.placeholder))}));case"attribute.removed":return void this.getAttributes(t.name).forEach((e=>{e.element=null,e.placeholder&&He(e.placeholder)}));default:console.warn(`The message '${e}' is not handled by the element`)}else i.forEach((e=>{e(t)}))},registerHandler(e,t){return Array.isArray(this.handlers[e])||(this.handlers[e]=[]),this.handlers[e].push(t),!0},unregisterHandler(e,t){if(!b(this.handlers,e))return!1;for(let i=0;i<this.handlers[e].length;i++)if(this.handlers[e][i]===t)return this.handlers[e].splice(i,1),!0;return!1},focus(){this.element.focus()},render(){const e=this.getSchema(),{type:t,projection:i,content:n}=e;var s=null;if("layout"===t?(this.element=ds.createLayout(this.model,a(i,n),this).init(this.args),this.model.registerLayout(this.element)):"field"===t&&(this.element=Nn.createField(this.model,a(i,n),this).init(this.args),this.model.registerField(this.element)),this.isRoot()&&(this.element.focusable=!0),s=this.element.render(),!C(s))throw new Error("Projection element container could not be created");if(Object.assign(s.dataset,{projection:this.id,object:this.concept.object,alt:this.schema.length}),this.optional){let e=oe({class:["btn","structure__btn-delete"],title:"Delete"});e.addEventListener("click",(e=>{this.concept.delete()})),s.classList.add("has-toolbar"),s.prepend(e)}if(this.hasMultipleViews){let e=ee({class:["badge","badge--alt"],title:"This projection has multiple views"});s.prepend(e)}return this.addContainer(s),s},addContainer(e){if(!L(e))throw new TypeError("Bad request: Missing container");this.containers.push(e)},refresh(){this.editing?this.containers.forEach((e=>{e.tabIndex=0})):this.containers.forEach((e=>{e.tabIndex=null}))},changeView(e){if(this.hasMultipleViews){var t=this.getContainer();this.index=a(e,(this.index+1)%this.schema.length);var i=this.getContainer();return L(i)||(i=this.render()),t.replaceWith(i),i.focus(),this}this.environment.notify("There is no alternative projection for this concept")},export(){return{id:this.id,root:this.isRoot(),concept:{id:this.concept.id,name:this.concept.name}}},bindEvents(){this.schema.length>1&&(L(this.btnPrev)||(this.btnPrev=oe({type:"button",class:["btn","btn-projection","btn-projection--previous","hidden"],disabled:this.index<=0,dataset:{context:"projection",action:"previous"}},"Previous Projection")),L(this.btnNext)||(this.btnNext=oe({type:"button",class:["btn","btn-projection","btn-projection--next","hidden"],disabled:this.index>=this.schema.length-1,dataset:{context:"projection",action:"next"}},"Next Projection")),this.container.addEventListener("click",(e=>{var t=e.target,i=this.container;$e(i),t===this.btnPrev?(this.index-=1,function(e,t){if(!x([e,t],j))throw new TypeError("Bad argument: The given `element` or `target` is not a valid Element");e.insertAdjacentElement("beforebegin",t)}(i,this.render())):t===this.btnNext&&(this.index+=1,function(e,t){if(!x([e,t],j))throw new TypeError("Bad argument: The given `element` or `target` is not a valid Element");e.insertAdjacentElement("afterend",t)}(i,this.render())),He(this.container),this.btnPrev.disabled=this.index<=0,this.btnNext.disabled=this.index>=this.schema.length-1})),this.container.append(this.btnNext,this.btnPrev))}},fs=[],bs={projections:null,fields:null,statics:null,layouts:null,init(e){return this.projections=[],this.fields=new Map,this.statics=new Map,this.layouts=new Map,this},done(){return this.projections.forEach((e=>{})),this.projections=[],this.fields.clear(),this.layouts.clear(),this.statics.clear(),this},createProjection(e,t){const i=this.getModelProjection(e,t);r(i)&&console.warn(e,i,t);const n=ms.createProjection(this,i,e,this.environment);return n.tag=t,this.addProjection(n),n},getProjections(){return this.projections.slice()},getProjection(e){return Number.isInteger(e)?this.projections[e]:this.projections.find((t=>t.id===e))},addProjection(e){if(y(e))throw new TypeError("Bad request: The 'projection' argument must be a Projection");return this.projections.push(e),this},removeProjection(e){var t=this.projections.findIndex((t=>t.id===e));return-1!==t&&(this.projections.splice(t,1),!0)},registerField(e){return e.environment=this.environment,this.fields.set(e.id,e),this},unregisterField(e){var t=this.fields.get(e.id);return t&&(t.environment=null,this.fields.delete(t.id)),this},getField(e){return this.fields.get(e)},registerStatic(e){return e.environment=this.environment,this.statics.set(e.id,e),this},unregisterStatic(e){var t=this.statics.get(e.id);return t&&(t.environment=null,this.statics.delete(t.id)),this},getStatic(e){return this.statics.get(e)},registerLayout(e){return e.environment=this.environment,this.layouts.set(e.id,e),this},unregisterLayout(e){var t=this.layouts.get(e.id);return t&&(t.environment=null,this.layouts.delete(t.id)),this},getLayout(e){return this.layouts.get(e)},getMetadata(e){let t=this.schema.find((t=>t.id===e));return t?t.metadata:null},hasProjection(e){return-1!==this.schema.findIndex((t=>t.name===e))},hasConceptProjection(e,t){const i=t=>t.concept.name===e.name;return y(t)?-1!==this.schema.findIndex((e=>i(e))):-1!==this.schema.findIndex((e=>i(e)&&(e=>Array.isArray(e.tags)&&e.tags.includes(t))(e)))},getModelProjection(e,t){if(y(e))throw new TypeError("Bad parameter: concept");var i=null;return i=o(e)?this.schema.filter((t=>"template"!==t.type&&t.concept.name===e)):this.schema.filter((t=>{return"template"!==t.type&&((t=>t&&(t===e.name||e.schema&&t===e.schema.base))(t.concept.name)||!y(i=t.concept.prototype)&&"prototype"!==e.nature&&e.hasPrototype(i));var i})),h(t)&&!r(t)?i.filter((e=>e.tags&&e.tags.includes(t))):i},getModelTemplate(e,t){return this.schema.find((t=>"template"===t.type&&t.name===e))},getModelProjectionTemplate(e,t,i){var n=this.getModelProjection(e,i);return Array.isArray(n)?(n=n.filter((e=>"template"===e.type&&e.template===t)))[0]:[]},getModelProjectionLayout(e,t,i){var n=this.getModelProjection(e,i);return Array.isArray(n)?n=n.filter((e=>"layout"===e.type)).find((e=>e.name===t)):[]},getModelProjectionField(e,t,i){return this.schema.filter((t=>t.concept===e)).filter((e=>"field"===e.type)).find((e=>e.name===t))},export(){const e=[];return this.getProjections().forEach((t=>{e.push(t.export())})),e}},gs={projection:null,container:null,content:null,views:null,schema:null,isOpen:!1,visible:!0,get isRendered(){return L(this.container)},init(e){return e&&(this.schema=e),this},update(e){e&&(this.schema=e),this.schema=e},show(){return He(this.container),this.visible=!0,this},hide(){return $e(this.container),this.visible=!1,this},toggle(){return qe(this.container),this.visible=!this.visible,this},open(){return 0===this.actionList.childElementCount?(this.notify("The menu is empty",1500),this):(this.container.classList.add("open"),this.show(),this.isOpen=!0,this)},close(){return this.container.classList.remove("open"),this.isOpen=!1,this},clear(){return Ce(this.content),this},refresh(){const{activeProjection:e}=this.editor;return y(e)?(this.content.textContent="N/A",void Ce(this.views)):(Ce(this.views),e.schema.forEach((e=>{this.views.append(J({class:["projection-window-view"]},"VIEW"))})),this.content.textContent=e.id,this)},render(){const e=H();L(this.container)||(this.container=F({class:["projection-window","hidden"],draggable:!0,title:"Click to handle projection"}));const t=Y({class:["projection-window-title"],dataset:{ignore:"all"}},"Projection");return e.append(t),L(this.content)||(this.content=F({class:["projection-window-content"]}),e.append(this.content)),L(this.views)||(this.views=U({class:["bare-list","projection-window-views"]}),e.append(this.views)),e.append(this.btnChange),e.hasChildNodes()&&(this.container.append(e),this.bindEvents()),this.refresh(),this.container},bindEvents(){this.container.addEventListener("click",(e=>{var t=Ye(e.target);const{action:i}=t.dataset;"change"===i?this.projection.changeView():"search"===i||"style"===i&&this.openStyle()}))}},vs={container:null,designMenu:null,modelMenu:null,schema:null,isOpen:!1,visible:!0,btnStart:null,modelFileIO:null,projectionFileIO:null,init(e){return e&&(this.schema=e),this},get isRendered(){return L(this.container)},show(){return He(this.container),this.visible=!0,this},hide(){return $e(this.container),this.visible=!1,this},toggle(){return qe(this.container),this.visible=!this.visible,this},open(){return this.container.classList.add("open"),this.show(),this.isOpen=!0,this},close(){return this.container.classList.remove("open"),this.hide(),this.isOpen=!1,this},clear(){return Ce(this.container),this},update(){},render(){const e=H();return L(this.container)||(this.container=F({class:["editor-home"]})),L(this.designMenu)||(this.designMenu=ws.call(this),e.append(this.designMenu)),L(this.modelMenu)||(this.modelMenu=xs.call(this),e.append(this.modelMenu)),e.hasChildNodes()&&(this.container.append(e),this.bindEvents()),this.refresh(),this.container},refresh(){const{hasConceptModel:e,hasProjectionModel:t}=this.editor;return e&&t||this.show(),this.modelFileIO.setFile(e?"file":null),this.projectionFileIO.setFile(t?"file":null),this.btnStart.disabled=!(e&&t),this},bindEvents(){}};function ws(){const e=q({class:["editor-home-section","editor-home-section--design"]});let t=D({class:["title","editor-home-section__title","font-ui"]},"Design "),i=F({class:["editor-home-section__content","editor-home-section--design__content"]}),n=Es("metamodel"),s=Es("projection");return i.append(n,s),e.append(t,i),e}function Es(e){return oe({class:["btn","editor-home-section__button","editor-home-section__button--new"],dataset:{action:`create-${e}`}},`Create a ${e}`)}function xs(){const e=q({class:["editor-home-section","editor-home-section--model"]});let t=D({class:["title","editor-home-section__title","font-ui"]},"Modelling activity"),i=F({class:["editor-home-section__content","editor-home-section--model__content"]});return this.modelFileIO=_s.call(this,"model"),this.projectionFileIO=_s.call(this,"projection"),i.append(this.modelFileIO.render(),this.projectionFileIO.render()),this.btnStart=oe({class:["btn","editor-home-section--model__button","editor-home-section__button--start"],dataset:{action:"close",context:"home"}},"Start modelling"),e.append(t,i,this.btnStart),e}function _s(e,t){const i=Object.create(Cs,{editor:{value:this.editor}});return i.init(e,t),i}const Cs={file:null,type:null,title:null,status:null,container:null,btnLoad:null,btnUnload:null,btnReLoad:null,init(e,t){return this.type=e,this.title=a(t,e),this},get hasFile(){return!y(this.file)},getFile(){return this.file},setFile(e){this.file=e,this.refresh()},refresh(){return this.hasFile?this.container.classList.remove("empty"):this.container.classList.add("empty"),this.btnReLoad.disabled=!this.hasFile,this.btnUnload.disabled=!this.hasFile,this},render(){this.container=F({class:["drop-area","editor-home-section__drop-area",`editor-home-section__drop-area--${this.type}`],dataset:{type:this.type}});let e=F({class:["drop-area__file-section"]}),t=ee({class:["icon","file-section__icon"]},`${this.type} {JSON}`),i=F({class:["file-section__actionbar"]});var n;this.btnUnload=oe({class:["btn","file-section__actionbar-button","file-section__actionbar-button--remove"],dataset:{action:`unload-${this.type}`}},"UN.load"),this.btnReLoad=oe({class:["btn","file-section__actionbar-button","file-section__actionbar-button--reload"],dataset:{action:`reload-${this.type}`}},"RE.load"),i.append(this.btnUnload,this.btnReLoad),e.append(t,i),this.btnLoad=oe({class:["btn","drop-area__button","drop-area__button--open"],dataset:{action:`load-${this.type}`}},`Select ${n=this.title.charAt(0),n&&["a","e","i","o","u"].includes(n.toLowerCase())?"an":"a"} ${this.title}`);let s=z({class:["drop-area__instruction"]},[this.btnLoad,"or drop it here"]);return this.container.append(e,s),this.bindEvents(),this.refresh(),this.container},bindEvents(){this.container.addEventListener("dragenter",(e=>{this.container.classList.add("highlight"),e.preventDefault(),e.stopPropagation()}),!1),this.container.addEventListener("dragleave",(e=>{this.container.classList.remove("highlight"),e.preventDefault(),e.stopPropagation()}),!1),this.container.addEventListener("dragover",(e=>{this.container.classList.add("highlight"),e.preventDefault(),e.stopPropagation()}),!1),this.container.addEventListener("drop",(e=>{this.container.classList.remove("highlight");let t=e.dataTransfer.files[0];if(!t.name.endsWith(".json"))return void this.notify("This file is not supported. Please use a .json file");let i=new FileReader;i.onload=e=>{this.editor.load(i.result,this.type)},i.readAsText(t),e.preventDefault(),e.stopPropagation()}),!1)}},js={container:null,actionList:null,notification:null,schema:null,isOpen:!1,visible:!0,get isRendered(){return L(this.container)},init(e){return e&&(this.schema=e),this},show(){return He(this.container),this.visible=!0,this},hide(){return $e(this.container),this.visible=!1,this},toggle(){return qe(this.container),this.visible=!this.visible,this},open(){return 0===this.actionList.childElementCount?(this.notify("The menu is empty",1500),this):(this.container.classList.add("open"),this.show(),this.isOpen=!0,this)},close(){return this.container.classList.remove("open"),this.isOpen=!1,this},clear(){return Ce(this.container),this},update(e){e&&(this.schema=e);const{actions:t}=this.schema,i=H();t.filter((e=>a(e.default,!0))).forEach((e=>{const{name:t,content:n,downloadable:s,handler:r}=e;let o=oe({class:["btn","menu-action__button"],dataset:{action:t,downloadable:s,handler:!0}},a(n,t)),l=J({class:["menu-action-list-item"]},o);i.append(l)})),Ce(this.actionList).append(i),this.schema=e},notify(e,t=4500){let i=function(e,t="normal"){var i=Y({class:["notification-message",`notification-message--${t}`]},e);return Array.isArray(e)?i.style.minWidth=`${Math.min(.6*e[0].length,30)}em`:i.style.minWidth=`${Math.min(.6*e.length,30)}em`,i}(e);const n="open";if(this.notification.classList.contains(n))return!1;this.notification.appendChild(i),setTimeout((()=>{this.notification.classList.add(n),this.container.classList.add("menu--notifying")}),50),setTimeout((()=>{this.notification.classList.remove(n),this.container.classList.remove("menu--notifying"),setTimeout((()=>{Ce(this.notification)}),500)}),t)},render(){const e=H();L(this.container)||(this.container=F({class:["menu"],draggable:!0,title:"Click to access the editor actions",dataset:{action:"menu.click",handler:!0}})),L(this.notification)||(this.notification=F({class:["notification","menu-notification"]}),e.appendChild(this.notification));const t=Y({class:["menu-title"],dataset:{ignore:"all"}},"Menu");return e.append(t),L(this.actionList)||(this.actionList=U({class:["bare-list","menu-action-list"]}),e.append(this.actionList)),e.hasChildNodes()&&(this.container.append(e),this.bindEvents()),this.update(),this.refresh(),this.container},refresh(){return this.editor.isReady?this.show():this.hide(),this},bindEvents(){this.editor.registerHandler("menu.click",(()=>this.isOpen?this.close():this.open()))}},Ls={container:null,schema:null,isOpen:!1,visible:!0,btnStart:null,modelFileIO:null,projectionFileIO:null,get isRendered(){return L(this.container)},init(e){return e&&(this.schema=e),this},show(){return He(this.container),this.visible=!0,this},hide(){return $e(this.container),this.visible=!1,this},toggle(){return qe(this.container),this.visible=!this.visible,this},open(){return this.container.classList.add("open"),this.show(),this.isOpen=!0,this},close(){return this.container.classList.remove("open"),this.hide(),this.isOpen=!1,this},clear(){return Ce(this.container),this},update(){},render(){const e=H();return L(this.container)||(this.container=F({class:["editor-style"]})),e.hasChildNodes()&&(this.container.append(e),this.bindEvents()),this.close(),this.refresh(),this.container},refresh(){return this},bindEvents(){}};var Ts=0;const ks={container:null,schema:null,isOpen:!1,visible:!0,btnStart:null,downloadList:null,files:null,init(e){return e&&(this.schema=e),this.files=new Map,this},get isRendered(){return L(this.container)},show(){return He(this.container),this.visible=!0,this},hide(){return $e(this.container),this.visible=!1,this},toggle(){return qe(this.container),this.visible=!this.visible,this},open(){return this.container.classList.add("open"),this.show(),this.isOpen=!0,this},close(){return this.container.classList.remove("open"),this.hide(),this.isOpen=!1,this},addFile(e){const t="application/json";window.URL=window.webkitURL||window.URL;var i=G({class:["bare-link","download-item__link"]},"Download"),n=new Blob([JSON.stringify(e)],{type:t});Object.assign(i,{download:"model.json",href:window.URL.createObjectURL(n)}),i.dataset.downloadurl=[t,i.download,i.href].join(":");let s=J({class:["download-item","download-item--build"]}),a=oe({class:["btn","btn-delete"],dataset:{action:"delete",target:"parent"}},"✖"),r=Y({class:["download-item__name"],dataset:{action:"delete",target:"parent"}},"Build file"+Ts++);s.append(a,r,i),this.downloadList.append(s)},clear(){return Ce(this.container),this},update(){},render(){const e=H();return L(this.container)||(this.container=F({class:["editor-file"]})),L(this.downloadList)||(this.downloadList=U({class:["bare-list","download-list"]}),e.append(this.downloadList)),e.hasChildNodes()&&(this.container.append(e),this.bindEvents()),this.refresh(),this.container},refresh(){return this.downloadList.hasChildNodes()?this.show():this.hide(),this},bindEvents(){}};function As(e,t,i){return Object.create(Os,{object:{value:"selector"},model:{value:i},type:{value:e},editor:{value:t}})}const Os={container:null,list:null,editor:null,dataList:null,fetch:null,init(e){return this.fetch=e,this},render(){const e=H();return L(this.container)||(this.container=F({class:["container","container--editor-selectors"]})),L(this.list)||(this.list=U({class:["bare-list","editor-selectors","font-ui"]}),e.append(this.list)),e.hasChildNodes()&&(this.container.appendChild(e),this.bindEvents()),this.refresh(),this.container},refresh(){return this},update(){return this.dataList=this.fetch(),Ce(this.list),this.dataList.forEach((e=>{const{concept:t}=e;let i=B({class:["title","editor-selector__title"]},`${e.name||e.type}`);t&&i.append(Y({class:["editor-selector__title-concept"]},(t.name||t.prototype).replace(" ","-").toLowerCase()));let n=oe({class:["btn","btn-collapse"],dataset:{action:"collapse",rel:"parent",target:"selector"}}),s=$({class:["title","editor-selector__header"],title:`Expand/Collapse ${this.type}`},[i,n]),a=Ms[this.type],r=F({class:["editor-selector__preview"]},a(e)),o=Vs[this.type],l=F({class:["editor-selector__action-bar"]},o(e)),c=J({class:["editor-selector","collapsed","font-ui"],title:e.description,tabindex:0,dataset:{type:this.type,name:"selector",projection:e.id}},[s,r,l]);this.list.appendChild(c)})),this.refresh(),this},show(){return He(this.container),this},hide(){return $e(this.container),this},bindEvents(){this.container.addEventListener("change",(e=>{const{target:t}=e,{action:i,type:n,id:s,concept:a}=t.dataset;"global"===i&&this.editor.projectionModel.changeProjection({global:t.checked})}))}},Ms={projection:e=>{const{concept:t,tags:i=[]}=e,n=H();let s=Y({class:["editor-selector__preview-concept"]},t.name||t.prototype),a=U({class:["bare-list","editor-selector__preview-tags"]});return i.forEach((e=>a.append(J({class:["editor-selector__preview-tag"]},e)))),n.append(s,a),n},value:e=>{if(y(e))return Z({class:["editor-selector__preview-null"]},"null");const{name:t,value:i,attributes:n}=e;if(["string","number","boolean"].includes(t))return Y({class:["editor-selector__preview-text"]},i);if("set"===t){let e=U({class:["bare-list","editor-selector__preview-list"]});return i.forEach((t=>{let i=J({class:["editor-selector__preview-list-item"]},Ms.value(t));e.append(i)})),e}if(n){let e=U({class:["bare-list","editor-selector__preview-attributes"]});return n.forEach((t=>{const{name:i,value:n}=t;let s=Y({class:["editor-selector__preview-text","editor-selector__preview-text--attribute"]},i),a=J({class:["editor-selector__preview-attribute"]},[s,Ms.value(n)]);e.append(a)})),e}return i?Ms.value(i):e.toString()},concept:e=>{const t=H();if(Array.isArray(e.attributes)){let i=U({class:["bare-list","editor-selector__attributes"]});e.attributes.forEach((e=>{const{name:t,required:n,target:s}=e;let a=Y({class:["editor-selector__preview-text","editor-selector__preview-text--attribute"]},t),r=Y({class:["editor-selector__preview-text","editor-selector__preview-text--target"]},s.name),o=J({class:["editor-selector__attribute"]},[a,r]);n&&(o.classList.add("required"),ee({class:["editor-selector__badge"]})),i.append(o)})),t.append(i)}return t}},Vs={projection:e=>{const t=H();te({type:"checkbox",class:["checkbox","editor-selector__action-bar-checkbox","editor-selector__action-bar-checkbox--global"],checked:E(e.global),dataset:{action:"global",id:e.id}});let i=oe({class:["btn","editor-selector__action-bar-button","editor-selector__action-bar-button","editor-selector__action-bar-button--clone"],dataset:{action:"edit",id:e.id}},"Edit");return t.append(i),t},value:e=>{const t=H();let i=oe({class:["btn","editor-selector__action-bar-button","editor-selector__action-bar-button--clone"],dataset:{action:"clone",id:e.id}},"Clone"),n=oe({class:["btn","editor-selector__action-bar-button","editor-selector__action-bar-button--delete"],dataset:{action:"delete",id:e.id}},"Delete");return t.append(i,n),t},concept:e=>{const t=H();let i=oe({class:["btn","editor-selector__action-bar-button","editor-selector__action-bar-button--clone"],dataset:{action:"create",concept:e.name}},"Create");return t.append(i),t}};function Ss(e){let t=J({class:["tab","editor-header-tab"],tabindex:0,dataset:{value:e,action:`selector-${e}`}}),i=Y({class:["editor-header-tab__content"]},e);return t.append(i),t}const Ns={editor:null,valueCount:0,container:null,title:null,visible:!0,tabs:null,tabConcept:null,tabValue:null,tabProjection:null,tabConceptNotification:null,tabValueNotification:null,tabProjectionNotification:null,activeTab:null,activeTabValue:null,menu:null,body:null,btnClose:null,btnHome:null,get isRendered(){return L(this.container)},init(e){return e&&(this.editor=e),this._conceptSelector=As("concept",this.editor).init((()=>this.editor.hasConceptModel?this.editor.getRoots().map((e=>this.editor.conceptModel.getCompleteModelConcept(e))):[])),this._valueSelector=As("value",this.editor).init((()=>this.editor.hasConceptModel?this.editor.conceptModel.getValues():[])),this._projectionSelector=As("projection",this.editor).init((()=>this.editor.hasProjectionModel?this.editor.projectionModel.schema.filter((e=>"template"!==e.type)):[])),this},render(){const e=H();L(this.container)||(this.container=F({class:["editor-header"]})),L(this.title)||(this.title=Y({class:["editor-header-title"]},"Editor")),this.tabs=U({class:["bare-list","tabs","editor-header-tabs"]}),this.tabConcept=Ss("concept"),this.tabConceptNotification=ee({class:["editor-selector__notification","hidden"]}),this.tabConcept.prepend(this.tabConceptNotification),this.tabValue=Ss("value"),this.tabValueNotification=ee({class:["editor-selector__notification","hidden"]}),this.tabValue.prepend(this.tabValueNotification),this.tabProjection=Ss("projection"),this.tabProjectionNotification=ee({class:["editor-selector__notification","hidden"]}),this.tabProjection.prepend(this.tabProjectionNotification),this.tabs.append(this.tabConcept,this.tabValue),this.activeTab=this.tabs.children[0],this.activeTab.classList.add("selected"),this.activeTabValue=this.activeTab.dataset.value,this.btnClose=oe({class:["btn","btn-close"],dataset:{action:"close"}}),this.btnHome=oe({class:["btn","btn-home"],dataset:{action:"home"}}),oe({class:["btn","btn-style","hidden"],dataset:{action:"style"}});let t=F({class:["editor-toolbar"]},[this.btnHome,this.btnClose]);return L(this.menu)||(this.menu=F({class:["editor-header-menu"]},[this.title,this.tabs,t]),e.append(this.menu)),L(this.body)||(this.body=F({class:["editor-header-main"]}),e.append(this.body)),L(this._conceptSelector.container)||this.body.append(this._conceptSelector.render()),L(this._valueSelector.container)||this.body.append(this._valueSelector.render()),L(this._projectionSelector.container)||this.body.append(this._projectionSelector.render()),e.hasChildNodes()&&(this.container.appendChild(e),this.bindEvents()),this.refresh(),this.container},refresh(){if(b(this.editor.config,"name")&&(this.title.textContent=`Editor – ${this.editor.config.name}`),this.editor.concept)return this.title.textContent=`Editor – ${this.editor.config.name} : ${this.editor.concept.name}`,$e(this.tabs),void $e(this.body);this.editor.hasConceptModel?(He(this.tabs),He(this.body)):($e(this.tabs),$e(this.body));let e=Rs[this.activeTabValue];return l(e)&&e.call(this),this.valueCount>0?(this.tabValueNotification.textContent=this.valueCount,He(this.tabValueNotification)):$e(this.tabValueNotification),this},updateSelector(e){const{value:t}=e.dataset;this.activeTabValue!==t&&e.parentElement===this.tabs&&(this.activeTab.classList.remove("selected"),this.activeTabValue=t,this.activeTab=e,this.activeTab.classList.add("selected"),this.refresh())},show(){return He(this.container),this.visible=!0,this},hide(){return $e(this.container),this.visible=!1,this},toggle(){return qe(this.container),this.visible=!this.visible,this},bindEvents(){this.container.addEventListener("keydown",(e=>{const{target:t}=e;switch(e.key){case Fe:t.click()}})),this.tabs.addEventListener("click",(e=>{const{target:t}=e;let i=Is.call(this,t);this.updateSelector(i)})),this.body.addEventListener("click",(e=>{const{target:t}=e,{action:i,id:n,concept:s,handler:a}=t.dataset;if("clone"===i){let e=this.editor.conceptModel.getValue(n);this.editor.activeConcept.initValue(e)}else"delete"===i?this.editor.conceptModel.removeValue(n):"edit"===i?this.editor.projectionModel.getMetadata(n):"create"===i&&this.editor.createInstance(s)})),ct("value.added",(e=>{this.valueCount++,this.refresh()})),ct("value.removed",(e=>{this.refresh()}))}},Rs={concept:function(){this._conceptSelector.update(),this._conceptSelector.show(),$e(this.tabConceptNotification),this._valueSelector.hide(),this._projectionSelector.hide()},projection:function(){this._projectionSelector.update(),this._projectionSelector.show(),$e(this.tabProjectionNotification),this._conceptSelector.hide(),this._valueSelector.hide()},value:function(){this._valueSelector.update(),this.valueCount=0,this._valueSelector.show(),$e(this.tabValueNotification),this._conceptSelector.hide(),this._projectionSelector.hide()}};function Is(e){const t=e=>e.parentElement===this.tabs;return t(e)?e:Ee(e,t,10)}function Ps(){return Object.create(Ns,{object:{value:"environment"},name:{value:"editor-header"},editor:{value:this}})}function Hs(){return Object.create(gs,{object:{value:"environment"},name:{value:"projection-window"},type:{value:"window"},editor:{value:this}})}function $s(){return Object.create(js,{object:{value:"environment"},name:{value:"editor-menu"},type:{value:"menu"},editor:{value:this}})}function qs(){return Object.create(vs,{object:{value:"environment"},name:{value:"editor-home"},type:{value:"home"},editor:{value:this}})}function Ds(){return Object.create(Ls,{object:{value:"environment"},name:{value:"editor-style"},type:{value:"style"},editor:{value:this}})}function Bs(){return Object.create(ks,{object:{value:"environment"},name:{value:"editor-file"},type:{value:"file"},editor:{value:this}})}const Fs=i(3),zs=i(513),Ws=i(438),Us=i(678),Js=i(76),Gs=i(230),Ks={header:{selectors:{},css:["editor-header"]},root:[],body:{concept:{actions:[{name:"build",triggers:["click"]}],css:["model-concept-list"]},css:["editor-body"]},menu:{actions:[{name:"export"},{name:"import"}],css:["editor-menu"]}},Xs={conceptModel:null,projectionModel:null,concept:null,activeConcept:null,activeProjection:null,container:null,header:null,body:null,footer:null,projectionWindow:null,menu:null,home:null,style:null,files:null,input:null,activeElement:null,config:null,active:!1,handlers:null,init(e={}){const{conceptModel:t,projectionModel:i,concept:n,projection:s,config:a=Ks}=e;return this.conceptModel=t,this.projectionModel=i,this.concept=n,this.projection=s,this.config=a,this.handlers={},this.config&&(this.header=Ps.call(this).init()),this.projectionWindow=Hs.call(this).init(),this.menu=$s.call(this).init(this.config.menu),this.home=qs.call(this).init(this.config.home),this.style=Ds.call(this).init(this.config.style),this.files=Bs.call(this).init(this.config.files),this.render(),this},setConfig(e){if(y(e))return!1;this.config=e,this.menu.update(this.config.menu),this.home.update(this.config.home),this.style.update(this.config.style),this.files.update(this.config.files)},getRoots(){const{root:e=[]}=this.config;return r(e)?this.conceptModel.getSchema("concrete"):e},createInstance(e){if(!this.conceptModel.isConcept(e))return this.notify(`The concept '${e}' is not defined in the model`,Xe.ERROR),!1;let t=this.conceptModel.createConcept(e);return this.addInstance(t)},addInstance(e,t={},i=!0){if(y(e))return this.notify("The concept is not valid",Xe.ERROR),!1;const{name:n}=e;let s=this.projectionModel.createProjection(e,t.tag).init(),a=D({class:["title","editor-concept-title"]},n),r=$({class:["editor-concept-header"]},[a]);if(i){let t=oe({class:["btn","editor-concept-toolbar__btn-delete"],title:`Delete ${n.toLowerCase()}`});t.addEventListener("click",(t=>{e.delete(!0)&&(Ce(o),o.remove())}));let i=oe({class:["btn","editor-concept-toolbar__btn-new"],title:`New ${n.toLowerCase()}`});i.addEventListener("click",(e=>{this.createInstance(n)})),oe({class:["btn","editor-concept-toolbar__btn-collapse"],title:`Collapse ${n.toLowerCase()}`});let s=oe({class:["btn","editor-concept-toolbar__btn-maximize"],title:`Maximize ${n.toLowerCase()}`});s.addEventListener("click",(e=>{o.classList.toggle("focus")}));let a=F({class:["editor-concept-toolbar"]},[i,s,t]);r.append(a)}let o=F({class:["editor-concept"],draggable:!1,dataset:{nature:"concept-container"}},[r,s.render()]);return this.conceptSection.appendChild(o),s.focus(),o},initInstance(){if(this.isReady)return this.concept?(this.addInstance(this.concept,this.projection,!1).classList.add("focus"),!0):(this.conceptModel.getRootConcepts().forEach((e=>{this.addInstance(e)})),this)},get hasConceptModel(){return!y(this.conceptModel)},get hasProjectionModel(){return!y(this.projectionModel)},get isReady(){return this.hasConceptModel&&this.hasProjectionModel},addConcept(e){Array.isArray(e)&&this.conceptModel.schema.push(...e),this.refresh()},addProjection(e){Array.isArray(e)&&this.projectionModel.schema.push(...e),this.refresh()},getField(e){if(!L(e))return console.warn("Field error: Bad argument"),null;const{id:t,nature:i}=e.dataset;return y(t)?(console.warn("Field error: Missing id attribute on field"),null):["field","field-component"].includes(i)?this.projectionModel.getField(t):(console.warn("Field error: Unknown nature attribute on field"),null)},getStatic(e){if(!L(e))return console.warn("Static error: Bad argument"),null;const{id:t,nature:i}=e.dataset;return y(t)?(console.warn("Static error: Missing id attribute on field"),null):["static"].includes(i)?this.projectionModel.getStatic(t):(console.warn("Static error: Unknown nature attribute on field"),null)},getLayout(e){if(!L(e))return console.warn("Layout error: Bad argument"),null;const{id:t,nature:i}=e.dataset;return y(t)?(console.warn("Layout error: Missing id attribute on field"),null):["layout"].includes(i)?this.projectionModel.getLayout(t):(console.warn("Layout error: Unknown nature attribute on field"),null)},resolveElement(e){if(!L(e))return null;const{nature:t}=e.dataset;if(y(t))return null;let i=null;switch(t){case"field":case"field-component":i=this.getField(e);break;case"layout":i=this.getLayout(e);break;case"static":i=this.getStatic(e)}return i&&(i.environment=this),i},download(e){return this.files.addFile(e),this.refresh(),e},export(e=!1){const t="application/json";window.URL=window.webkitURL||window.URL;var i=G({});this.container.appendChild(i),p(i.href)||window.URL.revokeObjectURL(i.href);const n={concept:this.conceptModel.schema,values:this.conceptModel.export()};var s=new Blob([JSON.stringify(n)],{type:t});return Object.assign(i,{download:"model.json",href:window.URL.createObjectURL(s)}),i.dataset.downloadurl=[t,i.download,i.href].join(":"),e?(function(e){if(y(e))return!1;var t=ie({value:L(e)?e.textContent:e.toString(),readonly:!0});L(t)&&(document.body.appendChild(t),t.select(),document.execCommand("copy"),t.remove())}(JSON.stringify(n)),this.notify("Export has been copied to clipboard")):(i.click(),this.notify("The model has been successfully saved. Please download the model.")),setTimeout((()=>{window.URL.revokeObjectURL(i.href),i.remove()}),1500),n},notify(e,t){let i=z({class:["notify"],html:e});t&&i.classList.add(t),this.container.appendChild(i),setTimeout((()=>{i.classList.add("open")}),50),setTimeout((()=>{i.classList.remove("open"),setTimeout((()=>{i.remove()}),500)}),4500)},show(){He(this.container)},hide(){$e(this.container)},open(){return this.show(),this.active=!0,ht("editor.open"),this},reduce(){return this.hide(),this.active=!0,ht("editor.reduce"),this},close(){return this.hide(),this.active=!1,this.clean(),this.container.remove(),this.manager.deleteEditor(this),ht("editor.close"),this},unloadConceptModel(){return this.hasConceptModel&&(this.conceptModel.done(),this.conceptModel=null,this.refresh()),this},loadConceptModel(e,t){return Array.isArray(e)?(this.unloadConceptModel(),this.clear(),this.conceptModel=Ri.createModel(e).init(t),y(this.conceptModel),this.hasProjectionModel&&this.projectionModel.done(),this.initInstance(),this.refresh(),this):(this.notify("Invalid concept model",Xe.ERROR),!1)},unloadProjectionModel(){return this.hasProjectionModel&&(this.projectionModel.done(),this.projectionModel=null,this.refresh()),this},loadProjectionModel(e,t){return Array.isArray(e)?(this.unloadProjectionModel(),this.clear(),this.projectionModel=function(e,t){const i=Object.create(bs,{schema:{value:e},environment:{value:t}});return fs.push(i),i}(e,this).init(t),y(this.projectionModel),this.initInstance(),this.refresh(),this):(this.notify("Invalid projection model",Xe.ERROR),!1)},load(e,t){const i=JSON.parse(e);switch(t){case"model":if(Array.isArray(i))this.loadConceptModel(i);else{const{concept:e,values:t=[]}=i;this.loadConceptModel(e,t)}break;case"projection":if(Array.isArray(i))this.loadProjectionModel(i);else{const{projection:e,views:t=[]}=i;this.loadProjectionModel(e,t)}break;default:return console.warn(`File type ${t} not handled`),!1}return!0},unload(){return this.unloadConceptModel(),this.unloadProjectionModel(),this.clear(),this},clean(){return this.conceptModel,this.projectionModel,Ce(this.container),ht("editor.clean"),this},clear(){return this.conceptSection&&Ce(this.conceptSection),this.activeElement=null,this.activeConcept=null,this.activeProjection=null,ht("editor.clear"),this},render(e){const t=H();return this.home.isRendered||t.appendChild(this.home.render()),this.style.isRendered||t.appendChild(this.style.render()),this.header.isRendered||t.appendChild(this.header.render()),L(this.body)||(this.body=F({class:["editor-body"],tabindex:0}),this.conceptSection=q({class:["model-concept-section"]}),this.body.append(this.conceptSection),t.appendChild(this.body)),L(this.footer)||(this.footer=F({class:["editor-footer"],tabindex:0}),this.files.isRendered||this.footer.append(this.files.render()),t.appendChild(this.footer)),L(this.projectionWindow.container)||t.appendChild(this.projectionWindow.render()),this.menu.isRendered||t.appendChild(this.menu.render()),L(this.input)||(this.input=te({type:"file",class:["hidden"],accept:".json"}),t.appendChild(this.input)),t.hasChildNodes()&&(this.container.appendChild(t),this.bindEvents()),L(e)&&e.appendChild(this.container),this.initInstance(),this.refresh(),this.container},refresh(){return this.hasConceptModel?this.container.classList.remove("no-concept-model"):this.container.classList.add("no-concept-model"),this.hasProjectionModel?this.container.classList.remove("no-projection-model"):this.container.classList.add("no-projection-model"),this.header.refresh(),this.menu.refresh(),this.home.refresh(),this.style.refresh(),this.files.refresh(),this.projectionWindow.refresh(),this},updateActiveElement(e){if(!this.activeElement||this.activeElement!==e)return this.activeElement=e,this},updateActiveConcept(e){return this.activeConcept=e,this.refresh(),this},updateActiveProjection(e){return this.activeProjection=e,this.refresh(),this},getHandlers(e){return a(this.handlers[e],[])},triggerEvent(e){const{name:t,downloadable:i}=e;return this.getHandlers(t).forEach((e=>{let t=e.call(this,this.conceptModel);!1!==t&&i&&this.download(t)})),!0},registerHandler(e,t){return Array.isArray(this.handlers[e])||(this.handlers[e]=[]),this.handlers[e].push(t),!0},unregisterHandler(e,t){if(!b(this.handlers,e))return!1;for(let i=0;i<this.handlers[e].length;i++)if(this.handlers[e][i]===t)return this.handlers[e].splice(i,1),!0;return!1},bindEvents(){var e=null,t=null;const i={open:e=>{const{context:t}=e.dataset;t?this[t].open():this.open()},close:e=>{const{context:t}=e.dataset;t?this[t].close():this.close()},collapse:e=>{const{rel:t,target:i}=e.dataset;if("parent"===t){let t=Ee(e,(e=>e.dataset.name===i));L(t)&&t.classList.toggle("collapsed")}},delete:e=>{const{target:t}=e.dataset;if("parent"===t){let t=e.parentElement;Ce(t),t.remove()}},style:e=>{this.style.toggle()},home:e=>{this.home.toggle()},files:e=>{this.files.toggle()},export:e=>{this.export()},copy:e=>{this.export(!0)},"load-model":e=>{let i=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});t="model",this.input.dispatchEvent(i)},"unload-model":e=>{this.unloadConceptModel()},"reload-model":e=>{const{schema:t,values:i}=this.projectionModel;this.loadConceptModel(t,i)},"load-projection":e=>{let i=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});t="projection",this.input.dispatchEvent(i)},"unload-projection":e=>{this.unloadProjectionModel()},"reload-projection":e=>{const{schema:t,views:i}=this.projectionModel;this.loadProjectionModel(t,i)},"create-metamodel":e=>{const{concept:t,values:i=[]}=zs,{projection:n,views:s=[]}=Ws,{editor:a}=Fs;this.unload(),this.setConfig(a),this.loadConceptModel(t,i),this.loadProjectionModel(n,s)},"create-projection":e=>{const{concept:t,values:i=[]}=Js,{projection:n,views:s=[]}=Gs,{editor:a}=Us;this.unload(),this.setConfig(a),this.loadConceptModel(t,i),this.loadProjectionModel(n,s)}};this.container.addEventListener("click",(e=>{var t=Ye(e.target);const{action:n,handler:s,downloadable:a}=t.dataset;this.activeElement&&this.activeElement.clickHandler(t);const r=i[n];s&&n?this.triggerEvent({name:n,downloadable:a}):l(r)&&(r(t),t.blur())}),!0),this.input.addEventListener("change",(e=>{let i=this.input.files[0];if(!i.name.endsWith(".json"))return void this.notify("This file is not supported. Please use a .json file");let n=new FileReader;n.onload=e=>{this.load(n.result,t),t=null,this.input.value=""},n.readAsText(i)})),this.body.addEventListener("keydown",(t=>{const{target:i}=t,{nature:n}=i.dataset;var s=!1;switch(t.key){case Be:this.activeElement&&e!==ze&&!0===this.activeElement.backspaceHandler(i)&&t.preventDefault();break;case ze:t.preventDefault(),s=!0;break;case Ke:this.activeElement&&e!==ze&&this.activeElement.deleteHandler(i)&&t.preventDefault();break;case" ":this.activeElement&&e!==ze&&this.activeElement.spaceHandler(i)&&t.preventDefault();break;case"Alt":t.preventDefault(),this.activeProjection&&this.activeProjection.hasMultipleViews&&this.activeProjection.changeView(),s=!0;break;case Fe:this.activeElement?!0===this.activeElement.enterHandler(i)&&t.preventDefault():t.preventDefault();break;case We:this.activeElement&&!0===this.activeElement.escapeHandler(i)&&t.preventDefault();break;case"Insert":this.activeElement&&t.preventDefault();break;case Ue:this.activeElement&&!0===this.activeElement.arrowHandler("up",i)&&t.preventDefault();break;case Ge:this.activeElement&&!0===this.activeElement.arrowHandler("down",i)&&t.preventDefault();break;case Je:this.activeElement&&!0===this.activeElement.arrowHandler("right",i)&&t.preventDefault();break;case"ArrowLeft":this.activeElement&&!0===this.activeElement.arrowHandler("left",i)&&t.preventDefault();break;case"s":e===ze&&(this.activeConcept.copy(),t.preventDefault())}s&&(e=t.key)}),!1),this.body.addEventListener("keyup",(t=>{var i=t.target;switch(t.key){case" ":e===ze&&this.activeElement&&this.activeElement._spaceHandler(i);break;case Ke:e===ze&&this.activeElement&&this.activeElement.delete(i);break;case ze:e===ze&&this.activeElement&&this.activeElement.controlHandler(i)}e=-1}),!1),this.body.addEventListener("focusin",(e=>{const{target:t}=e,i=this.resolveElement(t);if(i&&i.focusable){if(this.activeElement&&this.activeElement!==i&&(this.activeElement.focusOut(),this.activeElement=null),y(i)||i===this.activeElement)return void(this.activeElement&&this.activeElement._focusIn(t));this.updateActiveElement(i),this.activeElement.focusIn(t)}else this.activeElement&&this.activeElement.focusOut(t),this.activeElement=null;if(this.activeElement){let e=this.activeElement.projection;this.updateActiveProjection(e),this.updateActiveConcept(e.concept)}}));var n=null;this.container.addEventListener("dragstart",(e=>{e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("clientX",e.clientX),e.dataTransfer.setData("clientY",e.clientY),n=e.target,this.body.classList.add("dragging")})),this.container.addEventListener("dragend",(e=>{this.body.classList.remove("dragging"),n=null})),this.body.addEventListener("drop",(e=>{var t=e.dataTransfer.getData("clientX"),i=e.dataTransfer.getData("clientY");n.style.top=`${Math.max(n.offsetTop-(i-e.clientY),0)}px`,n.style.left=`${Math.max(n.offsetLeft-(t-e.clientX),0)}px`})),this.body.addEventListener("dragover",(e=>{e.preventDefault()})),this.registerHandler("build-concept",Bt),this.registerHandler("build-projection",Ct),this.registerHandler("export",(()=>this.export())),this.registerHandler("copy",(()=>this.export(!0)))}};function Ys(){return this.model.concepts.filter((e=>this.metamodel.isConcrete(e.name)))}const Qs={metamodel:null,model:null,concept:null,container:null,header:null,body:null,footer:null,selectorElement:null,selectorList:null,input:null,results:null,active:!1,fields:null,init(e,t,i){return this.metamodel=e,this.model=t,this.concept=i,this.fields=new Map,this.render(),this},registerField(e){return e.editor=this,this.fields.set(e.id,e),this},unregisterField(e){var t=this.fields.get(e.id);return t&&(t.editor=null,this.fields.delete(t.id)),this},open(){return this.active=!0,He(this.container),this.container.classList.replace("close","open"),this.input.focus(),ht("explorer.open"),this},close(){return this.active=!1,$e(this.container),this.container.classList.replace("open","close"),ht("explorer.close"),this},clear(){return Ce(this.results),this.input.value="",this},render(e){const t=H();if(!L(this.header)){this.header=F({class:["explorer-header"],tabindex:-1});let e=oe({class:["btn","btn-close"],dataset:{action:"close"}}),i=F({class:["explorer-toolbar"]},[e]);this.header.appendChild(i);const{refname:n,name:s}=this.activeConcept;this.concept&&this.header.appendChild(F({class:["explorer-header-concept"]},`${n} (${s})`)),t.appendChild(this.header)}return L(this.body)||(this.body=F({class:["explorer-body"],tabindex:-1}),t.appendChild(this.body)),L(this.footer)||(this.footer=F({class:["editor-footer"],tabindex:-1}),t.appendChild(this.footer)),L(this.selectorElement)||(this.selectorElement=oe({class:["btn","explorer-header-concept","hidden"]}),this.header.appendChild(this.selectorElement)),L(this.selectorList)||(this.selectorList=U({class:["bare-list","explorer-selector-list","hidden"]}),t.appendChild(this.selectorList)),L(this.input)||(this.input=te({class:["explorer-input","hidden"],placeholder:"Rechercher..."}),t.appendChild(this.input)),L(this.results)||(this.results=U({class:["bare-list","explorer-results"]}),this.body.appendChild(this.results)),t.hasChildNodes()&&(this.container.appendChild(t),this.bindEvents()),L(e)&&e.appendChild(this.container),this.clear(),this.refresh(),this.container},update(e){const t=H();return t.appendChild(J({class:["explorer-result-title"]},"Attribute")),e.filter((e=>"attribute"===e.type)).forEach((e=>{var i=`${e.target}${e.accept?`:${e.accept}`:""}`;t.appendChild(Zs(e,"Target concept",i))})),t.appendChild(J({class:["explorer-result-title"]},"Component")),e.filter((e=>"component"===e.type)).forEach((e=>{var i=e.attributes.join(", ");t.appendChild(Zs(e,"Attributes",i))})),Ce(this.results),this.results.appendChild(t),this},refresh(){return y(this.concept)?(Ce(this.selectorList),Ys.call(this).forEach((e=>{var t=this.metamodel.getProjectionSchema(e.name).filter((e=>"explorer"===e.environment)),i=ms.createProjection(t,e,this).init(),n=J({class:["explorer-selector","explorer-selector--concept"],dataset:{concept:e.id}},i.render());this.selectorList.appendChild(n)})),He(this.selectorList),$e(this.results),$e(this.selectorElement)):(He(this.selectorElement),$e(this.selectorList),He(this.results),this.update(this.concept.getStructure())),this},query(e){var t=this.concept.getStructure().slice(0);if(!p(e)){var i=e.trim().replace(/\s+/g," ").split(" ");t=t.filter((e=>i.some((t=>{let i=!1;return e.alias&&(i=e.alias.includes(t)),i||e.name.includes(t)}))))}return this.update(t),this},bindEvents(){var e=0;this.container.addEventListener("keydown",(t=>{var i=!1;switch(t.key){case Be:break;case ze:t.preventDefault(),i=!0;break;case Ke:break;case"Alt":i=!0;break;case Fe:case Je:break;case Ue:e>0&&(e--,this.results.children[e].focus());break;case Ge:e<this.results.childElementCount&&(this.results.children[e].focus(),e++);break;case We:i=!1,this.close()}i&&t.key}),!1),this.container.addEventListener("click",(e=>{"close"===e.target.dataset.action&&this.close()})),this.results.addEventListener("change",(e=>{let t=e.target,[i,n]=t.value.split(":");"attribute"===n?this.concept.createAttribute(i):"component"===n&&this.concept.createComponent(i),t.disabled=!0})),this.input.addEventListener("input",(t=>{this.query(this.input.value.trim()),e=0})),this.input.addEventListener("blur",(e=>{p(this.input.value)&&(this.input.value="")}));const t=e=>e.parentElement===this.selectorList?e:Ee(e,(e=>e.parentElement===this.selectorList));this.selectorList.addEventListener("click",(e=>{const{target:i}=e,n=t(i),{concept:s}=n.dataset;if(s){let e=this.model.getConcept(s);this.concept=e,this.selectorElement.textContent=e.fullName,this.clear(),this.refresh()}})),this.selectorElement.addEventListener("click",(e=>{He(this.selectorList)}))}};function Zs(e,t,i){const{name:n,alias:s,type:r,created:o,required:l}=e,c=te({type:"checkbox",class:["explorer-result-item__checkbox"],value:`${n}:${r}`,disabled:!0});c.id=`${v(n)}${v(r)}`,c.checked=o,c.required=l;const h=Y({class:["explorer-result-item__label-name"]},a(s,n)),u=Y({class:["explorer-result-item__label-info"]},[`${t}: `,Q({class:["concept-name"]},`${i}`)]),d=ne({class:["explorer-result-item__label"]},[h,u]);d.htmlFor=c.id;var p=oe({type:"button",class:["btn","btn-add","explorer-result-item__button"],disabled:o,dataset:{action:"add"}},"+"),m=oe({type:"button",class:["btn","btn-remove","explorer-result-item__button"],disabled:l,dataset:{action:"remove"}},"-"),y=J({class:["explorer-result-item"],dataset:{value:n,required:l}},[c,d,p,m]);return y.tabIndex=-1,y}const ea="editor",ta="explorer",ia=[];var na=0;const sa=()=>"GE"+na++;function aa(e){return F({class:["env",`${e}-container`,"close"],tabindex:-1})}({container:null,containerEnv:null,homeContainer:null,menu:null,homePage:null,btnBuild:null,btnNew:null,btnStyle:null,get editors(){return ia.filter((e=>e.type===ea))},get explorers(){return ia.filter((e=>e.type===ta))},get hasEnvironment(){return!r(ia)},get hasEditor(){return ia.some((e=>e.type===ea))},get hasExplorer(){return ia.some((e=>e.type===ta))},init(e){const t=function(e){return L(e)?e:p(e)?be("[data-gentleman]"):be(e)}(e);if(!L(t))throw new TypeError("Bad argument: The container argument could not be resolved to an HTML Element.");return this.container=t,this.container.tabIndex=-1,this.containerEnv=this.container.dataset.gentleman,"editor"===this.containerEnv?(this.createEditor().init(),this):(this.bindDOM(),this.bindEvents(),this.render(),this)},render(){const e=H();return y(this.menu.parentElement)&&e.append(this.menu),y(this.btnNew.parentElement)&&this.menu.append(this.btnNew,this.btnStyle),e.hasChildNodes()&&this.container.append(e),this.refresh(),this.container},refresh(){return this.hasEnvironment||this.createEditor().init(),this},getEditors(e){const t=this.editors;return l(e)?this.editors.filter((t=>e(t))):t.filter((e=>!e.active))},getEditor(e){return e?ia((t=>t.id===e)):this.editors.find((e=>!e.active))},createEditor(){var e=Object.create(Xs,{object:{value:"environment"},type:{value:"editor"},name:{value:"editor"},id:{value:sa()},manager:{value:this},container:{value:aa("editor")}});return this.container.append(e.container),ia.push(e),this.refresh(),e},deleteEditor(e){var t;return-1!==(t=o(e)?ia.findIndex((t=>t.id===e)):ia.indexOf(e))&&(ia.splice(t,1),this.refresh(),!0)},getExplorer(e){return e?ia((t=>t.id===e)):this.explorers.find((e=>!e.active))},createExplorer(){const e=Object.create(Qs,{object:{value:"environment"},type:{value:"explorer"},name:{value:"explorer"},id:{value:sa()},manager:{value:this},container:{value:aa("explorer")}});return this.container.append(e.container),ia.push(e),this.refresh(),e},bindDOM(){L(this.menu)||(this.menu=F({class:["manager-menu"]})),L(this.btnNew)||(this.btnNew=oe({id:"btnNewEditor",class:["btn","manager__button","manager__btn-new"]},"New")),L(this.btnStyle)||(this.btnStyle=oe({id:"btnStyleEditor",class:["btn","manager__button","manager__btn-style","hidden"]},"Style"))},bindEvents(){this.menu.addEventListener("click",(e=>{const{target:t}=e;t===this.btnNew&&this.createEditor().init().open()}))}}).init().render()})()})();