<<<<<<< HEAD
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Gentleman=t():e.Gentleman=t()}(self,(function(){return(()=>{var e={779:function(e,t,i){var n,s;function a(e,t,i){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,i){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=l(e)););return e}(e,t);if(n){var s=Object.getOwnPropertyDescriptor(n,t);return s.get?s.get.call(i):s.value}})(e,t,i||e)}function r(e,t){return!t||"object"!==b(t)&&"function"!=typeof t?o(e):t}function o(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e){return m(e)||w(e)||p()}function d(e,t){return m(e)||function(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var i=[],n=!0,s=!1,a=void 0;try{for(var r,o=e[Symbol.iterator]();!(n=(r=o.next()).done)&&(i.push(r.value),!t||i.length!==t);n=!0);}catch(e){s=!0,a=e}finally{try{n||null==o.return||o.return()}finally{if(s)throw a}}return i}}(e,t)||p()}function p(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function m(e){if(Array.isArray(e))return e}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v(e,t){for(var i,n=0;n<t.length;n++)(i=t[n]).enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}function g(e,t,i){return t&&v(e.prototype,t),i&&v(e,i),e}function b(e){return(b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function y(e){return function(e){if(Array.isArray(e)){for(var t=0,i=Array(e.length);t<e.length;t++)i[t]=e[t];return i}}(e)||w(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function w(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}s=function(){var e=Math.abs,t=String.fromCharCode,n=Math.floor;function s(e){return s[e]}return s["../../package.json"]={name:"coffeescript",description:"Unfancy JavaScript",keywords:["javascript","language","coffeescript","compiler"],author:"Jeremy Ashkenas",version:"2.5.1",license:"MIT",engines:{node:">=6"},directories:{lib:"./lib/coffeescript"},main:"./lib/coffeescript/index",module:"./lib/coffeescript-browser-compiler-modern/coffeescript.js",browser:"./lib/coffeescript-browser-compiler-legacy/coffeescript.js",bin:{coffee:"./bin/coffee",cake:"./bin/cake"},files:["bin","lib","register.js","repl.js"],scripts:{test:"node ./bin/cake test","test-harmony":"node --harmony ./bin/cake test"},homepage:"https://coffeescript.org",bugs:"https://github.com/jashkenas/coffeescript/issues",repository:{type:"git",url:"git://github.com/jashkenas/coffeescript.git"},devDependencies:{"@babel/core":"^7.7.7","@babel/preset-env":"^7.7.7","babel-preset-minify":"^0.5.1",codemirror:"^5.50.0",docco:"~0.8.0","highlight.js":"~9.17.1",jison:"^0.4.18","markdown-it":"~10.0.0",underscore:"~1.9.1",webpack:"~4.41.5"},dependencies:{}},s["./helpers"]=function(){var e={};return function(){var t,i,s,a,r,o,l,c,h,u,d,p,m,f,v=[].indexOf;e.starts=function(e,t,i){return t===e.substr(i,t.length)},e.ends=function(e,t,i){var n;return n=t.length,t===e.substr(e.length-n-(i||0),n)},e.repeat=p=function(e,t){var i;for(i="";0<t;)1&t&&(i+=e),t>>>=1,e+=e;return i},e.compact=function(e){var t,i,n,s;for(s=[],t=0,n=e.length;t<n;t++)(i=e[t])&&s.push(i);return s},e.count=function(e,t){var i,n;if(i=n=0,!t.length)return 1/0;for(;n=1+e.indexOf(t,n);)i++;return i},e.merge=function(e,t){return o(o({},e),t)},o=e.extend=function(e,t){var i,n;for(i in t)n=t[i],e[i]=n;return e},e.flatten=l=function(e){var t,i,n,s;for(i=[],n=0,s=e.length;n<s;n++)t=e[n],"[object Array]"===Object.prototype.toString.call(t)?i=i.concat(l(t)):i.push(t);return i},e.del=function(e,t){var i;return i=e[t],delete e[t],i},e.some=null==(d=Array.prototype.some)?function(e){var t,i;for(t=0,i=this.length;t<i;t++)if(e(this[t]))return!0;return!1}:d,e.invertLiterate=function(e){var t,i,n,s,a,r,o,l,c;for(l=[],t=/^\s*$/,n=/^[\t ]/,o=/^(?:\t?| {0,3})(?:[\*\-\+]|[0-9]{1,9}\.)[ \t]/,s=!1,i=0,a=(c=e.split("\n")).length;i<a;i++)r=c[i],t.test(r)?(s=!1,l.push(r)):s||o.test(r)?(s=!0,l.push("# ".concat(r))):!s&&n.test(r)?l.push(r):(s=!0,l.push("# ".concat(r)));return l.join("\n")},s=function(e,t){return t?{first_line:e.first_line,first_column:e.first_column,last_line:t.last_line,last_column:t.last_column,last_line_exclusive:t.last_line_exclusive,last_column_exclusive:t.last_column_exclusive,range:[e.range[0],t.range[1]]}:e},e.extractAllCommentTokens=function(e){var t,i,n,s,a,r,o,l,c,h,u,d,p;for(t={},n=0,o=e.length;n<o;n++)if((p=e[n]).comments)for(s=0,l=(h=p.comments).length;s<l;s++)t[(i=h[s]).locationData.range[0]]=i;for(u=[],a=0,c=(d=Object.keys(t).sort((function(e,t){return e-t}))).length;a<c;a++)r=d[a],u.push(t[r]);return u},a=function(e){return"".concat(e.range[0],"-").concat(e.range[1])},e.buildTokenDataDictionary=r=function(e){var t,i,n,s,r,o;for(r={},i=0,n=e.length;i<n;i++)if((s=e[i]).comments&&(null==r[o=a(s[2])]&&(r[o]={}),s.comments)){var l;(l=null==(t=r[o]).comments?t.comments=[]:t.comments).push.apply(l,y(s.comments))}return r},e.addDataToNode=function(e,t,n,o,l){var c=!(5<arguments.length&&void 0!==arguments[5])||arguments[5];return function(h){var u,d,p,m,f;return u=s(null==(p=null==n?void 0:n.locationData)?t:p,null==(m=null==l?void 0:l.locationData)?o:m),null!=(null==h?void 0:h.updateLocationDataIfMissing)&&null!=t?h.updateLocationDataIfMissing(u,c):h.locationData=u,null==e.tokenData&&(e.tokenData=r(e.parser.tokens)),null!=h.locationData&&(d=a(h.locationData),null!=(null==(f=e.tokenData[d])?void 0:f.comments)&&i(e.tokenData[d].comments,h)),h}},e.attachCommentsToNode=i=function(e,t){var i;if(null!=e&&0!==e.length)return null==t.comments&&(t.comments=[]),(i=t.comments).push.apply(i,y(e))},e.locationDataToString=function(e){var t;return"2"in e&&"first_line"in e[2]?t=e[2]:"first_line"in e&&(t=e),t?"".concat(t.first_line+1,":").concat(t.first_column+1,"-")+"".concat(t.last_line+1,":").concat(t.last_column+1):"No location data"},e.baseFileName=function(e){var t,i,n=!!(1<arguments.length&&void 0!==arguments[1])&&arguments[1],s=!!(2<arguments.length&&void 0!==arguments[2])&&arguments[2];return i=s?/\\|\//:/\//,t=e.split(i),e=t[t.length-1],n&&0<=e.indexOf(".")?((t=e.split(".")).pop(),"coffee"===t[t.length-1]&&1<t.length&&t.pop(),t.join(".")):e},e.isCoffee=function(e){return/\.((lit)?coffee|coffee\.md)$/.test(e)},e.isLiterate=function(e){return/\.(litcoffee|coffee\.md)$/.test(e)},e.throwSyntaxError=function(e,t){var i;throw(i=new SyntaxError(e)).location=t,i.toString=m,i.stack=i.toString(),i},e.updateSyntaxError=function(e,t,i){return e.toString===m&&(e.code||(e.code=t),e.filename||(e.filename=i),e.stack=e.toString()),e},m=function(){var e,t,i,n,s,a,r,o,l,c,h,u,d,m;if(!this.code||!this.location)return Error.prototype.toString.call(this);var f=this.location;return r=f.first_line,a=f.first_column,null==(l=f.last_line)&&(l=r),null==(o=f.last_column)&&(o=a),s=this.filename||"[stdin]",e=this.code.split("\n")[r],m=a,n=r===l?o+1:e.length,c=e.slice(0,m).replace(/[^\s]/g," ")+p("^",n-m),"undefined"!=typeof process&&null!==process&&(i=(null==(h=process.stdout)?void 0:h.isTTY)&&(null==(u={NODE_ENV:"production"})||!u.NODE_DISABLE_COLORS)),(null==(d=this.colorful)?i:d)&&(t=function(e){return"[1;31m".concat(e,"[0m")},e=e.slice(0,m)+t(e.slice(m,n))+e.slice(n),c=t(c)),"".concat(s,":").concat(r+1,":").concat(a+1,": error: ").concat(this.message,"\n").concat(e,"\n").concat(c)},e.nameWhitespaceCharacter=function(e){return" "===e?"space":"\n"===e?"newline":"\r"===e?"carriage return":"\t"===e?"tab":e},e.parseNumber=function(e){var t;return null==e?NaN:null==(t=function(){switch(e.charAt(1)){case"b":return 2;case"o":return 8;case"x":return 16;default:return null}}())?parseFloat(e.replace(/_/g,"")):parseInt(e.slice(2).replace(/_/g,""),t)},e.isFunction=function(e){return"[object Function]"===Object.prototype.toString.call(e)},e.isNumber=h=function(e){return"[object Number]"===Object.prototype.toString.call(e)},e.isString=u=function(e){return"[object String]"===Object.prototype.toString.call(e)},e.isBoolean=c=function(e){return!0===e||!1===e||"[object Boolean]"===Object.prototype.toString.call(e)},e.isPlainObject=function(e){return!("object"!==b(e)||!e||Array.isArray(e)||h(e)||u(e)||c(e))},f=function(e){var t,i,s;return s=function(e){var t;return t=e.toString(16),"\\u".concat(p("0",4-t.length)).concat(t)},65536>e?s(e):(t=n((e-65536)/1024)+55296,i=(e-65536)%1024+56320,"".concat(s(t)).concat(s(i)))},e.replaceUnicodeCodePointEscapes=function(e){var i,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},s=n.flags,a=n.error,r=n.delimiter,o=void 0===r?"":r;return i=null!=s&&0>v.call(s,"u"),e.replace(t,(function(e,t,n,s){var r;return t||(1114111<(r=parseInt(n,16))&&a("unicode code point escapes greater than \\u{10ffff} are not allowed",{offset:s+o.length,length:n.length+4}),i?f(r):e)}))},t=/(\\\\)|\\u\{([\da-fA-F]+)\}/g}.call(this),{exports:e}.exports}(),s["./rewriter"]=function(){var e={};return function(){var t,i,n,a,r,o,l,c,h,u,p,m,v,b,w,k,x,E,T,N,A,C,L,S,I=[].indexOf,D={}.hasOwnProperty,j=s("./helpers");for(S=j.throwSyntaxError,x=j.extractAllCommentTokens,C=function(e,t){var i,n,s,a,r;if(e.comments){if(t.comments&&0!==t.comments.length){for(r=[],n=0,s=(a=e.comments).length;n<s;n++)(i=a[n]).unshift?r.push(i):t.comments.push(i);t.comments=r.concat(t.comments)}else t.comments=e.comments;return delete e.comments}},E=function(e,t,i,n){var s;return(s=[e,t]).generated=!0,i&&(s.origin=i),n&&C(n,s),s},e.Rewriter=function(){var e=function(){"use strict";function e(){f(this,e)}return g(e,[{key:"rewrite",value:function(e){var t,i,n;return this.tokens=e,("undefined"!=typeof process&&null!==process?null==(t={NODE_ENV:"production"})?void 0:t.DEBUG_TOKEN_STREAM:void 0)&&({NODE_ENV:"production"}.DEBUG_REWRITTEN_TOKEN_STREAM&&console.log("Initial token stream:"),console.log(function(){var e,t,i,s;for(s=[],e=0,t=(i=this.tokens).length;e<t;e++)n=i[e],s.push(n[0]+"/"+n[1]+(n.comments?"*":""));return s}.call(this).join(" "))),this.removeLeadingNewlines(),this.closeOpenCalls(),this.closeOpenIndexes(),this.normalizeLines(),this.tagPostfixConditionals(),this.addImplicitBracesAndParens(),this.rescueStowawayComments(),this.addLocationDataToGeneratedTokens(),this.enforceValidJSXAttributes(),this.fixIndentationLocationData(),this.exposeTokenDataToGrammar(),("undefined"!=typeof process&&null!==process?null==(i={NODE_ENV:"production"})?void 0:i.DEBUG_REWRITTEN_TOKEN_STREAM:void 0)&&({NODE_ENV:"production"}.DEBUG_TOKEN_STREAM&&console.log("Rewritten token stream:"),console.log(function(){var e,t,i,s;for(s=[],e=0,t=(i=this.tokens).length;e<t;e++)n=i[e],s.push(n[0]+"/"+n[1]+(n.comments?"*":""));return s}.call(this).join(" "))),this.tokens}},{key:"scanTokens",value:function(e){var t,i,n;for(n=this.tokens,t=0;i=n[t];)t+=e.call(this,i,t,n);return!0}},{key:"detectEnd",value:function(e,t,i){var n,s,a,r,c,h=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{};for(c=this.tokens,n=0;r=c[e];){if(0===n&&t.call(this,r,e))return i.call(this,r,e);if(s=r[0],0<=I.call(l,s)?n+=1:(a=r[0],0<=I.call(o,a)&&(n-=1)),0>n)return h.returnOnNegativeLevel?void 0:i.call(this,r,e);e+=1}return e-1}},{key:"removeLeadingNewlines",value:function(){var e,t,i,n,s,a,r,o;for(e=t=0,s=(r=this.tokens).length;t<s&&"TERMINATOR"===d(r[e],1)[0];e=++t);if(0!==e){for(i=0,a=(o=this.tokens.slice(0,e)).length;i<a;i++)n=o[i],C(n,this.tokens[e]);return this.tokens.splice(0,e)}}},{key:"closeOpenCalls",value:function(){var e,t;return t=function(e){var t;return")"===(t=e[0])||"CALL_END"===t},e=function(e){return e[0]="CALL_END"},this.scanTokens((function(i,n){return"CALL_START"===i[0]&&this.detectEnd(n+1,t,e),1}))}},{key:"closeOpenIndexes",value:function(){var e,t,i;return i=null,t=function(e){var t;return"]"===(t=e[0])||"INDEX_END"===t},e=function(e,t){return this.tokens.length>=t&&":"===this.tokens[t+1][0]?(i[0]="[",e[0]="]"):e[0]="INDEX_END"},this.scanTokens((function(n,s){return"INDEX_START"===n[0]&&(i=n,this.detectEnd(s+1,t,e)),1}))}},{key:"indexOfTag",value:function(e){var t,i,n,s,a;t=0;for(var r=arguments.length,o=Array(1<r?r-1:0),l=1;l<r;l++)o[l-1]=arguments[l];for(i=n=0,s=o.length;0<=s?n<s:n>s;i=0<=s?++n:--n)if(null!=o[i]&&("string"==typeof o[i]&&(o[i]=[o[i]]),a=this.tag(e+i+t),0>I.call(o[i],a)))return-1;return e+i+t-1}},{key:"looksObjectish",value:function(e){var t,i;return-1!==this.indexOfTag(e,"@",null,":")||-1!==this.indexOfTag(e,null,":")||!(-1===(i=this.indexOfTag(e,l))||(t=null,this.detectEnd(i+1,(function(e){var t;return t=e[0],0<=I.call(o,t)}),(function(e,i){return t=i})),":"!==this.tag(t+1)))}},{key:"findTagsBackwards",value:function(e,t){var i,n,s,a,r,c,h;for(i=[];0<=e&&(i.length||(a=this.tag(e),0>I.call(t,a)&&(r=this.tag(e),0>I.call(l,r)||this.tokens[e].generated)&&(c=this.tag(e),0>I.call(v,c))));)n=this.tag(e),0<=I.call(o,n)&&i.push(this.tag(e)),s=this.tag(e),0<=I.call(l,s)&&i.length&&i.pop(),e-=1;return h=this.tag(e),0<=I.call(t,h)}},{key:"addImplicitBracesAndParens",value:function(){var e,t;return e=[],t=null,this.scanTokens((function(s,a,r){var m,f,g,b,y,w,x,T,N,A,C,L,S,D,j,O,R,_,P,M,F,V,$,B,H,U,W,q,z,X,G,J,Y,K,Q,Z,ee,te,ie=this;te=d(s,1)[0];var ne=d(F=0<a?r[a-1]:[],1);if(M=ne[0],O=d(R=a<r.length-1?r[a+1]:[],1)[0],G=function(){return e[e.length-1]},J=a,g=function(e){return a-J+e},C=function(e){var t;return null==e||null==(t=e[2])?void 0:t.ours},S=function(e){return C(e)&&"{"===(null==e?void 0:e[0])},L=function(e){return C(e)&&"("===(null==e?void 0:e[0])},x=function(){return C(G())},A=function(){return S(G())},N=function(){var e;return x()&&"CONTROL"===(null==(e=G())?void 0:e[0])},Y=function(t){return e.push(["(",t,{ours:!0}]),r.splice(t,0,E("CALL_START","(",["","implicit function call",s[2]],F))},m=function(){return e.pop(),r.splice(a,0,E("CALL_END",")",["","end of input",s[2]],F)),a+=1},K=function(t){var i,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},a=n.startsLine,o=n.continuationLineIndent;return e.push(["{",t,{sameLine:!0,startsLine:void 0===a||a,ours:!0,continuationLineIndent:o}]),(i=new String("{")).generated=!0,r.splice(t,0,E("{",i,s,F))},f=function(t){return t=null==t?a:t,e.pop(),r.splice(t,0,E("}","}",s,F)),a+=1},b=function(e){var t;return t=null,ie.detectEnd(e,(function(e){return"TERMINATOR"===e[0]}),(function(e,i){return t=i}),{returnOnNegativeLevel:!0}),null!=t&&ie.looksObjectish(t+1)},((T=function(){return L(G())})()||A())&&0<=I.call(n,te)||A()&&":"===M&&"FOR"===te)return e.push(["CONTROL",a,{ours:!0}]),g(1);if("INDENT"===te&&x()){if("=>"!==M&&"->"!==M&&"["!==M&&"("!==M&&","!==M&&"{"!==M&&"ELSE"!==M&&"="!==M)for(;T()||A()&&":"!==M;)T()?m():f();return N()&&e.pop(),e.push([te,a]),g(1)}if(0<=I.call(l,te))return e.push([te,a]),g(1);if(0<=I.call(o,te)){for(;x();)T()?m():A()?f():e.pop();t=e.pop()}if(w=function(){var e,t;return!!(ie.findTagsBackwards(a,["FOR"])&&ie.findTagsBackwards(a,["FORIN","FOROF","FORFROM"])||ie.findTagsBackwards(a,["WHILE","UNTIL","LOOP","LEADING_WHEN"]))&&(e=!1,t=s[2].first_line,ie.detectEnd(a,(function(e){var t;return t=e[0],0<=I.call(v,t)}),(function(i,n){var s,a=d(r[n-1]||[],3);return M=a[0],s=a[2].first_line,e=t===s&&("->"===M||"=>"===M)}),{returnOnNegativeLevel:!0}),e)},(0<=I.call(u,te)&&s.spaced||"?"===te&&0<a&&!r[a-1].spaced)&&(0<=I.call(c,O)||"..."===O&&(V=this.tag(a+2),0<=I.call(c,V))&&!this.findTagsBackwards(a,["INDEX_START","["])||0<=I.call(p,O)&&!R.spaced&&!R.newLine)&&!w())return"?"===te&&(te=s[0]="FUNC_EXIST"),Y(a+1),g(2);if(0<=I.call(u,te)&&-1<this.indexOfTag(a+1,"INDENT")&&this.looksObjectish(a+2)&&!this.findTagsBackwards(a,["CLASS","EXTENDS","IF","CATCH","SWITCH","LEADING_WHEN","FOR","WHILE","UNTIL"]))return Y(a+1),e.push(["INDENT",a+2]),g(3);if(":"===te){if(ee=0>=(U=function(){var e;switch(!1){case e=this.tag(a-1),0>I.call(o,e):var i=d(t,2);return Z=i[0],Q=i[1],"["===Z&&0<Q&&"@"===this.tag(Q-1)&&!r[Q-1].spaced?Q-1:Q;case"@"!==this.tag(a-2):return a-2;default:return a-1}}.call(this))||($=this.tag(U-1),0<=I.call(v,$))||r[U-1].newLine,G()){var se=d(G(),2);if(X=se[0],q=se[1],("{"===X||"INDENT"===X&&"{"===this.tag(q-1))&&(ee||","===this.tag(U-1)||"{"===this.tag(U-1))&&(B=this.tag(U-1),0>I.call(k,B)))return g(1)}return K(U,{startsLine:!!ee,continuationLineIndent:(1<a?r[a-2]:[]).continuationLineIndent}),g(2)}if(0<=I.call(v,te))for(D=e.length-1;0<=D&&(z=e[D],C(z));D+=-1)S(z)&&(z[2].sameLine=!1);if("TERMINATOR"===te&&s.endsContinuationLineIndentation)for(P=s.endsContinuationLineIndentation.preContinuationLineIndent;A()&&null!=(y=G()[2].continuationLineIndent)&&y>P;)f();if(j="OUTDENT"===M||F.newLine,0<=I.call(h,te)||0<=I.call(i,te)&&j||(".."===te||"..."===te)&&this.findTagsBackwards(a,["INDEX_START"]))for(;x();){var ae=d(G(),3);X=ae[0],q=ae[1];var re=ae[2];if(W=re.sameLine,ee=re.startsLine,T()&&","!==M||","===M&&"TERMINATOR"===te&&null==O)m();else if(A()&&W&&"TERMINATOR"!==te&&":"!==M&&("POST_IF"!==te&&"FOR"!==te&&"WHILE"!==te&&"UNTIL"!==te||!ee||!b(a+1)))f();else if(!A()||"TERMINATOR"!==te||","===M||ee&&this.looksObjectish(a+1)){if(!N()||"CLASS"!==r[G()[1]][0]||"TERMINATOR"!==te)break;e.pop()}else f()}if(","===te&&!this.looksObjectish(a+1)&&A()&&"FOROF"!==(H=this.tag(a+2))&&"FORIN"!==H&&("TERMINATOR"!==O||!this.looksObjectish(a+2)))for(_="OUTDENT"===O?1:0;A();)f(a+_);return g(1)}))}},{key:"enforceValidJSXAttributes",value:function(){return this.scanTokens((function(e,t,i){var n,s;return e.jsxColon&&"STRING_START"!==(s=(n=i[t+1])[0])&&"STRING"!==s&&"("!==s&&S("expected wrapped or quoted JSX attribute",n[2]),1}))}},{key:"rescueStowawayComments",value:function(){var e,t,i,n;return t=function(e,t,i,n){return"TERMINATOR"!==i[t][0]&&i[n](E("TERMINATOR","\n",i[t])),i[n](E("JS","",i[t],e))},e=function(e,t){var i,n;for(i=e+1;i!==t.length&&(n=t[i][0],0<=I.call(a,n));){if("INTERPOLATION_END"===t[i][0])return!0;i++}return!1},n=function(e,i,n){var s,r,o,l,c,h;for(s=i;s!==n.length&&(l=n[s][0],0<=I.call(a,l));)s++;if(!(s===n.length||(c=n[s][0],0<=I.call(a,c)))){for(r=0,o=(h=e.comments).length;r<o;r++)h[r].unshift=!0;return C(e,n[s]),1}return s=n.length-1,t(e,s,n,"push"),1},i=function(e,i,n){var s,r,o;for(s=i;-1!==s&&(r=n[s][0],0<=I.call(a,r));)s--;return-1===s||(o=n[s][0],0<=I.call(a,o))?(t(e,0,n,"unshift"),3):(C(e,n[s]),1)},this.scanTokens((function(t,s,r){var o,l,c,h,u;if(!t.comments)return 1;if(u=1,c=t[0],0<=I.call(a,c)){for(o={comments:[]},l=t.comments.length-1;-1!==l;)!1===t.comments[l].newLine&&!1===t.comments[l].here&&(o.comments.unshift(t.comments[l]),t.comments.splice(l,1)),l--;0!==o.comments.length&&(u=i(o,s-1,r)),0!==t.comments.length&&n(t,s,r)}else if(!e(s,r)){for(o={comments:[]},l=t.comments.length-1;-1!==l;)!t.comments[l].newLine||t.comments[l].unshift||"JS"===t[0]&&t.generated||(o.comments.unshift(t.comments[l]),t.comments.splice(l,1)),l--;0!==o.comments.length&&(u=n(o,s+1,r))}return 0===(null==(h=t.comments)?void 0:h.length)&&delete t.comments,u}))}},{key:"addLocationDataToGeneratedTokens",value:function(){return this.scanTokens((function(e,t,i){var n,s,a,r,o,l,c;if(e[2])return 1;if(!e.generated&&!e.explicit)return 1;if(e.fromThen&&"INDENT"===e[0])return e[2]=e.origin[2],1;if("{"===e[0]&&(a=null==(l=i[t+1])?void 0:l[2])){var h=a;s=h.first_line,n=h.first_column,o=d(h.range,1)[0]}else if(r=null==(c=i[t-1])?void 0:c[2]){var u=r;s=u.last_line,n=u.last_column,o=d(u.range,2)[1],n+=1}else s=n=0,o=0;return e[2]={first_line:s,first_column:n,last_line:s,last_column:n,last_line_exclusive:s,last_column_exclusive:n,range:[o,o]},1}))}},{key:"fixIndentationLocationData",value:function(){var e,t=this;return null==this.allComments&&(this.allComments=x(this.tokens)),e=function(e,i){var n,s,a,r,o,l,c,h,u=i.afterPosition,d=i.indentSize,p=i.first,m=i.indented;if(h=e[2].range[0],o=function(e){return(!e.outdented||null!=d&&e.indentSize>d)&&(!m||e.indented)&&!!(e.locationData.range[0]<h)&&!!(e.locationData.range[0]>u)},p){for(r=null,s=(l=t.allComments).length-1;0<=s;s+=-1)if(o(n=l[s]))r=n;else if(r)return r;return r}for(a=(c=t.allComments).length-1;0<=a;a+=-1)if(o(n=c[a]))return n;return null},this.scanTokens((function(t,i,n){var s,a,r,o,l,c,h,u,d;if("INDENT"!==(c=t[0])&&"OUTDENT"!==c&&(!t.generated||"CALL_END"!==t[0]||null!=(h=t.data)&&h.closingTagNameToken)&&(!t.generated||"}"!==t[0]))return 1;if(s="INDENT"===t[0],l=(null==(u=t.prevToken)?n[i-1]:u)[2],d=t.explicit||t.generated)for(a=t,r=i;(a.explicit||a.generated)&&r!==n.length-1;)a=n[r++];return o=e(d?a:t,{afterPosition:l.range[0],indentSize:t.indentSize,first:s,indented:d}),!s||null!=o&&o.newLine?(t.generated&&"CALL_END"===t[0]&&(null==o?void 0:o.indented)||(null!=o&&(l=o.locationData),t[2]={first_line:null==o?l.last_line:l.first_line,first_column:null==o?l.last_column:s?0:l.first_column,last_line:l.last_line,last_column:l.last_column,last_line_exclusive:l.last_line_exclusive,last_column_exclusive:l.last_column_exclusive,range:s&&null!=o?[l.range[0]-o.indentSize,l.range[1]]:l.range}),1):1}))}},{key:"normalizeLines",value:function(){var e,t,n,s,a,o,l,c,h,u=this;return h=a=c=null,l=null,o=null,s=[],n=function(e,t){var n,s,a,c;return";"!==e[1]&&(n=e[0],0<=I.call(b,n))&&!("TERMINATOR"===e[0]&&(s=this.tag(t+1),0<=I.call(r,s)))&&!("ELSE"===e[0]&&("THEN"!==h||o||l))&&("CATCH"!==(a=e[0])&&"FINALLY"!==a||"->"!==h&&"=>"!==h)||(c=e[0],0<=I.call(i,c)&&(this.tokens[t-1].newLine||"OUTDENT"===this.tokens[t-1][0]))},e=function(e,t){return"ELSE"===e[0]&&"THEN"===h&&s.pop(),this.tokens.splice(","===this.tag(t-1)?t-1:t,0,c)},t=function(e,t){var i,n,a;return 0<(a=s.length)?(i=s.pop(),(n=d(u.indentation(e[i]),2)[1])[1]=2*a,e.splice(t,0,n),n[1]=2,e.splice(t+1,0,n),u.detectEnd(t+2,(function(e){var t;return"OUTDENT"===(t=e[0])||"TERMINATOR"===t}),(function(t,i){if("OUTDENT"===this.tag(i)&&"OUTDENT"===this.tag(i+1))return e.splice(i,2)})),t+2):t},this.scanTokens((function(i,u,p){var m,f,v,g,b,k,x;if(m=("->"===(x=d(i,1)[0])||"=>"===x)&&this.findTagsBackwards(u,["IF","WHILE","FOR","UNTIL","SWITCH","WHEN","LEADING_WHEN","[","INDEX_START"])&&!this.findTagsBackwards(u,["THEN","..","..."]),"TERMINATOR"===x){if("ELSE"===this.tag(u+1)&&"OUTDENT"!==this.tag(u-1))return p.splice.apply(p,[u,1].concat(y(this.indentation()))),1;if(g=this.tag(u+1),0<=I.call(r,g))return";"===i[1]&&"OUTDENT"===this.tag(u+1)&&(p[u+1].prevToken=i,C(i,p[u+1])),p.splice(u,1),0}if("CATCH"===x)for(f=v=1;2>=v;f=++v)if("OUTDENT"===(b=this.tag(u+f))||"TERMINATOR"===b||"FINALLY"===b)return p.splice.apply(p,[u+f,0].concat(y(this.indentation()))),2+f;if(("->"===x||"=>"===x)&&(","===(k=this.tag(u+1))||"]"===k||"."===this.tag(u+1)&&i.newLine)){var E=d(this.indentation(p[u]),2);return a=E[0],c=E[1],p.splice(u+1,0,a,c),1}if(0<=I.call(w,x)&&"INDENT"!==this.tag(u+1)&&("ELSE"!==x||"IF"!==this.tag(u+1))&&!m){h=x;var T=d(this.indentation(p[u]),2);return a=T[0],c=T[1],"THEN"===h&&(a.fromThen=!0),"THEN"===x&&(l=this.findTagsBackwards(u,["LEADING_WHEN"])&&"IF"===this.tag(u+1),o=this.findTagsBackwards(u,["IF"])&&"IF"===this.tag(u+1)),"THEN"===x&&this.findTagsBackwards(u,["IF"])&&s.push(u),"ELSE"===x&&"OUTDENT"!==this.tag(u-1)&&(u=t(p,u)),p.splice(u+1,0,a),this.detectEnd(u+2,n,e),"THEN"===x&&p.splice(u,1),1}return 1}))}},{key:"tagPostfixConditionals",value:function(){var e,t,i;return i=null,t=function(e,t){var i,n;return n=d(e,1)[0],i=d(this.tokens[t-1],1)[0],"TERMINATOR"===n||"INDENT"===n&&0>I.call(w,i)},e=function(e){if("INDENT"!==e[0]||e.generated&&!e.fromThen)return i[0]="POST_"+i[0]},this.scanTokens((function(n,s){return"IF"===n[0]?(i=n,this.detectEnd(s+1,t,e),1):1}))}},{key:"exposeTokenDataToGrammar",value:function(){return this.scanTokens((function(e){var t,i,n,s;if(e.generated||e.data&&0!==Object.keys(e.data).length){for(t in e[1]=new String(e[1]),n=null==(i=e.data)?{}:i)D.call(n,t)&&(s=n[t],e[1][t]=s);e.generated&&(e[1].generated=!0)}return 1}))}},{key:"indentation",value:function(e){var t,i;return t=["INDENT",2],i=["OUTDENT",2],e?(t.generated=i.generated=!0,t.origin=i.origin=e):t.explicit=i.explicit=!0,[t,i]}},{key:"tag",value:function(e){var t;return null==(t=this.tokens[e])?void 0:t[0]}}]),e}();return e.prototype.generate=E,e}.call(this),t=[["(",")"],["[","]"],["{","}"],["INDENT","OUTDENT"],["CALL_START","CALL_END"],["PARAM_START","PARAM_END"],["INDEX_START","INDEX_END"],["STRING_START","STRING_END"],["INTERPOLATION_START","INTERPOLATION_END"],["REGEX_START","REGEX_END"]],e.INVERSES=m={},l=[],o=[],T=0,A=t.length;T<A;T++){var O=d(t[T],2);N=O[0],L=O[1],l.push(m[L]=N),o.push(m[N]=L)}r=["CATCH","THEN","ELSE","FINALLY"].concat(o),u=["IDENTIFIER","PROPERTY","SUPER",")","CALL_END","]","INDEX_END","@","THIS"],c=["IDENTIFIER","JSX_TAG","PROPERTY","NUMBER","INFINITY","NAN","STRING","STRING_START","REGEX","REGEX_START","JS","NEW","PARAM_START","CLASS","IF","TRY","SWITCH","THIS","UNDEFINED","NULL","BOOL","UNARY","DO","DO_IIFE","YIELD","AWAIT","UNARY_MATH","SUPER","THROW","@","->","=>","[","(","{","--","++"],w=["ELSE","->","=>","TRY","FINALLY","THEN"],b=["TERMINATOR","CATCH","FINALLY","ELSE","OUTDENT","LEADING_WHEN"],v=["TERMINATOR","INDENT","OUTDENT"],a=["(",")","[","]","{","}",":",".","..","...",",","=","++","--","?","AS","AWAIT","CALL_START","CALL_END","DEFAULT","DO","DO_IIFE","ELSE","EXTENDS","EXPORT","FORIN","FOROF","FORFROM","IMPORT","INDENT","INDEX_SOAK","INTERPOLATION_START","INTERPOLATION_END","LEADING_WHEN","OUTDENT","PARAM_END","REGEX_START","REGEX_END","RETURN","STRING_END","THROW","UNARY","YIELD"].concat((p=["+","-"]).concat((h=["POST_IF","FOR","WHILE","UNTIL","WHEN","BY","LOOP","TERMINATOR"]).concat((i=[".","?.","::","?::"]).concat(n=["IF","TRY","FINALLY","CATCH","CLASS","SWITCH"])))),e.UNFINISHED=k=["\\",".","?.","?::","UNARY","DO","DO_IIFE","MATH","UNARY_MATH","+","-","**","SHIFT","RELATION","COMPARE","&","^","|","&&","||","BIN?","EXTENDS"]}.call(this),{exports:e}.exports}(),s["./lexer"]=function(){var e={};return function(){var t,i,n,a,r,o,l,c,h,p,m,v,b,w,k,x,E,T,N,A,C,L,S,I,D,j,O,R,_,P,M,F,V,$,B,H,U,W,q,z,X,G,J,Y,K,Q,Z,ee,te,ie,ne,se,ae,re,oe,le,ce,he,ue,de,pe,me,fe,ve,ge,be,ye,we,ke=[].indexOf,xe=[].slice,Ee=s("./rewriter");Y=Ee.Rewriter,L=Ee.INVERSES,re=Ee.UNFINISHED;var Te=s("./helpers");ue=Te.count,Te.starts,Te.compact,Te.repeat,pe=Te.invertLiterate,ge=Te.merge,he=Te.attachCommentsToNode,Te.locationDataToString,we=Te.throwSyntaxError,ye=Te.replaceUnicodeCodePointEscapes,de=Te.flatten,be=Te.parseNumber,e.Lexer=function(){"use strict";function e(){f(this,e),this.error=this.error.bind(this)}return g(e,[{key:"tokenize",value:function(e){var t,i,n,s,a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};for(this.literate=a.literate,this.indent=0,this.baseIndent=0,this.continuationLineAdditionalIndent=0,this.outdebt=0,this.indents=[],this.indentLiteral="",this.ends=[],this.tokens=[],this.seenFor=!1,this.seenImport=!1,this.seenExport=!1,this.importSpecifierList=!1,this.exportSpecifierList=!1,this.jsxDepth=0,this.jsxObjAttribute={},this.chunkLine=a.line||0,this.chunkColumn=a.column||0,this.chunkOffset=a.offset||0,this.locationDataCompensations=a.locationDataCompensations||{},e=this.clean(e),n=0;this.chunk=e.slice(n);){t=this.identifierToken()||this.commentToken()||this.whitespaceToken()||this.lineToken()||this.stringToken()||this.numberToken()||this.jsxToken()||this.regexToken()||this.jsToken()||this.literalToken();var r=this.getLineAndColumnFromChunk(t),o=d(r,3);if(this.chunkLine=o[0],this.chunkColumn=o[1],this.chunkOffset=o[2],n+=t,a.untilBalanced&&0===this.ends.length)return{tokens:this.tokens,index:n}}return this.closeIndentation(),(i=this.ends.pop())&&this.error("missing ".concat(i.tag),(null==(s=i.origin)?i:s)[2]),!1===a.rewrite?this.tokens:(new Y).rewrite(this.tokens)}},{key:"clean",value:function(e){var i,n,s=this;return n=0,e.charCodeAt(0)===t&&(e=e.slice(1),this.locationDataCompensations[0]=1,n+=1),le.test(e)&&(e="\n".concat(e),this.chunkLine--,null==(i=this.locationDataCompensations)[0]&&(i[0]=0),this.locationDataCompensations[0]-=1),e=e.replace(/\r/g,(function(e,t){return s.locationDataCompensations[n+t]=1,""})).replace(ne,""),this.literate&&(e=pe(e)),e}},{key:"identifierToken",value:function(){var e,t,n,s,l,c,h,u,p,m,f,v,g,b,y,w,k,x,E,N,A,C,L,S,D,j,O,R,M;if(!(p=((h=this.atJSXTag())?I:T).exec(this.chunk)))return 0;var F=d(p,3);if(u=F[0],l=F[1],t=F[2],c=l.length,m=void 0,"own"===l&&"FOR"===this.tag())return this.token("OWN",l),l.length;if("from"===l&&"YIELD"===this.tag())return this.token("FROM",l),l.length;if("as"===l&&this.seenImport){if("*"===this.value())this.tokens[this.tokens.length-1][0]="IMPORT_ALL";else if(g=this.value(!0),0<=ke.call(o,g)){f=this.prev();var V=["IDENTIFIER",this.value(!0)];f[0]=V[0],f[1]=V[1]}if("DEFAULT"===(b=this.tag())||"IMPORT_ALL"===b||"IDENTIFIER"===b)return this.token("AS",l),l.length}if("as"===l&&this.seenExport){if("IDENTIFIER"===(x=this.tag())||"DEFAULT"===x)return this.token("AS",l),l.length;if(E=this.value(!0),0<=ke.call(o,E)){f=this.prev();var $=["IDENTIFIER",this.value(!0)];return f[0]=$[0],f[1]=$[1],this.token("AS",l),l.length}}if("default"===l&&this.seenExport&&("EXPORT"===(N=this.tag())||"AS"===N))return this.token("DEFAULT",l),l.length;if("do"===l&&(j=/^(\s*super)(?!\(\))/.exec(this.chunk.slice(3)))){this.token("SUPER","super"),this.token("CALL_START","("),this.token("CALL_END",")");var B=d(j,2);return u=B[0],B[1].length+3}if(f=this.prev(),M={},"IDENTIFIER"!=(O=t||null!=f&&("."===(A=f[0])||"?."===A||"::"===A||"?::"===A||!f.spaced&&"@"===f[0])?"PROPERTY":"IDENTIFIER")||!(0<=ke.call(_,l)||0<=ke.call(o,l))||this.exportSpecifierList&&0<=ke.call(o,l)?"IDENTIFIER"===O&&this.seenFor&&"from"===l&&me(f)?(O="FORFROM",this.seenFor=!1):"PROPERTY"===O&&f&&(f.spaced&&(D=f[0],0<=ke.call(i,D))&&/^[gs]et$/.test(f[1])&&1<this.tokens.length&&"."!==(y=this.tokens[this.tokens.length-2][0])&&"?."!==y&&"@"!==y?this.error("'".concat(f[1],"' cannot be used as a keyword, or as a function call without parentheses"),f[2]):"."===f[0]&&1<this.tokens.length&&"UNARY"===(v=this.tokens[this.tokens.length-2])[0]&&"new"===v[1]?v[0]="NEW_TARGET":2<this.tokens.length&&(v=this.tokens[this.tokens.length-2],("@"===(w=f[0])||"THIS"===w)&&v&&v.spaced&&/^[gs]et$/.test(v[1])&&"."!==(k=this.tokens[this.tokens.length-3][0])&&"?."!==k&&"@"!==k&&this.error("'".concat(v[1],"' cannot be used as a keyword, or as a function call without parentheses"),v[2]))):"WHEN"===(O=l.toUpperCase())&&(C=this.tag(),0<=ke.call(P,C))?O="LEADING_WHEN":"FOR"===O?this.seenFor={endsLength:this.ends.length}:"UNLESS"===O?O="IF":"IMPORT"===O?this.seenImport=!0:"EXPORT"===O?this.seenExport=!0:0<=ke.call(se,O)?O="UNARY":0<=ke.call(G,O)&&("INSTANCEOF"!==O&&this.seenFor?(O="FOR"+O,this.seenFor=!1):(O="RELATION","!"===this.value()&&(m=this.tokens.pop(),M.invert=null==(L=null==(S=m.data)?void 0:S.original)?m[1]:L))),"IDENTIFIER"===O&&0<=ke.call(J,l)&&!h&&this.error("reserved word '".concat(l,"'"),{length:l.length}),"PROPERTY"===O||this.exportSpecifierList||this.importSpecifierList||(0<=ke.call(a,l)&&(e=l,l=r[l],M.original=e),O="!"===l?"UNARY":"=="===l||"!="===l?"COMPARE":"true"===l||"false"===l?"BOOL":"break"===l||"continue"===l||"debugger"===l?"STATEMENT":"&&"===l||"||"===l?l:O),R=this.token(O,l,{length:c,data:M}),e&&(R.origin=[O,e,R[2]]),m){var H=[m[2].first_line,m[2].first_column,m[2].range[0]];R[2].first_line=H[0],R[2].first_column=H[1],R[2].range[0]=H[2]}return t&&(n=u.lastIndexOf(h?"=":":"),s=this.token(":",":",{offset:n}),h&&(s.jsxColon=!0)),h&&"IDENTIFIER"===O&&":"!==f[0]&&this.token(",",",",{length:0,origin:R,generated:!0}),u.length}},{key:"numberToken",value:function(){var e,t,i,n,s,a;if(!(t=B.exec(this.chunk)))return 0;switch(e=(i=t[0]).length,!1){case!/^0[BOX]/.test(i):this.error("radix prefix in '".concat(i,"' must be lowercase"),{offset:1});break;case!/^(?!0x).*E/.test(i):this.error("exponential notation in '".concat(i,"' must be indicated with a lowercase 'e'"),{offset:i.indexOf("E")});break;case!/^0\d*[89]/.test(i):this.error("decimal literal '".concat(i,"' must not be prefixed with '0'"),{length:e});break;case!/^0\d+/.test(i):this.error("octal literal '".concat(i,"' must be prefixed with '0o'"),{length:e})}return a={parsedValue:n=be(i)},"INFINITY"==(s=Infinity===n?"INFINITY":"NUMBER")&&(a.original=i),this.token(s,i,{length:e,data:a}),e}},{key:"stringToken",value:function(){var e,t,i,n,s,a,r,o,l,c,h,u,p=this,m=d(ie.exec(this.chunk)||[],1);if(!(o=m[0]))return 0;(r=this.prev())&&"from"===this.value()&&(this.seenImport||this.seenExport)&&(r[0]="FROM"),c="'"===o?te:'"'===o?Z:"'''"===o?w:'"""'===o?v:void 0;var f=this.matchWithInterpolations(c,o);if(u=f.tokens,i=f.index,3===o.length)for(s=null,t=function(){var e,t,i;for(i=[],n=e=0,t=u.length;e<t;n=++e)"NEOSTRING"===(h=u[n])[0]&&i.push(h[1]);return i}().join("#{}");a=b.exec(t);)e=a[1],(null===s||0<(l=e.length)&&l<s.length)&&(s=e);return o.charAt(0),this.mergeInterpolationTokens(u,{quote:o,indent:s,endOffset:i},(function(e){return p.validateUnicodeCodePointEscapes(e,{delimiter:o})})),this.atJSXTag()&&this.token(",",",",{length:0,origin:this.prev,generated:!0}),i}},{key:"commentToken",value:function(){var e,t,i,n,s,a,r,o,c,h,u,p,f,v,g,b,y,w,k,x,E,T,N,A,C,L=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.chunk,S=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},I=S.heregex,D=S.returnCommentTokens,j=S.offsetInChunk,O=void 0===j?0:j;if(!(w=L.match(l)))return 0;var R=w,_=d(R,5);return i=_[0],c=_[1],o=_[2],h=_[3],y=_[4],s=null,f=/^\s*\n+\s*#/.test(i),o?((k=m.exec(o))&&this.error("block comments cannot contain ".concat(k[0]),{offset:"###".length+k.index,length:k[0].length}),L=(L=L.replace("###".concat(o,"###"),"")).replace(/^\n+/,""),this.lineToken({chunk:L}),s=[{content:n=o,length:i.length-c.length-h.length,leadingWhitespace:c}]):(v="",n=y.replace(/^(\n*)/,(function(e){return v=e,""})),A="",r=!1,s=n.split("\n").map((function(e){var t,i;return-1<e.indexOf("#")?(i="",t={content:n=e.replace(/^([ |\t]*)#/,(function(e,t){return i=t,""})),length:"#".length+n.length,leadingWhitespace:"".concat(r?"":v).concat(A).concat(i),precededByBlankLine:!!A},r=!0,A="",t):void(A+="\n".concat(e))})).filter((function(e){return e}))),a=function(e){var t,i=e.leadingWhitespace,n=e.nonInitial;if(t=i.lastIndexOf("\n"),null==o&&n)null==t&&(t=-1);else if(!(-1<t))return null;return i.length-1-t},t=function(){var t,i,r;for(r=[],u=t=0,i=s.length;t<i;u=++t){var l=s[u];n=l.content,b=l.length,g=l.leadingWhitespace,N=l.precededByBlankLine,O+=((E=0!==u)?1:0)+g.length,p=a({leadingWhitespace:g,nonInitial:E}),x=null==p||-1===p,e={content:n,here:null!=o,newLine:f||E,locationData:this.makeLocationData({offsetInChunk:O,length:b}),precededByBlankLine:N,indentSize:p,indented:!x&&p>this.indent,outdented:!x&&p<this.indent},I&&(e.heregex=!0),O+=b,r.push(e)}return r}.call(this),(C=this.prev())?he(t,C):(t[0].newLine=!0,this.lineToken({chunk:this.chunk.slice(i.length),offset:i.length}),(T=this.makeToken("JS","",{offset:i.length,generated:!0})).comments=t,this.tokens.push(T),this.newlineToken(i.length)),void 0!==D&&D?t:i.length}},{key:"jsToken",value:function(){var e,t,i,n;return"`"===this.chunk.charAt(0)&&(t=(i=E.exec(this.chunk))||S.exec(this.chunk))?(n=t[1],e=t[0].length,this.token("JS",n,{length:e,data:{here:!!i}}),e):0}},{key:"regexToken",value:function(){var e,t,n,s,a,r,o,l,c,h,u,p,m,f,v,g,b,y,w,E,T=this;switch(!1){case!(m=z.exec(this.chunk)):this.error("regular expressions cannot begin with ".concat(m[2]),{offset:m.index+m[1].length});break;case!(m=this.matchWithInterpolations(k,"///")):var N=m;for(E=N.tokens,u=N.index,o=[];f=x.exec(this.chunk.slice(0,u));){s=f.index;var A=d(f,3);A[0],p=A[1],n=A[2],o.push({comment:n,offsetInChunk:s+p.length})}r=de(function(){var e,t,i;for(i=[],e=0,t=o.length;e<t;e++)a=o[e],i.push(this.commentToken(a.comment,Object.assign(a,{heregex:!0,returnCommentTokens:!0})));return i}.call(this));break;case!(m=W.exec(this.chunk)):var C=d(m,3);if(w=C[0],e=C[1],t=C[2],this.validateEscapes(e,{isRegex:!0,offsetInChunk:1}),u=w.length,g=this.prev())if(g.spaced&&(b=g[0],0<=ke.call(i,b))){if(!t||U.test(w))return 0}else if(y=g[0],0<=ke.call($,y))return 0;t||this.error("missing / (unclosed regex)");break;default:return 0}switch(c=u+(h=d(q.exec(this.chunk.slice(u)),1)[0]).length,v=this.makeToken("REGEX",null,{length:c}),!1){case!!oe.test(h):this.error("invalid regular expression flags ".concat(h),{offset:u,length:h.length});break;case!(w||1===E.length):l=e?"/":"///",null==e&&(e=E[0][1]),this.validateUnicodeCodePointEscapes(e,{delimiter:l}),this.token("REGEX","/".concat(e,"/").concat(h),{length:c,origin:v,data:{delimiter:l}});break;default:this.token("REGEX_START","(",{length:0,origin:v,generated:!0}),this.token("IDENTIFIER","RegExp",{length:0,generated:!0}),this.token("CALL_START","(",{length:0,generated:!0}),this.mergeInterpolationTokens(E,{double:!0,heregex:{flags:h},endOffset:c-h.length,quote:"///"},(function(e){return T.validateUnicodeCodePointEscapes(e,{delimiter:l})})),h&&(this.token(",",",",{offset:u-1,length:0,generated:!0}),this.token("STRING",'"'+h+'"',{offset:u,length:h.length})),this.token(")",")",{offset:c,length:0,generated:!0}),this.token("REGEX_END",")",{offset:c,length:0,generated:!0})}return(null==r?void 0:r.length)&&ce(this.tokens[this.tokens.length-1],{heregexCommentTokens:r}),c}},{key:"lineToken",value:function(){var e,t,i,n,s,a,r,o,l,c,h,u=Math.min,d=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},p=d.chunk,m=void 0===p?this.chunk:p,f=d.offset,v=void 0===f?0:f;if(!(s=V.exec(m)))return 0;if(n=s[0],((e="\\"===(null==(l=this.prev())?void 0:l[0]))||(null==(c=this.seenFor)?void 0:c.endsLength)<this.ends.length)&&this.seenFor||(this.seenFor=!1),e&&this.seenImport||this.importSpecifierList||(this.seenImport=!1),e&&this.seenExport||this.exportSpecifierList||(this.seenExport=!1),h=n.length-1-n.lastIndexOf("\n"),o=this.unfinished(),r=0<h?n.slice(-h):"",!/^(.?)\1*$/.exec(r))return this.error("mixed indentation",{offset:n.length}),n.length;if(a=u(r.length,this.indentLiteral.length),r.slice(0,a)!==this.indentLiteral.slice(0,a))return this.error("indentation mismatch",{offset:n.length}),n.length;if(h-this.continuationLineAdditionalIndent===this.indent)return o?this.suppressNewlines():this.newlineToken(v),n.length;if(h>this.indent){if(o)return e||(this.continuationLineAdditionalIndent=h-this.indent),this.continuationLineAdditionalIndent&&(l.continuationLineIndent=this.indent+this.continuationLineAdditionalIndent),this.suppressNewlines(),n.length;if(!this.tokens.length)return this.baseIndent=this.indent=h,this.indentLiteral=r,n.length;t=h-this.indent+this.outdebt,this.token("INDENT",t,{offset:v+n.length-h,length:h}),this.indents.push(t),this.ends.push({tag:"OUTDENT"}),this.outdebt=this.continuationLineAdditionalIndent=0,this.indent=h,this.indentLiteral=r}else h<this.baseIndent?this.error("missing indentation",{offset:v+n.length}):(i=0<this.continuationLineAdditionalIndent,this.continuationLineAdditionalIndent=0,this.outdentToken({moveOut:this.indent-h,noNewlines:o,outdentLength:n.length,offset:v,indentSize:h,endsContinuationLineIndentation:i}));return n.length}},{key:"outdentToken",value:function(e){var t,i,n,s,a=e.moveOut,r=e.noNewlines,o=e.outdentLength,l=void 0===o?0:o,c=e.offset,h=void 0===c?0:c,u=e.indentSize,d=e.endsContinuationLineIndentation;for(t=this.indent-a;0<a;)this.indents[this.indents.length-1]?this.outdebt&&a<=this.outdebt?(this.outdebt-=a,a=0):(i=this.indents.pop()+this.outdebt,l&&(n=this.chunk[l],0<=ke.call(N,n))&&(t-=i-a,a=i),this.outdebt=0,this.pair("OUTDENT"),this.token("OUTDENT",a,{length:l,indentSize:u+a-i}),a-=i):this.outdebt=a=0;return i&&(this.outdebt-=a),this.suppressSemicolons(),"TERMINATOR"===this.tag()||r||(s=this.token("TERMINATOR","\n",{offset:h+l,length:0}),d&&(s.endsContinuationLineIndentation={preContinuationLineIndent:this.indent})),this.indent=t,this.indentLiteral=this.indentLiteral.slice(0,t),this}},{key:"whitespaceToken",value:function(){var e,t;return(e=le.exec(this.chunk))||"\n"===this.chunk.charAt(0)?((t=this.prev())&&(t[e?"spaced":"newLine"]=!0),e?e[0].length:0):0}},{key:"newlineToken",value:function(e){return this.suppressSemicolons(),"TERMINATOR"!==this.tag()&&this.token("TERMINATOR","\n",{offset:e,length:0}),this}},{key:"suppressNewlines",value:function(){var e;return"\\"===(e=this.prev())[1]&&(e.comments&&1<this.tokens.length&&he(e.comments,this.tokens[this.tokens.length-2]),this.tokens.pop()),this}},{key:"jsxToken",value:function(){var e,t,i,n,s,a,r,o,l,h,p,m,f,v,g,b,y,w,k,x,E,T=this;if(n=this.chunk[0],g=0<this.tokens.length?this.tokens[this.tokens.length-1][0]:"","<"===n){if(!(p=j.exec(this.chunk.slice(1))||D.exec(this.chunk.slice(1)))||!(0<this.jsxDepth||!(v=this.prev())||v.spaced||(w=v[0],0>ke.call(c,w))))return 0;var N=d(p,2);if(N[0],s=r=N[1],0<=ke.call(r,".")){var A=u(r.split("."));r=A[0],b=A.slice(1)}else b=[];for(k=this.token("JSX_TAG",r,{length:r.length+1,data:{openingBracketToken:this.makeToken("<","<"),tagNameToken:this.makeToken("IDENTIFIER",r,{offset:1})}}),m=r.length+1,o=0,h=b.length;o<h;o++)y=b[o],this.token(".",".",{offset:m}),m+=1,this.token("PROPERTY",y,{offset:m}),m+=y.length;return this.token("CALL_START","(",{generated:!0}),this.token("[","[",{generated:!0}),this.ends.push({tag:"/>",origin:k,name:r,properties:b}),this.jsxDepth++,s.length+1}if(l=this.atJSXTag()){if("/>"===this.chunk.slice(0,2))return this.pair("/>"),this.token("]","]",{length:2,generated:!0}),this.token("CALL_END",")",{length:2,generated:!0,data:{selfClosingSlashToken:this.makeToken("/","/"),closingBracketToken:this.makeToken(">",">",{offset:1})}}),this.jsxDepth--,2;if("{"===n)return":"===g?(x=this.token("(","{"),this.jsxObjAttribute[this.jsxDepth]=!1,ce(this.tokens[this.tokens.length-3],{jsx:!0})):(x=this.token("{","{"),this.jsxObjAttribute[this.jsxDepth]=!0),this.ends.push({tag:"}",origin:x}),1;if(">"===n){f=this.pair("/>").origin,this.token("]","]",{generated:!0,data:{closingBracketToken:this.makeToken(">",">")}}),this.token(",","JSX_COMMA",{generated:!0});var L=this.matchWithInterpolations(C,">","</",R);return E=L.tokens,t=L.index,this.mergeInterpolationTokens(E,{endOffset:t,jsx:!0},(function(e){return T.validateUnicodeCodePointEscapes(e,{delimiter:">"})})),(p=j.exec(this.chunk.slice(t))||D.exec(this.chunk.slice(t)))&&p[1]==="".concat(l.name).concat(function(){var e,t,i,n;for(n=[],e=0,t=(i=l.properties).length;e<t;e++)y=i[e],n.push(".".concat(y));return n}().join(""))||this.error("expected corresponding JSX closing tag for ".concat(l.name),l.origin.data.tagNameToken[2]),e=t+(a=d(p,2)[1]).length,">"!==this.chunk[e]&&this.error("missing closing > after tag name",{offset:e,length:1}),i=this.token("CALL_END",")",{offset:t-2,length:a.length+3,generated:!0,data:{closingTagOpeningBracketToken:this.makeToken("<","<",{offset:t-2}),closingTagSlashToken:this.makeToken("/","/",{offset:t-1}),closingTagNameToken:this.makeToken("IDENTIFIER",a,{offset:t}),closingTagClosingBracketToken:this.makeToken(">",">",{offset:t+a.length})}}),ce(f,i.data),this.jsxDepth--,e+1}return 0}return this.atJSXTag(1)&&"}"===n?(this.pair(n),this.jsxObjAttribute[this.jsxDepth]?(this.token("}","}"),this.jsxObjAttribute[this.jsxDepth]=!1):this.token(")","}"),this.token(",",",",{generated:!0}),1):0}},{key:"atJSXTag",value:function(){var e,t,i,n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;if(0===this.jsxDepth)return!1;for(e=this.ends.length-1;"OUTDENT"===(null==(i=this.ends[e])?void 0:i.tag)||0<n--;)e--;return"/>"===(null==(t=this.ends[e])?void 0:t.tag)&&t}},{key:"literalToken",value:function(){var e,t,s,a,r,o,l,c,u,m,f,v,g,b;if((e=H.exec(this.chunk))?(b=d(e,1)[0],n.test(b)&&this.tagParameters()):b=this.chunk.charAt(0),v=b,(a=this.prev())&&0<=ke.call(["="].concat(y(p)),b)&&(f=!1,"="!==b||"||"!==(r=a[1])&&"&&"!==r||a.spaced||(a[0]="COMPOUND_ASSIGN",a[1]+="=",(null==(o=a.data)?void 0:o.original)&&(a.data.original+="="),a[2].range=[a[2].range[0],a[2].range[1]+1],a[2].last_column+=1,a[2].last_column_exclusive+=1,a=this.tokens[this.tokens.length-2],f=!0),a&&"PROPERTY"!==a[0]&&(s=null==(l=a.origin)?a:l,(t=fe(a[1],s[1]))&&this.error(t,s[2])),f))return b.length;if("("===b&&"IMPORT"===(null==a?void 0:a[0])&&(a[0]="DYNAMIC_IMPORT"),"{"===b&&this.seenImport?this.importSpecifierList=!0:this.importSpecifierList&&"}"===b?this.importSpecifierList=!1:"{"===b&&"EXPORT"===(null==a?void 0:a[0])?this.exportSpecifierList=!0:this.exportSpecifierList&&"}"===b&&(this.exportSpecifierList=!1),";"===b)c=null==a?void 0:a[0],0<=ke.call(["="].concat(y(re)),c)&&this.error("unexpected ;"),this.seenFor=this.seenImport=this.seenExport=!1,v="TERMINATOR";else if("*"===b&&"EXPORT"===(null==a?void 0:a[0]))v="EXPORT_ALL";else if(0<=ke.call(F,b))v="MATH";else if(0<=ke.call(h,b))v="COMPARE";else if(0<=ke.call(p,b))v="COMPOUND_ASSIGN";else if(0<=ke.call(se,b))v="UNARY";else if(0<=ke.call(ae,b))v="UNARY_MATH";else if(0<=ke.call(K,b))v="SHIFT";else if("?"===b&&(null==a?void 0:a.spaced))v="BIN?";else if(a)if("("===b&&!a.spaced&&(u=a[0],0<=ke.call(i,u)))"?"===a[0]&&(a[0]="FUNC_EXIST"),v="CALL_START";else if("["===b&&(m=a[0],0<=ke.call(A,m)&&!a.spaced||"::"===a[0]))switch(v="INDEX_START",a[0]){case"?":a[0]="INDEX_SOAK"}return g=this.makeToken(v,b),"("===b||"{"===b||"["===b?this.ends.push({tag:L[b],origin:g}):(")"===b||"}"===b||"]"===b)&&this.pair(b),this.tokens.push(this.makeToken(v,b)),b.length}},{key:"tagParameters",value:function(){var e,t,i,n,s;if(")"!==this.tag())return this.tagDoIife();for(i=[],e=(s=this.tokens).length,(t=s[--e])[0]="PARAM_END";n=s[--e];)switch(n[0]){case")":i.push(n);break;case"(":case"CALL_START":if(!i.length)return"("===n[0]?(n[0]="PARAM_START",this.tagDoIife(e-1)):(t[0]="CALL_END",this);i.pop()}return this}},{key:"tagDoIife",value:function(e){var t;return"DO"!==(null==(t=this.tokens[null==e?this.tokens.length-1:e])?void 0:t[0])||(t[0]="DO_IIFE"),this}},{key:"closeIndentation",value:function(){return this.outdentToken({moveOut:this.indent,indentSize:0})}},{key:"matchWithInterpolations",value:function(t,i){var n,s,a,r,o,l,c,h,u,p,m,f,v,g,b,w,k,x=2<arguments.length&&void 0!==arguments[2]?arguments[2]:i,E=3<arguments.length&&void 0!==arguments[3]?arguments[3]:/^#\{/;if(k=[],p=i.length,this.chunk.slice(0,p)!==i)return null;for(b=this.chunk.slice(p);;){var T=t.exec(b),N=d(T,1);if(w=N[0],this.validateEscapes(w,{isRegex:"/"===i.charAt(0),offsetInChunk:p}),k.push(this.makeToken("NEOSTRING",w,{offset:p})),b=b.slice(w.length),p+=w.length,!(c=E.exec(b)))break;var A=c,C=d(A,1);o=C[0].length-1;var L=this.getLineAndColumnFromChunk(p+o),S=d(L,3);l=S[0],a=S[1],u=S[2],g=b.slice(o);var I=(new e).tokenize(g,{line:l,column:a,offset:u,untilBalanced:!0,locationDataCompensations:this.locationDataCompensations});h=I.tokens,r=I.index,(n="}"===b[(r+=o)-1])&&(m=d(h,1)[0],s=d(xe.call(h,-1),1)[0],m[0]="INTERPOLATION_START",m[1]="(",m[2].first_column-=o,m[2].range=[m[2].range[0]-o,m[2].range[1]],s[0]="INTERPOLATION_END",s[1]=")",s.origin=["","end of interpolation",s[2]]),"TERMINATOR"===(null==(f=h[1])?void 0:f[0])&&h.splice(1,1),"INDENT"===(null==(v=h[h.length-3])?void 0:v[0])&&"OUTDENT"===h[h.length-2][0]&&h.splice(-3,2),n||(m=this.makeToken("INTERPOLATION_START","(",{offset:p,length:0,generated:!0}),s=this.makeToken("INTERPOLATION_END",")",{offset:p+r,length:0,generated:!0}),h=[m].concat(y(h),[s])),k.push(["TOKENS",h]),b=b.slice(r),p+=r}return b.slice(0,x.length)!==x&&this.error("missing ".concat(x),{length:i.length}),{tokens:k,index:p+x.length}}},{key:"mergeInterpolationTokens",value:function(e,t,i){var n,s,a,r,o,l,c,h,u,p,m,f,v,g,b,w,k,x,E,T,N,A,C;for(w=t.quote,c=t.indent,a=t.double,o=t.heregex,r=t.endOffset,u=t.jsx,1<e.length&&(g=this.token("STRING_START","(",{length:null==(k=null==w?void 0:w.length)?0:k,data:{quote:w},generated:null==w||!w.length})),this.tokens.length,n=e.length-1,l=h=0,f=e.length;h<f;l=++h){var L,S=d(T=e[l],2);switch(E=S[0],C=S[1],E){case"TOKENS":if(2===C.length&&(C[0].comments||C[1].comments)){for((b=this.makeToken("JS","",{generated:!0}))[2]=C[0][2],p=0,v=C.length;p<v;p++){var I;(A=C[p]).comments&&(null==b.comments&&(b.comments=[]),(I=b.comments).push.apply(I,y(A.comments)))}C.splice(1,0,b)}C[0],N=C;break;case"NEOSTRING":s=i.call(this,T[1],l),0===l&&ce(T,{initialChunk:!0}),l===n&&ce(T,{finalChunk:!0}),ce(T,{indent:c,quote:w,double:a}),o&&ce(T,{heregex:o}),u&&ce(T,{jsx:u}),T[0]="STRING",T[1]='"'+s+'"',1===e.length&&null!=w&&(T[2].first_column-=w.length,"\n"===T[1].substr(-2,1)?(T[2].last_line+=1,T[2].last_column=w.length-1):(T[2].last_column+=w.length,2===T[1].length&&(T[2].last_column-=1)),T[2].last_column_exclusive+=w.length,T[2].range=[T[2].range[0]-w.length,T[2].range[1]+w.length]),N=[T]}(L=this.tokens).push.apply(L,y(N))}if(g)return m=d(xe.call(e,-1),1)[0],g.origin=["STRING",null,{first_line:g[2].first_line,first_column:g[2].first_column,last_line:m[2].last_line,last_column:m[2].last_column,last_line_exclusive:m[2].last_line_exclusive,last_column_exclusive:m[2].last_column_exclusive,range:[g[2].range[0],m[2].range[1]]}],(null==w?void 0:w.length)||(g[2]=g.origin[2]),this.token("STRING_END",")",{offset:r-(null==w?"":w).length,length:null==(x=null==w?void 0:w.length)?0:x,generated:null==w||!w.length})}},{key:"pair",value:function(e){var t,i,n,s,a;return n=this.ends,e!==(a=null==(i=d(xe.call(n,-1),1)[0])?void 0:i.tag)?("OUTDENT"!==a&&this.error("unmatched ".concat(e)),s=this.indents,t=d(xe.call(s,-1),1)[0],this.outdentToken({moveOut:t,noNewlines:!0}),this.pair(e)):this.ends.pop()}},{key:"getLocationDataCompensation",value:function(e,t){var i,n,s,a;for(a=0,s=t,n=e;n<=t&&(n!==t||e===s);)null!=(i=this.locationDataCompensations[n])&&(a+=i,t+=i),n++;return a}},{key:"getLineAndColumnFromChunk",value:function(e){var t,i,n,s,a,r,o;return n=this.getLocationDataCompensation(this.chunkOffset,this.chunkOffset+e),0===e?[this.chunkLine,this.chunkColumn+n,this.chunkOffset+n]:(o=e>=this.chunk.length?this.chunk:this.chunk.slice(0,+(e-1)+1||9e9),s=ue(o,"\n"),t=this.chunkColumn,0<s?(r=o.split("\n"),t=d(xe.call(r,-1),1)[0].length,0>(a=this.getLocationDataCompensation(this.chunkOffset,this.chunkOffset+e-t))&&(a=0),i=this.getLocationDataCompensation(this.chunkOffset+e+a-t,this.chunkOffset+e+a)):(t+=o.length,i=n),[this.chunkLine+s,t+i,this.chunkOffset+e+n])}},{key:"makeLocationData",value:function(e){var t,i,n,s=e.offsetInChunk,a=e.length;n={range:[]};var r=d(this.getLineAndColumnFromChunk(s),3);n.first_line=r[0],n.first_column=r[1],n.range[0]=r[2],i=0<a?a-1:0;var o=d(this.getLineAndColumnFromChunk(s+i),3);n.last_line=o[0],n.last_column=o[1],t=o[2];var l=d(this.getLineAndColumnFromChunk(s+i+(0<a?1:0)),2);return n.last_line_exclusive=l[0],n.last_column_exclusive=l[1],n.range[1]=0<a?t+1:t,n}},{key:"makeToken",value:function(e,t){var i,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},s=n.offset,a=void 0===s?0:s,r=n.length,o=void 0===r?t.length:r,l=n.origin,c=n.generated,h=n.indentSize;return i=[e,t,this.makeLocationData({offsetInChunk:a,length:o})],l&&(i.origin=l),c&&(i.generated=!0),null!=h&&(i.indentSize=h),i}},{key:"token",value:function(e,t){var i,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},s=n.offset,a=n.length,r=n.origin,o=n.data,l=n.generated,c=n.indentSize;return i=this.makeToken(e,t,{offset:s,length:a,origin:r,generated:l,indentSize:c}),o&&ce(i,o),this.tokens.push(i),i}},{key:"tag",value:function(){var e,t;return e=this.tokens,null==(t=d(xe.call(e,-1),1)[0])?void 0:t[0]}},{key:"value",value:function(){var e,t,i=!!(0<arguments.length&&void 0!==arguments[0])&&arguments[0];return e=this.tokens,t=d(xe.call(e,-1),1)[0],i&&null!=(null==t?void 0:t.origin)?t.origin[1]:null==t?void 0:t[1]}},{key:"prev",value:function(){return this.tokens[this.tokens.length-1]}},{key:"unfinished",value:function(){var e;return M.test(this.chunk)||(e=this.tag(),0<=ke.call(re,e))}},{key:"validateUnicodeCodePointEscapes",value:function(e,t){return ye(e,ge(t,{error:this.error}))}},{key:"validateEscapes",value:function(e){var t,i,n,s,a,r,o,l,c,h=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(s=(h.isRegex?X:ee).exec(e))return s[0],t=s[1],r=s[2],i=s[3],c=s[4],l=s[5],a=r?"octal escape sequences are not allowed":"invalid escape sequence",n="\\".concat(r||i||c||l),this.error("".concat(a," ").concat(n),{offset:(null==(o=h.offsetInChunk)?0:o)+s.index+t.length,length:n.length})}},{key:"suppressSemicolons",value:function(){var e,t,i;for(i=[];";"===this.value();)this.tokens.pop(),e=null==(t=this.prev())?void 0:t[0],0<=ke.call(["="].concat(y(re)),e)?i.push(this.error("unexpected ;")):i.push(void 0);return i}},{key:"error",value:function(e){var t,i,n,s,a,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return n="first_line"in r?r:{first_line:(t=d(this.getLineAndColumnFromChunk(null==(s=r.offset)?0:s),2))[0],first_column:i=t[1],last_column:i+(null==(a=r.length)?1:a)-1},we(e,n)}}]),e}(),fe=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:e;switch(!1){case 0>ke.call([].concat(y(_),y(o)),e):return"keyword '".concat(t,"' can't be assigned");case 0>ke.call(Q,e):return"'".concat(t,"' can't be assigned");case 0>ke.call(J,e):return"reserved word '".concat(t,"' can't be assigned");default:return!1}},e.isUnassignable=fe,me=function(e){var t;return"IDENTIFIER"===e[0]||"FOR"!==e[0]&&"{"!==(t=e[1])&&"["!==t&&","!==t&&":"!==t},ce=function(e,t){return Object.assign(null==e.data?e.data={}:e.data,t)},_=["true","false","null","this","new","delete","typeof","in","instanceof","return","throw","break","continue","debugger","yield","await","if","else","switch","for","while","do","try","catch","finally","class","extends","super","import","export","default"],o=["undefined","Infinity","NaN","then","unless","until","loop","of","by","when"],r={and:"&&",or:"||",is:"==",isnt:"!=",not:"!",yes:"true",no:"false",on:"true",off:"false"},a=function(){var e;for(ve in e=[],r)e.push(ve);return e}(),o=o.concat(a),J=["case","function","var","void","with","const","let","enum","native","implements","interface","package","private","protected","public","static"],Q=["arguments","eval"],e.JS_FORBIDDEN=_.concat(J).concat(Q),t=65279,T=/^(?!\d)((?:(?!\s)[$\w\x7f-\uffff])+)([^\n\S]*:(?!:))?/,O=/(?:(?!\s)[\-$\w\x7f-\uffff])+/.source,j=RegExp("^(?![\\d<])(".concat(O,"(?:\\s*:\\s*").concat(O,"|(?:\\s*\\.\\s*").concat(O,")+)?)")),D=/^()>/,I=RegExp("^(?!\\d)(".concat(O,"(?:\\s*:\\s*").concat(O,")?)([^\\S]*=(?!=))?")),B=/^0b[01](?:_?[01])*n?|^0o[0-7](?:_?[0-7])*n?|^0x[\da-f](?:_?[\da-f])*n?|^\d+n|^(?:\d(?:_?\d)*)?\.?(?:\d(?:_?\d)*)+(?:e[+-]?(?:\d(?:_?\d)*)+)?/i,H=/^(?:[-=]>|[-+*\/%<>&|^!?=]=|>>>=?|([-+:])\1|([&|<>*\/%])\2=?|\?(\.|::)|\.{2,3})/,le=/^[^\n\S]+/,l=/^(\s*)###([^#][\s\S]*?)(?:###([^\n\S]*)|###$)|^((?:\s*#(?!##[^#]).*)+)/,n=/^[-=]>/,V=/^(?:\n[^\n\S]*)+/,S=/^`(?!``)((?:[^`\\]|\\[\s\S])*)`/,E=/^```((?:[^`\\]|\\[\s\S]|`(?!``))*)```/,ie=/^(?:'''|"""|'|")/,te=/^(?:[^\\']|\\[\s\S])*/,Z=/^(?:[^\\"#]|\\[\s\S]|\#(?!\{))*/,w=/^(?:[^\\']|\\[\s\S]|'(?!''))*/,v=/^(?:[^\\"#]|\\[\s\S]|"(?!"")|\#(?!\{))*/,C=/^(?:[^\{<])*/,R=/^(?:\{|<(?!\/))/,b=/\n+([^\n\S]*)(?=\S)/g,W=/^\/(?!\/)((?:[^[\/\n\\]|\\[^\n]|\[(?:\\[^\n]|[^\]\n\\])*\])*)(\/)?/,q=/^\w*/,oe=/^(?!.*(.).*\1)[gimsuy]*$/,k=/^(?:[^\\\/#\s]|\\[\s\S]|\/(?!\/\/)|\#(?!\{)|\s+(?:#(?!\{).*)?)*/,x=/(\s+)(#(?!{).*)/gm,z=/^(\/|\/{3}\s*)(\*)/,U=/^\/=?\s/,m=/\*\//,M=/^\s*(?:,|\??\.(?![.\d])|\??::)/,ee=/((?:^|[^\\])(?:\\\\)*)\\(?:(0\d|[1-7])|(x(?![\da-fA-F]{2}).{0,2})|(u\{(?![\da-fA-F]{1,}\})[^}]*\}?)|(u(?!\{|[\da-fA-F]{4}).{0,4}))/,X=/((?:^|[^\\])(?:\\\\)*)\\(?:(0\d)|(x(?![\da-fA-F]{2}).{0,2})|(u\{(?![\da-fA-F]{1,}\})[^}]*\}?)|(u(?!\{|[\da-fA-F]{4}).{0,4}))/,ne=/\s+$/,p=["-=","+=","/=","*=","%=","||=","&&=","?=","<<=",">>=",">>>=","&=","^=","|=","**=","//=","%%="],se=["NEW","TYPEOF","DELETE"],ae=["!","~"],K=["<<",">>",">>>"],h=["==","!=","<",">","<=",">="],F=["*","/","%","//","%%"],G=["IN","OF","INSTANCEOF"],A=(i=["IDENTIFIER","PROPERTY",")","]","?","@","THIS","SUPER","DYNAMIC_IMPORT"]).concat(["NUMBER","INFINITY","NAN","STRING","STRING_END","REGEX","REGEX_END","BOOL","NULL","UNDEFINED","}","::"]),c=["IDENTIFIER",")","]","NUMBER"],$=A.concat(["++","--"]),P=["INDENT","OUTDENT","TERMINATOR"],N=[")","}","]"]}.call(this),{exports:e}.exports}(),s["./parser"]=function(){var e={},t={exports:e},i=function(){function e(){this.yy={}}var t=function(e,t,i,n){for(i=i||{},n=e.length;n--;i[e[n]]=t);return i},i=[1,24],n=[1,59],s=[1,97],a=[1,98],r=[1,93],o=[1,99],l=[1,100],c=[1,95],h=[1,96],u=[1,68],p=[1,70],m=[1,71],f=[1,72],v=[1,73],g=[1,74],b=[1,76],y=[1,80],w=[1,77],k=[1,78],x=[1,62],E=[1,45],T=[1,38],N=[1,82],A=[1,83],C=[1,81],L=[1,92],S=[1,57],I=[1,63],D=[1,64],j=[1,79],O=[1,50],R=[1,58],_=[1,75],P=[1,87],M=[1,88],F=[1,89],V=[1,90],$=[1,56],B=[1,86],H=[1,40],U=[1,41],W=[1,61],q=[1,42],z=[1,43],X=[1,44],G=[1,46],J=[1,47],Y=[1,101],K=[1,6,35,52,153],Q=[1,6,33,35,52,74,76,96,135,142,153,156,164],Z=[1,119],ee=[1,120],te=[1,121],ie=[1,116],ne=[1,104],se=[1,103],ae=[1,102],re=[1,105],oe=[1,106],le=[1,107],ce=[1,108],he=[1,109],ue=[1,110],de=[1,111],pe=[1,112],me=[1,113],fe=[1,114],ve=[1,115],ge=[1,123],be=[1,6,33,35,52,74,76,91,96,107,118,135,142,153,155,156,157,163,164,181,187,188,191,192,193,194,195,196,197,198,199,200,201,202],ye=[2,211],we=[1,129],ke=[1,134],xe=[1,130],Ee=[1,131],Te=[1,132],Ne=[1,135],Ae=[1,128],Ce=[1,6,33,35,52,74,76,96,135,142,153,155,156,157,163,164,181],Le=[1,6,33,35,46,47,52,74,76,91,96,105,106,107,109,110,111,114,118,133,134,135,142,153,155,156,157,163,164,181,187,188,191,192,193,194,195,196,197,198,199,200,201,202],Se=[2,129],Ie=[2,133],De=[6,33,91,96],je=[2,106],Oe=[1,147],Re=[1,146],_e=[1,141],Pe=[1,150],Me=[1,155],Fe=[1,153],Ve=[1,159],$e=[1,165],Be=[1,161],He=[1,162],Ue=[1,164],We=[1,169],qe=[1,6,33,35,46,47,52,66,74,76,91,96,105,106,107,109,110,111,114,118,133,134,135,142,153,155,156,157,163,164,181,187,188,191,192,193,194,195,196,197,198,199,200,201,202],ze=[2,126],Xe=[1,6,35,52,74,76,91,96,107,118,135,142,153,155,156,157,163,164,181,187,188,191,192,193,194,195,196,197,198,199,200,201,202],Ge=[2,31],Je=[1,194],Ye=[1,195],Ke=[2,93],Qe=[1,201],Ze=[1,207],et=[1,222],tt=[1,217],it=[1,226],nt=[1,223],st=[1,228],at=[1,229],rt=[1,231],ot=[2,216],lt=[1,233],ct=[14,32,33,39,40,44,46,47,54,55,59,60,61,62,63,64,73,75,82,85,87,88,89,93,94,108,116,119,121,129,137,147,151,152,155,157,160,163,174,180,183,184,185,186,187,188,189,190],ht=[1,6,33,35,46,47,52,66,74,76,91,96,105,106,107,109,110,111,114,118,120,133,134,135,142,153,155,156,157,163,164,181,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203],ut=[1,245],dt=[1,246],pt=[2,155],mt=[1,262],ft=[1,263],vt=[1,265],gt=[1,275],bt=[1,276],yt=[1,6,33,35,46,47,52,70,74,76,91,96,105,106,107,109,110,111,114,118,133,134,135,142,153,155,156,157,163,164,181,187,188,191,192,193,194,195,196,197,198,199,200,201,202],wt=[1,6,33,35,36,46,47,52,66,70,74,76,91,96,105,106,107,109,110,111,114,118,120,126,133,134,135,142,153,155,156,157,163,164,171,172,173,181,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203],kt=[1,6,33,35,46,47,49,51,52,57,70,74,76,91,96,105,106,107,109,110,111,114,118,133,134,135,142,153,155,156,157,163,164,181,187,188,191,192,193,194,195,196,197,198,199,200,201,202],xt=[1,281],Et=[46,47,134],Tt=[1,320],Nt=[1,319],At=[6,33],Ct=[2,104],Lt=[1,326],St=[6,33,35,91,96],It=[6,33,35,66,76,91,96],Dt=[1,6,33,35,52,74,76,91,96,107,118,135,142,153,155,156,157,163,164,181,187,188,192,193,194,195,196,197,198,199,200,201,202],jt=[2,366],Ot=[2,367],Rt=[1,6,33,35,52,74,76,91,96,107,118,135,142,153,155,156,157,163,164,181,187,188,192,194,195,196,197,198,199,200,201,202],_t=[46,47,105,106,109,110,111,114,133,134],Pt=[1,355],Mt=[1,6,33,35,52,74,76,91,96,107,118,135,142,153,155,156,157,163,164,181],Ft=[2,91],Vt=[1,372],$t=[1,374],Bt=[1,379],Ht=[1,381],Ut=[6,33,74,96],Wt=[2,236],qt=[2,237],zt=[1,6,33,35,46,47,52,66,74,76,91,96,105,106,107,109,110,111,114,118,133,134,135,142,153,155,156,157,163,164,171,172,173,181,187,188,191,192,193,194,195,196,197,198,199,200,201,202],Xt=[1,395],Gt=[14,32,33,35,39,40,44,46,47,54,55,59,60,61,62,63,64,73,74,75,76,82,85,87,88,89,93,94,96,108,116,119,121,129,137,147,151,152,155,157,160,163,174,180,183,184,185,186,187,188,189,190],Jt=[1,397],Yt=[6,33,35,74,96],Kt=[6,14,32,33,35,39,40,44,46,47,54,55,59,60,61,62,63,64,73,74,75,76,82,85,87,88,89,93,94,96,108,116,119,121,129,137,147,151,152,155,157,160,163,174,180,183,184,185,186,187,188,189,190],Qt=[6,33,35,74,96,135],Zt=[1,6,33,35,46,47,52,57,74,76,91,96,105,106,107,109,110,111,114,118,133,134,135,142,153,155,156,157,163,164,181,187,188,191,192,193,194,195,196,197,198,199,200,201,202],ei=[1,408],ti=[1,6,33,35,46,47,52,66,70,74,76,91,96,105,106,107,109,110,111,114,118,120,133,134,135,142,153,155,156,157,163,164,171,172,173,181,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203],ii=[1,6,33,35,52,74,76,91,96,107,118,135,142,153,164,181],ni=[1,6,33,35,52,74,76,91,96,107,118,135,142,153,156,164,181],si=[2,289],ai=[171,172,173],ri=[96,171,172,173],oi=[6,33,118],li=[1,427],ci=[6,33,35,96,118],hi=[6,33,35,70,96,118],ui=[6,33,35,66,70,76,96,105,106,109,110,111,114,118,133,134],di=[6,33,35,76,96,105,106,109,110,111,114,118,133,134],pi=[46,47,49,51],mi=[1,6,33,35,52,74,76,91,96,107,118,135,142,153,155,156,157,163,164,181,187,188,194,195,196,197,198,199,200,201,202],fi=[2,356],vi=[2,355],gi=[35,107],bi=[14,32,35,39,40,44,46,47,54,55,59,60,61,62,63,64,73,75,82,85,87,88,89,93,94,107,108,116,119,121,129,137,147,151,152,155,157,160,163,174,180,183,184,185,186,187,188,189,190],yi=[2,222],wi=[6,33,35],ki=[2,105],xi=[1,466],Ei=[1,467],Ti=[1,6,33,35,46,47,52,74,76,91,96,105,106,107,109,110,111,114,118,133,134,135,142,149,150,153,155,156,157,163,164,176,178,181,187,188,191,192,193,194,195,196,197,198,199,200,201,202],Ni=[1,335],Ai=[35,176,178],Ci=[1,6,35,52,74,76,91,96,107,118,135,142,153,156,164,181],Li=[1,504],Si=[1,511],Ii=[1,6,33,35,52,74,76,96,135,142,153,156,164,181],Di=[2,120],ji=[1,524],Oi=[33,35,74],Ri=[1,532],_i=[6,33,35,96,135],Pi=[1,6,33,35,52,74,76,91,96,107,118,135,142,153,155,156,157,163,164,176,181,187,188,191,192,193,194,195,196,197,198,199,200,201,202],Mi=[1,6,33,35,52,74,76,96,135,142,153,156,164,176],Fi=[2,303],Vi=[2,304],$i=[2,319],Bi=[1,552],Hi=[1,553],Ui=[6,33,35,118],Wi=[1,6,33,35,52,74,76,91,96,107,118,135,142,153,155,157,163,164,181],qi=[6,33,35,96],zi=[1,6,33,35,52,74,76,91,96,107,118,135,142,149,153,155,156,157,163,164,181,187,188,191,192,193,194,195,196,197,198,199,200,201,202],Xi=[33,96],Gi=[1,604],Ji=[1,605],Yi=[1,612],Ki=[1,613],Qi=[1,630],Zi=[1,631],en=[2,274],tn=[2,277],nn=[2,290],sn=[2,305],an=[2,309],rn=[2,306],on=[2,310],ln=[2,307],cn=[2,308],hn=[2,320],un=[2,321],dn=[1,6,33,35,52,74,76,91,96,107,118,135,142,153,155,156,157,163,181],pn=[2,311],mn=[2,313],fn=[2,315],vn=[2,317],gn=[2,312],bn=[2,314],yn=[2,316],wn=[2,318],kn={trace:function(){},yy:{},symbols_:{error:2,Root:3,Body:4,Line:5,TERMINATOR:6,Expression:7,ExpressionLine:8,Statement:9,FuncDirective:10,YieldReturn:11,AwaitReturn:12,Return:13,STATEMENT:14,Import:15,Export:16,Value:17,Code:18,Operation:19,Assign:20,If:21,Try:22,While:23,For:24,Switch:25,Class:26,Throw:27,Yield:28,CodeLine:29,IfLine:30,OperationLine:31,YIELD:32,INDENT:33,Object:34,OUTDENT:35,FROM:36,Block:37,Identifier:38,IDENTIFIER:39,JSX_TAG:40,Property:41,PROPERTY:42,AlphaNumeric:43,NUMBER:44,String:45,STRING:46,STRING_START:47,Interpolations:48,STRING_END:49,InterpolationChunk:50,INTERPOLATION_START:51,INTERPOLATION_END:52,Regex:53,REGEX:54,REGEX_START:55,Invocation:56,REGEX_END:57,Literal:58,JS:59,UNDEFINED:60,NULL:61,BOOL:62,INFINITY:63,NAN:64,Assignable:65,"=":66,AssignObj:67,ObjAssignable:68,ObjRestValue:69,":":70,SimpleObjAssignable:71,ThisProperty:72,"[":73,"]":74,"@":75,"...":76,ObjSpreadExpr:77,ObjSpreadIdentifier:78,Parenthetical:79,Super:80,This:81,SUPER:82,OptFuncExist:83,Arguments:84,DYNAMIC_IMPORT:85,Accessor:86,RETURN:87,AWAIT:88,PARAM_START:89,ParamList:90,PARAM_END:91,FuncGlyph:92,"->":93,"=>":94,OptComma:95,",":96,Param:97,ParamVar:98,Array:99,Splat:100,SimpleAssignable:101,Range:102,DoIife:103,MetaProperty:104,".":105,INDEX_START:106,INDEX_END:107,NEW_TARGET:108,"?.":109,"::":110,"?::":111,Index:112,IndexValue:113,INDEX_SOAK:114,Slice:115,"{":116,AssignList:117,"}":118,CLASS:119,EXTENDS:120,IMPORT:121,ImportDefaultSpecifier:122,ImportNamespaceSpecifier:123,ImportSpecifierList:124,ImportSpecifier:125,AS:126,DEFAULT:127,IMPORT_ALL:128,EXPORT:129,ExportSpecifierList:130,EXPORT_ALL:131,ExportSpecifier:132,FUNC_EXIST:133,CALL_START:134,CALL_END:135,ArgList:136,THIS:137,Elisions:138,ArgElisionList:139,OptElisions:140,RangeDots:141,"..":142,Arg:143,ArgElision:144,Elision:145,SimpleArgs:146,TRY:147,Catch:148,FINALLY:149,CATCH:150,THROW:151,"(":152,")":153,WhileLineSource:154,WHILE:155,WHEN:156,UNTIL:157,WhileSource:158,Loop:159,LOOP:160,ForBody:161,ForLineBody:162,FOR:163,BY:164,ForStart:165,ForSource:166,ForLineSource:167,ForVariables:168,OWN:169,ForValue:170,FORIN:171,FOROF:172,FORFROM:173,SWITCH:174,Whens:175,ELSE:176,When:177,LEADING_WHEN:178,IfBlock:179,IF:180,POST_IF:181,IfBlockLine:182,UNARY:183,DO:184,DO_IIFE:185,UNARY_MATH:186,"-":187,"+":188,"--":189,"++":190,"?":191,MATH:192,"**":193,SHIFT:194,COMPARE:195,"&":196,"^":197,"|":198,"&&":199,"||":200,"BIN?":201,RELATION:202,COMPOUND_ASSIGN:203,$accept:0,$end:1},terminals_:{2:"error",6:"TERMINATOR",14:"STATEMENT",32:"YIELD",33:"INDENT",35:"OUTDENT",36:"FROM",39:"IDENTIFIER",40:"JSX_TAG",42:"PROPERTY",44:"NUMBER",46:"STRING",47:"STRING_START",49:"STRING_END",51:"INTERPOLATION_START",52:"INTERPOLATION_END",54:"REGEX",55:"REGEX_START",57:"REGEX_END",59:"JS",60:"UNDEFINED",61:"NULL",62:"BOOL",63:"INFINITY",64:"NAN",66:"=",70:":",73:"[",74:"]",75:"@",76:"...",82:"SUPER",85:"DYNAMIC_IMPORT",87:"RETURN",88:"AWAIT",89:"PARAM_START",91:"PARAM_END",93:"->",94:"=>",96:",",105:".",106:"INDEX_START",107:"INDEX_END",108:"NEW_TARGET",109:"?.",110:"::",111:"?::",114:"INDEX_SOAK",116:"{",118:"}",119:"CLASS",120:"EXTENDS",121:"IMPORT",126:"AS",127:"DEFAULT",128:"IMPORT_ALL",129:"EXPORT",131:"EXPORT_ALL",133:"FUNC_EXIST",134:"CALL_START",135:"CALL_END",137:"THIS",142:"..",147:"TRY",149:"FINALLY",150:"CATCH",151:"THROW",152:"(",153:")",155:"WHILE",156:"WHEN",157:"UNTIL",160:"LOOP",163:"FOR",164:"BY",169:"OWN",171:"FORIN",172:"FOROF",173:"FORFROM",174:"SWITCH",176:"ELSE",178:"LEADING_WHEN",180:"IF",181:"POST_IF",183:"UNARY",184:"DO",185:"DO_IIFE",186:"UNARY_MATH",187:"-",188:"+",189:"--",190:"++",191:"?",192:"MATH",193:"**",194:"SHIFT",195:"COMPARE",196:"&",197:"^",198:"|",199:"&&",200:"||",201:"BIN?",202:"RELATION",203:"COMPOUND_ASSIGN"},productions_:[0,[3,0],[3,1],[4,1],[4,3],[4,2],[5,1],[5,1],[5,1],[5,1],[10,1],[10,1],[9,1],[9,1],[9,1],[9,1],[7,1],[7,1],[7,1],[7,1],[7,1],[7,1],[7,1],[7,1],[7,1],[7,1],[7,1],[7,1],[8,1],[8,1],[8,1],[28,1],[28,2],[28,4],[28,3],[37,2],[37,3],[38,1],[38,1],[41,1],[43,1],[43,1],[45,1],[45,3],[48,1],[48,2],[50,3],[50,5],[50,2],[50,1],[53,1],[53,3],[58,1],[58,1],[58,1],[58,1],[58,1],[58,1],[58,1],[58,1],[20,3],[20,4],[20,5],[67,1],[67,1],[67,3],[67,5],[67,3],[67,5],[71,1],[71,1],[71,1],[68,1],[68,3],[68,4],[68,1],[69,2],[69,2],[69,2],[69,2],[77,1],[77,1],[77,1],[77,1],[77,1],[77,3],[77,2],[77,3],[77,3],[78,2],[78,2],[13,2],[13,4],[13,1],[11,3],[11,2],[12,3],[12,2],[18,5],[18,2],[29,5],[29,2],[92,1],[92,1],[95,0],[95,1],[90,0],[90,1],[90,3],[90,4],[90,6],[97,1],[97,2],[97,2],[97,3],[97,1],[98,1],[98,1],[98,1],[98,1],[100,2],[100,2],[101,1],[101,2],[101,2],[101,1],[65,1],[65,1],[65,1],[17,1],[17,1],[17,1],[17,1],[17,1],[17,1],[17,1],[17,1],[17,1],[80,3],[80,4],[80,6],[104,3],[86,2],[86,2],[86,2],[86,2],[86,1],[86,1],[86,1],[112,3],[112,5],[112,2],[113,1],[113,1],[34,4],[117,0],[117,1],[117,3],[117,4],[117,6],[26,1],[26,2],[26,3],[26,4],[26,2],[26,3],[26,4],[26,5],[15,2],[15,4],[15,4],[15,5],[15,7],[15,6],[15,9],[124,1],[124,3],[124,4],[124,4],[124,6],[125,1],[125,3],[125,1],[125,3],[122,1],[123,3],[16,3],[16,5],[16,2],[16,4],[16,5],[16,6],[16,3],[16,5],[16,4],[16,5],[16,7],[130,1],[130,3],[130,4],[130,4],[130,6],[132,1],[132,3],[132,3],[132,1],[132,3],[56,3],[56,3],[56,3],[56,2],[83,0],[83,1],[84,2],[84,4],[81,1],[81,1],[72,2],[99,2],[99,3],[99,4],[141,1],[141,1],[102,5],[102,5],[115,3],[115,2],[115,3],[115,2],[115,2],[115,1],[136,1],[136,3],[136,4],[136,4],[136,6],[143,1],[143,1],[143,1],[143,1],[139,1],[139,3],[139,4],[139,4],[139,6],[144,1],[144,2],[140,1],[140,2],[138,1],[138,2],[145,1],[145,2],[146,1],[146,1],[146,3],[146,3],[22,2],[22,3],[22,4],[22,5],[148,3],[148,3],[148,2],[27,2],[27,4],[79,3],[79,5],[154,2],[154,4],[154,2],[154,4],[158,2],[158,4],[158,4],[158,2],[158,4],[158,4],[23,2],[23,2],[23,2],[23,2],[23,1],[159,2],[159,2],[24,2],[24,2],[24,2],[24,2],[161,2],[161,4],[161,2],[162,4],[162,2],[165,2],[165,3],[165,3],[170,1],[170,1],[170,1],[170,1],[168,1],[168,3],[166,2],[166,2],[166,4],[166,4],[166,4],[166,4],[166,4],[166,4],[166,6],[166,6],[166,6],[166,6],[166,6],[166,6],[166,6],[166,6],[166,2],[166,4],[166,4],[167,2],[167,2],[167,4],[167,4],[167,4],[167,4],[167,4],[167,4],[167,6],[167,6],[167,6],[167,6],[167,6],[167,6],[167,6],[167,6],[167,2],[167,4],[167,4],[25,5],[25,5],[25,7],[25,7],[25,4],[25,6],[175,1],[175,2],[177,3],[177,4],[179,3],[179,5],[21,1],[21,3],[21,3],[21,3],[182,3],[182,5],[30,1],[30,3],[30,3],[30,3],[31,2],[31,2],[31,2],[19,2],[19,2],[19,2],[19,2],[19,2],[19,2],[19,4],[19,2],[19,2],[19,2],[19,2],[19,2],[19,3],[19,3],[19,3],[19,3],[19,3],[19,3],[19,3],[19,3],[19,3],[19,3],[19,3],[19,3],[19,3],[19,3],[19,5],[19,4],[103,2]],performAction:function(e,t,i,n,s,a,r){var o,l,c,h,u=a.length-1;switch(s){case 1:return this.$=n.addDataToNode(n,r[u],a[u],r[u],a[u],!0)(new n.Root(new n.Block));case 2:return this.$=n.addDataToNode(n,r[u],a[u],r[u],a[u],!0)(new n.Root(a[u]));case 3:this.$=n.addDataToNode(n,r[u],a[u],r[u],a[u],!0)(n.Block.wrap([a[u]]));break;case 4:this.$=n.addDataToNode(n,r[u-2],a[u-2],r[u],a[u],!0)(a[u-2].push(a[u]));break;case 5:this.$=a[u-1];break;case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 14:case 15:case 16:case 17:case 18:case 19:case 20:case 21:case 22:case 23:case 24:case 25:case 26:case 27:case 28:case 29:case 30:case 41:case 52:case 54:case 64:case 69:case 70:case 71:case 72:case 75:case 80:case 81:case 82:case 83:case 84:case 104:case 105:case 116:case 117:case 118:case 119:case 125:case 126:case 129:case 135:case 148:case 236:case 237:case 238:case 240:case 253:case 254:case 297:case 298:case 353:case 359:this.$=a[u];break;case 13:this.$=n.addDataToNode(n,r[u],a[u],r[u],a[u],!0)(new n.StatementLiteral(a[u]));break;case 31:this.$=n.addDataToNode(n,r[u],a[u],r[u],a[u],!0)(new n.Op(a[u],new n.Value(new n.Literal(""))));break;case 32:case 363:case 364:case 365:case 367:case 368:case 371:case 394:this.$=n.addDataToNode(n,r[u-1],a[u-1],r[u],a[u],!0)(new n.Op(a[u-1],a[u]));break;case 33:case 372:this.$=n.addDataToNode(n,r[u-3],a[u-3],r[u],a[u],!0)(new n.Op(a[u-3],a[u-1]));break;case 34:this.$=n.addDataToNode(n,r[u-2],a[u-2],r[u],a[u],!0)(new n.Op(a[u-2].concat(a[u-1]),a[u]));break;case 35:this.$=n.addDataToNode(n,r[u-1],a[u-1],r[u],a[u],!0)(new n.Block);break;case 36:case 149:this.$=n.addDataToNode(n,r[u-2],a[u-2],r[u],a[u],!0)(a[u-1]);break;case 37:this.$=n.addDataToNode(n,r[u],a[u],r[u],a[u],!0)(new n.IdentifierLiteral(a[u]));break;case 38:this.$=n.addDataToNode(n,r[u],a[u],r[u],a[u],!0)(new n.JSXTag(a[u].toString(),{tagNameLocationData:a[u].tagNameToken[2],closingTagOpeningBracketLocationData:null==(o=a[u].closingTagOpeningBracketToken)?void 0:o[2],closingTagSlashLocationData:null==(l=a[u].closingTagSlashToken)?void 0:l[2],closingTagNameLocationData:null==(c=a[u].closingTagNameToken)?void 0:c[2],closingTagClosingBracketLocationData:null==(h=a[u].closingTagClosingBracketToken)?void 0:h[2]}));break;case 39:this.$=n.addDataToNode(n,r[u],a[u],r[u],a[u],!0)(new n.PropertyName(a[u].toString()));break;case 40:this.$=n.addDataToNode(n,r[u],a[u],r[u],a[u],!0)(new n.NumberLiteral(a[u].toString(),{parsedValue:a[u].parsedValue}));break;case 42:this.$=n.addDataToNode(n,r[u],a[u],r[u],a[u],!0)(new n.StringLiteral(a[u].slice(1,-1),{quote:a[u].quote,initialChunk:a[u].initialChunk,finalChunk:a[u].finalChunk,indent:a[u].indent,double:a[u].double,heregex:a[u].heregex}));break;case 43:this.$=n.addDataToNode(n,r[u-2],a[u-2],r[u],a[u],!0)(new n.StringWithInterpolations(n.Block.wrap(a[u-1]),{quote:a[u-2].quote,startQuote:n.addDataToNode(n,r[u-2],a[u-2],null,null,!0)(new n.Literal(a[u-2].toString()))}));break;case 44:case 107:case 156:case 175:case 197:case 231:case 245:case 249:case 301:case 347:this.$=n.addDataToNode(n,r[u],a[u],r[u],a[u],!0)([a[u]]);break;case 45:case 246:case 250:case 348:this.$=n.addDataToNode(n,r[u-1],a[u-1],r[u],a[u],!0)(a[u-1].concat(a[u]));break;case 46:this.$=n.addDataToNode(n,r[u-2],a[u-2],r[u],a[u],!0)(new n.Interpolation(a[u-1]));break;case 47:this.$=n.addDataToNode(n,r[u-4],a[u-4],r[u],a[u],!0)(new n.Interpolation(a[u-2]));break;case 48:this.$=n.addDataToNode(n,r[u-1],a[u-1],r[u],a[u],!0)(new n.Interpolation);break;case 49:case 282:this.$=n.addDataToNode(n,r[u],a[u],r[u],a[u],!0)(a[u]);break;case 50:this.$=n.addDataToNode(n,r[u],a[u],r[u],a[u],!0)(new n.RegexLiteral(a[u].toString(),{delimiter:a[u].delimiter,heregexCommentTokens:a[u].heregexCommentTokens}));break;case 51:this.$=n.addDataToNode(n,r[u-2],a[u-2],r[u],a[u],!0)(new n.RegexWithInterpolations(a[u-1],{heregexCommentTokens:a[u].heregexCommentTokens}));break;case 53:this.$=n.addDataToNode(n,r[u],a[u],r[u],a[u],!0)(new n.PassthroughLiteral(a[u].toString(),{here:a[u].here,generated:a[u].generated}));break;case 55:this.$=n.addDataToNode(n,r[u],a[u],r[u],a[u],!0)(new n.UndefinedLiteral(a[u]));break;case 56:this.$=n.addDataToNode(n,r[u],a[u],r[u],a[u],!0)(new n.NullLiteral(a[u]));break;case 57:this.$=n.addDataToNode(n,r[u],a[u],r[u],a[u],!0)(new n.BooleanLiteral(a[u].toString(),{originalValue:a[u].original}));break;case 58:this.$=n.addDataToNode(n,r[u],a[u],r[u],a[u],!0)(new n.InfinityLiteral(a[u].toString(),{originalValue:a[u].original}));break;case 59:this.$=n.addDataToNode(n,r[u],a[u],r[u],a[u],!0)(new n.NaNLiteral(a[u]));break;case 60:this.$=n.addDataToNode(n,r[u-2],a[u-2],r[u],a[u],!0)(new n.Assign(a[u-2],a[u]));break;case 61:this.$=n.addDataToNode(n,r[u-3],a[u-3],r[u],a[u],!0)(new n.Assign(a[u-3],a[u]));break;case 62:this.$=n.addDataToNode(n,r[u-4],a[u-4],r[u],a[u],!0)(new n.Assign(a[u-4],a[u-1]));break;case 63:case 122:case 127:case 128:case 130:case 131:case 132:case 133:case 134:case 136:case 137:case 299:case 300:this.$=n.addDataToNode(n,r[u],a[u],r[u],a[u],!0)(new n.Value(a[u]));break;case 65:this.$=n.addDataToNode(n,r[u-2],a[u-2],r[u],a[u],!0)(new n.Assign(n.addDataToNode(n,r[u-2],a[u-2],null,null,!0)(new n.Value(a[u-2])),a[u],"object",{operatorToken:n.addDataToNode(n,r[u-1],a[u-1],null,null,!0)(new n.Literal(a[u-1]))}));break;case 66:this.$=n.addDataToNode(n,r[u-4],a[u-4],r[u],a[u],!0)(new n.Assign(n.addDataToNode(n,r[u-4],a[u-4],null,null,!0)(new n.Value(a[u-4])),a[u-1],"object",{operatorToken:n.addDataToNode(n,r[u-3],a[u-3],null,null,!0)(new n.Literal(a[u-3]))}));break;case 67:this.$=n.addDataToNode(n,r[u-2],a[u-2],r[u],a[u],!0)(new n.Assign(n.addDataToNode(n,r[u-2],a[u-2],null,null,!0)(new n.Value(a[u-2])),a[u],null,{operatorToken:n.addDataToNode(n,r[u-1],a[u-1],null,null,!0)(new n.Literal(a[u-1]))}));break;case 68:this.$=n.addDataToNode(n,r[u-4],a[u-4],r[u],a[u],!0)(new n.Assign(n.addDataToNode(n,r[u-4],a[u-4],null,null,!0)(new n.Value(a[u-4])),a[u-1],null,{operatorToken:n.addDataToNode(n,r[u-3],a[u-3],null,null,!0)(new n.Literal(a[u-3]))}));break;case 73:this.$=n.addDataToNode(n,r[u-2],a[u-2],r[u],a[u],!0)(new n.Value(new n.ComputedPropertyName(a[u-1])));break;case 74:this.$=n.addDataToNode(n,r[u-3],a[u-3],r[u],a[u],!0)(new n.Value(n.addDataToNode(n,r[u-3],a[u-3],null,null,!0)(new n.ThisLiteral(a[u-3])),[n.addDataToNode(n,r[u-1],a[u-1],null,null,!0)(new n.ComputedPropertyName(a[u-1]))],"this"));break;case 76:this.$=n.addDataToNode(n,r[u-1],a[u-1],r[u],a[u],!0)(new n.Splat(new n.Value(a[u-1])));break;case 77:this.$=n.addDataToNode(n,r[u-1],a[u-1],r[u],a[u],!0)(new n.Splat(new n.Value(a[u]),{postfix:!1}));break;case 78:case 120:this.$=n.addDataToNode(n,r[u-1],a[u-1],r[u],a[u],!0)(new n.Splat(a[u-1]));break;case 79:case 121:this.$=n.addDataToNode(n,r[u-1],a[u-1],r[u],a[u],!0)(new n.Splat(a[u],{postfix:!1}));break;case 85:case 209:this.$=n.addDataToNode(n,r[u-2],a[u-2],r[u],a[u],!0)(new n.SuperCall(n.addDataToNode(n,r[u-2],a[u-2],null,null,!0)(new n.Super),a[u],a[u-1].soak,a[u-2]));break;case 86:case 210:this.$=n.addDataToNode(n,r[u-1],a[u-1],r[u],a[u],!0)(new n.DynamicImportCall(n.addDataToNode(n,r[u-1],a[u-1],null,null,!0)(new n.DynamicImport),a[u]));break;case 87:this.$=n.addDataToNode(n,r[u-2],a[u-2],r[u],a[u],!0)(new n.Call(new n.Value(a[u-2]),a[u],a[u-1].soak));break;case 88:case 208:this.$=n.addDataToNode(n,r[u-2],a[u-2],r[u],a[u],!0)(new n.Call(a[u-2],a[u],a[u-1].soak));break;case 89:case 90:this.$=n.addDataToNode(n,r[u-1],a[u-1],r[u],a[u],!0)(new n.Value(a[u-1]).add(a[u]));break;case 91:this.$=n.addDataToNode(n,r[u-1],a[u-1],r[u],a[u],!0)(new n.Return(a[u]));break;case 92:this.$=n.addDataToNode(n,r[u-3],a[u-3],r[u],a[u],!0)(new n.Return(new n.Value(a[u-1])));break;case 93:this.$=n.addDataToNode(n,r[u],a[u],r[u],a[u],!0)(new n.Return);break;case 94:this.$=n.addDataToNode(n,r[u-2],a[u-2],r[u],a[u],!0)(new n.YieldReturn(a[u],{returnKeyword:n.addDataToNode(n,r[u-1],a[u-1],null,null,!0)(new n.Literal(a[u-1]))}));break;case 95:this.$=n.addDataToNode(n,r[u-1],a[u-1],r[u],a[u],!0)(new n.YieldReturn(null,{returnKeyword:n.addDataToNode(n,r[u],a[u],null,null,!0)(new n.Literal(a[u]))}));break;case 96:this.$=n.addDataToNode(n,r[u-2],a[u-2],r[u],a[u],!0)(new n.AwaitReturn(a[u],{returnKeyword:n.addDataToNode(n,r[u-1],a[u-1],null,null,!0)(new n.Literal(a[u-1]))}));break;case 97:this.$=n.addDataToNode(n,r[u-1],a[u-1],r[u],a[u],!0)(new n.AwaitReturn(null,{returnKeyword:n.addDataToNode(n,r[u],a[u],null,null,!0)(new n.Literal(a[u]))}));break;case 98:this.$=n.addDataToNode(n,r[u-4],a[u-4],r[u],a[u],!0)(new n.Code(a[u-3],a[u],a[u-1],n.addDataToNode(n,r[u-4],a[u-4],null,null,!0)(new n.Literal(a[u-4]))));break;case 99:this.$=n.addDataToNode(n,r[u-1],a[u-1],r[u],a[u],!0)(new n.Code([],a[u],a[u-1]));break;case 100:this.$=n.addDataToNode(n,r[u-4],a[u-4],r[u],a[u],!0)(new n.Code(a[u-3],n.addDataToNode(n,r[u],a[u],null,null,!0)(n.Block.wrap([a[u]])),a[u-1],n.addDataToNode(n,r[u-4],a[u-4],null,null,!0)(new n.Literal(a[u-4]))));break;case 101:this.$=n.addDataToNode(n,r[u-1],a[u-1],r[u],a[u],!0)(new n.Code([],n.addDataToNode(n,r[u],a[u],null,null,!0)(n.Block.wrap([a[u]])),a[u-1]));break;case 102:case 103:this.$=n.addDataToNode(n,r[u],a[u],r[u],a[u],!0)(new n.FuncGlyph(a[u]));break;case 106:case 155:case 247:this.$=n.addDataToNode(n,r[u],a[u],r[u],a[u],!0)([]);break;case 108:case 157:case 176:case 198:case 232:case 241:this.$=n.addDataToNode(n,r[u-2],a[u-2],r[u],a[u],!0)(a[u-2].concat(a[u]));break;case 109:case 158:case 177:case 199:case 233:case 242:this.$=n.addDataToNode(n,r[u-3],a[u-3],r[u],a[u],!0)(a[u-3].concat(a[u]));break;case 110:case 159:case 179:case 201:case 235:this.$=n.addDataToNode(n,r[u-5],a[u-5],r[u],a[u],!0)(a[u-5].concat(a[u-2]));break;case 111:this.$=n.addDataToNode(n,r[u],a[u],r[u],a[u],!0)(new n.Param(a[u]));break;case 112:this.$=n.addDataToNode(n,r[u-1],a[u-1],r[u],a[u],!0)(new n.Param(a[u-1],null,!0));break;case 113:this.$=n.addDataToNode(n,r[u-1],a[u-1],r[u],a[u],!0)(new n.Param(a[u],null,{postfix:!1}));break;case 114:this.$=n.addDataToNode(n,r[u-2],a[u-2],r[u],a[u],!0)(new n.Param(a[u-2],a[u]));break;case 115:case 239:this.$=n.addDataToNode(n,r[u],a[u],r[u],a[u],!0)(new n.Expansion);break;case 123:this.$=n.addDataToNode(n,r[u-1],a[u-1],r[u],a[u],!0)(a[u-1].add(a[u]));break;case 124:this.$=n.addDataToNode(n,r[u-1],a[u-1],r[u],a[u],!0)(new n.Value(a[u-1]).add(a[u]));break;case 138:this.$=n.addDataToNode(n,r[u-2],a[u-2],r[u],a[u],!0)(new n.Super(n.addDataToNode(n,r[u],a[u],null,null,!0)(new n.Access(a[u])),n.addDataToNode(n,r[u-2],a[u-2],null,null,!0)(new n.Literal(a[u-2]))));break;case 139:this.$=n.addDataToNode(n,r[u-3],a[u-3],r[u],a[u],!0)(new n.Super(n.addDataToNode(n,r[u-1],a[u-1],null,null,!0)(new n.Index(a[u-1])),n.addDataToNode(n,r[u-3],a[u-3],null,null,!0)(new n.Literal(a[u-3]))));break;case 140:this.$=n.addDataToNode(n,r[u-5],a[u-5],r[u],a[u],!0)(new n.Super(n.addDataToNode(n,r[u-2],a[u-2],null,null,!0)(new n.Index(a[u-2])),n.addDataToNode(n,r[u-5],a[u-5],null,null,!0)(new n.Literal(a[u-5]))));break;case 141:this.$=n.addDataToNode(n,r[u-2],a[u-2],r[u],a[u],!0)(new n.MetaProperty(n.addDataToNode(n,r[u-2],a[u-2],null,null,!0)(new n.IdentifierLiteral(a[u-2])),n.addDataToNode(n,r[u],a[u],null,null,!0)(new n.Access(a[u]))));break;case 142:this.$=n.addDataToNode(n,r[u-1],a[u-1],r[u],a[u],!0)(new n.Access(a[u]));break;case 143:this.$=n.addDataToNode(n,r[u-1],a[u-1],r[u],a[u],!0)(new n.Access(a[u],{soak:!0}));break;case 144:this.$=n.addDataToNode(n,r[u-1],a[u-1],r[u],a[u],!0)([n.addDataToNode(n,r[u-1],a[u-1],null,null,!0)(new n.Access(new n.PropertyName("prototype"),{shorthand:!0})),n.addDataToNode(n,r[u],a[u],null,null,!0)(new n.Access(a[u]))]);break;case 145:this.$=n.addDataToNode(n,r[u-1],a[u-1],r[u],a[u],!0)([n.addDataToNode(n,r[u-1],a[u-1],null,null,!0)(new n.Access(new n.PropertyName("prototype"),{shorthand:!0,soak:!0})),n.addDataToNode(n,r[u],a[u],null,null,!0)(new n.Access(a[u]))]);break;case 146:this.$=n.addDataToNode(n,r[u],a[u],r[u],a[u],!0)(new n.Access(new n.PropertyName("prototype"),{shorthand:!0}));break;case 147:this.$=n.addDataToNode(n,r[u],a[u],r[u],a[u],!0)(new n.Access(new n.PropertyName("prototype"),{shorthand:!0,soak:!0}));break;case 150:this.$=n.addDataToNode(n,r[u-4],a[u-4],r[u],a[u],!0)(a[u-2]);break;case 151:this.$=n.addDataToNode(n,r[u-1],a[u-1],r[u],a[u],!0)(n.extend(a[u],{soak:!0}));break;case 152:this.$=n.addDataToNode(n,r[u],a[u],r[u],a[u],!0)(new n.Index(a[u]));break;case 153:this.$=n.addDataToNode(n,r[u],a[u],r[u],a[u],!0)(new n.Slice(a[u]));break;case 154:this.$=n.addDataToNode(n,r[u-3],a[u-3],r[u],a[u],!0)(new n.Obj(a[u-2],a[u-3].generated));break;case 160:this.$=n.addDataToNode(n,r[u],a[u],r[u],a[u],!0)(new n.Class);break;case 161:this.$=n.addDataToNode(n,r[u-1],a[u-1],r[u],a[u],!0)(new n.Class(null,null,a[u]));break;case 162:this.$=n.addDataToNode(n,r[u-2],a[u-2],r[u],a[u],!0)(new n.Class(null,a[u]));break;case 163:this.$=n.addDataToNode(n,r[u-3],a[u-3],r[u],a[u],!0)(new n.Class(null,a[u-1],a[u]));break;case 164:this.$=n.addDataToNode(n,r[u-1],a[u-1],r[u],a[u],!0)(new n.Class(a[u]));break;case 165:this.$=n.addDataToNode(n,r[u-2],a[u-2],r[u],a[u],!0)(new n.Class(a[u-1],null,a[u]));break;case 166:this.$=n.addDataToNode(n,r[u-3],a[u-3],r[u],a[u],!0)(new n.Class(a[u-2],a[u]));break;case 167:this.$=n.addDataToNode(n,r[u-4],a[u-4],r[u],a[u],!0)(new n.Class(a[u-3],a[u-1],a[u]));break;case 168:this.$=n.addDataToNode(n,r[u-1],a[u-1],r[u],a[u],!0)(new n.ImportDeclaration(null,a[u]));break;case 169:this.$=n.addDataToNode(n,r[u-3],a[u-3],r[u],a[u],!0)(new n.ImportDeclaration(new n.ImportClause(a[u-2],null),a[u]));break;case 170:this.$=n.addDataToNode(n,r[u-3],a[u-3],r[u],a[u],!0)(new n.ImportDeclaration(new n.ImportClause(null,a[u-2]),a[u]));break;case 171:this.$=n.addDataToNode(n,r[u-4],a[u-4],r[u],a[u],!0)(new n.ImportDeclaration(new n.ImportClause(null,new n.ImportSpecifierList([])),a[u]));break;case 172:this.$=n.addDataToNode(n,r[u-6],a[u-6],r[u],a[u],!0)(new n.ImportDeclaration(new n.ImportClause(null,new n.ImportSpecifierList(a[u-4])),a[u]));break;case 173:this.$=n.addDataToNode(n,r[u-5],a[u-5],r[u],a[u],!0)(new n.ImportDeclaration(new n.ImportClause(a[u-4],a[u-2]),a[u]));break;case 174:this.$=n.addDataToNode(n,r[u-8],a[u-8],r[u],a[u],!0)(new n.ImportDeclaration(new n.ImportClause(a[u-7],new n.ImportSpecifierList(a[u-4])),a[u]));break;case 178:case 200:case 234:this.$=n.addDataToNode(n,r[u-3],a[u-3],r[u],a[u],!0)(a[u-2]);break;case 180:this.$=n.addDataToNode(n,r[u],a[u],r[u],a[u],!0)(new n.ImportSpecifier(a[u]));break;case 181:this.$=n.addDataToNode(n,r[u-2],a[u-2],r[u],a[u],!0)(new n.ImportSpecifier(a[u-2],a[u]));break;case 182:this.$=n.addDataToNode(n,r[u],a[u],r[u],a[u],!0)(new n.ImportSpecifier(n.addDataToNode(n,r[u],a[u],null,null,!0)(new n.DefaultLiteral(a[u]))));break;case 183:this.$=n.addDataToNode(n,r[u-2],a[u-2],r[u],a[u],!0)(new n.ImportSpecifier(n.addDataToNode(n,r[u-2],a[u-2],null,null,!0)(new n.DefaultLiteral(a[u-2])),a[u]));break;case 184:this.$=n.addDataToNode(n,r[u],a[u],r[u],a[u],!0)(new n.ImportDefaultSpecifier(a[u]));break;case 185:this.$=n.addDataToNode(n,r[u-2],a[u-2],r[u],a[u],!0)(new n.ImportNamespaceSpecifier(new n.Literal(a[u-2]),a[u]));break;case 186:this.$=n.addDataToNode(n,r[u-2],a[u-2],r[u],a[u],!0)(new n.ExportNamedDeclaration(new n.ExportSpecifierList([])));break;case 187:this.$=n.addDataToNode(n,r[u-4],a[u-4],r[u],a[u],!0)(new n.ExportNamedDeclaration(new n.ExportSpecifierList(a[u-2])));break;case 188:this.$=n.addDataToNode(n,r[u-1],a[u-1],r[u],a[u],!0)(new n.ExportNamedDeclaration(a[u]));break;case 189:this.$=n.addDataToNode(n,r[u-3],a[u-3],r[u],a[u],!0)(new n.ExportNamedDeclaration(n.addDataToNode(n,r[u-2],a[u-2],r[u],a[u],!0)(new n.Assign(a[u-2],a[u],null,{moduleDeclaration:"export"}))));break;case 190:this.$=n.addDataToNode(n,r[u-4],a[u-4],r[u],a[u],!0)(new n.ExportNamedDeclaration(n.addDataToNode(n,r[u-3],a[u-3],r[u],a[u],!0)(new n.Assign(a[u-3],a[u],null,{moduleDeclaration:"export"}))));break;case 191:this.$=n.addDataToNode(n,r[u-5],a[u-5],r[u],a[u],!0)(new n.ExportNamedDeclaration(n.addDataToNode(n,r[u-4],a[u-4],r[u],a[u],!0)(new n.Assign(a[u-4],a[u-1],null,{moduleDeclaration:"export"}))));break;case 192:this.$=n.addDataToNode(n,r[u-2],a[u-2],r[u],a[u],!0)(new n.ExportDefaultDeclaration(a[u]));break;case 193:this.$=n.addDataToNode(n,r[u-4],a[u-4],r[u],a[u],!0)(new n.ExportDefaultDeclaration(new n.Value(a[u-1])));break;case 194:this.$=n.addDataToNode(n,r[u-3],a[u-3],r[u],a[u],!0)(new n.ExportAllDeclaration(new n.Literal(a[u-2]),a[u]));break;case 195:this.$=n.addDataToNode(n,r[u-4],a[u-4],r[u],a[u],!0)(new n.ExportNamedDeclaration(new n.ExportSpecifierList([]),a[u]));break;case 196:this.$=n.addDataToNode(n,r[u-6],a[u-6],r[u],a[u],!0)(new n.ExportNamedDeclaration(new n.ExportSpecifierList(a[u-4]),a[u]));break;case 202:this.$=n.addDataToNode(n,r[u],a[u],r[u],a[u],!0)(new n.ExportSpecifier(a[u]));break;case 203:this.$=n.addDataToNode(n,r[u-2],a[u-2],r[u],a[u],!0)(new n.ExportSpecifier(a[u-2],a[u]));break;case 204:this.$=n.addDataToNode(n,r[u-2],a[u-2],r[u],a[u],!0)(new n.ExportSpecifier(a[u-2],n.addDataToNode(n,r[u],a[u],null,null,!0)(new n.DefaultLiteral(a[u]))));break;case 205:this.$=n.addDataToNode(n,r[u],a[u],r[u],a[u],!0)(new n.ExportSpecifier(n.addDataToNode(n,r[u],a[u],null,null,!0)(new n.DefaultLiteral(a[u]))));break;case 206:this.$=n.addDataToNode(n,r[u-2],a[u-2],r[u],a[u],!0)(new n.ExportSpecifier(n.addDataToNode(n,r[u-2],a[u-2],null,null,!0)(new n.DefaultLiteral(a[u-2])),a[u]));break;case 207:this.$=n.addDataToNode(n,r[u-2],a[u-2],r[u],a[u],!0)(new n.TaggedTemplateCall(a[u-2],a[u],a[u-1].soak));break;case 211:this.$=n.addDataToNode(n,r[u],a[u],r[u],a[u],!0)({soak:!1});break;case 212:this.$=n.addDataToNode(n,r[u],a[u],r[u],a[u],!0)({soak:!0});break;case 213:this.$=n.addDataToNode(n,r[u-1],a[u-1],r[u],a[u],!0)([]);break;case 214:this.$=n.addDataToNode(n,r[u-3],a[u-3],r[u],a[u],!0)((a[u-2].implicit=a[u-3].generated,a[u-2]));break;case 215:case 216:this.$=n.addDataToNode(n,r[u],a[u],r[u],a[u],!0)(new n.Value(new n.ThisLiteral(a[u])));break;case 217:this.$=n.addDataToNode(n,r[u-1],a[u-1],r[u],a[u],!0)(new n.Value(n.addDataToNode(n,r[u-1],a[u-1],null,null,!0)(new n.ThisLiteral(a[u-1])),[n.addDataToNode(n,r[u],a[u],null,null,!0)(new n.Access(a[u]))],"this"));break;case 218:this.$=n.addDataToNode(n,r[u-1],a[u-1],r[u],a[u],!0)(new n.Arr([]));break;case 219:this.$=n.addDataToNode(n,r[u-2],a[u-2],r[u],a[u],!0)(new n.Arr(a[u-1]));break;case 220:this.$=n.addDataToNode(n,r[u-3],a[u-3],r[u],a[u],!0)(new n.Arr([].concat(a[u-2],a[u-1])));break;case 221:this.$=n.addDataToNode(n,r[u],a[u],r[u],a[u],!0)({exclusive:!1});break;case 222:this.$=n.addDataToNode(n,r[u],a[u],r[u],a[u],!0)({exclusive:!0});break;case 223:case 224:this.$=n.addDataToNode(n,r[u-4],a[u-4],r[u],a[u],!0)(new n.Range(a[u-3],a[u-1],a[u-2].exclusive?"exclusive":"inclusive"));break;case 225:case 227:this.$=n.addDataToNode(n,r[u-2],a[u-2],r[u],a[u],!0)(new n.Range(a[u-2],a[u],a[u-1].exclusive?"exclusive":"inclusive"));break;case 226:case 228:this.$=n.addDataToNode(n,r[u-1],a[u-1],r[u],a[u],!0)(new n.Range(a[u-1],null,a[u].exclusive?"exclusive":"inclusive"));break;case 229:this.$=n.addDataToNode(n,r[u-1],a[u-1],r[u],a[u],!0)(new n.Range(null,a[u],a[u-1].exclusive?"exclusive":"inclusive"));break;case 230:this.$=n.addDataToNode(n,r[u],a[u],r[u],a[u],!0)(new n.Range(null,null,a[u].exclusive?"exclusive":"inclusive"));break;case 243:this.$=n.addDataToNode(n,r[u-3],a[u-3],r[u],a[u],!0)(a[u-2].concat(a[u-1]));break;case 244:this.$=n.addDataToNode(n,r[u-5],a[u-5],r[u],a[u],!0)(a[u-5].concat(a[u-4],a[u-2],a[u-1]));break;case 248:this.$=n.addDataToNode(n,r[u-1],a[u-1],r[u],a[u],!0)([].concat(a[u]));break;case 251:this.$=n.addDataToNode(n,r[u],a[u],r[u],a[u],!0)(new n.Elision);break;case 252:this.$=n.addDataToNode(n,r[u-1],a[u-1],r[u],a[u],!0)(a[u-1]);break;case 255:case 256:this.$=n.addDataToNode(n,r[u-2],a[u-2],r[u],a[u],!0)([].concat(a[u-2],a[u]));break;case 257:this.$=n.addDataToNode(n,r[u-1],a[u-1],r[u],a[u],!0)(new n.Try(a[u]));break;case 258:this.$=n.addDataToNode(n,r[u-2],a[u-2],r[u],a[u],!0)(new n.Try(a[u-1],a[u]));break;case 259:this.$=n.addDataToNode(n,r[u-3],a[u-3],r[u],a[u],!0)(new n.Try(a[u-2],null,a[u],n.addDataToNode(n,r[u-1],a[u-1],null,null,!0)(new n.Literal(a[u-1]))));break;case 260:this.$=n.addDataToNode(n,r[u-4],a[u-4],r[u],a[u],!0)(new n.Try(a[u-3],a[u-2],a[u],n.addDataToNode(n,r[u-1],a[u-1],null,null,!0)(new n.Literal(a[u-1]))));break;case 261:this.$=n.addDataToNode(n,r[u-2],a[u-2],r[u],a[u],!0)(new n.Catch(a[u],a[u-1]));break;case 262:this.$=n.addDataToNode(n,r[u-2],a[u-2],r[u],a[u],!0)(new n.Catch(a[u],n.addDataToNode(n,r[u-1],a[u-1],null,null,!0)(new n.Value(a[u-1]))));break;case 263:this.$=n.addDataToNode(n,r[u-1],a[u-1],r[u],a[u],!0)(new n.Catch(a[u]));break;case 264:this.$=n.addDataToNode(n,r[u-1],a[u-1],r[u],a[u],!0)(new n.Throw(a[u]));break;case 265:this.$=n.addDataToNode(n,r[u-3],a[u-3],r[u],a[u],!0)(new n.Throw(new n.Value(a[u-1])));break;case 266:this.$=n.addDataToNode(n,r[u-2],a[u-2],r[u],a[u],!0)(new n.Parens(a[u-1]));break;case 267:this.$=n.addDataToNode(n,r[u-4],a[u-4],r[u],a[u],!0)(new n.Parens(a[u-2]));break;case 268:case 272:this.$=n.addDataToNode(n,r[u-1],a[u-1],r[u],a[u],!0)(new n.While(a[u]));break;case 269:case 273:case 274:this.$=n.addDataToNode(n,r[u-3],a[u-3],r[u],a[u],!0)(new n.While(a[u-2],{guard:a[u]}));break;case 270:case 275:this.$=n.addDataToNode(n,r[u-1],a[u-1],r[u],a[u],!0)(new n.While(a[u],{invert:!0}));break;case 271:case 276:case 277:this.$=n.addDataToNode(n,r[u-3],a[u-3],r[u],a[u],!0)(new n.While(a[u-2],{invert:!0,guard:a[u]}));break;case 278:case 279:case 287:case 288:this.$=n.addDataToNode(n,r[u-1],a[u-1],r[u],a[u],!0)(a[u-1].addBody(a[u]));break;case 280:case 281:this.$=n.addDataToNode(n,r[u-1],a[u-1],r[u],a[u],!0)(Object.assign(a[u],{postfix:!0}).addBody(n.addDataToNode(n,r[u-1],a[u-1],null,null,!0)(n.Block.wrap([a[u-1]]))));break;case 283:this.$=n.addDataToNode(n,r[u-1],a[u-1],r[u],a[u],!0)(new n.While(n.addDataToNode(n,r[u-1],a[u-1],null,null,!0)(new n.BooleanLiteral("true")),{isLoop:!0}).addBody(a[u]));break;case 284:this.$=n.addDataToNode(n,r[u-1],a[u-1],r[u],a[u],!0)(new n.While(n.addDataToNode(n,r[u-1],a[u-1],null,null,!0)(new n.BooleanLiteral("true")),{isLoop:!0}).addBody(n.addDataToNode(n,r[u],a[u],null,null,!0)(n.Block.wrap([a[u]]))));break;case 285:case 286:this.$=n.addDataToNode(n,r[u-1],a[u-1],r[u],a[u],!0)((a[u].postfix=!0,a[u].addBody(a[u-1])));break;case 289:this.$=n.addDataToNode(n,r[u-1],a[u-1],r[u],a[u],!0)(new n.For([],{source:n.addDataToNode(n,r[u],a[u],null,null,!0)(new n.Value(a[u]))}));break;case 290:case 292:this.$=n.addDataToNode(n,r[u-3],a[u-3],r[u],a[u],!0)(new n.For([],{source:n.addDataToNode(n,r[u-2],a[u-2],null,null,!0)(new n.Value(a[u-2])),step:a[u]}));break;case 291:case 293:this.$=n.addDataToNode(n,r[u-1],a[u-1],r[u],a[u],!0)(a[u-1].addSource(a[u]));break;case 294:this.$=n.addDataToNode(n,r[u-1],a[u-1],r[u],a[u],!0)(new n.For([],{name:a[u][0],index:a[u][1]}));break;case 295:this.$=n.addDataToNode(n,r[u-2],a[u-2],r[u],a[u],!0)(function(){var e,t,i=d(a[u],2);return t=i[0],e=i[1],new n.For([],{name:t,index:e,await:!0,awaitTag:n.addDataToNode(n,r[u-1],a[u-1],null,null,!0)(new n.Literal(a[u-1]))})}());break;case 296:this.$=n.addDataToNode(n,r[u-2],a[u-2],r[u],a[u],!0)(function(){var e,t,i=d(a[u],2);return t=i[0],e=i[1],new n.For([],{name:t,index:e,own:!0,ownTag:n.addDataToNode(n,r[u-1],a[u-1],null,null,!0)(new n.Literal(a[u-1]))})}());break;case 302:this.$=n.addDataToNode(n,r[u-2],a[u-2],r[u],a[u],!0)([a[u-2],a[u]]);break;case 303:case 322:this.$=n.addDataToNode(n,r[u-1],a[u-1],r[u],a[u],!0)({source:a[u]});break;case 304:case 323:this.$=n.addDataToNode(n,r[u-1],a[u-1],r[u],a[u],!0)({source:a[u],object:!0});break;case 305:case 306:case 324:case 325:this.$=n.addDataToNode(n,r[u-3],a[u-3],r[u],a[u],!0)({source:a[u-2],guard:a[u]});break;case 307:case 308:case 326:case 327:this.$=n.addDataToNode(n,r[u-3],a[u-3],r[u],a[u],!0)({source:a[u-2],guard:a[u],object:!0});break;case 309:case 310:case 328:case 329:this.$=n.addDataToNode(n,r[u-3],a[u-3],r[u],a[u],!0)({source:a[u-2],step:a[u]});break;case 311:case 312:case 313:case 314:case 330:case 331:case 332:case 333:this.$=n.addDataToNode(n,r[u-5],a[u-5],r[u],a[u],!0)({source:a[u-4],guard:a[u-2],step:a[u]});break;case 315:case 316:case 317:case 318:case 334:case 335:case 336:case 337:this.$=n.addDataToNode(n,r[u-5],a[u-5],r[u],a[u],!0)({source:a[u-4],step:a[u-2],guard:a[u]});break;case 319:case 338:this.$=n.addDataToNode(n,r[u-1],a[u-1],r[u],a[u],!0)({source:a[u],from:!0});break;case 320:case 321:case 339:case 340:this.$=n.addDataToNode(n,r[u-3],a[u-3],r[u],a[u],!0)({source:a[u-2],guard:a[u],from:!0});break;case 341:case 342:this.$=n.addDataToNode(n,r[u-4],a[u-4],r[u],a[u],!0)(new n.Switch(a[u-3],a[u-1]));break;case 343:case 344:this.$=n.addDataToNode(n,r[u-6],a[u-6],r[u],a[u],!0)(new n.Switch(a[u-5],a[u-3],n.addDataToNode(n,r[u-2],a[u-2],r[u-1],a[u-1],!0)(a[u-1])));break;case 345:this.$=n.addDataToNode(n,r[u-3],a[u-3],r[u],a[u],!0)(new n.Switch(null,a[u-1]));break;case 346:this.$=n.addDataToNode(n,r[u-5],a[u-5],r[u],a[u],!0)(new n.Switch(null,a[u-3],n.addDataToNode(n,r[u-2],a[u-2],r[u-1],a[u-1],!0)(a[u-1])));break;case 349:this.$=n.addDataToNode(n,r[u-2],a[u-2],r[u],a[u],!0)(new n.SwitchWhen(a[u-1],a[u]));break;case 350:this.$=n.addDataToNode(n,r[u-3],a[u-3],r[u],a[u],!1)(n.addDataToNode(n,r[u-3],a[u-3],r[u-1],a[u-1],!0)(new n.SwitchWhen(a[u-2],a[u-1])));break;case 351:case 357:this.$=n.addDataToNode(n,r[u-2],a[u-2],r[u],a[u],!0)(new n.If(a[u-1],a[u],{type:a[u-2]}));break;case 352:case 358:this.$=n.addDataToNode(n,r[u-4],a[u-4],r[u],a[u],!0)(a[u-4].addElse(n.addDataToNode(n,r[u-2],a[u-2],r[u],a[u],!0)(new n.If(a[u-1],a[u],{type:a[u-2]}))));break;case 354:case 360:this.$=n.addDataToNode(n,r[u-2],a[u-2],r[u],a[u],!0)(a[u-2].addElse(a[u]));break;case 355:case 356:case 361:case 362:this.$=n.addDataToNode(n,r[u-2],a[u-2],r[u],a[u],!0)(new n.If(a[u],n.addDataToNode(n,r[u-2],a[u-2],null,null,!0)(n.Block.wrap([a[u-2]])),{type:a[u-1],postfix:!0}));break;case 366:this.$=n.addDataToNode(n,r[u-1],a[u-1],r[u],a[u],!0)(new n.Op(a[u-1].toString(),a[u],void 0,void 0,{originalOperator:a[u-1].original}));break;case 369:this.$=n.addDataToNode(n,r[u-1],a[u-1],r[u],a[u],!0)(new n.Op("-",a[u]));break;case 370:this.$=n.addDataToNode(n,r[u-1],a[u-1],r[u],a[u],!0)(new n.Op("+",a[u]));break;case 373:this.$=n.addDataToNode(n,r[u-1],a[u-1],r[u],a[u],!0)(new n.Op("--",a[u]));break;case 374:this.$=n.addDataToNode(n,r[u-1],a[u-1],r[u],a[u],!0)(new n.Op("++",a[u]));break;case 375:this.$=n.addDataToNode(n,r[u-1],a[u-1],r[u],a[u],!0)(new n.Op("--",a[u-1],null,!0));break;case 376:this.$=n.addDataToNode(n,r[u-1],a[u-1],r[u],a[u],!0)(new n.Op("++",a[u-1],null,!0));break;case 377:this.$=n.addDataToNode(n,r[u-1],a[u-1],r[u],a[u],!0)(new n.Existence(a[u-1]));break;case 378:this.$=n.addDataToNode(n,r[u-2],a[u-2],r[u],a[u],!0)(new n.Op("+",a[u-2],a[u]));break;case 379:this.$=n.addDataToNode(n,r[u-2],a[u-2],r[u],a[u],!0)(new n.Op("-",a[u-2],a[u]));break;case 380:case 381:case 382:case 384:case 385:case 386:case 389:this.$=n.addDataToNode(n,r[u-2],a[u-2],r[u],a[u],!0)(new n.Op(a[u-1],a[u-2],a[u]));break;case 383:case 387:case 388:this.$=n.addDataToNode(n,r[u-2],a[u-2],r[u],a[u],!0)(new n.Op(a[u-1].toString(),a[u-2],a[u],void 0,{originalOperator:a[u-1].original}));break;case 390:this.$=n.addDataToNode(n,r[u-2],a[u-2],r[u],a[u],!0)(function(){var e,t;return new n.Op(a[u-1].toString(),a[u-2],a[u],void 0,{invertOperator:null==(e=null==(t=a[u-1].invert)?void 0:t.original)?a[u-1].invert:e})}());break;case 391:this.$=n.addDataToNode(n,r[u-2],a[u-2],r[u],a[u],!0)(new n.Assign(a[u-2],a[u],a[u-1].toString(),{originalContext:a[u-1].original}));break;case 392:this.$=n.addDataToNode(n,r[u-4],a[u-4],r[u],a[u],!0)(new n.Assign(a[u-4],a[u-1],a[u-3].toString(),{originalContext:a[u-3].original}));break;case 393:this.$=n.addDataToNode(n,r[u-3],a[u-3],r[u],a[u],!0)(new n.Assign(a[u-3],a[u],a[u-2].toString(),{originalContext:a[u-2].original}))}},table:[{1:[2,1],3:1,4:2,5:3,7:4,8:5,9:6,10:7,11:27,12:28,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:n,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:E,89:T,92:39,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:B,182:60,183:H,184:U,185:W,186:q,187:z,188:X,189:G,190:J},{1:[3]},{1:[2,2],6:Y},t(K,[2,3]),t(Q,[2,6],{158:117,161:118,165:122,155:Z,157:ee,163:te,181:ie,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve}),t(Q,[2,7]),t(Q,[2,8],{165:122,158:124,161:125,155:Z,157:ee,163:te,181:ge}),t(Q,[2,9]),t(be,[2,16],{83:126,86:127,112:133,46:ye,47:ye,134:ye,105:we,106:ke,109:xe,110:Ee,111:Te,114:Ne,133:Ae}),t(be,[2,17],{112:133,86:136,105:we,106:ke,109:xe,110:Ee,111:Te,114:Ne}),t(be,[2,18]),t(be,[2,19]),t(be,[2,20]),t(be,[2,21]),t(be,[2,22]),t(be,[2,23]),t(be,[2,24]),t(be,[2,25]),t(be,[2,26]),t(be,[2,27]),t(Q,[2,28]),t(Q,[2,29]),t(Q,[2,30]),t(Ce,[2,12]),t(Ce,[2,13]),t(Ce,[2,14]),t(Ce,[2,15]),t(Q,[2,10]),t(Q,[2,11]),t(Le,Se,{66:[1,137]}),t(Le,[2,130]),t(Le,[2,131]),t(Le,[2,132]),t(Le,Ie),t(Le,[2,134]),t(Le,[2,135]),t(Le,[2,136]),t(Le,[2,137]),t(De,je,{90:138,97:139,98:140,38:142,72:143,99:144,34:145,39:s,40:a,73:Oe,75:Re,76:_e,116:L}),{5:149,7:4,8:5,9:6,10:7,11:27,12:28,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:n,33:Pe,34:66,37:148,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:E,89:T,92:39,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:B,182:60,183:H,184:U,185:W,186:q,187:z,188:X,189:G,190:J},{7:151,8:152,9:154,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:T,92:39,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:B,182:60,183:H,184:U,185:W,186:q,187:z,188:X,189:G,190:J},{7:156,8:157,9:154,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:T,92:39,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:B,182:60,183:H,184:U,185:W,186:q,187:z,188:X,189:G,190:J},{7:158,9:163,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:Ve,92:160,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:$e,183:Be,184:He,185:Ue,186:q,187:z,188:X,189:G,190:J},{7:166,9:163,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:Ve,92:160,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:$e,183:Be,184:He,185:Ue,186:q,187:z,188:X,189:G,190:J},{7:167,9:163,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:Ve,92:160,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:$e,183:Be,184:He,185:Ue,186:q,187:z,188:X,189:G,190:J},{7:168,9:163,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:Me,33:We,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:[1,170],88:Fe,89:Ve,92:160,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:$e,183:Be,184:He,185:Ue,186:q,187:z,188:X,189:G,190:J},{17:172,18:173,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:174,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,89:Ve,92:160,93:N,94:A,99:65,101:171,102:32,103:34,104:37,108:C,116:L,137:j,152:_,185:Ue},{17:172,18:173,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:174,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,89:Ve,92:160,93:N,94:A,99:65,101:175,102:32,103:34,104:37,108:C,116:L,137:j,152:_,185:Ue},t(qe,ze,{189:[1,176],190:[1,177],203:[1,178]}),t(be,[2,353],{176:[1,179]}),{33:Pe,37:180},{33:Pe,37:181},{33:Pe,37:182},t(be,[2,282]),{33:Pe,37:183},{33:Pe,37:184},{7:185,8:186,9:154,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:Me,33:[1,187],34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:T,92:39,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:B,182:60,183:H,184:U,185:W,186:q,187:z,188:X,189:G,190:J},t(Xe,[2,160],{58:30,79:31,102:32,56:33,103:34,81:35,80:36,104:37,99:65,34:66,43:67,53:69,38:84,72:85,45:94,92:160,17:172,18:173,65:174,37:188,101:190,33:Pe,39:s,40:a,44:r,46:o,47:l,54:c,55:h,59:u,60:p,61:m,62:f,63:v,64:g,73:b,75:y,82:w,85:k,89:Ve,93:N,94:A,108:C,116:L,120:[1,189],137:j,152:_,185:Ue}),{7:191,9:163,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:Me,33:[1,192],34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:Ve,92:160,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:$e,183:Be,184:He,185:Ue,186:q,187:z,188:X,189:G,190:J},t([1,6,35,52,74,76,96,135,142,153,155,156,157,163,164,181,191,192,193,194,195,196,197,198,199,200,201,202],Ge,{17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,13:23,15:25,16:26,65:29,58:30,79:31,102:32,56:33,103:34,81:35,80:36,104:37,101:48,179:49,158:51,154:52,159:53,161:54,162:55,99:65,34:66,43:67,53:69,38:84,72:85,165:91,45:94,92:160,9:163,7:193,14:i,32:Me,33:Je,36:Ye,39:s,40:a,44:r,46:o,47:l,54:c,55:h,59:u,60:p,61:m,62:f,63:v,64:g,73:b,75:y,82:w,85:k,87:[1,196],88:Fe,89:Ve,93:N,94:A,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,160:F,174:$,180:$e,183:Be,184:He,185:Ue,186:q,187:z,188:X,189:G,190:J}),t(Q,[2,359],{176:[1,197]}),{18:199,29:198,89:T,92:39,93:N,94:A},t([1,6,35,52,74,76,96,135,142,153,155,156,157,163,164,181],Ke,{17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,13:23,15:25,16:26,65:29,58:30,79:31,102:32,56:33,103:34,81:35,80:36,104:37,101:48,179:49,158:51,154:52,159:53,161:54,162:55,99:65,34:66,43:67,53:69,38:84,72:85,165:91,45:94,92:160,9:163,7:200,14:i,32:Me,33:Qe,39:s,40:a,44:r,46:o,47:l,54:c,55:h,59:u,60:p,61:m,62:f,63:v,64:g,73:b,75:y,82:w,85:k,87:x,88:Fe,89:Ve,93:N,94:A,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,160:F,174:$,180:$e,183:Be,184:He,185:Ue,186:q,187:z,188:X,189:G,190:J}),{38:206,39:s,40:a,45:202,46:o,47:l,116:[1,205],122:203,123:204,128:Ze},{26:209,38:210,39:s,40:a,116:[1,208],119:S,127:[1,211],131:[1,212]},t(qe,[2,127]),t(qe,[2,128]),t(Le,[2,52]),t(Le,[2,53]),t(Le,[2,54]),t(Le,[2,55]),t(Le,[2,56]),t(Le,[2,57]),t(Le,[2,58]),t(Le,[2,59]),{4:213,5:3,7:4,8:5,9:6,10:7,11:27,12:28,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:n,33:[1,214],34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:E,89:T,92:39,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:B,182:60,183:H,184:U,185:W,186:q,187:z,188:X,189:G,190:J},{7:215,8:216,9:154,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:Me,33:et,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,74:tt,75:y,76:it,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:T,92:39,93:N,94:A,96:nt,99:65,100:225,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,138:218,139:219,143:224,144:221,145:220,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:B,182:60,183:H,184:U,185:W,186:q,187:z,188:X,189:G,190:J},{83:227,105:st,106:at,133:Ae,134:ye},{84:230,134:rt},t(Le,[2,215]),t(Le,ot,{41:232,42:lt}),{105:[1,234]},t(ct,[2,102]),t(ct,[2,103]),t(ht,[2,122]),t(ht,[2,125]),{7:235,8:236,9:154,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:T,92:39,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:B,182:60,183:H,184:U,185:W,186:q,187:z,188:X,189:G,190:J},{7:237,8:238,9:154,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:T,92:39,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:B,182:60,183:H,184:U,185:W,186:q,187:z,188:X,189:G,190:J},{7:239,8:240,9:154,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:T,92:39,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:B,182:60,183:H,184:U,185:W,186:q,187:z,188:X,189:G,190:J},{7:242,9:163,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:Me,33:Pe,34:66,37:241,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:Ve,92:160,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:$e,183:Be,184:He,185:Ue,186:q,187:z,188:X,189:G,190:J},{34:251,38:248,39:s,40:a,72:249,73:b,75:Re,88:ut,99:250,102:243,116:L,168:244,169:dt,170:247},{166:252,167:253,171:[1,254],172:[1,255],173:[1,256]},t([6,33,96,118],pt,{45:94,117:257,67:258,68:259,69:260,71:261,43:264,77:266,38:267,41:268,72:269,78:270,34:271,79:272,80:273,81:274,39:s,40:a,42:lt,44:r,46:o,47:l,73:mt,75:ft,76:vt,82:gt,85:bt,116:L,137:j,152:_}),t(yt,[2,40]),t(yt,[2,41]),t(Le,[2,50]),{17:172,18:173,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:277,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:174,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,89:Ve,92:160,93:N,94:A,99:65,101:278,102:32,103:34,104:37,108:C,116:L,137:j,152:_,185:Ue},t(wt,[2,37]),t(wt,[2,38]),t(kt,[2,42]),{45:282,46:o,47:l,48:279,50:280,51:xt},t(K,[2,5],{7:4,8:5,9:6,10:7,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,13:23,15:25,16:26,11:27,12:28,65:29,58:30,79:31,102:32,56:33,103:34,81:35,80:36,104:37,92:39,101:48,179:49,158:51,154:52,159:53,161:54,162:55,182:60,99:65,34:66,43:67,53:69,38:84,72:85,165:91,45:94,5:283,14:i,32:n,39:s,40:a,44:r,46:o,47:l,54:c,55:h,59:u,60:p,61:m,62:f,63:v,64:g,73:b,75:y,82:w,85:k,87:x,88:E,89:T,93:N,94:A,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,155:P,157:M,160:F,163:V,174:$,180:B,183:H,184:U,185:W,186:q,187:z,188:X,189:G,190:J}),t(be,[2,377]),{7:284,9:163,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:Ve,92:160,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:$e,183:Be,184:He,185:Ue,186:q,187:z,188:X,189:G,190:J},{7:285,9:163,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:Ve,92:160,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:$e,183:Be,184:He,185:Ue,186:q,187:z,188:X,189:G,190:J},{7:286,9:163,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:Ve,92:160,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:$e,183:Be,184:He,185:Ue,186:q,187:z,188:X,189:G,190:J},{7:287,9:163,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:Ve,92:160,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:$e,183:Be,184:He,185:Ue,186:q,187:z,188:X,189:G,190:J},{7:288,9:163,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:Ve,92:160,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:$e,183:Be,184:He,185:Ue,186:q,187:z,188:X,189:G,190:J},{7:289,9:163,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:Ve,92:160,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:$e,183:Be,184:He,185:Ue,186:q,187:z,188:X,189:G,190:J},{7:290,9:163,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:Ve,92:160,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:$e,183:Be,184:He,185:Ue,186:q,187:z,188:X,189:G,190:J},{7:291,9:163,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:Ve,92:160,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:$e,183:Be,184:He,185:Ue,186:q,187:z,188:X,189:G,190:J},{7:292,9:163,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:Ve,92:160,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:$e,183:Be,184:He,185:Ue,186:q,187:z,188:X,189:G,190:J},{7:293,9:163,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:Ve,92:160,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:$e,183:Be,184:He,185:Ue,186:q,187:z,188:X,189:G,190:J},{7:294,9:163,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:Ve,92:160,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:$e,183:Be,184:He,185:Ue,186:q,187:z,188:X,189:G,190:J},{7:295,9:163,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:Ve,92:160,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:$e,183:Be,184:He,185:Ue,186:q,187:z,188:X,189:G,190:J},{7:296,9:163,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:Ve,92:160,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:$e,183:Be,184:He,185:Ue,186:q,187:z,188:X,189:G,190:J},{7:297,8:298,9:154,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:T,92:39,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:B,182:60,183:H,184:U,185:W,186:q,187:z,188:X,189:G,190:J},t(be,[2,281]),t(be,[2,286]),{7:237,8:299,9:154,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:T,92:39,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:B,182:60,183:H,184:U,185:W,186:q,187:z,188:X,189:G,190:J},{7:239,8:300,9:154,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:T,92:39,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:B,182:60,183:H,184:U,185:W,186:q,187:z,188:X,189:G,190:J},{34:251,38:248,39:s,40:a,72:249,73:b,75:Re,88:ut,99:250,102:301,116:L,168:244,169:dt,170:247},{166:252,171:[1,302],172:[1,303],173:[1,304]},{7:305,8:306,9:154,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:T,92:39,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:B,182:60,183:H,184:U,185:W,186:q,187:z,188:X,189:G,190:J},t(be,[2,280]),t(be,[2,285]),{45:307,46:o,47:l,84:308,134:rt},t(ht,[2,123]),t(Et,[2,212]),{41:309,42:lt},{41:310,42:lt},t(ht,[2,146],{41:311,42:lt}),t(ht,[2,147],{41:312,42:lt}),t(ht,[2,148]),{7:315,8:317,9:154,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:Me,33:[1,314],34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,76:Tt,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:T,92:39,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,113:313,115:316,116:L,119:S,121:I,129:D,137:j,141:318,142:Nt,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:B,182:60,183:H,184:U,185:W,186:q,187:z,188:X,189:G,190:J},{106:ke,112:321,114:Ne},t(ht,[2,124]),{6:[1,323],7:322,9:163,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:Me,33:[1,324],34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:Ve,92:160,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:$e,183:Be,184:He,185:Ue,186:q,187:z,188:X,189:G,190:J},t(At,Ct,{95:327,91:[1,325],96:Lt}),t(St,[2,107]),t(St,[2,111],{66:[1,329],76:[1,328]}),t(St,[2,115],{38:142,72:143,99:144,34:145,98:330,39:s,40:a,73:Oe,75:Re,116:L}),t(It,[2,116]),t(It,[2,117]),t(It,[2,118]),t(It,[2,119]),{41:232,42:lt},{7:331,8:332,9:154,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:Me,33:et,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,74:tt,75:y,76:it,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:T,92:39,93:N,94:A,96:nt,99:65,100:225,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,138:218,139:219,143:224,144:221,145:220,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:B,182:60,183:H,184:U,185:W,186:q,187:z,188:X,189:G,190:J},t(Le,[2,99]),t(Q,[2,101]),{4:334,5:3,7:4,8:5,9:6,10:7,11:27,12:28,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:n,34:66,35:[1,333],38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:E,89:T,92:39,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:B,182:60,183:H,184:U,185:W,186:q,187:z,188:X,189:G,190:J},t(Dt,jt,{158:117,161:118,165:122,191:ae}),t(Q,[2,363]),{7:168,9:163,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:Me,33:We,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:Ve,92:160,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:$e,183:Be,184:He,185:Ue,186:q,187:z,188:X,189:G,190:J},{155:Z,157:ee,158:124,161:125,163:te,165:122,181:ge},t([1,6,35,52,74,76,91,96,107,118,135,142,153,155,156,157,163,164,181,191,192,193,194,195,196,197,198,199,200,201,202],Ge,{17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,13:23,15:25,16:26,65:29,58:30,79:31,102:32,56:33,103:34,81:35,80:36,104:37,101:48,179:49,158:51,154:52,159:53,161:54,162:55,99:65,34:66,43:67,53:69,38:84,72:85,165:91,45:94,92:160,9:163,7:193,14:i,32:Me,33:Je,36:Ye,39:s,40:a,44:r,46:o,47:l,54:c,55:h,59:u,60:p,61:m,62:f,63:v,64:g,73:b,75:y,82:w,85:k,87:x,88:Fe,89:Ve,93:N,94:A,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,160:F,174:$,180:$e,183:Be,184:He,185:Ue,186:q,187:z,188:X,189:G,190:J}),t(Dt,Ot,{158:117,161:118,165:122,191:ae}),t(Q,[2,364]),t(Rt,[2,368],{158:117,161:118,165:122,191:ae,193:oe}),t(De,je,{97:139,98:140,38:142,72:143,99:144,34:145,90:336,39:s,40:a,73:Oe,75:Re,76:_e,116:L}),{33:Pe,37:148},{7:337,9:163,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:Ve,92:160,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:$e,183:Be,184:He,185:Ue,186:q,187:z,188:X,189:G,190:J},{7:338,9:163,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:Ve,92:160,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:$e,183:Be,184:He,185:Ue,186:q,187:z,188:X,189:G,190:J},{155:Z,157:ee,158:124,161:125,163:te,165:122,181:[1,339]},{18:199,89:Ve,92:160,93:N,94:A},{7:340,9:163,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:Ve,92:160,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:$e,183:Be,184:He,185:Ue,186:q,187:z,188:X,189:G,190:J},t(Rt,[2,369],{158:117,161:118,165:122,191:ae,193:oe}),t(Rt,[2,370],{158:117,161:118,165:122,191:ae,193:oe}),t(Dt,[2,371],{158:117,161:118,165:122,191:ae}),{34:341,116:L},t(Q,[2,97],{17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,13:23,15:25,16:26,65:29,58:30,79:31,102:32,56:33,103:34,81:35,80:36,104:37,101:48,179:49,158:51,154:52,159:53,161:54,162:55,99:65,34:66,43:67,53:69,38:84,72:85,165:91,45:94,92:160,9:163,7:342,14:i,32:Me,39:s,40:a,44:r,46:o,47:l,54:c,55:h,59:u,60:p,61:m,62:f,63:v,64:g,73:b,75:y,82:w,85:k,87:x,88:Fe,89:Ve,93:N,94:A,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,155:Ke,157:Ke,163:Ke,181:Ke,160:F,174:$,180:$e,183:Be,184:He,185:Ue,186:q,187:z,188:X,189:G,190:J}),t(be,[2,373],{46:ze,47:ze,105:ze,106:ze,109:ze,110:ze,111:ze,114:ze,133:ze,134:ze}),t(Et,ye,{83:126,86:127,112:133,105:we,106:ke,109:xe,110:Ee,111:Te,114:Ne,133:Ae}),{86:136,105:we,106:ke,109:xe,110:Ee,111:Te,112:133,114:Ne},t(_t,Se),t(be,[2,374],{46:ze,47:ze,105:ze,106:ze,109:ze,110:ze,111:ze,114:ze,133:ze,134:ze}),t(be,[2,375]),t(be,[2,376]),{6:[1,345],7:343,9:163,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:Me,33:[1,344],34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:Ve,92:160,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:$e,183:Be,184:He,185:Ue,186:q,187:z,188:X,189:G,190:J},{33:Pe,37:346,180:[1,347]},t(be,[2,257],{148:348,149:[1,349],150:[1,350]}),t(be,[2,278]),t(be,[2,279]),t(be,[2,287]),t(be,[2,288]),{33:[1,351],155:Z,157:ee,158:117,161:118,163:te,165:122,181:ie,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve},{33:[1,352]},{175:353,177:354,178:Pt},t(be,[2,161]),{7:356,9:163,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:Ve,92:160,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:$e,183:Be,184:He,185:Ue,186:q,187:z,188:X,189:G,190:J},t(Xe,[2,164],{37:357,33:Pe,46:ze,47:ze,105:ze,106:ze,109:ze,110:ze,111:ze,114:ze,133:ze,134:ze,120:[1,358]}),t(Mt,[2,264],{158:117,161:118,165:122,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve}),{34:359,116:L},t(Mt,[2,32],{158:117,161:118,165:122,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve}),{34:360,116:L},{7:361,9:163,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:Ve,92:160,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:$e,183:Be,184:He,185:Ue,186:q,187:z,188:X,189:G,190:J},t([1,6,35,52,74,76,96,135,142,153,156,164],[2,95],{17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,13:23,15:25,16:26,65:29,58:30,79:31,102:32,56:33,103:34,81:35,80:36,104:37,101:48,179:49,158:51,154:52,159:53,161:54,162:55,99:65,34:66,43:67,53:69,38:84,72:85,165:91,45:94,92:160,9:163,7:362,14:i,32:Me,33:Qe,39:s,40:a,44:r,46:o,47:l,54:c,55:h,59:u,60:p,61:m,62:f,63:v,64:g,73:b,75:y,82:w,85:k,87:x,88:Fe,89:Ve,93:N,94:A,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,155:Ke,157:Ke,163:Ke,181:Ke,160:F,174:$,180:$e,183:Be,184:He,185:Ue,186:q,187:z,188:X,189:G,190:J}),{33:Pe,37:363,180:[1,364]},t(Q,[2,365]),t(Le,[2,394]),t(Ce,Ft,{158:117,161:118,165:122,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve}),{34:365,116:L},t(Ce,[2,168]),{36:[1,366],96:[1,367]},{36:[1,368]},{33:Vt,38:373,39:s,40:a,118:[1,369],124:370,125:371,127:$t},t([36,96],[2,184]),{126:[1,375]},{33:Bt,38:380,39:s,40:a,118:[1,376],127:Ht,130:377,132:378},t(Ce,[2,188]),{66:[1,382]},{7:383,9:163,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:Me,33:[1,384],34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:Ve,92:160,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:$e,183:Be,184:He,185:Ue,186:q,187:z,188:X,189:G,190:J},{36:[1,385]},{6:Y,153:[1,386]},{4:387,5:3,7:4,8:5,9:6,10:7,11:27,12:28,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:n,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:E,89:T,92:39,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:B,182:60,183:H,184:U,185:W,186:q,187:z,188:X,189:G,190:J},t(Ut,Wt,{158:117,161:118,165:122,141:388,76:[1,389],142:Nt,155:Z,157:ee,163:te,181:ie,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve}),t(Ut,qt,{141:390,76:Tt,142:Nt}),t(zt,[2,218]),{7:331,8:332,9:154,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,74:[1,391],75:y,76:it,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:T,92:39,93:N,94:A,96:nt,99:65,100:225,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,143:393,145:392,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:B,182:60,183:H,184:U,185:W,186:q,187:z,188:X,189:G,190:J},t([6,33,74],Ct,{140:394,95:396,96:Xt}),t(Gt,[2,249],{6:Jt}),t(Yt,[2,240]),{7:331,8:332,9:154,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:Me,33:et,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,76:it,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:T,92:39,93:N,94:A,96:nt,99:65,100:225,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,138:399,139:398,143:224,144:221,145:220,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:B,182:60,183:H,184:U,185:W,186:q,187:z,188:X,189:G,190:J},t(Kt,[2,251]),t(Yt,[2,245]),t(Qt,[2,238]),t(Qt,[2,239],{17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,13:23,15:25,16:26,65:29,58:30,79:31,102:32,56:33,103:34,81:35,80:36,104:37,101:48,179:49,158:51,154:52,159:53,161:54,162:55,99:65,34:66,43:67,53:69,38:84,72:85,165:91,45:94,92:160,9:163,7:400,14:i,32:Me,39:s,40:a,44:r,46:o,47:l,54:c,55:h,59:u,60:p,61:m,62:f,63:v,64:g,73:b,75:y,82:w,85:k,87:x,88:Fe,89:Ve,93:N,94:A,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,155:P,157:M,160:F,163:V,174:$,180:$e,183:Be,184:He,185:Ue,186:q,187:z,188:X,189:G,190:J}),{84:401,134:rt},{41:402,42:lt},{7:403,9:163,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:Me,33:[1,404],34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:Ve,92:160,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:$e,183:Be,184:He,185:Ue,186:q,187:z,188:X,189:G,190:J},t(Zt,[2,210]),{7:331,8:332,9:154,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:Me,33:ei,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,76:it,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:T,92:39,93:N,94:A,99:65,100:225,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,135:[1,405],136:406,137:j,143:407,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:B,182:60,183:H,184:U,185:W,186:q,187:z,188:X,189:G,190:J},t(ti,[2,217]),t(ti,[2,39]),{41:409,42:lt},{33:Pe,37:410,155:Z,157:ee,158:117,161:118,163:te,165:122,181:ie,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve},{33:Pe,37:411},t(ii,[2,272],{158:117,161:118,165:122,155:Z,156:[1,412],157:ee,163:te,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve}),{33:[2,268],156:[1,413]},t(ii,[2,275],{158:117,161:118,165:122,155:Z,156:[1,414],157:ee,163:te,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve}),{33:[2,270],156:[1,415]},t(be,[2,283]),t(ni,[2,284],{158:117,161:118,165:122,155:Z,157:ee,163:te,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve}),{33:si,164:[1,416]},t(ai,[2,294]),{34:251,38:248,39:s,40:a,72:249,73:Oe,75:Re,99:250,116:L,168:417,170:247},{34:251,38:248,39:s,40:a,72:249,73:Oe,75:Re,99:250,116:L,168:418,170:247},t(ai,[2,301],{96:[1,419]}),t(ri,[2,297]),t(ri,[2,298]),t(ri,[2,299]),t(ri,[2,300]),t(be,[2,291]),{33:[2,293]},{7:420,8:421,9:154,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:T,92:39,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:B,182:60,183:H,184:U,185:W,186:q,187:z,188:X,189:G,190:J},{7:422,8:423,9:154,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:T,92:39,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:B,182:60,183:H,184:U,185:W,186:q,187:z,188:X,189:G,190:J},{7:424,8:425,9:154,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:T,92:39,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:B,182:60,183:H,184:U,185:W,186:q,187:z,188:X,189:G,190:J},t(oi,Ct,{95:426,96:li}),t(ci,[2,156]),t(ci,[2,63],{70:[1,428]}),t(ci,[2,64]),t(hi,[2,72],{112:133,83:431,86:432,66:[1,429],76:[1,430],105:we,106:ke,109:xe,110:Ee,111:Te,114:Ne,133:Ae,134:ye}),{7:433,9:163,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:Ve,92:160,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:$e,183:Be,184:He,185:Ue,186:q,187:z,188:X,189:G,190:J},t([76,105,106,109,110,111,114,133,134],ot,{41:232,42:lt,73:[1,434]}),t(hi,[2,75]),{34:271,38:267,39:s,40:a,41:268,42:lt,71:435,72:269,75:y,77:436,78:270,79:272,80:273,81:274,82:gt,85:bt,116:L,137:j,152:_},{76:[1,437],83:438,86:439,105:we,106:ke,109:xe,110:Ee,111:Te,112:133,114:Ne,133:Ae,134:ye},t(ui,[2,69]),t(ui,[2,70]),t(ui,[2,71]),t(di,[2,80]),t(di,[2,81]),t(di,[2,82]),t(di,[2,83]),t(di,[2,84]),{83:440,105:st,106:at,133:Ae,134:ye},{84:441,134:rt},t(_t,Ie,{57:[1,442]}),t(_t,ze),{45:282,46:o,47:l,49:[1,443],50:444,51:xt},t(pi,[2,44]),{4:445,5:3,7:4,8:5,9:6,10:7,11:27,12:28,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:n,33:[1,446],34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,52:[1,447],53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:E,89:T,92:39,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:B,182:60,183:H,184:U,185:W,186:q,187:z,188:X,189:G,190:J},t(pi,[2,49]),t(K,[2,4]),t(mi,[2,378],{158:117,161:118,165:122,191:ae,192:re,193:oe}),t(mi,[2,379],{158:117,161:118,165:122,191:ae,192:re,193:oe}),t(Rt,[2,380],{158:117,161:118,165:122,191:ae,193:oe}),t(Rt,[2,381],{158:117,161:118,165:122,191:ae,193:oe}),t([1,6,33,35,52,74,76,91,96,107,118,135,142,153,155,156,157,163,164,181,194,195,196,197,198,199,200,201,202],[2,382],{158:117,161:118,165:122,187:ne,188:se,191:ae,192:re,193:oe}),t([1,6,33,35,52,74,76,91,96,107,118,135,142,153,155,156,157,163,164,181,195,196,197,198,199,200,201],[2,383],{158:117,161:118,165:122,187:ne,188:se,191:ae,192:re,193:oe,194:le,202:ve}),t([1,6,33,35,52,74,76,91,96,107,118,135,142,153,155,156,157,163,164,181,196,197,198,199,200,201],[2,384],{158:117,161:118,165:122,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,202:ve}),t([1,6,33,35,52,74,76,91,96,107,118,135,142,153,155,156,157,163,164,181,197,198,199,200,201],[2,385],{158:117,161:118,165:122,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,202:ve}),t([1,6,33,35,52,74,76,91,96,107,118,135,142,153,155,156,157,163,164,181,198,199,200,201],[2,386],{158:117,161:118,165:122,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,202:ve}),t([1,6,33,35,52,74,76,91,96,107,118,135,142,153,155,156,157,163,164,181,199,200,201],[2,387],{158:117,161:118,165:122,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,202:ve}),t([1,6,33,35,52,74,76,91,96,107,118,135,142,153,155,156,157,163,164,181,200,201],[2,388],{158:117,161:118,165:122,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,202:ve}),t([1,6,33,35,52,74,76,91,96,107,118,135,142,153,155,156,157,163,164,181,201],[2,389],{158:117,161:118,165:122,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,202:ve}),t([1,6,33,35,52,74,76,91,96,107,118,135,142,153,155,156,157,163,164,181,195,196,197,198,199,200,201,202],[2,390],{158:117,161:118,165:122,187:ne,188:se,191:ae,192:re,193:oe,194:le}),t(ni,fi,{158:117,161:118,165:122,155:Z,157:ee,163:te,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve}),t(Q,[2,362]),{156:[1,448]},{156:[1,449]},t([1,6,33,35,52,74,76,91,96,107,118,135,142,153,155,156,157,163,181,187,188,191,192,193,194,195,196,197,198,199,200,201,202],si,{164:[1,450]}),{7:451,8:452,9:154,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:T,92:39,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:B,182:60,183:H,184:U,185:W,186:q,187:z,188:X,189:G,190:J},{7:453,8:454,9:154,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:T,92:39,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:B,182:60,183:H,184:U,185:W,186:q,187:z,188:X,189:G,190:J},{7:455,8:456,9:154,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:T,92:39,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:B,182:60,183:H,184:U,185:W,186:q,187:z,188:X,189:G,190:J},t(ni,vi,{158:117,161:118,165:122,155:Z,157:ee,163:te,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve}),t(Q,[2,361]),t(Zt,[2,207]),t(Zt,[2,208]),t(ht,[2,142]),t(ht,[2,143]),t(ht,[2,144]),t(ht,[2,145]),{107:[1,457]},{7:315,8:317,9:154,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,76:Tt,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:T,92:39,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,113:458,115:316,116:L,119:S,121:I,129:D,137:j,141:318,142:Nt,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:B,182:60,183:H,184:U,185:W,186:q,187:z,188:X,189:G,190:J},t(gi,[2,152],{158:117,161:118,165:122,141:459,76:Tt,142:Nt,155:Z,157:ee,163:te,181:ie,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve}),t(gi,[2,153]),{76:Tt,141:460,142:Nt},t(gi,[2,230],{17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,13:23,15:25,16:26,65:29,58:30,79:31,102:32,56:33,103:34,81:35,80:36,104:37,101:48,179:49,158:51,154:52,159:53,161:54,162:55,99:65,34:66,43:67,53:69,38:84,72:85,165:91,45:94,92:160,9:163,7:461,14:i,32:Me,39:s,40:a,44:r,46:o,47:l,54:c,55:h,59:u,60:p,61:m,62:f,63:v,64:g,73:b,75:y,82:w,85:k,87:x,88:Fe,89:Ve,93:N,94:A,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,155:P,157:M,160:F,163:V,174:$,180:$e,183:Be,184:He,185:Ue,186:q,187:z,188:X,189:G,190:J}),t(bi,[2,221]),t(bi,yi),t(ht,[2,151]),t(Mt,[2,60],{158:117,161:118,165:122,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve}),{7:462,9:163,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:Ve,92:160,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:$e,183:Be,184:He,185:Ue,186:q,187:z,188:X,189:G,190:J},{7:463,9:163,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:Ve,92:160,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:$e,183:Be,184:He,185:Ue,186:q,187:z,188:X,189:G,190:J},{92:464,93:N,94:A},t(wi,ki,{98:140,38:142,72:143,99:144,34:145,97:465,39:s,40:a,73:Oe,75:Re,76:_e,116:L}),{6:xi,33:Ei},t(St,[2,112]),{7:468,9:163,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:Ve,92:160,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:$e,183:Be,184:He,185:Ue,186:q,187:z,188:X,189:G,190:J},t(St,[2,113]),t(Qt,Wt,{158:117,161:118,165:122,76:[1,469],155:Z,157:ee,163:te,181:ie,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve}),t(Qt,qt),t(Ti,[2,35]),{6:Y,35:[1,470]},{7:471,9:163,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:Ve,92:160,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:$e,183:Be,184:He,185:Ue,186:q,187:z,188:X,189:G,190:J},t(At,Ct,{95:327,91:[1,472],96:Lt}),t(Dt,jt,{158:117,161:118,165:122,191:ae}),t(Dt,Ot,{158:117,161:118,165:122,191:ae}),{7:473,9:163,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:Ve,92:160,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:$e,183:Be,184:He,185:Ue,186:q,187:z,188:X,189:G,190:J},{33:Pe,37:410,155:Z,157:ee,158:117,161:118,163:te,165:122,181:Ni,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve},{35:[1,474]},t(Q,[2,96],{158:117,161:118,165:122,155:Ft,157:Ft,163:Ft,181:Ft,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve}),t(Mt,[2,391],{158:117,161:118,165:122,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve}),{7:475,9:163,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:Ve,92:160,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:$e,183:Be,184:He,185:Ue,186:q,187:z,188:X,189:G,190:J},{7:476,9:163,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:Ve,92:160,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:$e,183:Be,184:He,185:Ue,186:q,187:z,188:X,189:G,190:J},t(be,[2,354]),{7:477,9:163,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:Ve,92:160,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:$e,183:Be,184:He,185:Ue,186:q,187:z,188:X,189:G,190:J},t(be,[2,258],{149:[1,478]}),{33:Pe,37:479},{33:Pe,34:481,37:482,38:480,39:s,40:a,116:L},{175:483,177:354,178:Pt},{175:484,177:354,178:Pt},{35:[1,485],176:[1,486],177:487,178:Pt},t(Ai,[2,347]),{7:489,8:490,9:154,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:T,92:39,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,146:488,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:B,182:60,183:H,184:U,185:W,186:q,187:z,188:X,189:G,190:J},t(Ci,[2,162],{158:117,161:118,165:122,37:491,33:Pe,155:Z,157:ee,163:te,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve}),t(be,[2,165]),{7:492,9:163,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:Ve,92:160,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:$e,183:Be,184:He,185:Ue,186:q,187:z,188:X,189:G,190:J},{35:[1,493]},{35:[1,494]},t(Mt,[2,34],{158:117,161:118,165:122,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve}),t(Q,[2,94],{158:117,161:118,165:122,155:Ft,157:Ft,163:Ft,181:Ft,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve}),t(Q,[2,360]),{7:496,8:495,9:154,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:T,92:39,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:B,182:60,183:H,184:U,185:W,186:q,187:z,188:X,189:G,190:J},{35:[1,497]},{45:498,46:o,47:l},{116:[1,500],123:499,128:Ze},{45:501,46:o,47:l},{36:[1,502]},t(oi,Ct,{95:503,96:Li}),t(ci,[2,175]),{33:Vt,38:373,39:s,40:a,124:505,125:371,127:$t},t(ci,[2,180],{126:[1,506]}),t(ci,[2,182],{126:[1,507]}),{38:508,39:s,40:a},t(Ce,[2,186],{36:[1,509]}),t(oi,Ct,{95:510,96:Si}),t(ci,[2,197]),{33:Bt,38:380,39:s,40:a,127:Ht,130:512,132:378},t(ci,[2,202],{126:[1,513]}),t(ci,[2,205],{126:[1,514]}),{6:[1,516],7:515,9:163,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:Me,33:[1,517],34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:Ve,92:160,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:$e,183:Be,184:He,185:Ue,186:q,187:z,188:X,189:G,190:J},t(Ii,[2,192],{158:117,161:118,165:122,155:Z,157:ee,163:te,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve}),{34:518,116:L},{45:519,46:o,47:l},t(Le,[2,266]),{6:Y,35:[1,520]},{7:521,9:163,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:Ve,92:160,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:$e,183:Be,184:He,185:Ue,186:q,187:z,188:X,189:G,190:J},t([14,32,39,40,44,46,47,54,55,59,60,61,62,63,64,73,75,82,85,87,88,89,93,94,108,116,119,121,129,137,147,151,152,155,157,160,163,174,180,183,184,185,186,187,188,189,190],yi,{6:Di,33:Di,74:Di,96:Di}),{7:522,9:163,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:Ve,92:160,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:$e,183:Be,184:He,185:Ue,186:q,187:z,188:X,189:G,190:J},t(zt,[2,219]),t(Gt,[2,250],{6:Jt}),t(Yt,[2,246]),{33:ji,74:[1,523]},t([6,33,35,74],ki,{17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,13:23,15:25,16:26,65:29,58:30,79:31,102:32,56:33,103:34,81:35,80:36,104:37,92:39,101:48,179:49,158:51,154:52,159:53,161:54,162:55,182:60,99:65,34:66,43:67,53:69,38:84,72:85,165:91,45:94,9:154,145:220,143:224,100:225,7:331,8:332,144:525,138:526,14:i,32:Me,39:s,40:a,44:r,46:o,47:l,54:c,55:h,59:u,60:p,61:m,62:f,63:v,64:g,73:b,75:y,76:it,82:w,85:k,87:x,88:Fe,89:T,93:N,94:A,96:nt,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,155:P,157:M,160:F,163:V,174:$,180:B,183:H,184:U,185:W,186:q,187:z,188:X,189:G,190:J}),t(Oi,[2,247],{6:[1,527]}),t(Kt,[2,252]),t(wi,Ct,{95:396,140:528,96:Xt}),{7:331,8:332,9:154,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,76:it,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:T,92:39,93:N,94:A,96:nt,99:65,100:225,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,143:393,145:392,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:B,182:60,183:H,184:U,185:W,186:q,187:z,188:X,189:G,190:J},t(Qt,[2,121],{158:117,161:118,165:122,155:Z,157:ee,163:te,181:Ni,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve}),t(Zt,[2,209]),t(Le,[2,138]),{107:[1,529],155:Z,157:ee,158:117,161:118,163:te,165:122,181:Ni,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve},{7:530,9:163,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:Ve,92:160,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:$e,183:Be,184:He,185:Ue,186:q,187:z,188:X,189:G,190:J},t(Zt,[2,213]),t([6,33,135],Ct,{95:531,96:Ri}),t(_i,[2,231]),{7:331,8:332,9:154,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:Me,33:ei,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,76:it,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:T,92:39,93:N,94:A,99:65,100:225,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,136:533,137:j,143:407,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:B,182:60,183:H,184:U,185:W,186:q,187:z,188:X,189:G,190:J},t(Le,[2,141]),t(Pi,[2,351]),t(Mi,[2,357]),{7:534,9:163,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:Ve,92:160,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:$e,183:Be,184:He,185:Ue,186:q,187:z,188:X,189:G,190:J},{7:535,8:536,9:154,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:T,92:39,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:B,182:60,183:H,184:U,185:W,186:q,187:z,188:X,189:G,190:J},{7:537,9:163,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:Ve,92:160,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:$e,183:Be,184:He,185:Ue,186:q,187:z,188:X,189:G,190:J},{7:538,8:539,9:154,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:T,92:39,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:B,182:60,183:H,184:U,185:W,186:q,187:z,188:X,189:G,190:J},{7:540,8:541,9:154,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:T,92:39,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:B,182:60,183:H,184:U,185:W,186:q,187:z,188:X,189:G,190:J},t(ai,[2,295]),t(ai,[2,296]),{34:251,38:248,39:s,40:a,72:249,73:Oe,75:Re,99:250,116:L,170:542},{33:Fi,155:Z,156:[1,543],157:ee,158:117,161:118,163:te,164:[1,544],165:122,181:ie,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve},{33:[2,322],156:[1,545],164:[1,546]},{33:Vi,155:Z,156:[1,547],157:ee,158:117,161:118,163:te,165:122,181:ie,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve},{33:[2,323],156:[1,548]},{33:$i,155:Z,156:[1,549],157:ee,158:117,161:118,163:te,165:122,181:ie,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve},{33:[2,338],156:[1,550]},{6:Bi,33:Hi,118:[1,551]},t(Ui,ki,{45:94,68:259,69:260,71:261,43:264,77:266,38:267,41:268,72:269,78:270,34:271,79:272,80:273,81:274,67:554,39:s,40:a,42:lt,44:r,46:o,47:l,73:mt,75:ft,76:vt,82:gt,85:bt,116:L,137:j,152:_}),{7:555,9:163,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:Me,33:[1,556],34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:Ve,92:160,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:$e,183:Be,184:He,185:Ue,186:q,187:z,188:X,189:G,190:J},{7:557,9:163,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:Me,33:[1,558],34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:Ve,92:160,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:$e,183:Be,184:He,185:Ue,186:q,187:z,188:X,189:G,190:J},t(ci,[2,76]),{84:559,134:rt},t(di,[2,89]),{74:[1,560],155:Z,157:ee,158:117,161:118,163:te,165:122,181:Ni,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve},{7:561,9:163,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:Ve,92:160,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:$e,183:Be,184:He,185:Ue,186:q,187:z,188:X,189:G,190:J},t(ci,[2,77],{112:133,83:431,86:432,105:we,106:ke,109:xe,110:Ee,111:Te,114:Ne,133:Ae,134:ye}),t(ci,[2,79],{112:133,83:438,86:439,105:we,106:ke,109:xe,110:Ee,111:Te,114:Ne,133:Ae,134:ye}),t(ci,[2,78]),{84:562,134:rt},t(di,[2,90]),{84:563,134:rt},t(di,[2,86]),t(Le,[2,51]),t(kt,[2,43]),t(pi,[2,45]),{6:Y,52:[1,564]},{4:565,5:3,7:4,8:5,9:6,10:7,11:27,12:28,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:n,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:E,89:T,92:39,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:B,182:60,183:H,184:U,185:W,186:q,187:z,188:X,189:G,190:J},t(pi,[2,48]),{7:566,9:163,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:Ve,92:160,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:$e,183:Be,184:He,185:Ue,186:q,187:z,188:X,189:G,190:J},{7:567,9:163,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:Ve,92:160,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:$e,183:Be,184:He,185:Ue,186:q,187:z,188:X,189:G,190:J},{7:568,9:163,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:Ve,92:160,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:$e,183:Be,184:He,185:Ue,186:q,187:z,188:X,189:G,190:J},t([1,6,33,35,52,74,76,91,96,107,118,135,142,153,155,157,163,181],Fi,{158:117,161:118,165:122,156:[1,569],164:[1,570],187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve}),{156:[1,571],164:[1,572]},t(Wi,Vi,{158:117,161:118,165:122,156:[1,573],187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve}),{156:[1,574]},t(Wi,$i,{158:117,161:118,165:122,156:[1,575],187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve}),{156:[1,576]},t(ht,[2,149]),{35:[1,577]},t(gi,[2,226],{17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,13:23,15:25,16:26,65:29,58:30,79:31,102:32,56:33,103:34,81:35,80:36,104:37,101:48,179:49,158:51,154:52,159:53,161:54,162:55,99:65,34:66,43:67,53:69,38:84,72:85,165:91,45:94,92:160,9:163,7:578,14:i,32:Me,39:s,40:a,44:r,46:o,47:l,54:c,55:h,59:u,60:p,61:m,62:f,63:v,64:g,73:b,75:y,82:w,85:k,87:x,88:Fe,89:Ve,93:N,94:A,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,155:P,157:M,160:F,163:V,174:$,180:$e,183:Be,184:He,185:Ue,186:q,187:z,188:X,189:G,190:J}),t(gi,[2,228],{17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,13:23,15:25,16:26,65:29,58:30,79:31,102:32,56:33,103:34,81:35,80:36,104:37,101:48,179:49,158:51,154:52,159:53,161:54,162:55,99:65,34:66,43:67,53:69,38:84,72:85,165:91,45:94,92:160,9:163,7:579,14:i,32:Me,39:s,40:a,44:r,46:o,47:l,54:c,55:h,59:u,60:p,61:m,62:f,63:v,64:g,73:b,75:y,82:w,85:k,87:x,88:Fe,89:Ve,93:N,94:A,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,155:P,157:M,160:F,163:V,174:$,180:$e,183:Be,184:He,185:Ue,186:q,187:z,188:X,189:G,190:J}),t(gi,[2,229],{158:117,161:118,165:122,155:Z,157:ee,163:te,181:Ni,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve}),t(Mt,[2,61],{158:117,161:118,165:122,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve}),{35:[1,580],155:Z,157:ee,158:117,161:118,163:te,165:122,181:Ni,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve},{5:582,7:4,8:5,9:6,10:7,11:27,12:28,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:n,33:Pe,34:66,37:581,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:E,89:T,92:39,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:B,182:60,183:H,184:U,185:W,186:q,187:z,188:X,189:G,190:J},t(St,[2,108]),{34:145,38:142,39:s,40:a,72:143,73:Oe,75:Re,76:_e,97:583,98:140,99:144,116:L},t(qi,je,{97:139,98:140,38:142,72:143,99:144,34:145,90:584,39:s,40:a,73:Oe,75:Re,76:_e,116:L}),t(St,[2,114],{158:117,161:118,165:122,155:Z,157:ee,163:te,181:Ni,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve}),t(Qt,Di),t(Ti,[2,36]),t(ni,fi,{158:117,161:118,165:122,155:Z,157:ee,163:te,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve}),{92:585,93:N,94:A},t(ni,vi,{158:117,161:118,165:122,155:Z,157:ee,163:te,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve}),t(be,[2,372]),{35:[1,586],155:Z,157:ee,158:117,161:118,163:te,165:122,181:Ni,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve},t(Mt,[2,393],{158:117,161:118,165:122,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve}),{33:Pe,37:587,155:Z,157:ee,158:117,161:118,163:te,165:122,181:Ni,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve},{33:Pe,37:588},t(be,[2,259]),{33:Pe,37:589},{33:Pe,37:590},t(zi,[2,263]),{35:[1,591],176:[1,592],177:487,178:Pt},{35:[1,593],176:[1,594],177:487,178:Pt},t(be,[2,345]),{33:Pe,37:595},t(Ai,[2,348]),{33:Pe,37:596,96:[1,597]},t(Xi,[2,253],{158:117,161:118,165:122,155:Z,157:ee,163:te,181:ie,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve}),t(Xi,[2,254]),t(be,[2,163]),t(Ci,[2,166],{158:117,161:118,165:122,37:598,33:Pe,155:Z,157:ee,163:te,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve}),t(be,[2,265]),t(be,[2,33]),{33:Pe,37:599},{155:Z,157:ee,158:117,161:118,163:te,165:122,181:ie,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve},t(Ce,[2,92]),t(Ce,[2,169]),{36:[1,600]},{33:Vt,38:373,39:s,40:a,124:601,125:371,127:$t},t(Ce,[2,170]),{45:602,46:o,47:l},{6:Gi,33:Ji,118:[1,603]},t(Ui,ki,{38:373,125:606,39:s,40:a,127:$t}),t(wi,Ct,{95:607,96:Li}),{38:608,39:s,40:a},{38:609,39:s,40:a},{36:[2,185]},{45:610,46:o,47:l},{6:Yi,33:Ki,118:[1,611]},t(Ui,ki,{38:380,132:614,39:s,40:a,127:Ht}),t(wi,Ct,{95:615,96:Si}),{38:616,39:s,40:a,127:[1,617]},{38:618,39:s,40:a},t(Ii,[2,189],{158:117,161:118,165:122,155:Z,157:ee,163:te,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve}),{7:619,9:163,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:Ve,92:160,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:$e,183:Be,184:He,185:Ue,186:q,187:z,188:X,189:G,190:J},{7:620,9:163,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:Ve,92:160,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:$e,183:Be,184:He,185:Ue,186:q,187:z,188:X,189:G,190:J},{35:[1,621]},t(Ce,[2,194]),{153:[1,622]},{74:[1,623],155:Z,157:ee,158:117,161:118,163:te,165:122,181:Ni,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve},{74:[1,624],155:Z,157:ee,158:117,161:118,163:te,165:122,181:Ni,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve},t(zt,[2,220]),{7:331,8:332,9:154,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:Me,33:et,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,76:it,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:T,92:39,93:N,94:A,96:nt,99:65,100:225,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,138:399,139:625,143:224,144:221,145:220,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:B,182:60,183:H,184:U,185:W,186:q,187:z,188:X,189:G,190:J},t(Yt,[2,241]),t(Oi,[2,248],{17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,13:23,15:25,16:26,65:29,58:30,79:31,102:32,56:33,103:34,81:35,80:36,104:37,92:39,101:48,179:49,158:51,154:52,159:53,161:54,162:55,182:60,99:65,34:66,43:67,53:69,38:84,72:85,165:91,45:94,9:154,100:225,7:331,8:332,145:392,143:393,14:i,32:Me,39:s,40:a,44:r,46:o,47:l,54:c,55:h,59:u,60:p,61:m,62:f,63:v,64:g,73:b,75:y,76:it,82:w,85:k,87:x,88:Fe,89:T,93:N,94:A,96:nt,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,155:P,157:M,160:F,163:V,174:$,180:B,183:H,184:U,185:W,186:q,187:z,188:X,189:G,190:J}),{7:331,8:332,9:154,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,76:it,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:T,92:39,93:N,94:A,96:nt,99:65,100:225,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,138:399,143:224,144:626,145:220,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:B,182:60,183:H,184:U,185:W,186:q,187:z,188:X,189:G,190:J},{33:ji,35:[1,627]},t(Le,[2,139]),{35:[1,628],155:Z,157:ee,158:117,161:118,163:te,165:122,181:Ni,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve},{6:Qi,33:Zi,135:[1,629]},t([6,33,35,135],ki,{17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,13:23,15:25,16:26,65:29,58:30,79:31,102:32,56:33,103:34,81:35,80:36,104:37,92:39,101:48,179:49,158:51,154:52,159:53,161:54,162:55,182:60,99:65,34:66,43:67,53:69,38:84,72:85,165:91,45:94,9:154,100:225,7:331,8:332,143:632,14:i,32:Me,39:s,40:a,44:r,46:o,47:l,54:c,55:h,59:u,60:p,61:m,62:f,63:v,64:g,73:b,75:y,76:it,82:w,85:k,87:x,88:Fe,89:T,93:N,94:A,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,155:P,157:M,160:F,163:V,174:$,180:B,183:H,184:U,185:W,186:q,187:z,188:X,189:G,190:J}),t(wi,Ct,{95:633,96:Ri}),t(ni,[2,273],{158:117,161:118,165:122,155:Z,157:ee,163:te,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve}),{33:en,155:Z,157:ee,158:117,161:118,163:te,165:122,181:ie,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve},{33:[2,269]},t(ni,[2,276],{158:117,161:118,165:122,155:Z,157:ee,163:te,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve}),{33:tn,155:Z,157:ee,158:117,161:118,163:te,165:122,181:ie,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve},{33:[2,271]},{33:nn,155:Z,157:ee,158:117,161:118,163:te,165:122,181:ie,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve},{33:[2,292]},t(ai,[2,302]),{7:634,8:635,9:154,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:T,92:39,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:B,182:60,183:H,184:U,185:W,186:q,187:z,188:X,189:G,190:J},{7:636,8:637,9:154,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:T,92:39,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:B,182:60,183:H,184:U,185:W,186:q,187:z,188:X,189:G,190:J},{7:638,8:639,9:154,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:T,92:39,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:B,182:60,183:H,184:U,185:W,186:q,187:z,188:X,189:G,190:J},{7:640,8:641,9:154,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:T,92:39,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:B,182:60,183:H,184:U,185:W,186:q,187:z,188:X,189:G,190:J},{7:642,8:643,9:154,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:T,92:39,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:B,182:60,183:H,184:U,185:W,186:q,187:z,188:X,189:G,190:J},{7:644,8:645,9:154,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:T,92:39,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:B,182:60,183:H,184:U,185:W,186:q,187:z,188:X,189:G,190:J},{7:646,8:647,9:154,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:T,92:39,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:B,182:60,183:H,184:U,185:W,186:q,187:z,188:X,189:G,190:J},{7:648,8:649,9:154,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:T,92:39,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:B,182:60,183:H,184:U,185:W,186:q,187:z,188:X,189:G,190:J},t(zt,[2,154]),{34:271,38:267,39:s,40:a,41:268,42:lt,43:264,44:r,45:94,46:o,47:l,67:650,68:259,69:260,71:261,72:269,73:mt,75:ft,76:vt,77:266,78:270,79:272,80:273,81:274,82:gt,85:bt,116:L,137:j,152:_},t(qi,pt,{45:94,67:258,68:259,69:260,71:261,43:264,77:266,38:267,41:268,72:269,78:270,34:271,79:272,80:273,81:274,117:651,39:s,40:a,42:lt,44:r,46:o,47:l,73:mt,75:ft,76:vt,82:gt,85:bt,116:L,137:j,152:_}),t(ci,[2,157]),t(ci,[2,65],{158:117,161:118,165:122,155:Z,157:ee,163:te,181:Ni,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve}),{7:652,9:163,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:Ve,92:160,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:$e,183:Be,184:He,185:Ue,186:q,187:z,188:X,189:G,190:J},t(ci,[2,67],{158:117,161:118,165:122,155:Z,157:ee,163:te,181:Ni,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve}),{7:653,9:163,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:Ve,92:160,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:$e,183:Be,184:He,185:Ue,186:q,187:z,188:X,189:G,190:J},t(di,[2,87]),t(hi,[2,73]),{74:[1,654],155:Z,157:ee,158:117,161:118,163:te,165:122,181:Ni,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve},t(di,[2,88]),t(di,[2,85]),t(pi,[2,46]),{6:Y,35:[1,655]},t(ni,en,{158:117,161:118,165:122,155:Z,157:ee,163:te,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve}),t(ni,tn,{158:117,161:118,165:122,155:Z,157:ee,163:te,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve}),t(ni,nn,{158:117,161:118,165:122,155:Z,157:ee,163:te,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve}),{7:656,8:657,9:154,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:T,92:39,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:B,182:60,183:H,184:U,185:W,186:q,187:z,188:X,189:G,190:J},{7:658,8:659,9:154,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:T,92:39,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:B,182:60,183:H,184:U,185:W,186:q,187:z,188:X,189:G,190:J},{7:660,8:661,9:154,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:T,92:39,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:B,182:60,183:H,184:U,185:W,186:q,187:z,188:X,189:G,190:J},{7:662,8:663,9:154,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:T,92:39,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:B,182:60,183:H,184:U,185:W,186:q,187:z,188:X,189:G,190:J},{7:664,9:163,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:Ve,92:160,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:$e,183:Be,184:He,185:Ue,186:q,187:z,188:X,189:G,190:J},{7:665,9:163,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:Ve,92:160,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:$e,183:Be,184:He,185:Ue,186:q,187:z,188:X,189:G,190:J},{7:666,9:163,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:Ve,92:160,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:$e,183:Be,184:He,185:Ue,186:q,187:z,188:X,189:G,190:J},{7:667,9:163,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:Ve,92:160,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:$e,183:Be,184:He,185:Ue,186:q,187:z,188:X,189:G,190:J},{107:[1,668]},t(gi,[2,225],{158:117,161:118,165:122,155:Z,157:ee,163:te,181:Ni,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve}),t(gi,[2,227],{158:117,161:118,165:122,155:Z,157:ee,163:te,181:Ni,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve}),t(be,[2,62]),t(Le,[2,98]),t(Q,[2,100]),t(St,[2,109]),t(wi,Ct,{95:669,96:Lt}),{33:Pe,37:581},t(be,[2,392]),t(Pi,[2,352]),t(be,[2,260]),t(zi,[2,261]),t(zi,[2,262]),t(be,[2,341]),{33:Pe,37:670},t(be,[2,342]),{33:Pe,37:671},{35:[1,672]},t(Ai,[2,349],{6:[1,673]}),{7:674,8:675,9:154,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:T,92:39,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:B,182:60,183:H,184:U,185:W,186:q,187:z,188:X,189:G,190:J},t(be,[2,167]),t(Mi,[2,358]),{45:676,46:o,47:l},t(oi,Ct,{95:677,96:Li}),t(Ce,[2,171]),{36:[1,678]},{38:373,39:s,40:a,125:679,127:$t},{33:Vt,38:373,39:s,40:a,124:680,125:371,127:$t},t(ci,[2,176]),{6:Gi,33:Ji,35:[1,681]},t(ci,[2,181]),t(ci,[2,183]),t(Ce,[2,195]),t(Ce,[2,187],{36:[1,682]}),{38:380,39:s,40:a,127:Ht,132:683},{33:Bt,38:380,39:s,40:a,127:Ht,130:684,132:378},t(ci,[2,198]),{6:Yi,33:Ki,35:[1,685]},t(ci,[2,203]),t(ci,[2,204]),t(ci,[2,206]),t(Ii,[2,190],{158:117,161:118,165:122,155:Z,157:ee,163:te,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve}),{35:[1,686],155:Z,157:ee,158:117,161:118,163:te,165:122,181:Ni,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve},t(Ce,[2,193]),t(Le,[2,267]),t(Le,[2,223]),t(Le,[2,224]),t(wi,Ct,{95:396,140:687,96:Xt}),t(Yt,[2,242]),t(Yt,[2,243]),{107:[1,688]},t(Zt,[2,214]),{7:331,8:332,9:154,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,76:it,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:T,92:39,93:N,94:A,99:65,100:225,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,143:689,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:B,182:60,183:H,184:U,185:W,186:q,187:z,188:X,189:G,190:J},{7:331,8:332,9:154,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:Me,33:ei,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,76:it,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:T,92:39,93:N,94:A,99:65,100:225,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,136:690,137:j,143:407,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:B,182:60,183:H,184:U,185:W,186:q,187:z,188:X,189:G,190:J},t(_i,[2,232]),{6:Qi,33:Zi,35:[1,691]},{33:sn,155:Z,157:ee,158:117,161:118,163:te,164:[1,692],165:122,181:ie,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve},{33:[2,324],164:[1,693]},{33:an,155:Z,156:[1,694],157:ee,158:117,161:118,163:te,165:122,181:ie,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve},{33:[2,328],156:[1,695]},{33:rn,155:Z,157:ee,158:117,161:118,163:te,164:[1,696],165:122,181:ie,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve},{33:[2,325],164:[1,697]},{33:on,155:Z,156:[1,698],157:ee,158:117,161:118,163:te,165:122,181:ie,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve},{33:[2,329],156:[1,699]},{33:ln,155:Z,157:ee,158:117,161:118,163:te,165:122,181:ie,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve},{33:[2,326]},{33:cn,155:Z,157:ee,158:117,161:118,163:te,165:122,181:ie,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve},{33:[2,327]},{33:hn,155:Z,157:ee,158:117,161:118,163:te,165:122,181:ie,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve},{33:[2,339]},{33:un,155:Z,157:ee,158:117,161:118,163:te,165:122,181:ie,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve},{33:[2,340]},t(ci,[2,158]),t(wi,Ct,{95:700,96:li}),{35:[1,701],155:Z,157:ee,158:117,161:118,163:te,165:122,181:Ni,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve},{35:[1,702],155:Z,157:ee,158:117,161:118,163:te,165:122,181:Ni,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve},t(hi,[2,74]),{52:[1,703]},t(dn,sn,{158:117,161:118,165:122,164:[1,704],187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve}),{164:[1,705]},t(Wi,an,{158:117,161:118,165:122,156:[1,706],187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve}),{156:[1,707]},t(dn,rn,{158:117,161:118,165:122,164:[1,708],187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve}),{164:[1,709]},t(Wi,on,{158:117,161:118,165:122,156:[1,710],187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve}),{156:[1,711]},t(Mt,ln,{158:117,161:118,165:122,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve}),t(Mt,cn,{158:117,161:118,165:122,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve}),t(Mt,hn,{158:117,161:118,165:122,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve}),t(Mt,un,{158:117,161:118,165:122,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve}),t(ht,[2,150]),{6:xi,33:Ei,35:[1,712]},{35:[1,713]},{35:[1,714]},t(be,[2,346]),t(Ai,[2,350]),t(Xi,[2,255],{158:117,161:118,165:122,155:Z,157:ee,163:te,181:ie,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve}),t(Xi,[2,256]),t(Ce,[2,173]),{6:Gi,33:Ji,118:[1,715]},{45:716,46:o,47:l},t(ci,[2,177]),t(wi,Ct,{95:717,96:Li}),t(ci,[2,178]),{45:718,46:o,47:l},t(ci,[2,199]),t(wi,Ct,{95:719,96:Si}),t(ci,[2,200]),t(Ce,[2,191]),{33:ji,35:[1,720]},t(Le,[2,140]),t(_i,[2,233]),t(wi,Ct,{95:721,96:Ri}),t(_i,[2,234]),{7:722,8:723,9:154,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:T,92:39,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:B,182:60,183:H,184:U,185:W,186:q,187:z,188:X,189:G,190:J},{7:724,8:725,9:154,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:T,92:39,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:B,182:60,183:H,184:U,185:W,186:q,187:z,188:X,189:G,190:J},{7:726,8:727,9:154,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:T,92:39,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:B,182:60,183:H,184:U,185:W,186:q,187:z,188:X,189:G,190:J},{7:728,8:729,9:154,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:T,92:39,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:B,182:60,183:H,184:U,185:W,186:q,187:z,188:X,189:G,190:J},{7:730,8:731,9:154,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:T,92:39,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:B,182:60,183:H,184:U,185:W,186:q,187:z,188:X,189:G,190:J},{7:732,8:733,9:154,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:T,92:39,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:B,182:60,183:H,184:U,185:W,186:q,187:z,188:X,189:G,190:J},{7:734,8:735,9:154,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:T,92:39,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:B,182:60,183:H,184:U,185:W,186:q,187:z,188:X,189:G,190:J},{7:736,8:737,9:154,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,29:20,30:21,31:22,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:T,92:39,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:B,182:60,183:H,184:U,185:W,186:q,187:z,188:X,189:G,190:J},{6:Bi,33:Hi,35:[1,738]},t(ci,[2,66]),t(ci,[2,68]),t(pi,[2,47]),{7:739,9:163,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:Ve,92:160,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:$e,183:Be,184:He,185:Ue,186:q,187:z,188:X,189:G,190:J},{7:740,9:163,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:Ve,92:160,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:$e,183:Be,184:He,185:Ue,186:q,187:z,188:X,189:G,190:J},{7:741,9:163,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:Ve,92:160,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:$e,183:Be,184:He,185:Ue,186:q,187:z,188:X,189:G,190:J},{7:742,9:163,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:Ve,92:160,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:$e,183:Be,184:He,185:Ue,186:q,187:z,188:X,189:G,190:J},{7:743,9:163,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:Ve,92:160,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:$e,183:Be,184:He,185:Ue,186:q,187:z,188:X,189:G,190:J},{7:744,9:163,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:Ve,92:160,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:$e,183:Be,184:He,185:Ue,186:q,187:z,188:X,189:G,190:J},{7:745,9:163,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:Ve,92:160,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:$e,183:Be,184:He,185:Ue,186:q,187:z,188:X,189:G,190:J},{7:746,9:163,13:23,14:i,15:25,16:26,17:8,18:9,19:10,20:11,21:12,22:13,23:14,24:15,25:16,26:17,27:18,28:19,32:Me,34:66,38:84,39:s,40:a,43:67,44:r,45:94,46:o,47:l,53:69,54:c,55:h,56:33,58:30,59:u,60:p,61:m,62:f,63:v,64:g,65:29,72:85,73:b,75:y,79:31,80:36,81:35,82:w,85:k,87:x,88:Fe,89:Ve,92:160,93:N,94:A,99:65,101:48,102:32,103:34,104:37,108:C,116:L,119:S,121:I,129:D,137:j,147:O,151:R,152:_,154:52,155:P,157:M,158:51,159:53,160:F,161:54,162:55,163:V,165:91,174:$,179:49,180:$e,183:Be,184:He,185:Ue,186:q,187:z,188:X,189:G,190:J},t(St,[2,110]),t(be,[2,343]),t(be,[2,344]),{36:[1,747]},t(Ce,[2,172]),{6:Gi,33:Ji,35:[1,748]},t(Ce,[2,196]),{6:Yi,33:Ki,35:[1,749]},t(Yt,[2,244]),{6:Qi,33:Zi,35:[1,750]},{33:pn,155:Z,157:ee,158:117,161:118,163:te,165:122,181:ie,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve},{33:[2,330]},{33:mn,155:Z,157:ee,158:117,161:118,163:te,165:122,181:ie,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve},{33:[2,332]},{33:fn,155:Z,157:ee,158:117,161:118,163:te,165:122,181:ie,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve},{33:[2,334]},{33:vn,155:Z,157:ee,158:117,161:118,163:te,165:122,181:ie,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve},{33:[2,336]},{33:gn,155:Z,157:ee,158:117,161:118,163:te,165:122,181:ie,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve},{33:[2,331]},{33:bn,155:Z,157:ee,158:117,161:118,163:te,165:122,181:ie,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve},{33:[2,333]},{33:yn,155:Z,157:ee,158:117,161:118,163:te,165:122,181:ie,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve},{33:[2,335]},{33:wn,155:Z,157:ee,158:117,161:118,163:te,165:122,181:ie,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve},{33:[2,337]},t(ci,[2,159]),t(Mt,pn,{158:117,161:118,165:122,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve}),t(Mt,mn,{158:117,161:118,165:122,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve}),t(Mt,fn,{158:117,161:118,165:122,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve}),t(Mt,vn,{158:117,161:118,165:122,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve}),t(Mt,gn,{158:117,161:118,165:122,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve}),t(Mt,bn,{158:117,161:118,165:122,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve}),t(Mt,yn,{158:117,161:118,165:122,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve}),t(Mt,wn,{158:117,161:118,165:122,187:ne,188:se,191:ae,192:re,193:oe,194:le,195:ce,196:he,197:ue,198:de,199:pe,200:me,201:fe,202:ve}),{45:751,46:o,47:l},t(ci,[2,179]),t(ci,[2,201]),t(_i,[2,235]),t(Ce,[2,174])],defaultActions:{253:[2,293],508:[2,185],536:[2,269],539:[2,271],541:[2,292],643:[2,326],645:[2,327],647:[2,339],649:[2,340],723:[2,330],725:[2,332],727:[2,334],729:[2,336],731:[2,331],733:[2,333],735:[2,335],737:[2,337]},parseError:function(e,t){if(!t.recoverable){var i=new Error(e);throw i.hash=t,i}this.trace(e)},parse:function(e){var t=this,i=[0],n=[null],s=[],a=this.table,r="",o=0,l=0,c=0,h=1,u=s.slice.call(arguments,1),d=Object.create(this.lexer),p={yy:{}};for(var m in this.yy)Object.prototype.hasOwnProperty.call(this.yy,m)&&(p.yy[m]=this.yy[m]);d.setInput(e,p.yy),p.yy.lexer=d,p.yy.parser=this,void 0===d.yylloc&&(d.yylloc={});var f=d.yylloc;s.push(f);var v=d.options&&d.options.ranges;this.parseError="function"==typeof p.yy.parseError?p.yy.parseError:Object.getPrototypeOf(this).parseError;for(var g,b,y,w,k,x,E,T,N,A=function(){var e;return"number"!=typeof(e=d.lex()||h)&&(e=t.symbols_[e]||e),e},C={};;){if(y=i[i.length-1],this.defaultActions[y]?w=this.defaultActions[y]:(null==g&&(g=A()),w=a[y]&&a[y][g]),void 0===w||!w.length||!w[0]){var L="";for(x in N=[],a[y])this.terminals_[x]&&x>2&&N.push("'"+this.terminals_[x]+"'");L=d.showPosition?"Parse error on line "+(o+1)+":\n"+d.showPosition()+"\nExpecting "+N.join(", ")+", got '"+(this.terminals_[g]||g)+"'":"Parse error on line "+(o+1)+": Unexpected "+(g==h?"end of input":"'"+(this.terminals_[g]||g)+"'"),this.parseError(L,{text:d.match,token:this.terminals_[g]||g,line:d.yylineno,loc:f,expected:N})}if(w[0]instanceof Array&&1<w.length)throw new Error("Parse Error: multiple actions possible at state: "+y+", token: "+g);switch(w[0]){case 1:i.push(g),n.push(d.yytext),s.push(d.yylloc),i.push(w[1]),g=null,b?(g=b,b=null):(l=d.yyleng,r=d.yytext,o=d.yylineno,f=d.yylloc,0<c&&c--);break;case 2:if(E=this.productions_[w[1]][1],C.$=n[n.length-E],C._$={first_line:s[s.length-(E||1)].first_line,last_line:s[s.length-1].last_line,first_column:s[s.length-(E||1)].first_column,last_column:s[s.length-1].last_column},v&&(C._$.range=[s[s.length-(E||1)].range[0],s[s.length-1].range[1]]),void 0!==(k=this.performAction.apply(C,[r,l,o,p.yy,w[1],n,s].concat(u))))return k;E&&(i=i.slice(0,-1*E*2),n=n.slice(0,-1*E),s=s.slice(0,-1*E)),i.push(this.productions_[w[1]][0]),n.push(C.$),s.push(C._$),T=a[i[i.length-2]][i[i.length-1]],i.push(T);break;case 3:return!0}}return!0}};return e.prototype=kn,kn.Parser=e,new e}();return void 0!==e&&(e.parser=i,e.Parser=i.Parser,e.parse=function(){return i.parse.apply(i,arguments)},e.main=function(){},s.main===t&&e.main(process.argv.slice(1))),t.exports}(),s["./scope"]=function(){var e={};return function(){var i=[].indexOf;e.Scope=function(){"use strict";function e(t,i,n,s){var a,r;f(this,e),this.parent=t,this.expressions=i,this.method=n,this.referencedVars=s,this.variables=[{name:"arguments",type:"arguments"}],this.comments={},this.positions={},this.parent||(this.utilities={}),this.root=null==(a=null==(r=this.parent)?void 0:r.root)?this:a}return g(e,[{key:"add",value:function(e,t,i){return this.shared&&!i?this.parent.add(e,t,i):Object.prototype.hasOwnProperty.call(this.positions,e)?this.variables[this.positions[e]].type=t:this.positions[e]=this.variables.push({name:e,type:t})-1}},{key:"namedMethod",value:function(){var e;return(null==(e=this.method)?void 0:e.name)||!this.parent?this.method:this.parent.namedMethod()}},{key:"find",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"var";return!!this.check(e)||(this.add(e,t),!1)}},{key:"parameter",value:function(e){return this.shared&&this.parent.check(e,!0)?void 0:this.add(e,"param")}},{key:"check",value:function(e){var t;return!(!this.type(e)&&!(null==(t=this.parent)?void 0:t.check(e)))}},{key:"temporary",value:function(e,i){var s,a,r,o,l,c=!!(2<arguments.length&&void 0!==arguments[2])&&arguments[2];return c?(l=e.charCodeAt(0),a="z".charCodeAt(0),r=t(l+i%(1+(s=a-l))),o=n(i/(s+1)),"".concat(r).concat(o||"")):"".concat(e).concat(i||"")}},{key:"type",value:function(e){var t,i,n,s;for(t=0,i=(n=this.variables).length;t<i;t++)if((s=n[t]).name===e)return s.type;return null}},{key:"freeVariable",value:function(e){var t,n,s,a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};for(t=0;s=this.temporary(e,t,a.single),this.check(s)||0<=i.call(this.root.referencedVars,s);)t++;return(null==(n=a.reserve)||n)&&this.add(s,"var",!0),s}},{key:"assign",value:function(e,t){return this.add(e,{value:t,assigned:!0},!0),this.hasAssignments=!0}},{key:"hasDeclarations",value:function(){return!!this.declaredVariables().length}},{key:"declaredVariables",value:function(){var e;return function(){var t,i,n,s;for(s=[],t=0,i=(n=this.variables).length;t<i;t++)"var"===(e=n[t]).type&&s.push(e.name);return s}.call(this).sort()}},{key:"assignedVariables",value:function(){var e,t,i,n,s;for(n=[],e=0,t=(i=this.variables).length;e<t;e++)(s=i[e]).type.assigned&&n.push("".concat(s.name," = ").concat(s.type.value));return n}}]),e}()}.call(this),{exports:e}.exports}(),s["./nodes"]=function(){var t={};return function(){var i,n,h,p,m,v,b,w,k,x,E,T,N,A,C,L,S,I,D,j,O,R,_,P,M,F,V,$,B,H,U,W,q,z,X,G,J,Y,K,Q,Z,ee,te,ie,ne,se,ae,re,oe,le,ce,he,ue,de,pe,me,fe,ve,ge,be,ye,we,ke,xe,Ee,Te,Ne,Ae,Ce,Le,Se,Ie,De,je,Oe,Re,_e,Pe,Me,Fe,Ve,$e,Be,He,Ue,We,qe,ze,Xe,Ge,Je,Ye,Ke,Qe,Ze,et,tt,it,nt,st,at,rt,ot,lt,ct,ht,ut,dt,pt,mt,ft,vt,gt,bt,yt,wt,kt,xt,Et,Tt,Nt,At,Ct,Lt,St,It,Dt,jt,Ot,Rt,_t,Pt,Mt,Ft,Vt,$t=[].indexOf,Bt=[].splice,Ht=[].slice;Error.stackTraceLimit=Infinity;var Ut=s("./scope");Oe=Ut.Scope;var Wt=s("./lexer");kt=Wt.isUnassignable,ie=Wt.JS_FORBIDDEN;var qt=s("./helpers");st=qt.compact,ht=qt.flatten,ot=qt.extend,At=qt.merge,at=qt.del,qt.starts,qt.ends,qt.some,tt=qt.addDataToNode,nt=qt.attachCommentsToNode,Tt=qt.locationDataToString,_t=qt.throwSyntaxError,jt=qt.replaceUnicodeCodePointEscapes,qt.isFunction,qt.isPlainObject,wt=qt.isNumber,Dt=qt.parseNumber,t.extend=ot,t.addDataToNode=tt,Ze=function(){return!0},ve=function(){return!1},We=function(){return this},fe=function(){return this.negated=!this.negated,this},t.CodeFragment=N=function(){"use strict";function e(t,i){var n;f(this,e),this.code="".concat(i),this.type=(null==t||null==(n=t.constructor)?void 0:n.name)||"unknown",this.locationData=null==t?void 0:t.locationData,this.comments=null==t?void 0:t.comments}return g(e,[{key:"toString",value:function(){return"".concat(this.code).concat(this.locationData?": "+Tt(this.locationData):"")}}]),e}(),ut=function(e){var t;return function(){var i,n,s;for(s=[],i=0,n=e.length;i<n;i++)t=e[i],s.push(t.code);return s}().join("")},t.Base=m=function(){var e=function(){"use strict";function e(){f(this,e)}return g(e,[{key:"compile",value:function(e,t){return ut(this.compileToFragments(e,t))}},{key:"compileWithoutComments",value:function(e,t){var i,n,s=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"compile";return this.comments&&(this.ignoreTheseCommentsTemporarily=this.comments,delete this.comments),(n=this.unwrapAll()).comments&&(n.ignoreTheseCommentsTemporarily=n.comments,delete n.comments),i=this[s](e,t),this.ignoreTheseCommentsTemporarily&&(this.comments=this.ignoreTheseCommentsTemporarily,delete this.ignoreTheseCommentsTemporarily),n.ignoreTheseCommentsTemporarily&&(n.comments=n.ignoreTheseCommentsTemporarily,delete n.ignoreTheseCommentsTemporarily),i}},{key:"compileNodeWithoutComments",value:function(e,t){return this.compileWithoutComments(e,t,"compileNode")}},{key:"compileToFragments",value:function(e,t){var i,n;return e=ot({},e),t&&(e.level=t),(n=this.unfoldSoak(e)||this).tab=e.indent,i=e.level!==ce&&n.isStatement(e)?n.compileClosure(e):n.compileNode(e),this.compileCommentFragments(e,n,i),i}},{key:"compileToFragmentsWithoutComments",value:function(e,t){return this.compileWithoutComments(e,t,"compileToFragments")}},{key:"compileClosure",value:function(e){var t,n,s,a,r,o,l;switch(this.checkForPureStatementInExpression(),e.sharedScope=!0,s=new T([],v.wrap([this])),t=[],this.contains((function(e){return e instanceof Be}))?s.bound=!0:((n=this.contains(vt))||this.contains(gt))&&(t=[new Xe],n?(a="apply",t.push(new B("arguments"))):a="call",s=new Ke(s,[new i(new Ne(a))])),r=new w(s,t).compileNode(e),!1){case!(s.isGenerator||(null==(o=s.base)?void 0:o.isGenerator)):r.unshift(this.makeCode("(yield* ")),r.push(this.makeCode(")"));break;case!(s.isAsync||(null==(l=s.base)?void 0:l.isAsync)):r.unshift(this.makeCode("(await ")),r.push(this.makeCode(")"))}return r}},{key:"compileCommentFragments",value:function(e,t,i){var n,s,a,r,o,l,c,h;if(!t.comments)return i;for(h=function(e){var t;return e.unshift?Mt(i,e):(0!==i.length&&(t=i[i.length-1],e.newLine&&""!==t.code&&!/\n\s*$/.test(t.code)&&(e.code="\n".concat(e.code))),i.push(e))},o=0,l=(c=t.comments).length;o<l;o++)a=c[o],0>$t.call(this.compiledComments,a)&&(this.compiledComments.push(a),(r=a.here?new V(a).compileNode(e):new he(a).compileNode(e)).isHereComment&&!r.newLine||t.includeCommentFragments()?h(r):(0===i.length&&i.push(this.makeCode("")),r.unshift?(null==(n=i[0]).precedingComments&&(n.precedingComments=[]),i[0].precedingComments.push(r)):(null==(s=i[i.length-1]).followingComments&&(s.followingComments=[]),i[i.length-1].followingComments.push(r))));return i}},{key:"cache",value:function(e,t,i){var n,s;return(null==i?this.shouldCache():i(this))?(n=new B(e.scope.freeVariable("ref")),s=new h(n,this),t?[s.compileToFragments(e,t),[this.makeCode(n.value)]]:[s,n]):[n=t?this.compileToFragments(e,t):this,n]}},{key:"hoist",value:function(){var e,t,i;return this.hoisted=!0,i=new $(this),e=this.compileNode,t=this.compileToFragments,this.compileNode=function(t){return i.update(e,t)},this.compileToFragments=function(e){return i.update(t,e)},i}},{key:"cacheToCodeFragments",value:function(e){return[ut(e[0]),ut(e[1])]}},{key:"makeReturn",value:function(e,t){var i;return t?void(this.canBeReturned=!0):(i=this.unwrapAll(),e?new w(new ue("".concat(e,".push")),[i]):new Le(i))}},{key:"contains",value:function(e){var t;return t=void 0,this.traverseChildren(!1,(function(i){if(e(i))return t=i,!1})),t}},{key:"lastNode",value:function(e){return 0===e.length?null:e[e.length-1]}},{key:"toString",value:function(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.constructor.name;return e="\n"+t+i,this.soak&&(e+="?"),this.eachChild((function(i){return e+=i.toString(t+Ue)})),e}},{key:"checkForPureStatementInExpression",value:function(){var e;if(e=this.jumps())return e.error("cannot use a pure statement in an expression")}},{key:"ast",value:function(e,t){var i;return e=this.astInitialize(e,t),i=this.astNode(e),null!=this.astNode&&this.canBeReturned&&Object.assign(i,{returns:!0}),i}},{key:"astInitialize",value:function(e,t){return e=Object.assign({},e),null!=t&&(e.level=t),e.level>ce&&this.checkForPureStatementInExpression(),this.isStatement(e)&&e.level!==ce&&null!=e.scope&&this.makeReturn(null,!0),e}},{key:"astNode",value:function(e){return Object.assign({},{type:this.astType(e)},this.astProperties(e),this.astLocationData())}},{key:"astProperties",value:function(){return{}}},{key:"astType",value:function(){return this.constructor.name}},{key:"astLocationData",value:function(){return xt(this.locationData)}},{key:"isStatementAst",value:function(e){return this.isStatement(e)}},{key:"eachChild",value:function(e){var t,i,n,s,a,r,o;if(!this.children)return this;for(i=0,s=(r=this.children).length;i<s;i++)if(this[t=r[i]])for(n=0,a=(o=ht([this[t]])).length;n<a;n++)if(!1===e(o[n]))return this;return this}},{key:"traverseChildren",value:function(e,t){return this.eachChild((function(i){if(!1!==t(i))return i.traverseChildren(e,t)}))}},{key:"replaceInContext",value:function(e,t){var i,n,s,a,r,o,l,c,h;if(!this.children)return!1;for(r=0,l=(h=this.children).length;r<l;r++)if(s=this[i=h[r]])if(Array.isArray(s))for(a=o=0,c=s.length;o<c;a=++o){if(e(n=s[a]))return Bt.apply(s,[a,a-a+1].concat(t(n,this))),!0;if(n.replaceInContext(e,t))return!0}else{if(e(s))return this[i]=t(s,this),!0;if(s.replaceInContext(e,t))return!0}}},{key:"invert",value:function(){return new ke("!",this)}},{key:"unwrapAll",value:function(){var e;for(e=this;e!==(e=e.unwrap());)continue;return e}},{key:"updateLocationDataIfMissing",value:function(e,t){return t&&(this.forceUpdateLocation=!0),this.locationData&&!this.forceUpdateLocation?this:(delete this.forceUpdateLocation,this.locationData=e,this.eachChild((function(t){return t.updateLocationDataIfMissing(e)})))}},{key:"withLocationDataFrom",value:function(e){var t=e.locationData;return this.updateLocationDataIfMissing(t)}},{key:"withLocationDataAndCommentsFrom",value:function(e){var t;return this.withLocationDataFrom(e),(null==(t=e.comments)?void 0:t.length)&&(this.comments=t),this}},{key:"error",value:function(e){return _t(e,this.locationData)}},{key:"makeCode",value:function(e){return new N(this,e)}},{key:"wrapInParentheses",value:function(e){return[this.makeCode("(")].concat(y(e),[this.makeCode(")")])}},{key:"wrapInBraces",value:function(e){return[this.makeCode("{")].concat(y(e),[this.makeCode("}")])}},{key:"joinFragmentArrays",value:function(e,t){var i,n,s,a,r;for(i=[],s=a=0,r=e.length;a<r;s=++a)n=e[s],s&&i.push(this.makeCode(t)),i=i.concat(n);return i}}]),e}();return e.prototype.children=[],e.prototype.isStatement=ve,e.prototype.compiledComments=[],e.prototype.includeCommentFragments=ve,e.prototype.jumps=ve,e.prototype.shouldCache=Ze,e.prototype.isChainable=ve,e.prototype.isAssignable=ve,e.prototype.isNumber=ve,e.prototype.unwrap=We,e.prototype.unfoldSoak=ve,e.prototype.assigns=ve,e}.call(this),t.HoistTarget=$=function(e){"use strict";function t(e){var i;return f(this,t),(i=r(this,l(t).call(this))).source=e,i.options={},i.targetFragments={fragments:[]},i}return c(t,e),g(t,null,[{key:"expand",value:function(e){var t,i,n;for(i=n=e.length-1;0<=n;i=n+=-1)(t=e[i]).fragments&&Bt.apply(e,[i,i-i+1].concat(this.expand(t.fragments)));return e}}]),g(t,[{key:"isStatement",value:function(e){return this.source.isStatement(e)}},{key:"update",value:function(e,t){return this.targetFragments.fragments=e.call(this.source,At(t,this.options))}},{key:"compileToFragments",value:function(e,t){return this.options.indent=e.indent,this.options.level=null==t?e.level:t,[this.targetFragments]}},{key:"compileNode",value:function(e){return this.compileToFragments(e)}},{key:"compileClosure",value:function(e){return this.compileToFragments(e)}}]),t}(m),t.Root=Se=function(){var e=function(e){"use strict";function t(e){var i;return f(this,t),(i=r(this,l(t).call(this))).body=e,i}return c(t,e),g(t,[{key:"compileNode",value:function(e){var t;return e.indent=e.bare?"":Ue,e.level=ce,e.compiling=!0,this.initializeScope(e),t=this.body.compileRoot(e),e.bare?t:[].concat(this.makeCode("(function() {\n"),t,this.makeCode("\n}).call(this);\n"))}},{key:"initializeScope",value:function(e){var t,i,n,s,a,r;for(e.scope=new Oe(null,this.body,null,null==(s=e.referencedVars)?[]:s),r=[],t=0,i=(a=e.locals||[]).length;t<i;t++)n=a[t],r.push(e.scope.parameter(n));return r}},{key:"commentsAst",value:function(){var e,t,i,n,s,a;for(null==this.allComments&&(this.allComments=function(){var e,i,n,s,a;for(a=[],e=0,i=(s=null==(n=this.allCommentTokens)?[]:n).length;e<i;e++)(t=s[e]).heregex||(t.here?a.push(new V(t)):a.push(new he(t)));return a}.call(this)),a=[],i=0,n=(s=this.allComments).length;i<n;i++)e=s[i],a.push(e.ast());return a}},{key:"astNode",value:function(e){return e.level=ce,this.initializeScope(e),a(l(t.prototype),"astNode",this).call(this,e)}},{key:"astType",value:function(){return"File"}},{key:"astProperties",value:function(e){return this.body.isRootBlock=!0,{program:Object.assign(this.body.ast(e),this.astLocationData()),comments:this.commentsAst()}}}]),t}(m);return e.prototype.children=["body"],e}.call(this),t.Block=v=function(){var e=function(e){"use strict";function t(e){var i;return f(this,t),(i=r(this,l(t).call(this))).expressions=st(ht(e||[])),i}return c(t,e),g(t,[{key:"push",value:function(e){return this.expressions.push(e),this}},{key:"pop",value:function(){return this.expressions.pop()}},{key:"unshift",value:function(e){return this.expressions.unshift(e),this}},{key:"unwrap",value:function(){return 1===this.expressions.length?this.expressions[0]:this}},{key:"isEmpty",value:function(){return!this.expressions.length}},{key:"isStatement",value:function(e){var t,i,n;for(t=0,i=(n=this.expressions).length;t<i;t++)if(n[t].isStatement(e))return!0;return!1}},{key:"jumps",value:function(e){var t,i,n,s;for(t=0,n=(s=this.expressions).length;t<n;t++)if(i=s[t].jumps(e))return i}},{key:"makeReturn",value:function(e,t){var i,n,s,a,r,o,l,c;if(r=this.expressions.length,l=this.expressions,(a=(null==(a=d(Ht.call(l,-1),1)[0])?void 0:a.unwrap())||!1)&&a instanceof Ee&&1<a.body.expressions.length){n=a.body.expressions;var h=d(Ht.call(n,-2),2);o=h[0],s=h[1],o=o.unwrap(),s=s.unwrap(),o instanceof J&&s instanceof J&&n[n.length-1].error("Adjacent JSX elements must be wrapped in an enclosing tag")}if(!t){for(;r--;){i=this.expressions[r],this.expressions[r]=i.makeReturn(e),i instanceof Le&&!i.expression&&this.expressions.splice(r,1);break}return this}null!=(c=this.expressions[r-1])&&c.makeReturn(e,t)}},{key:"compile",value:function(e,i){return e.scope?a(l(t.prototype),"compile",this).call(this,e,i):new Se(this).withLocationDataFrom(this).compile(e,i)}},{key:"compileNode",value:function(e){var i,n,s,a,r,o,l,c,h,u;for(this.tab=e.indent,u=e.level===ce,n=[],a=r=0,l=(h=this.expressions).length;r<l;a=++r)(c=h[a]).hoisted?c.compileToFragments(e):(c=c.unfoldSoak(e)||c)instanceof t?n.push(c.compileNode(e)):u?(c.front=!0,s=c.compileToFragments(e),c.isStatement(e)||(s=mt(s,this),""===(o=d(Ht.call(s,-1),1)[0]).code||o.isComment||s.push(this.makeCode(";"))),n.push(s)):n.push(c.compileToFragments(e,re));return u?this.spaced?[].concat(this.joinFragmentArrays(n,"\n\n"),this.makeCode("\n")):this.joinFragmentArrays(n,"\n"):(i=n.length?this.joinFragmentArrays(n,", "):[this.makeCode("void 0")],1<n.length&&e.level>=re?this.wrapInParentheses(i):i)}},{key:"compileRoot",value:function(e){var t;return this.spaced=!0,t=this.compileWithDeclarations(e),$.expand(t),this.compileComments(t)}},{key:"compileWithDeclarations",value:function(e){var t,i,n,s,a,r,o,l,c,h,u,d,p,m,f,v;for(r=[],o=l=0,h=(p=this.expressions).length;l<h&&p[o].unwrap()instanceof ue;o=++l);if(e=At(e,{level:ce}),o){m=this.expressions.splice(o,9e9);var g=[this.spaced,!1];v=g[0],this.spaced=g[1];var b=[this.compileNode(e),v];r=b[0],this.spaced=b[1],this.expressions=m}if(d=this.compileNode(e),(f=e.scope).expressions===this)if(a=e.scope.hasDeclarations(),t=f.hasAssignments,a||t){if(o&&r.push(this.makeCode("\n")),r.push(this.makeCode("".concat(this.tab,"var "))),a)for(s=c=0,u=(n=f.declaredVariables()).length;c<u;s=++c){var w;i=n[s],r.push(this.makeCode(i)),Object.prototype.hasOwnProperty.call(e.scope.comments,i)&&(w=r).push.apply(w,y(e.scope.comments[i])),s!==n.length-1&&r.push(this.makeCode(", "))}t&&(a&&r.push(this.makeCode(",\n".concat(this.tab+Ue))),r.push(this.makeCode(f.assignedVariables().join(",\n".concat(this.tab+Ue))))),r.push(this.makeCode(";\n".concat(this.spaced?"\n":"")))}else r.length&&d.length&&r.push(this.makeCode("\n"));return r.concat(d)}},{key:"compileComments",value:function(e){var t,i,n,s,a,r,o,l,c,h,u,d,p,m,f,v,g,b,y,w,k,x,E,T,N;for(a=o=0,h=e.length;o<h;a=++o){if((n=e[a]).precedingComments){for(s="",l=(y=e.slice(0,a+1)).length-1;0<=l;l+=-1){if(v=y[l],r=/^ {2,}/m.exec(v.code)){s=r[0];break}if(0<=$t.call(v.code,"\n"))break}for(t="\n".concat(s)+function(){var e,t,a,r;for(r=[],e=0,t=(a=n.precedingComments).length;e<t;e++)(i=a[e]).isHereComment&&i.multiline?r.push(It(i.code,s,!1)):r.push(i.code);return r}().join("\n".concat(s)).replace(/^(\s*)$/gm,""),g=c=(w=e.slice(0,a+1)).length-1;0<=c;g=c+=-1){if(-1===(p=(v=w[g]).code.lastIndexOf("\n")))if(0===g)v.code="\n"+v.code,p=0;else{if(!v.isStringWithInterpolations||"{"!==v.code)continue;t=t.slice(1)+"\n",p=1}delete n.precedingComments,v.code=v.code.slice(0,p)+t+v.code.slice(p);break}}if(n.followingComments){if(E=n.followingComments[0].trail,s="",!E||1!==n.followingComments.length)for(m=!1,f=0,u=(k=e.slice(a)).length;f<u;f++)if(T=k[f],m){if(r=/^ {2,}/m.exec(T.code)){s=r[0];break}if(0<=$t.call(T.code,"\n"))break}else{if(!(0<=$t.call(T.code,"\n")))continue;m=!0}for(t=1===a&&/^\s+$/.test(e[0].code)?"":E?" ":"\n".concat(s),t+=function(){var e,t,a,r;for(r=[],t=0,e=(a=n.followingComments).length;t<e;t++)(i=a[t]).isHereComment&&i.multiline?r.push(It(i.code,s,!1)):r.push(i.code);return r}().join("\n".concat(s)).replace(/^(\s*)$/gm,""),N=b=0,d=(x=e.slice(a)).length;b<d;N=++b){if(-1===(p=(T=x[N]).code.indexOf("\n")))if(N===e.length-1)T.code+="\n",p=T.code.length;else{if(!T.isStringWithInterpolations||"}"!==T.code)continue;t="".concat(t,"\n"),p=0}delete n.followingComments,"\n"===T.code&&(t=t.replace(/^\n/,"")),T.code=T.code.slice(0,p)+t+T.code.slice(p);break}}}return e}},{key:"astNode",value:function(e){return null!=e.level&&e.level!==ce&&this.expressions.length?new Re(this.expressions).withLocationDataFrom(this).ast(e):a(l(t.prototype),"astNode",this).call(this,e)}},{key:"astType",value:function(){return this.isRootBlock?"Program":this.isClassBody?"ClassBody":"BlockStatement"}},{key:"astProperties",value:function(e){var t,i,n,s,a,r,o,l;for(i=at(e,"checkForDirectives"),(this.isRootBlock||i)&&Rt(this.expressions,{notFinalExpression:i}),n=[],t=[],r=0,o=(l=this.expressions).length;r<o;r++)null!=(a=(s=l[r]).ast(e))&&(s instanceof C?n.push(a):s.isStatementAst(e)?t.push(a):t.push(Object.assign({type:"ExpressionStatement",expression:a},s.astLocationData())));return{body:t,directives:n}}},{key:"astLocationData",value:function(){return this.isRootBlock&&null==this.locationData?void 0:a(l(t.prototype),"astLocationData",this).call(this)}}],[{key:"wrap",value:function(e){return 1===e.length&&e[0]instanceof t?e[0]:new t(e)}}]),t}(m);return e.prototype.children=["expressions"],e}.call(this),t.Directive=C=function(e){"use strict";function t(e){var i;return f(this,t),(i=r(this,l(t).call(this))).value=e,i}return c(t,e),g(t,[{key:"astProperties",value:function(e){return{value:Object.assign({},this.value.ast(e),{type:"DirectiveLiteral"})}}}]),t}(m),t.Literal=ue=function(){var e=function(e){"use strict";function t(e){var i;return f(this,t),(i=r(this,l(t).call(this))).value=e,i}return c(t,e),g(t,[{key:"assigns",value:function(e){return e===this.value}},{key:"compileNode",value:function(){return[this.makeCode(this.value)]}},{key:"astProperties",value:function(){return{value:this.value}}},{key:"toString",value:function(){return" ".concat(this.isStatement()?a(l(t.prototype),"toString",this).call(this):this.constructor.name,": ").concat(this.value)}}]),t}(m);return e.prototype.shouldCache=ve,e}.call(this),t.NumberLiteral=be=function(e){"use strict";function t(e){var i,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},s=n.parsedValue;return f(this,t),(i=r(this,l(t).call(this))).value=e,i.parsedValue=s,null==i.parsedValue&&(wt(i.value)?(i.parsedValue=i.value,i.value="".concat(i.value)):i.parsedValue=Dt(i.value)),i}return c(t,e),g(t,[{key:"isBigInt",value:function(){return/n$/.test(this.value)}},{key:"astType",value:function(){return this.isBigInt()?"BigIntLiteral":"NumericLiteral"}},{key:"astProperties",value:function(){return{value:this.isBigInt()?this.parsedValue.toString():this.parsedValue,extra:{rawValue:this.isBigInt()?this.parsedValue.toString():this.parsedValue,raw:this.value}}}}]),t}(ue),t.InfinityLiteral=function(e){"use strict";function t(e){var i,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},s=n.originalValue,a=void 0===s?"Infinity":s;return f(this,t),(i=r(this,l(t).call(this))).value=e,i.originalValue=a,i}return c(t,e),g(t,[{key:"compileNode",value:function(){return[this.makeCode("2e308")]}},{key:"astNode",value:function(e){return"Infinity"===this.originalValue?a(l(t.prototype),"astNode",this).call(this,e):new be(this.value).withLocationDataFrom(this).ast(e)}},{key:"astType",value:function(){return"Identifier"}},{key:"astProperties",value:function(){return{name:"Infinity",declaration:!1}}}]),t}(be),t.NaNLiteral=function(e){"use strict";function t(){return f(this,t),r(this,l(t).call(this,"NaN"))}return c(t,e),g(t,[{key:"compileNode",value:function(e){var t;return t=[this.makeCode("0/0")],e.level>=oe?this.wrapInParentheses(t):t}},{key:"astType",value:function(){return"Identifier"}},{key:"astProperties",value:function(){return{name:"NaN",declaration:!1}}}]),t}(be),t.StringLiteral=Fe=function(e){"use strict";function t(e){var i,n,s,a,o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},c=o.quote,h=o.initialChunk,u=o.finalChunk,d=o.indent,p=o.double,m=o.heregex;return f(this,t),(i=r(this,l(t).call(this,""))).originalValue=e,i.quote=c,i.initialChunk=h,i.finalChunk=u,i.indent=d,i.double=p,i.heregex=m,"///"===i.quote&&(i.quote=null),i.fromSourceString=null!=i.quote,null==i.quote&&(i.quote='"'),n=i.isFromHeredoc(),a=i.originalValue,i.heregex?(a=a.replace(F,"$1$2"),a=jt(a,{flags:i.heregex.flags})):(a=a.replace(je,"$1"),a=i.fromSourceString?n?(i.indent&&(s=RegExp("\\n".concat(i.indent),"g")),s&&(a=a.replace(s,"\n")),i.initialChunk&&(a=a.replace(ne,"")),i.finalChunk&&(a=a.replace(qe,"")),a):a.replace(De,(function(e,t){return i.initialChunk&&0===t||i.finalChunk&&t+e.length===a.length?"":" "})):a),i.delimiter=i.quote.charAt(0),i.value=Nt(a,{delimiter:i.delimiter,double:i.double}),i.unquotedValueForTemplateLiteral=Nt(a,{delimiter:"`",double:i.double,escapeNewlines:!1,includeDelimiters:!1,convertTrailingNullEscapes:!0}),i.unquotedValueForJSX=Nt(a,{double:i.double,escapeNewlines:!1,includeDelimiters:!1,escapeDelimiter:!1}),i}return c(t,e),g(t,[{key:"compileNode",value:function(e){return this.shouldGenerateTemplateLiteral()?Ve.fromStringLiteral(this).compileNode(e):this.jsx?[this.makeCode(this.unquotedValueForJSX)]:a(l(t.prototype),"compileNode",this).call(this,e)}},{key:"withoutQuotesInLocationData",value:function(){var e,i,n;return i="\n"===this.originalValue.slice(-1),(n=Object.assign({},this.locationData)).first_column+=this.quote.length,i?(n.last_line-=1,n.last_column=n.last_line===n.first_line?n.first_column+this.originalValue.length-"\n".length:this.originalValue.slice(0,-1).length-"\n".length-this.originalValue.slice(0,-1).lastIndexOf("\n")):n.last_column-=this.quote.length,n.last_column_exclusive-=this.quote.length,n.range=[n.range[0]+this.quote.length,n.range[1]-this.quote.length],(e=new t(this.originalValue,{quote:this.quote,initialChunk:this.initialChunk,finalChunk:this.finalChunk,indent:this.indent,double:this.double,heregex:this.heregex})).locationData=n,e}},{key:"isFromHeredoc",value:function(){return 3===this.quote.length}},{key:"shouldGenerateTemplateLiteral",value:function(){return this.isFromHeredoc()}},{key:"astNode",value:function(e){return this.shouldGenerateTemplateLiteral()?Ve.fromStringLiteral(this).ast(e):a(l(t.prototype),"astNode",this).call(this,e)}},{key:"astProperties",value:function(){return{value:this.originalValue,extra:{raw:"".concat(this.delimiter).concat(this.originalValue).concat(this.delimiter)}}}}]),t}(ue),t.RegexLiteral=Ce=function(){var e=function(e){"use strict";function t(e){var i,n,s,a,o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},c=o.delimiter,h=void 0===c?"/":c,u=o.heregexCommentTokens,d=void 0===u?[]:u;return f(this,t),(i=r(this,l(t).call(this,""))).delimiter=h,i.heregexCommentTokens=d,s="///"===i.delimiter,n=e.lastIndexOf("/"),i.flags=e.slice(n+1),a=i.originalValue=e.slice(1,n),s&&(a=a.replace(F,"$1$2")),a=jt(a,{flags:i.flags}),i.value="".concat(Nt(a,{delimiter:"/"})).concat(i.flags),i}return c(t,e),g(t,[{key:"astType",value:function(){return"RegExpLiteral"}},{key:"astProperties",value:function(e){var t;return{value:void 0,pattern:d(this.REGEX_REGEX.exec(this.value),2)[1],flags:this.flags,delimiter:this.delimiter,originalPattern:this.originalValue,extra:{raw:this.value,originalRaw:"".concat(this.delimiter).concat(this.originalValue).concat(this.delimiter).concat(this.flags),rawValue:void 0},comments:function(){var i,n,s,a;for(a=[],i=0,n=(s=this.heregexCommentTokens).length;i<n;i++)(t=s[i]).here?a.push(new V(t).ast(e)):a.push(new he(t).ast(e));return a}.call(this)}}}]),t}(ue);return e.prototype.REGEX_REGEX=/^\/(.*)\/\w*$/,e}.call(this),t.PassthroughLiteral=Te=function(e){"use strict";function t(e){var i,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},s=n.here,a=n.generated;return f(this,t),(i=r(this,l(t).call(this,""))).originalValue=e,i.here=s,i.generated=a,i.value=i.originalValue.replace(/\\+(`|$)/g,(function(e){var t=Math.ceil;return e.slice(-t(e.length/2))})),i}return c(t,e),g(t,[{key:"astNode",value:function(e){return this.generated?null:a(l(t.prototype),"astNode",this).call(this,e)}},{key:"astProperties",value:function(){return{value:this.originalValue,here:!!this.here}}}]),t}(ue),t.IdentifierLiteral=B=function(){var e=function(e){"use strict";function t(){return f(this,t),r(this,l(t).apply(this,arguments))}return c(t,e),g(t,[{key:"eachName",value:function(e){return e(this)}},{key:"astType",value:function(){return this.jsx?"JSXIdentifier":"Identifier"}},{key:"astProperties",value:function(){return{name:this.value,declaration:!!this.isDeclaration}}}]),t}(ue);return e.prototype.isAssignable=Ze,e}.call(this),t.PropertyName=Ne=function(){var e=function(e){"use strict";function t(){return f(this,t),r(this,l(t).apply(this,arguments))}return c(t,e),g(t,[{key:"astType",value:function(){return this.jsx?"JSXIdentifier":"Identifier"}},{key:"astProperties",value:function(){return{name:this.value,declaration:!1}}}]),t}(ue);return e.prototype.isAssignable=Ze,e}.call(this),t.ComputedPropertyName=A=function(e){"use strict";function t(){return f(this,t),r(this,l(t).apply(this,arguments))}return c(t,e),g(t,[{key:"compileNode",value:function(e){return[this.makeCode("[")].concat(y(this.value.compileToFragments(e,re)),[this.makeCode("]")])}},{key:"astNode",value:function(e){return this.value.ast(e)}}]),t}(Ne),t.StatementLiteral=Me=function(){var e=function(e){"use strict";function t(){return f(this,t),r(this,l(t).apply(this,arguments))}return c(t,e),g(t,[{key:"jumps",value:function(e){return("break"!==this.value||(null==e?void 0:e.loop)||(null==e?void 0:e.block))&&("continue"!==this.value||null!=e&&e.loop)?void 0:this}},{key:"compileNode",value:function(){return[this.makeCode("".concat(this.tab).concat(this.value,";"))]}},{key:"astType",value:function(){switch(this.value){case"continue":return"ContinueStatement";case"break":return"BreakStatement";case"debugger":return"DebuggerStatement"}}}]),t}(ue);return e.prototype.isStatement=Ze,e.prototype.makeReturn=We,e}.call(this),t.ThisLiteral=Xe=function(e){"use strict";function t(e){var i;return f(this,t),(i=r(this,l(t).call(this,"this"))).shorthand="@"===e,i}return c(t,e),g(t,[{key:"compileNode",value:function(e){var t,i;return t=(null==(i=e.scope.method)?void 0:i.bound)?e.scope.method.context:this.value,[this.makeCode(t)]}},{key:"astType",value:function(){return"ThisExpression"}},{key:"astProperties",value:function(){return{shorthand:this.shorthand}}}]),t}(ue),t.UndefinedLiteral=Ye=function(e){"use strict";function t(){return f(this,t),r(this,l(t).call(this,"undefined"))}return c(t,e),g(t,[{key:"compileNode",value:function(e){return[this.makeCode(e.level>=se?"(void 0)":"void 0")]}},{key:"astType",value:function(){return"Identifier"}},{key:"astProperties",value:function(){return{name:this.value,declaration:!1}}}]),t}(ue),t.NullLiteral=ge=function(e){"use strict";function t(){return f(this,t),r(this,l(t).call(this,"null"))}return c(t,e),t}(ue),t.BooleanLiteral=b=function(e){"use strict";function t(e){var i,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},s=n.originalValue;return f(this,t),(i=r(this,l(t).call(this,e))).originalValue=s,null==i.originalValue&&(i.originalValue=i.value),i}return c(t,e),g(t,[{key:"astProperties",value:function(){return{value:"true"===this.value,name:this.originalValue}}}]),t}(ue),t.DefaultLiteral=function(e){"use strict";function t(){return f(this,t),r(this,l(t).apply(this,arguments))}return c(t,e),g(t,[{key:"astType",value:function(){return"Identifier"}},{key:"astProperties",value:function(){return{name:"default",declaration:!1}}}]),t}(ue),t.Return=Le=function(){var e=function(e){"use strict";function t(e){var i,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},s=n.belongsToFuncDirectiveReturn;return f(this,t),(i=r(this,l(t).call(this))).expression=e,i.belongsToFuncDirectiveReturn=s,i}return c(t,e),g(t,[{key:"compileToFragments",value:function(e,i){var n,s;return!(n=null==(s=this.expression)?void 0:s.makeReturn())||n instanceof t?a(l(t.prototype),"compileToFragments",this).call(this,e,i):n.compileToFragments(e,i)}},{key:"compileNode",value:function(e){var t,i,n,s;if(t=[],this.expression)for(t=this.expression.compileToFragments(e,le),Mt(t,this.makeCode("".concat(this.tab,"return "))),n=0,s=t.length;n<s;n++)if((i=t[n]).isHereComment&&0<=$t.call(i.code,"\n"))i.code=It(i.code,this.tab);else{if(!i.isLineComment)break;i.code="".concat(this.tab).concat(i.code)}else t.push(this.makeCode("".concat(this.tab,"return")));return t.push(this.makeCode(";")),t}},{key:"checkForPureStatementInExpression",value:function(){return this.belongsToFuncDirectiveReturn?void 0:a(l(t.prototype),"checkForPureStatementInExpression",this).call(this)}},{key:"astType",value:function(){return"ReturnStatement"}},{key:"astProperties",value:function(e){var t,i;return{argument:null==(t=null==(i=this.expression)?void 0:i.ast(e,le))?null:t}}}]),t}(m);return e.prototype.children=["expression"],e.prototype.isStatement=Ze,e.prototype.makeReturn=We,e.prototype.jumps=We,e}.call(this),t.FuncDirectiveReturn=M=function(){var e=function(e){"use strict";function t(e,i){var n,s=i.returnKeyword;return f(this,t),(n=r(this,l(t).call(this,e))).returnKeyword=s,n}return c(t,e),g(t,[{key:"compileNode",value:function(e){return this.checkScope(e),a(l(t.prototype),"compileNode",this).call(this,e)}},{key:"checkScope",value:function(e){if(null==e.scope.parent)return this.error("".concat(this.keyword," can only occur inside functions"))}},{key:"astNode",value:function(e){return this.checkScope(e),new ke(this.keyword,new Le(this.expression,{belongsToFuncDirectiveReturn:!0}).withLocationDataFrom(null==this.expression?this.returnKeyword:{locationData:Lt(this.returnKeyword.locationData,this.expression.locationData)})).withLocationDataFrom(this).ast(e)}}]),t}(Le);return e.prototype.isStatementAst=ve,e}.call(this),t.YieldReturn=et=function(){var e=function(e){"use strict";function t(){return f(this,t),r(this,l(t).apply(this,arguments))}return c(t,e),t}(M);return e.prototype.keyword="yield",e}.call(this),t.AwaitReturn=p=function(){var e=function(e){"use strict";function t(){return f(this,t),r(this,l(t).apply(this,arguments))}return c(t,e),t}(M);return e.prototype.keyword="await",e}.call(this),t.Value=Ke=function(){var e=function(e){"use strict";function t(e,i,n){var s,a,o,c=!!(3<arguments.length&&void 0!==arguments[3])&&arguments[3];return f(this,t),s=r(this,l(t).call(this)),!i&&e instanceof t?r(s,e):(s.base=e,s.properties=i||[],s.tag=n,n&&(s[n]=!0),s.isDefaultValue=c,(null==(a=s.base)?void 0:a.comments)&&s.base instanceof Xe&&null!=(null==(o=s.properties[0])?void 0:o.name)&&St(s.base,s.properties[0].name),s)}return c(t,e),g(t,[{key:"add",value:function(e){return this.properties=this.properties.concat(e),this.forceUpdateLocation=!0,this}},{key:"hasProperties",value:function(){return 0!==this.properties.length}},{key:"bareLiteral",value:function(e){return!this.properties.length&&this.base instanceof e}},{key:"isArray",value:function(){return this.bareLiteral(n)}},{key:"isRange",value:function(){return this.bareLiteral(Ae)}},{key:"shouldCache",value:function(){return this.hasProperties()||this.base.shouldCache()}},{key:"isAssignable",value:function(e){return this.hasProperties()||this.base.isAssignable(e)}},{key:"isNumber",value:function(){return this.bareLiteral(be)}},{key:"isString",value:function(){return this.bareLiteral(Fe)}},{key:"isRegex",value:function(){return this.bareLiteral(Ce)}},{key:"isUndefined",value:function(){return this.bareLiteral(Ye)}},{key:"isNull",value:function(){return this.bareLiteral(ge)}},{key:"isBoolean",value:function(){return this.bareLiteral(b)}},{key:"isAtomic",value:function(){var e,t,i,n;for(e=0,t=(n=this.properties.concat(this.base)).length;e<t;e++)if((i=n[e]).soak||i instanceof w||i instanceof ke&&"do"===i.operator)return!1;return!0}},{key:"isNotCallable",value:function(){return this.isNumber()||this.isString()||this.isRegex()||this.isArray()||this.isRange()||this.isSplice()||this.isObject()||this.isUndefined()||this.isNull()||this.isBoolean()}},{key:"isStatement",value:function(e){return!this.properties.length&&this.base.isStatement(e)}},{key:"isJSXTag",value:function(){return this.base instanceof ee}},{key:"assigns",value:function(e){return!this.properties.length&&this.base.assigns(e)}},{key:"jumps",value:function(e){return!this.properties.length&&this.base.jumps(e)}},{key:"isObject",value:function(e){return!this.properties.length&&this.base instanceof ye&&(!e||this.base.generated)}},{key:"isElision",value:function(){return!!(this.base instanceof n)&&this.base.hasElision()}},{key:"isSplice",value:function(){var e;return e=this.properties,d(Ht.call(e,-1),1)[0]instanceof _e}},{key:"looksStatic",value:function(e){var t,i,n;return!(!((n=this.base)instanceof Xe||(t=this.base).value===e)||1!==this.properties.length||"prototype"===(null==(i=this.properties[0].name)?void 0:i.value))&&{staticClassName:null==n?t:n}}},{key:"unwrap",value:function(){return this.properties.length?this:this.base}},{key:"cacheReference",value:function(e){var i,n,s,a,r;return r=this.properties,s=d(Ht.call(r,-1),1)[0],!(2>this.properties.length)||this.base.shouldCache()||null!=s&&s.shouldCache()?((i=new t(this.base,this.properties.slice(0,-1))).shouldCache()&&(n=new B(e.scope.freeVariable("base")),i=new t(new Ee(new h(n,i)))),s?(s.shouldCache()&&(a=new B(e.scope.freeVariable("name")),s=new q(new h(a,s.index)),a=new q(a)),[i.add(s),new t(n||i.base,[a||s])]):[i,n]):[this,this]}},{key:"compileNode",value:function(e){var t,i,n,s,a;for(this.base.front=this.front,t=(a=this.properties).length&&null!=this.base.cached?this.base.cached:this.base.compileToFragments(e,a.length?se:null),a.length&&Ie.test(ut(t))&&t.push(this.makeCode(".")),i=0,n=a.length;i<n;i++){var r;s=a[i],(r=t).push.apply(r,y(s.compileToFragments(e)))}return t}},{key:"unfoldSoak",value:function(e){var i=this;return null==this.unfoldedSoak?this.unfoldedSoak=function(){var n,s,a,r,o,l,c,u,d,p;if(a=i.base.unfoldSoak(e))return(p=a.body.properties).push.apply(p,y(i.properties)),a;for(s=r=0,o=(u=i.properties).length;r<o;s=++r)if((l=u[s]).soak)return l.soak=!1,n=new t(i.base,i.properties.slice(0,s)),d=new t(i.base,i.properties.slice(s)),n.shouldCache()&&(c=new B(e.scope.freeVariable("ref")),n=new Ee(new h(c,n)),d.base=c),new H(new D(n),d,{soak:!0});return!1}():this.unfoldedSoak}},{key:"eachName",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},i=t.checkAssignability;return this.hasProperties()?e(this):void 0!==i&&!i||this.base.isAssignable()?this.base.eachName(e):this.error("tried to assign to unassignable value")}},{key:"object",value:function(){var e,i;return this.hasProperties()?(e=this.properties.slice(0,this.properties.length-1),(i=new t(this.base,e,this.tag,this.isDefaultValue)).locationData=0===e.length?this.base.locationData:Lt(this.base.locationData,e[e.length-1].locationData),i):this}},{key:"containsSoak",value:function(){var e,t,i;if(!this.hasProperties())return!1;for(e=0,t=(i=this.properties).length;e<t;e++)if(i[e].soak)return!0;return!!(this.base instanceof w&&this.base.soak)}},{key:"astNode",value:function(e){return this.hasProperties()?a(l(t.prototype),"astNode",this).call(this,e):this.base.ast(e)}},{key:"astType",value:function(){return this.isJSXTag()?"JSXMemberExpression":this.containsSoak()?"OptionalMemberExpression":"MemberExpression"}},{key:"astProperties",value:function(e){var t,i,n,s;return n=this.properties,i=d(Ht.call(n,-1),1)[0],this.isJSXTag()&&(i.name.jsx=!0),t=i instanceof q||!((null==(s=i.name)?void 0:s.unwrap())instanceof Ne),{object:this.object().ast(e,se),property:i.ast(e,t?le:void 0),computed:t,optional:!!i.soak,shorthand:!!i.shorthand}}},{key:"astLocationData",value:function(){return this.isJSXTag()?Ct(xt(this.base.tagNameLocationData),xt(this.properties[this.properties.length-1].locationData)):a(l(t.prototype),"astLocationData",this).call(this)}}]),t}(m);return e.prototype.children=["base","properties"],e}.call(this),t.MetaProperty=function(){var e=function(e){"use strict";function t(e,i){var n;return f(this,t),(n=r(this,l(t).call(this))).meta=e,n.property=i,n}return c(t,e),g(t,[{key:"checkValid",value:function(e){if("new"===this.meta.value){if(!(this.property instanceof i&&"target"===this.property.name.value))return this.error("the only valid meta property for new is new.target");if(null==e.scope.parent)return this.error("new.target can only occur inside functions")}}},{key:"compileNode",value:function(e){var t,i,n;return this.checkValid(e),(t=n=[]).push.apply(t,y(this.meta.compileToFragments(e,se))),(i=n).push.apply(i,y(this.property.compileToFragments(e))),n}},{key:"astProperties",value:function(e){return this.checkValid(e),{meta:this.meta.ast(e,se),property:this.property.ast(e)}}}]),t}(m);return e.prototype.children=["meta","property"],e}.call(this),t.HereComment=V=function(e){"use strict";function t(e){var i,n=e.content,s=e.newLine,a=e.unshift,o=e.locationData;return f(this,t),(i=r(this,l(t).call(this))).content=n,i.newLine=s,i.unshift=a,i.locationData=o,i}return c(t,e),g(t,[{key:"compileNode",value:function(){var e,t,i,n,s,a,r,o,l;if(o=0<=$t.call(this.content,"\n")){for(i=null,n=0,a=(l=this.content.split("\n")).length;n<a;n++)r=l[n],s=/^\s*/.exec(r)[0],(!i||s.length<i.length)&&(i=s);i&&(this.content=this.content.replace(RegExp("\\n".concat(i),"g"),"\n"))}return(t=/\n\s*[#|\*]/.test(this.content))&&(this.content=this.content.replace(/^([ \t]*)#(?=\s)/gm," *")),this.content="/*".concat(this.content).concat(t?" ":"","*/"),(e=this.makeCode(this.content)).newLine=this.newLine,e.unshift=this.unshift,e.multiline=o,e.isComment=e.isHereComment=!0,e}},{key:"astType",value:function(){return"CommentBlock"}},{key:"astProperties",value:function(){return{value:this.content}}}]),t}(m),t.LineComment=he=function(e){"use strict";function t(e){var i,n=e.content,s=e.newLine,a=e.unshift,o=e.locationData,c=e.precededByBlankLine;return f(this,t),(i=r(this,l(t).call(this))).content=n,i.newLine=s,i.unshift=a,i.locationData=o,i.precededByBlankLine=c,i}return c(t,e),g(t,[{key:"compileNode",value:function(e){var t;return(t=this.makeCode(/^\s*$/.test(this.content)?"":"".concat(this.precededByBlankLine?"\n".concat(e.indent):"","//").concat(this.content))).newLine=this.newLine,t.unshift=this.unshift,t.trail=!this.newLine&&!this.unshift,t.isComment=t.isLineComment=!0,t}},{key:"astType",value:function(){return"CommentLine"}},{key:"astProperties",value:function(){return{value:this.content}}}]),t}(m),t.JSXIdentifier=Q=function(e){"use strict";function t(){return f(this,t),r(this,l(t).apply(this,arguments))}return c(t,e),g(t,[{key:"astType",value:function(){return"JSXIdentifier"}}]),t}(B),t.JSXTag=ee=function(e){"use strict";function t(e,i){var n,s=i.tagNameLocationData,a=i.closingTagOpeningBracketLocationData,o=i.closingTagSlashLocationData,c=i.closingTagNameLocationData,h=i.closingTagClosingBracketLocationData;return f(this,t),(n=r(this,l(t).call(this,e))).tagNameLocationData=s,n.closingTagOpeningBracketLocationData=a,n.closingTagSlashLocationData=o,n.closingTagNameLocationData=c,n.closingTagClosingBracketLocationData=h,n}return c(t,e),g(t,[{key:"astProperties",value:function(){return{name:this.value}}}]),t}(Q),t.JSXExpressionContainer=K=function(){var e=function(e){"use strict";function t(e){var i,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},s=n.locationData;return f(this,t),(i=r(this,l(t).call(this))).expression=e,i.expression.jsxAttribute=!0,i.locationData=null==s?i.expression.locationData:s,i}return c(t,e),g(t,[{key:"compileNode",value:function(e){return this.expression.compileNode(e)}},{key:"astProperties",value:function(e){return{expression:it(this.expression,e)}}}]),t}(m);return e.prototype.children=["expression"],e}.call(this),t.JSXEmptyExpression=Y=function(e){"use strict";function t(){return f(this,t),r(this,l(t).apply(this,arguments))}return c(t,e),t}(m),t.JSXText=te=function(e){"use strict";function t(e){var i;return f(this,t),(i=r(this,l(t).call(this))).value=e.unquotedValueForJSX,i.locationData=e.locationData,i}return c(t,e),g(t,[{key:"astProperties",value:function(){return{value:this.value,extra:{raw:this.value}}}}]),t}(m),t.JSXAttribute=X=function(){var e=function(e){"use strict";function t(e){var i,n,s=e.name,a=e.value;return f(this,t),(i=r(this,l(t).call(this))).name=s,i.value=null==a?null:(a=a.base)instanceof Fe?a:new K(a),null!=(n=i.value)&&(n.comments=a.comments),i}return c(t,e),g(t,[{key:"compileNode",value:function(e){var t,i;return t=this.name.compileToFragments(e,re),null==this.value?t:(i=this.value.compileToFragments(e,re),t.concat(this.makeCode("="),i))}},{key:"astProperties",value:function(e){var t,i,n;return t=this.name,0<=$t.call(t.value,":")&&(t=new Z(t)),{name:t.ast(e),value:null==(i=null==(n=this.value)?void 0:n.ast(e))?null:i}}}]),t}(m);return e.prototype.children=["name","value"],e}.call(this),t.JSXAttributes=G=function(){var e=function(e){"use strict";function t(e){var i,n,s,a,o,c,h,u,d,p,m,v,g;for(f(this,t),(i=r(this,l(t).call(this))).attributes=[],a=0,c=(p=e.objects).length;a<c;a++)if(u=p[a],i.checkValidAttribute(u),(s=u.base)instanceof B)(n=new X({name:new Q(s.value).withLocationDataAndCommentsFrom(s)})).locationData=s.locationData,i.attributes.push(n);else if(s.generated)for(o=0,h=(m=s.properties).length;o<h;o++){var b=d=m[o];g=b.variable,v=b.value,(n=new X({name:new Q(g.base.value).withLocationDataAndCommentsFrom(g.base),value:v})).locationData=d.locationData,i.attributes.push(n)}else(n=s.properties[0]).jsx=!0,n.locationData=s.locationData,i.attributes.push(n);return i.locationData=e.locationData,i}return c(t,e),g(t,[{key:"checkValidAttribute",value:function(e){var t,i;if(i=(null==(t=e.base)?void 0:t.properties)||[],!(t instanceof ye||t instanceof B)||t instanceof ye&&!t.generated&&(1<i.length||!(i[0]instanceof Pe)))return e.error('Unexpected token. Allowed JSX attributes are: id="val", src={source}, {props...} or attribute.')}},{key:"compileNode",value:function(e){var t,i,n,s,a;for(i=[],n=0,s=(a=this.attributes).length;n<s;n++){var r;t=a[n],i.push(this.makeCode(" ")),(r=i).push.apply(r,y(t.compileToFragments(e,ce)))}return i}},{key:"astNode",value:function(e){var t,i,n,s,a;for(a=[],i=0,n=(s=this.attributes).length;i<n;i++)t=s[i],a.push(t.ast(e));return a}}]),t}(m);return e.prototype.children=["attributes"],e}.call(this),t.JSXNamespacedName=Z=function(){var e=function(e){"use strict";function t(e){var i,n,s;f(this,t),i=r(this,l(t).call(this));var a=d(e.value.split(":"),2);return s=a[0],n=a[1],i.namespace=new Q(s).withLocationDataFrom({locationData:lt(s.length)(e.locationData)}),i.name=new Q(n).withLocationDataFrom({locationData:ct(n.length)(e.locationData)}),i.locationData=e.locationData,i}return c(t,e),g(t,[{key:"astProperties",value:function(e){return{namespace:this.namespace.ast(e),name:this.name.ast(e)}}}]),t}(m);return e.prototype.children=["namespace","name"],e}.call(this),t.JSXElement=J=function(){var e=function(e){"use strict";function t(e){var i,n=e.tagName,s=e.attributes,a=e.content;return f(this,t),(i=r(this,l(t).call(this))).tagName=n,i.attributes=s,i.content=a,i}return c(t,e),g(t,[{key:"compileNode",value:function(e){var t,i,n,s,a,r,o;return null!=(s=this.content)&&(s.base.jsx=!0),(t=n=[this.makeCode("<")]).push.apply(t,y(a=this.tagName.compileToFragments(e,se))),(i=n).push.apply(i,y(this.attributes.compileToFragments(e))),this.content?(n.push(this.makeCode(">")),(r=n).push.apply(r,y(this.content.compileNode(e,re))),(o=n).push.apply(o,[this.makeCode("</")].concat(y(a),[this.makeCode(">")]))):n.push(this.makeCode(" />")),n}},{key:"isFragment",value:function(){return!this.tagName.base.value.length}},{key:"astNode",value:function(e){var i;return this.openingElementLocationData=xt(this.attributes.locationData),(i=this.tagName.base).locationData=i.tagNameLocationData,null!=this.content&&(this.closingElementLocationData=Ct(xt(i.closingTagOpeningBracketLocationData),xt(i.closingTagClosingBracketLocationData))),a(l(t.prototype),"astNode",this).call(this,e)}},{key:"astType",value:function(){return this.isFragment()?"JSXFragment":"JSXElement"}},{key:"elementAstProperties",value:function(e){var t,i,n,s,a,r,o,l,c=this;if(l=function(){var t;return(null==(t=c.tagName.unwrap())?void 0:t.value)&&0<=$t.call(t.value,":")&&(t=new Z(t)),t.ast(e)},s=Object.assign({type:"JSXOpeningElement",name:l(),selfClosing:null==this.closingElementLocationData,attributes:this.attributes.ast(e)},this.openingElementLocationData),t=null,null!=this.closingElementLocationData&&("JSXMemberExpression"===(r=(t=Object.assign({type:"JSXClosingElement",name:Object.assign(l(),xt(this.tagName.base.closingTagNameLocationData))},this.closingElementLocationData)).name.type)||"JSXNamespacedName"===r))if(a=t.range[0]-s.range[0]+"/".length,i=t.loc.start.column-s.loc.start.column+"/".length,o=function(e){return e.range=[e.range[0]+a,e.range[1]+a],e.start+=a,e.end+=a,e.loc.start={line:c.closingElementLocationData.loc.start.line,column:e.loc.start.column+i},e.loc.end={line:c.closingElementLocationData.loc.start.line,column:e.loc.end.column+i}},"JSXMemberExpression"===t.name.type){for(n=t.name;"JSXMemberExpression"===n.type;)n!==t.name&&o(n),o(n.property),n=n.object;o(n)}else o(t.name.namespace),o(t.name.name);return{openingElement:s,closingElement:t}}},{key:"fragmentAstProperties",value:function(){return{openingFragment:Object.assign({type:"JSXOpeningFragment"},this.openingElementLocationData),closingFragment:Object.assign({type:"JSXClosingFragment"},this.closingElementLocationData)}}},{key:"contentAst",value:function(e){var i,n,s,a,r,o,l,c,h,u,d;if(!this.content||("function"==typeof(i=this.content.base).isEmpty?i.isEmpty():void 0))return[];for(a=this.content.unwrapAll(),s=function(){var i,n,s,c;if(a instanceof Fe)return[new te(a)];for(c=[],i=0,n=(s=this.content.unwrapAll().extractElements(e,{includeInterpolationWrappers:!0,isJsx:!0})).length;i<n;i++)(r=s[i])instanceof Fe?c.push(new te(r)):null==(l=r.expression)?((o=new Y).locationData=rt({interpolationNode:r,openingBrace:"{",closingBrace:"}"}),c.push(new K(o,{locationData:r.locationData}))):(d=l.unwrapAll())instanceof t&&d.locationData.range[0]===r.locationData.range[0]?c.push(d):c.push(new K(d,{locationData:r.locationData}));return c}.call(this),u=[],c=0,h=s.length;c<h;c++)(n=s[c])instanceof te&&0===n.value.length||u.push(n.ast(e));return u}},{key:"astProperties",value:function(e){return Object.assign(this.isFragment()?this.fragmentAstProperties(e):this.elementAstProperties(e),{children:this.contentAst(e)})}},{key:"astLocationData",value:function(){return null==this.closingElementLocationData?this.openingElementLocationData:Ct(this.openingElementLocationData,this.closingElementLocationData)}}]),t}(m);return e.prototype.children=["tagName","attributes","content"],e}.call(this),t.Call=w=function(){var e=function(e){"use strict";function t(e){var i,n,s=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],a=2<arguments.length?arguments[2]:void 0,o=3<arguments.length?arguments[3]:void 0;return f(this,t),(i=r(this,l(t).call(this))).variable=e,i.args=s,i.soak=a,i.token=o,i.implicit=i.args.implicit,i.isNew=!1,i.variable instanceof Ke&&i.variable.isNotCallable()&&i.variable.error("literal is not a function"),i.variable.base instanceof ee?r(i,new J({tagName:i.variable,attributes:new G(i.args[0].base),content:i.args[1]})):("RegExp"===(null==(n=i.variable.base)?void 0:n.value)&&0!==i.args.length&&St(i.variable,i.args[0]),i)}return c(t,e),g(t,[{key:"updateLocationDataIfMissing",value:function(e){var i,n;return this.locationData&&this.needsUpdatedStartLocation&&(this.locationData=Object.assign({},this.locationData,{first_line:e.first_line,first_column:e.first_column,range:[e.range[0],this.locationData.range[1]]}),(i=(null==(n=this.variable)?void 0:n.base)||this.variable).needsUpdatedStartLocation&&(this.variable.locationData=Object.assign({},this.variable.locationData,{first_line:e.first_line,first_column:e.first_column,range:[e.range[0],this.variable.locationData.range[1]]}),i.updateLocationDataIfMissing(e)),delete this.needsUpdatedStartLocation),a(l(t.prototype),"updateLocationDataIfMissing",this).call(this,e)}},{key:"newInstance",value:function(){var e,i;return(e=(null==(i=this.variable)?void 0:i.base)||this.variable)instanceof t&&!e.isNew?e.newInstance():this.isNew=!0,this.needsUpdatedStartLocation=!0,this}},{key:"unfoldSoak",value:function(e){var i,n,s,a,r,o,l,c;if(this.soak){if(this.variable instanceof $e)a=new ue(this.variable.compile(e)),c=new Ke(a),null==this.variable.accessor&&this.variable.error("Unsupported reference to 'super'");else{if(n=Pt(e,this,"variable"))return n;var h=d(new Ke(this.variable).cacheReference(e),2);a=h[0],c=h[1]}return(c=new t(c,this.args)).isNew=this.isNew,a=new ue("typeof ".concat(a.compile(e),' === "function"')),new H(a,new Ke(c),{soak:!0})}for(i=this,o=[];;)if(i.variable instanceof t)o.push(i),i=i.variable;else{if(!(i.variable instanceof Ke))break;if(o.push(i),!((i=i.variable.base)instanceof t))break}for(s=0,r=(l=o.reverse()).length;s<r;s++)i=l[s],n&&(i.variable instanceof t?i.variable=n:i.variable.base=n),n=Pt(e,i,"variable");return n}},{key:"compileNode",value:function(e){var t,n,s,a,r,o,l,c,h,u,p,m,f,v;for(this.checkForNewSuper(),null!=(u=this.variable)&&(u.front=this.front),o=[],v=(null==(p=this.variable)||null==(m=p.properties)?void 0:m[0])instanceof i,0<function(){var e,t,i,n;for(n=[],e=0,t=(i=this.args||[]).length;e<t;e++)(s=i[e])instanceof T&&n.push(s);return n}.call(this).length&&v&&!this.variable.base.cached&&(r=d(this.variable.base.cache(e,se,(function(){return!1})),1)[0],this.variable.base.cached=r),a=c=0,h=(f=this.args).length;c<h;a=++c){var g;s=f[a],a&&o.push(this.makeCode(", ")),(g=o).push.apply(g,y(s.compileToFragments(e,re)))}return l=[],this.isNew&&l.push(this.makeCode("new ")),(t=l).push.apply(t,y(this.variable.compileToFragments(e,se))),(n=l).push.apply(n,[this.makeCode("(")].concat(y(o),[this.makeCode(")")])),l}},{key:"checkForNewSuper",value:function(){if(this.isNew&&this.variable instanceof $e)return this.variable.error("Unsupported reference to 'super'")}},{key:"containsSoak",value:function(){var e;return!!this.soak||null!=(e=this.variable)&&"function"==typeof e.containsSoak&&e.containsSoak()}},{key:"astNode",value:function(e){var i;return this.soak&&this.variable instanceof $e&&(null==(i=e.scope.namedMethod())?void 0:i.ctor)&&this.variable.error("Unsupported reference to 'super'"),this.checkForNewSuper(),a(l(t.prototype),"astNode",this).call(this,e)}},{key:"astType",value:function(){return this.isNew?"NewExpression":this.containsSoak()?"OptionalCallExpression":"CallExpression"}},{key:"astProperties",value:function(e){var t;return{callee:this.variable.ast(e,se),arguments:function(){var i,n,s,a;for(a=[],i=0,n=(s=this.args).length;i<n;i++)t=s[i],a.push(t.ast(e,re));return a}.call(this),optional:!!this.soak,implicit:!!this.implicit}}}]),t}(m);return e.prototype.children=["variable","args"],e}.call(this),t.SuperCall=Be=function(){var e=function(e){"use strict";function t(){return f(this,t),r(this,l(t).apply(this,arguments))}return c(t,e),g(t,[{key:"isStatement",value:function(e){var t;return(null==(t=this.expressions)?void 0:t.length)&&e.level===ce}},{key:"compileNode",value:function(e){var i,n,s,r;if(null==(n=this.expressions)||!n.length)return a(l(t.prototype),"compileNode",this).call(this,e);if(r=new ue(ut(a(l(t.prototype),"compileNode",this).call(this,e))),s=new v(this.expressions.slice()),e.level>ce){var o=d(r.cache(e,null,Ze),2);r=o[0],i=o[1],s.push(i)}return s.unshift(r),s.compileToFragments(e,e.level===ce?e.level:re)}}]),t}(w);return e.prototype.children=w.prototype.children.concat(["expressions"]),e}.call(this),t.Super=$e=function(){var e=function(e){"use strict";function t(e,i){var n;return f(this,t),(n=r(this,l(t).call(this))).accessor=e,n.superLiteral=i,n}return c(t,e),g(t,[{key:"compileNode",value:function(e){var t,i,n,s,a,r,o;if(this.checkInInstanceMethod(e),null==(i=e.scope.namedMethod()).ctor&&null==this.accessor){var l=i;n=l.name,l.variable,(n.shouldCache()||n instanceof q&&n.index.isAssignable())&&(s=new B(e.scope.parent.freeVariable("name")),n.index=new h(s,n.index)),this.accessor=null==s?n:new q(s)}return(null==(a=this.accessor)||null==(r=a.name)?void 0:r.comments)&&(o=this.accessor.name.comments,delete this.accessor.name.comments),t=new Ke(new ue("super"),this.accessor?[this.accessor]:[]).compileToFragments(e),o&&nt(o,this.accessor.name),t}},{key:"checkInInstanceMethod",value:function(e){var t;if(null==(t=e.scope.namedMethod())||!t.isMethod)return this.error("cannot use super outside of an instance method")}},{key:"astNode",value:function(e){var i;return this.checkInInstanceMethod(e),null==this.accessor?a(l(t.prototype),"astNode",this).call(this,e):new Ke((new t).withLocationDataFrom(null==(i=this.superLiteral)?this:i),[this.accessor]).withLocationDataFrom(this).ast(e)}}]),t}(m);return e.prototype.children=["accessor"],e}.call(this),t.RegexWithInterpolations=function(){var e=function(e){"use strict";function t(e){var i,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},s=n.heregexCommentTokens,a=void 0===s?[]:s;return f(this,t),(i=r(this,l(t).call(this))).call=e,i.heregexCommentTokens=a,i}return c(t,e),g(t,[{key:"compileNode",value:function(e){return this.call.compileNode(e)}},{key:"astType",value:function(){return"InterpolatedRegExpLiteral"}},{key:"astProperties",value:function(e){var t,i,n;return{interpolatedPattern:this.call.args[0].ast(e),flags:null==(i=null==(n=this.call.args[1])?void 0:n.unwrap().originalValue)?"":i,comments:function(){var i,n,s,a;for(a=[],i=0,n=(s=this.heregexCommentTokens).length;i<n;i++)(t=s[i]).here?a.push(new V(t).ast(e)):a.push(new he(t).ast(e));return a}.call(this)}}}]),t}(m);return e.prototype.children=["call"],e}.call(this),t.TaggedTemplateCall=function(e){"use strict";function t(e,i,n){return f(this,t),i instanceof Fe&&(i=Ve.fromStringLiteral(i)),r(this,l(t).call(this,e,[i],n))}return c(t,e),g(t,[{key:"compileNode",value:function(e){return this.variable.compileToFragments(e,se).concat(this.args[0].compileToFragments(e,re))}},{key:"astType",value:function(){return"TaggedTemplateExpression"}},{key:"astProperties",value:function(e){return{tag:this.variable.ast(e,se),quasi:this.args[0].ast(e,re)}}}]),t}(w),t.Extends=function(){var e=function(e){"use strict";function t(e,i){var n;return f(this,t),(n=r(this,l(t).call(this))).child=e,n.parent=i,n}return c(t,e),g(t,[{key:"compileToFragments",value:function(e){return new w(new Ke(new ue(Ft("extend",e))),[this.child,this.parent]).compileToFragments(e)}}]),t}(m);return e.prototype.children=["child","parent"],e}.call(this),t.Access=i=function(){var e=function(e){"use strict";function t(e){var i,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},s=n.soak,a=n.shorthand;return f(this,t),(i=r(this,l(t).call(this))).name=e,i.soak=s,i.shorthand=a,i}return c(t,e),g(t,[{key:"compileToFragments",value:function(e){var t;return t=this.name.compileToFragments(e),this.name.unwrap()instanceof Ne?[this.makeCode(".")].concat(y(t)):[this.makeCode("[")].concat(y(t),[this.makeCode("]")])}},{key:"astNode",value:function(e){return this.name.ast(e)}}]),t}(m);return e.prototype.children=["name"],e.prototype.shouldCache=ve,e}.call(this),t.Index=q=function(){var e=function(e){"use strict";function t(e){var i;return f(this,t),(i=r(this,l(t).call(this))).index=e,i}return c(t,e),g(t,[{key:"compileToFragments",value:function(e){return[].concat(this.makeCode("["),this.index.compileToFragments(e,le),this.makeCode("]"))}},{key:"shouldCache",value:function(){return this.index.shouldCache()}},{key:"astNode",value:function(e){return this.index.ast(e)}}]),t}(m);return e.prototype.children=["index"],e}.call(this),t.Range=Ae=function(){var t=function(t){"use strict";function i(e,t,n){var s;return f(this,i),(s=r(this,l(i).call(this))).from=e,s.to=t,s.exclusive="exclusive"===n,s.equals=s.exclusive?"":"=",s}return c(i,t),g(i,[{key:"compileVariables",value:function(e){var t,i;e=At(e,{top:!0}),t=at(e,"shouldCache");var n=d(this.cacheToCodeFragments(this.from.cache(e,re,t)),2);this.fromC=n[0],this.fromVar=n[1];var s=d(this.cacheToCodeFragments(this.to.cache(e,re,t)),2);if(this.toC=s[0],this.toVar=s[1],i=at(e,"step")){var a=d(this.cacheToCodeFragments(i.cache(e,re,t)),2);this.step=a[0],this.stepVar=a[1]}return this.fromNum=this.from.isNumber()?Dt(this.fromVar):null,this.toNum=this.to.isNumber()?Dt(this.toVar):null,this.stepNum=(null==i?void 0:i.isNumber())?Dt(this.stepVar):null}},{key:"compileNode",value:function(e){var t,i,n,s,a,r,o,l,c,h,u,d,p,m,f,v,g,b;if(this.fromVar||this.compileVariables(e),!e.index)return this.compileArray(e);o=null!=this.fromNum&&null!=this.toNum,a=at(e,"index"),h=(r=at(e,"name"))&&r!==a,b=o&&!h?"var ".concat(a," = ").concat(this.fromC):"".concat(a," = ").concat(this.fromC),this.toC!==this.toVar&&(b+=", ".concat(this.toC)),this.step!==this.stepVar&&(b+=", ".concat(this.step)),c="".concat(a," <").concat(this.equals),s="".concat(a," >").concat(this.equals);var y=[this.fromNum,this.toNum];return n=y[0],v=y[1],m="".concat(null==(u=this.stepNum)?this.stepVar:u," !== 0"),p="".concat(null==(d=this.stepNum)?this.stepVar:d," > 0"),l="".concat(c," ").concat(o?v:this.toVar),g="".concat(s," ").concat(o?v:this.toVar),i=null==this.step?o?"".concat(n<=v?c:s," ").concat(v):"(".concat(this.fromVar," <= ").concat(this.toVar," ? ").concat(l," : ").concat(g,")"):null!=this.stepNum&&0!==this.stepNum?0<this.stepNum?"".concat(l):"".concat(g):"".concat(m," && (").concat(p," ? ").concat(l," : ").concat(g,")"),t=this.stepVar?"".concat(this.stepVar," > 0"):"".concat(this.fromVar," <= ").concat(this.toVar),f=this.stepVar?"".concat(a," += ").concat(this.stepVar):o?h?n<=v?"++".concat(a):"--".concat(a):"".concat(a,n<=v?"++":"--"):h?"".concat(t," ? ++").concat(a," : --").concat(a):"".concat(t," ? ").concat(a,"++ : ").concat(a,"--"),h&&(b="".concat(r," = ").concat(b)),h&&(f="".concat(r," = ").concat(f)),[this.makeCode("".concat(b,"; ").concat(i,"; ").concat(f))]}},{key:"compileArray",value:function(t){var i,n,s,a,r,o,l,c,h,u,d,p,m;return(l=null!=this.fromNum&&null!=this.toNum)&&20>=e(this.fromNum-this.toNum)?(u=function(){for(var e=[],t=d=this.fromNum,i=this.toNum;d<=i?t<=i:t>=i;d<=i?t++:t--)e.push(t);return e}.apply(this),this.exclusive&&u.pop(),[this.makeCode("[".concat(u.join(", "),"]"))]):(o=this.tab+Ue,r=t.scope.freeVariable("i",{single:!0,reserve:!1}),p=t.scope.freeVariable("results",{reserve:!1}),h="\n".concat(o,"var ").concat(p," = [];"),l?(t.index=r,n=ut(this.compileNode(t))):(m="".concat(r," = ").concat(this.fromC)+(this.toC===this.toVar?"":", ".concat(this.toC)),s="".concat(this.fromVar," <= ").concat(this.toVar),n="var ".concat(m,"; ").concat(s," ? ").concat(r," <").concat(this.equals," ").concat(this.toVar," : ").concat(r," >").concat(this.equals," ").concat(this.toVar,"; ").concat(s," ? ").concat(r,"++ : ").concat(r,"--")),c="{ ".concat(p,".push(").concat(r,"); }\n").concat(o,"return ").concat(p,";\n").concat(t.indent),((a=function(e){return null==e?void 0:e.contains(vt)})(this.from)||a(this.to))&&(i=", arguments"),[this.makeCode("(function() {".concat(h,"\n").concat(o,"for (").concat(n,")").concat(c,"}).apply(this").concat(null==i?"":i,")"))])}},{key:"astProperties",value:function(e){var t,i,n,s;return{from:null==(t=null==(i=this.from)?void 0:i.ast(e))?null:t,to:null==(n=null==(s=this.to)?void 0:s.ast(e))?null:n,exclusive:this.exclusive}}}]),i}(m);return t.prototype.children=["from","to"],t}.call(this),t.Slice=_e=function(){var e=function(e){"use strict";function t(e){var i;return f(this,t),(i=r(this,l(t).call(this))).range=e,i}return c(t,e),g(t,[{key:"compileNode",value:function(e){var t,i,n,s,a,r,o=this.range;return a=o.to,(null==(n=o.from)?void 0:n.shouldCache())&&(n=new Ke(new Ee(n))),(null==a?void 0:a.shouldCache())&&(a=new Ke(new Ee(a))),s=(null==n?void 0:n.compileToFragments(e,le))||[this.makeCode("0")],a&&(t=a.compileToFragments(e,le),i=ut(t),(this.range.exclusive||-1!=+i)&&(r=", "+(this.range.exclusive?i:a.isNumber()?"".concat(+i+1):(t=a.compileToFragments(e,se),"+".concat(ut(t)," + 1 || 9e9"))))),[this.makeCode(".slice(".concat(ut(s)).concat(r||"",")"))]}},{key:"astNode",value:function(e){return this.range.ast(e)}}]),t}(m);return e.prototype.children=["range"],e}.call(this),t.Obj=ye=function(){var e=function(e){"use strict";function t(e){var i,n=!!(1<arguments.length&&void 0!==arguments[1])&&arguments[1];return f(this,t),(i=r(this,l(t).call(this))).generated=n,i.objects=i.properties=e||[],i}return c(t,e),g(t,[{key:"isAssignable",value:function(e){var t,i,s,a,r,o;for(t=0,i=(r=this.properties).length;t<i;t++)if(a=r[t],(s=kt(a.unwrapAll().value))&&a.error(s),a instanceof h&&"object"===a.context&&!((null==(o=a.value)?void 0:o.base)instanceof n)&&(a=a.value),!a.isAssignable(e))return!1;return!0}},{key:"shouldCache",value:function(){return!this.isAssignable()}},{key:"hasSplat",value:function(){var e,t,i;for(e=0,t=(i=this.properties).length;e<t;e++)if(i[e]instanceof Pe)return!0;return!1}},{key:"reorderProperties",value:function(){var e,t,i;return e=this.properties,i=this.getAndCheckSplatProps(),t=e.splice(i[0],1),this.objects=this.properties=[].concat(e,t)}},{key:"compileNode",value:function(e){var t,i,n,s,a,r,o,l,c,u,p,m,f,v,g,b,w,k,x;if(this.hasSplat()&&this.lhs&&this.reorderProperties(),w=this.properties,this.generated)for(r=0,m=w.length;r<m;r++)(g=w[r])instanceof Ke&&g.error("cannot have an implicit value in an implicit object");for(n=e.indent+=Ue,p=this.lastNode(this.properties),this.propagateLhs(),a=!0,l=0,f=(k=this.properties).length;l<f;l++)(b=k[l])instanceof h&&"object"===b.context&&(a=!1);for((t=[]).push(this.makeCode(a?"":"\n")),i=u=0,v=w.length;u<v;i=++u){var E;if(b=w[i],o=i===w.length-1?"":a?", ":b===p?"\n":",\n",s=a?"":n,(c=b instanceof h&&"object"===b.context?b.variable:b instanceof h?(this.lhs||b.operatorToken.error("unexpected ".concat(b.operatorToken.value)),b.variable):b)instanceof Ke&&c.hasProperties()&&(("object"===b.context||!c.this)&&c.error("invalid object key"),c=c.properties[0].name,b=new h(c,b,"object")),c===b)if(b.shouldCache()){var T=d(b.base.cache(e),2);c=T[0],x=T[1],c instanceof B&&(c=new Ne(c.value)),b=new h(c,x,"object")}else if(c instanceof Ke&&c.base instanceof A)if(b.base.value.shouldCache()){var N=d(b.base.value.cache(e),2);c=N[0],x=N[1],c instanceof B&&(c=new A(c.value)),b=new h(c,x,"object")}else b=new h(c,b.base.value,"object");else"function"==typeof b.bareLiteral&&b.bareLiteral(B)||b instanceof Pe||(b=new h(b,b,"object"));s&&t.push(this.makeCode(s)),(E=t).push.apply(E,y(b.compileToFragments(e,ce))),o&&t.push(this.makeCode(o))}return t.push(this.makeCode(a?"":"\n".concat(this.tab))),t=this.wrapInBraces(t),this.front?this.wrapInParentheses(t):t}},{key:"getAndCheckSplatProps",value:function(){var e,t,i;if(this.hasSplat()&&this.lhs)return t=this.properties,1<(null==(i=function(){var i,n,s;for(s=[],e=i=0,n=t.length;i<n;e=++i)t[e]instanceof Pe&&s.push(e);return s}())?void 0:i.length)&&t[i[1]].error("multiple spread elements are disallowed"),i}},{key:"assigns",value:function(e){var t,i,n;for(t=0,i=(n=this.properties).length;t<i;t++)if(n[t].assigns(e))return!0;return!1}},{key:"eachName",value:function(e){var t,i,n,s,a;for(a=[],t=0,i=(s=this.properties).length;t<i;t++)(n=s[t])instanceof h&&"object"===n.context&&(n=n.value),null==(n=n.unwrapAll()).eachName?a.push(void 0):a.push(n.eachName(e));return a}},{key:"expandProperty",value:function(e){var t,i,n,s;return s=e.variable,t=e.context,n=e.operatorToken,(i=e instanceof h&&"object"===t?s:e instanceof h?(this.lhs||n.error("unexpected ".concat(n.value)),s):e)instanceof Ke&&i.hasProperties()?("object"!==t&&i.this||i.error("invalid object key"),new we(e instanceof h?{fromAssign:e}:{key:e})):i===e?e instanceof Pe?e:new we({key:e}):new we({fromAssign:e})}},{key:"expandProperties",value:function(){var e,t,i,n,s;for(s=[],e=0,t=(n=this.properties).length;e<t;e++)i=n[e],s.push(this.expandProperty(i));return s}},{key:"propagateLhs",value:function(e){var i,s,a,r,o,l;if(e&&(this.lhs=!0),this.lhs){for(o=[],i=0,s=(r=this.properties).length;i<s;i++)(a=r[i])instanceof h&&"object"===a.context?(l=a.value.unwrapAll())instanceof n||l instanceof t?o.push(l.propagateLhs(!0)):l instanceof h?o.push(l.nestedLhs=!0):o.push(void 0):a instanceof h?o.push(a.nestedLhs=!0):a instanceof Pe?o.push(a.propagateLhs(!0)):o.push(void 0);return o}}},{key:"astNode",value:function(e){return this.getAndCheckSplatProps(),a(l(t.prototype),"astNode",this).call(this,e)}},{key:"astType",value:function(){return this.lhs?"ObjectPattern":"ObjectExpression"}},{key:"astProperties",value:function(e){var t;return{implicit:!!this.generated,properties:function(){var i,n,s,a;for(a=[],i=0,n=(s=this.expandProperties()).length;i<n;i++)t=s[i],a.push(t.ast(e));return a}.call(this)}}}]),t}(m);return e.prototype.children=["properties"],e}.call(this),t.ObjectProperty=we=function(e){"use strict";function t(e){var i,n,s=e.key,a=e.fromAssign;return f(this,t),i=r(this,l(t).call(this)),a?(i.key=a.variable,n=a.value,"object"===a.context?i.value=n:(i.value=a,i.shorthand=!0),i.locationData=a.locationData):(i.key=s,i.shorthand=!0,i.locationData=s.locationData),i}return c(t,e),g(t,[{key:"astProperties",value:function(e){var t,i,n,s;return t=this.key instanceof Ke&&this.key.base instanceof A||this.key.unwrap()instanceof Ve,{key:(null==(i=this.key.ast(e,re))?void 0:i.declaration)?Object.assign({},i,{declaration:!1}):i,value:null==(n=null==(s=this.value)?void 0:s.ast(e,re))?i:n,shorthand:!!this.shorthand,computed:!!t,method:!1}}}]),t}(m),t.Arr=n=function(){var e=function(e){"use strict";function t(e){var i,n=!!(1<arguments.length&&void 0!==arguments[1])&&arguments[1];return f(this,t),(i=r(this,l(t).call(this))).lhs=n,i.objects=e||[],i.propagateLhs(),i}return c(t,e),g(t,[{key:"hasElision",value:function(){var e,t,i;for(e=0,t=(i=this.objects).length;e<t;e++)if(i[e]instanceof L)return!0;return!1}},{key:"isAssignable",value:function(e){var t,i,n,s,a,r,o,l,c=null==e?{}:e;i=c.allowExpansion,n=c.allowNontrailingSplat;var h=c.allowEmptyArray;if(t=void 0!==h&&h,!this.objects.length)return t;for(s=a=0,r=(l=this.objects).length;a<r;s=++a){if(o=l[s],!n&&o instanceof Pe&&s+1!==this.objects.length)return!1;if(!(i&&o instanceof j||o.isAssignable(e)&&(!o.isAtomic||o.isAtomic())))return!1}return!0}},{key:"shouldCache",value:function(){return!this.isAssignable()}},{key:"compileNode",value:function(e){var t,i,n,s,a,r,o,l,c,h,u,p,m,f,v,g,b,w,k,x,E,T,N,A,C;if(!this.objects.length)return[this.makeCode("[]")];for(e.indent+=Ue,a=function(e){var t=d(e,1)[0];return"Elision"===t.type&&","===t.code.trim()},E=!1,t=[],w=c=0,p=(N=this.objects).length;c<p;w=++c)(C=(b=N[w]).unwrapAll()).comments&&0===C.comments.filter((function(e){return!e.here})).length&&(C.includeCommentFragments=Ze);for(k=(i=function(){var t,i,n,s;for(s=[],t=0,i=(n=this.objects).length;t<i;t++)b=n[t],s.push(b.compileToFragments(e,re));return s}.call(this)).length,o=!1,l=h=0,m=i.length;h<m;l=++h){var L;for(u=0,f=(r=i[l]).length;u<f;u++)(n=r[u]).isHereComment?n.code=n.code.trim():0!==l&&!1===o&&pt(n)&&(o=!0);0!==l&&E&&(!a(r)||l===k-1)&&t.push(this.makeCode(", ")),E=E||!a(r),(L=t).push.apply(L,y(r))}if(o||0<=$t.call(ut(t),"\n")){for(s=x=0,v=t.length;x<v;s=++x)(n=t[s]).isHereComment?n.code="".concat(It(n.code,e.indent,!1),"\n").concat(e.indent):", "===n.code&&(null==n||!n.isElision)&&"StringLiteral"!==(A=n.type)&&"StringWithInterpolations"!==A&&(n.code=",\n".concat(e.indent));t.unshift(this.makeCode("[\n".concat(e.indent))),t.push(this.makeCode("\n".concat(this.tab,"]")))}else{for(T=0,g=t.length;T<g;T++)(n=t[T]).isHereComment&&(n.code="".concat(n.code," "));t.unshift(this.makeCode("[")),t.push(this.makeCode("]"))}return t}},{key:"assigns",value:function(e){var t,i,n;for(t=0,i=(n=this.objects).length;t<i;t++)if(n[t].assigns(e))return!0;return!1}},{key:"eachName",value:function(e){var t,i,n,s,a;for(a=[],t=0,i=(s=this.objects).length;t<i;t++)n=(n=s[t]).unwrapAll(),a.push(n.eachName(e));return a}},{key:"propagateLhs",value:function(e){var i,n,s,a,r,o;if(e&&(this.lhs=!0),this.lhs){for(r=[],i=0,n=(a=this.objects).length;i<n;i++)((s=a[i])instanceof Pe||s instanceof j)&&(s.lhs=!0),(o=s.unwrapAll())instanceof t||o instanceof ye?r.push(o.propagateLhs(!0)):o instanceof h?r.push(o.nestedLhs=!0):r.push(void 0);return r}}},{key:"astType",value:function(){return this.lhs?"ArrayPattern":"ArrayExpression"}},{key:"astProperties",value:function(e){var t;return{elements:function(){var i,n,s,a;for(a=[],i=0,n=(s=this.objects).length;i<n;i++)t=s[i],a.push(t.ast(e,re));return a}.call(this)}}}]),t}(m);return e.prototype.children=["objects"],e}.call(this),t.Class=k=function(){var e=function(e){"use strict";function t(e,i,n){var s;return f(this,t),(s=r(this,l(t).call(this))).variable=e,s.parent=i,s.body=n,null==s.body&&(s.body=new v,s.hasGeneratedBody=!0),s}return c(t,e),g(t,[{key:"compileNode",value:function(e){var t,i,n;if(this.name=this.determineName(),t=this.walkBody(e),this.parent instanceof Ke&&!this.parent.hasProperties()&&(n=this.parent.base.value),this.hasNameClash=null!=this.name&&this.name===n,i=this,t||this.hasNameClash?i=new I(i,t):null==this.name&&e.level===ce&&(i=new Ee(i)),this.boundMethods.length&&this.parent&&(null==this.variable&&(this.variable=new B(e.scope.freeVariable("_class"))),null==this.variableRef)){var s=d(this.variable.cache(e),2);this.variable=s[0],this.variableRef=s[1]}this.variable&&(i=new h(this.variable,i,null,{moduleDeclaration:this.moduleDeclaration})),this.compileNode=this.compileClassDeclaration;try{return i.compileToFragments(e)}finally{delete this.compileNode}}},{key:"compileClassDeclaration",value:function(e){var t,i,n,s,a;return(this.externalCtor||this.boundMethods.length)&&null==this.ctor&&(this.ctor=this.makeDefaultConstructor()),null!=(t=this.ctor)&&(t.noReturn=!0),this.boundMethods.length&&this.proxyBoundMethods(),e.indent+=Ue,(n=[]).push(this.makeCode("class ")),this.name&&n.push(this.makeCode(this.name)),null!=(null==(i=this.variable)?void 0:i.comments)&&this.compileCommentFragments(e,this.variable,n),this.name&&n.push(this.makeCode(" ")),this.parent&&(s=n).push.apply(s,[this.makeCode("extends ")].concat(y(this.parent.compileToFragments(e)),[this.makeCode(" ")])),n.push(this.makeCode("{")),this.body.isEmpty()||(this.body.spaced=!0,n.push(this.makeCode("\n")),(a=n).push.apply(a,y(this.body.compileToFragments(e,ce))),n.push(this.makeCode("\n".concat(this.tab)))),n.push(this.makeCode("}")),n}},{key:"determineName",value:function(){var e,t,n,s,a;return this.variable?(s=this.variable.properties,(n=(a=d(Ht.call(s,-1),1)[0])?a instanceof i&&a.name:this.variable.base)instanceof B||n instanceof Ne?(t=n.value,a||(e=kt(t))&&this.variable.error(e),0<=$t.call(ie,t)?"_".concat(t):t):null):null}},{key:"walkBody",value:function(e){var t,i,n,s,a,r,o,l,c,h,u,d,p,m,f,g,b;for(this.ctor=null,this.boundMethods=[],o=[],r=0,c=0,u=(g=(s=this.body.expressions).slice()).length;c<u;c++)if((n=g[c])instanceof Ke&&n.isObject(!0)){for(m=n.base.properties,a=[],i=0,b=0,f=function(){if(i>b)return a.push(new Ke(new ye(m.slice(b,i),!0)))};t=m[i];)(l=this.addInitializerExpression(t,e))&&(f(),a.push(l),o.push(l),b=i+1),i++;f(),Bt.apply(s,[r,r-r+1].concat(a)),r+=a.length}else(l=this.addInitializerExpression(n,e))&&(o.push(l),s[r]=l),r+=1;for(h=0,d=o.length;h<d;h++)(p=o[h])instanceof T&&(p.ctor?(this.ctor&&p.error("Cannot define more than one constructor in a class"),this.ctor=p):p.isStatic&&p.bound?p.context=this.name:p.bound&&this.boundMethods.push(p));return e.compiling?o.length===s.length?void 0:(this.body.expressions=function(){var e,t,i;for(i=[],e=0,t=o.length;e<t;e++)n=o[e],i.push(n.hoist());return i}(),new v(s)):void 0}},{key:"addInitializerExpression",value:function(e,t){return e.unwrapAll()instanceof Te?e:this.validInitializerMethod(e)?this.addInitializerMethod(e):!t.compiling&&this.validClassProperty(e)?this.addClassProperty(e):!t.compiling&&this.validClassPrototypeProperty(e)?this.addClassPrototypeProperty(e):null}},{key:"validInitializerMethod",value:function(e){return!!(e instanceof h&&e.value instanceof T)&&(!("object"!==e.context||e.variable.hasProperties())||e.variable.looksStatic(this.name)&&(this.name||!e.value.bound))}},{key:"addInitializerMethod",value:function(e){var t,n,s,a;return a=e.variable,t=e.value,s=e.operatorToken,t.isMethod=!0,t.isStatic=a.looksStatic(this.name),t.isStatic?t.name=a.properties[0]:(n=a.base,t.name=new(n.shouldCache()?q:i)(n),t.name.updateLocationDataIfMissing(n.locationData),(n instanceof Fe?"constructor"===n.originalValue:"constructor"===n.value)&&(t.ctor=this.parent?"derived":"base"),t.bound&&t.ctor&&t.error("Cannot define a constructor as a bound (fat arrow) function")),t.operatorToken=s,t}},{key:"validClassProperty",value:function(e){return!!(e instanceof h)&&e.variable.looksStatic(this.name)}},{key:"addClassProperty",value:function(e){var t,i,n,s;return s=e.variable,n=e.value,t=e.operatorToken,i=s.looksStatic(this.name).staticClassName,new x({name:s.properties[0],isStatic:!0,staticClassName:i,value:n,operatorToken:t}).withLocationDataFrom(e)}},{key:"validClassPrototypeProperty",value:function(e){return!!(e instanceof h)&&"object"===e.context&&!e.variable.hasProperties()}},{key:"addClassPrototypeProperty",value:function(e){var t,i;return i=e.variable,t=e.value,new E({name:i.base,value:t}).withLocationDataFrom(e)}},{key:"makeDefaultConstructor",value:function(){var e,t,n;return n=this.addInitializerMethod(new h(new Ke(new Ne("constructor")),new T)),this.body.unshift(n),this.parent&&n.body.push(new Be(new $e,[new Pe(new B("arguments"))])),this.externalCtor&&(t=new Ke(this.externalCtor,[new i(new Ne("apply"))]),e=[new Xe,new B("arguments")],n.body.push(new w(t,e)),n.body.makeReturn()),n}},{key:"proxyBoundMethods",value:function(){var e,t;return this.ctor.thisAssignments=function(){var n,s,a,r;for(r=[],n=0,s=(a=this.boundMethods).length;n<s;n++)e=a[n],this.parent&&(e.classVariable=this.variableRef),t=new Ke(new Xe,[e.name]),r.push(new h(t,new w(new Ke(t,[new i(new Ne("bind"))]),[new Xe])));return r}.call(this),null}},{key:"declareName",value:function(e){var t,i,n;if((i=null==(n=this.variable)?void 0:n.unwrap())instanceof B)return t=e.scope.find(i.value),i.isDeclaration=!t}},{key:"isStatementAst",value:function(){return!0}},{key:"astNode",value:function(e){var i,n,s;return(n=this.body.jumps())&&n.error("Class bodies cannot contain pure statements"),(i=this.body.contains(vt))&&i.error("Class bodies shouldn't reference arguments"),this.declareName(e),this.name=this.determineName(),this.body.isClassBody=!0,this.hasGeneratedBody&&(this.body.locationData=Vt(this.locationData)),this.walkBody(e),Rt(this.body.expressions),null!=(s=this.ctor)&&(s.noReturn=!0),a(l(t.prototype),"astNode",this).call(this,e)}},{key:"astType",value:function(e){return e.level===ce?"ClassDeclaration":"ClassExpression"}},{key:"astProperties",value:function(e){var t,i,n,s;return{id:null==(t=null==(i=this.variable)?void 0:i.ast(e))?null:t,superClass:null==(n=null==(s=this.parent)?void 0:s.ast(e,le))?null:n,body:this.body.ast(e,ce)}}}]),t}(m);return e.prototype.children=["variable","parent","body"],e}.call(this),t.ExecutableClassBody=I=function(){var e=function(e){"use strict";function t(e){var i,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new v;return f(this,t),(i=r(this,l(t).call(this))).class=e,i.body=n,i}return c(t,e),g(t,[{key:"compileNode",value:function(e){var t,n,s,a,r,o,l,c,u,d,p,m;return(l=this.body.jumps())&&l.error("Class bodies cannot contain pure statements"),(s=this.body.contains(vt))&&s.error("Class bodies shouldn't reference arguments"),u=[],n=[new Xe],m=new T(u,this.body),c=new Ee(new w(new Ke(m,[new i(new Ne("call"))]),n)),this.body.spaced=!0,e.classScope=m.makeScope(e.scope),this.name=null==(p=this.class.name)?e.classScope.freeVariable(this.defaultClassVariableName):p,o=new B(this.name),a=this.walkBody(),this.setContext(),this.class.hasNameClash&&(d=new B(e.classScope.freeVariable("superClass")),m.params.push(new xe(d)),n.push(this.class.parent),this.class.parent=d),this.externalCtor&&(r=new B(e.classScope.freeVariable("ctor",{reserve:!1})),this.class.externalCtor=r,this.externalCtor.variable.base=r),this.name===this.class.name?this.body.expressions.unshift(this.class):this.body.expressions.unshift(new h(new B(this.name),this.class)),(t=this.body.expressions).unshift.apply(t,y(a)),this.body.push(o),c.compileToFragments(e)}},{key:"walkBody",value:function(){var e,t,i,n=this;for(e=[],i=0;(t=this.body.expressions[i])&&t instanceof Ke&&t.isString();)if(t.hoisted)i++;else{var s;(s=e).push.apply(s,y(this.body.expressions.splice(i,1)))}return this.traverseChildren(!1,(function(e){var t,i,s,a,r,o;if(e instanceof k||e instanceof $)return!1;if(t=!0,e instanceof v){for(i=s=0,a=(o=e.expressions).length;s<a;i=++s)(r=o[i])instanceof Ke&&r.isObject(!0)?(t=!1,e.expressions[i]=n.addProperties(r.base.properties)):r instanceof h&&r.variable.looksStatic(n.name)&&(r.value.isStatic=!0);e.expressions=ht(e.expressions)}return t})),e}},{key:"setContext",value:function(){var e=this;return this.body.traverseChildren(!1,(function(t){return t instanceof Xe?t.value=e.name:t instanceof T&&t.bound&&(t.isStatic||!t.name)?t.context=e.name:void 0}))}},{key:"addProperties",value:function(e){var t,n,s,a,r,o,l;return r=function(){var r,c,u;for(u=[],r=0,c=e.length;r<c;r++)t=e[r],l=t.variable,n=null==l?void 0:l.base,o=t.value,delete t.context,"constructor"===n.value?(o instanceof T&&n.error("constructors must be defined at the top level of a class body"),t=this.externalCtor=new h(new Ke,o)):t.variable.this?t.value instanceof T&&(t.value.isStatic=!0):(s=n instanceof A?new q(n.value):new(n.shouldCache()?q:i)(n),a=new i(new Ne("prototype")),l=new Ke(new Xe,[a,s]),t.variable=l),u.push(t);return u}.call(this),st(r)}}]),t}(m);return e.prototype.children=["class","body"],e.prototype.defaultClassVariableName="_Class",e}.call(this),t.ClassProperty=x=function(){var e=function(e){"use strict";function t(e){var i,n=e.name,s=e.isStatic,a=e.staticClassName,o=e.value,c=e.operatorToken;return f(this,t),(i=r(this,l(t).call(this))).name=n,i.isStatic=s,i.staticClassName=a,i.value=o,i.operatorToken=c,i}return c(t,e),g(t,[{key:"astProperties",value:function(e){var t,i,n,s;return{key:this.name.ast(e,re),value:this.value.ast(e,re),static:!!this.isStatic,computed:this.name instanceof q||this.name instanceof A,operator:null==(t=null==(i=this.operatorToken)?void 0:i.value)?"=":t,staticClassName:null==(n=null==(s=this.staticClassName)?void 0:s.ast(e))?null:n}}}]),t}(m);return e.prototype.children=["name","value","staticClassName"],e.prototype.isStatement=Ze,e}.call(this),t.ClassPrototypeProperty=E=function(){var e=function(e){"use strict";function t(e){var i,n=e.name,s=e.value;return f(this,t),(i=r(this,l(t).call(this))).name=n,i.value=s,i}return c(t,e),g(t,[{key:"astProperties",value:function(e){return{key:this.name.ast(e,re),value:this.value.ast(e,re),computed:this.name instanceof A||this.name instanceof Ve}}}]),t}(m);return e.prototype.children=["name","value"],e.prototype.isStatement=Ze,e}.call(this),t.ModuleDeclaration=de=function(){var e=function(e){"use strict";function t(e,i){var n;return f(this,t),(n=r(this,l(t).call(this))).clause=e,n.source=i,n.checkSource(),n}return c(t,e),g(t,[{key:"checkSource",value:function(){if(null!=this.source&&this.source instanceof Ve)return this.source.error("the name of the module to be imported from must be an uninterpolated string")}},{key:"checkScope",value:function(e,t){if(0!==e.indent.length)return this.error("".concat(t," statements must be at top-level scope"))}}]),t}(m);return e.prototype.children=["clause","source"],e.prototype.isStatement=Ze,e.prototype.jumps=We,e.prototype.makeReturn=We,e}.call(this),t.ImportDeclaration=function(e){"use strict";function t(){return f(this,t),r(this,l(t).apply(this,arguments))}return c(t,e),g(t,[{key:"compileNode",value:function(e){var t,i,n;return this.checkScope(e,"import"),e.importedSymbols=[],(t=[]).push(this.makeCode("".concat(this.tab,"import "))),null!=this.clause&&(n=t).push.apply(n,y(this.clause.compileNode(e))),null!=(null==(i=this.source)?void 0:i.value)&&(null!==this.clause&&t.push(this.makeCode(" from ")),t.push(this.makeCode(this.source.value))),t.push(this.makeCode(";")),t}},{key:"astNode",value:function(e){return e.importedSymbols=[],a(l(t.prototype),"astNode",this).call(this,e)}},{key:"astProperties",value:function(e){var t,i,n;return n={specifiers:null==(t=null==(i=this.clause)?void 0:i.ast(e))?[]:t,source:this.source.ast(e)},this.clause&&(n.importKind="value"),n}}]),t}(de),t.ImportClause=function(){var e=function(e){"use strict";function t(e,i){var n;return f(this,t),(n=r(this,l(t).call(this))).defaultBinding=e,n.namedImports=i,n}return c(t,e),g(t,[{key:"compileNode",value:function(e){var t,i,n;return t=[],null!=this.defaultBinding&&((i=t).push.apply(i,y(this.defaultBinding.compileNode(e))),null!=this.namedImports&&t.push(this.makeCode(", "))),null!=this.namedImports&&(n=t).push.apply(n,y(this.namedImports.compileNode(e))),t}},{key:"astNode",value:function(e){var t,i;return st(ht([null==(t=this.defaultBinding)?void 0:t.ast(e),null==(i=this.namedImports)?void 0:i.ast(e)]))}}]),t}(m);return e.prototype.children=["defaultBinding","namedImports"],e}.call(this),t.ExportDeclaration=O=function(e){"use strict";function t(){return f(this,t),r(this,l(t).apply(this,arguments))}return c(t,e),g(t,[{key:"compileNode",value:function(e){var t,i;return this.checkScope(e,"export"),this.checkForAnonymousClassExport(),(t=[]).push(this.makeCode("".concat(this.tab,"export "))),this instanceof R&&t.push(this.makeCode("default ")),!(this instanceof R)&&(this.clause instanceof h||this.clause instanceof k)&&(t.push(this.makeCode("var ")),this.clause.moduleDeclaration="export"),t=null!=this.clause.body&&this.clause.body instanceof v?t.concat(this.clause.compileToFragments(e,ce)):t.concat(this.clause.compileNode(e)),null!=(null==(i=this.source)?void 0:i.value)&&t.push(this.makeCode(" from ".concat(this.source.value))),t.push(this.makeCode(";")),t}},{key:"checkForAnonymousClassExport",value:function(){if(!(this instanceof R)&&this.clause instanceof k&&!this.clause.variable)return this.clause.error("anonymous classes cannot be exported")}},{key:"astNode",value:function(e){return this.checkForAnonymousClassExport(),a(l(t.prototype),"astNode",this).call(this,e)}}]),t}(de),t.ExportNamedDeclaration=function(e){"use strict";function t(){return f(this,t),r(this,l(t).apply(this,arguments))}return c(t,e),g(t,[{key:"astProperties",value:function(e){var t,i,n,s;return s={source:null==(i=null==(n=this.source)?void 0:n.ast(e))?null:i,exportKind:"value"},t=this.clause.ast(e),this.clause instanceof _?(s.specifiers=t,s.declaration=null):(s.specifiers=[],s.declaration=t),s}}]),t}(O),t.ExportDefaultDeclaration=R=function(e){"use strict";function t(){return f(this,t),r(this,l(t).apply(this,arguments))}return c(t,e),g(t,[{key:"astProperties",value:function(e){return{declaration:this.clause.ast(e)}}}]),t}(O),t.ExportAllDeclaration=function(e){"use strict";function t(){return f(this,t),r(this,l(t).apply(this,arguments))}return c(t,e),g(t,[{key:"astProperties",value:function(e){return{source:this.source.ast(e),exportKind:"value"}}}]),t}(O),t.ModuleSpecifierList=me=function(){var e=function(e){"use strict";function t(e){var i;return f(this,t),(i=r(this,l(t).call(this))).specifiers=e,i}return c(t,e),g(t,[{key:"compileNode",value:function(e){var t,i,n,s,a,r,o;if(t=[],e.indent+=Ue,i=function(){var t,i,n,s;for(s=[],t=0,i=(n=this.specifiers).length;t<i;t++)o=n[t],s.push(o.compileToFragments(e,re));return s}.call(this),0!==this.specifiers.length){for(t.push(this.makeCode("{\n".concat(e.indent))),s=a=0,r=i.length;a<r;s=++a){var l;n=i[s],s&&t.push(this.makeCode(",\n".concat(e.indent))),(l=t).push.apply(l,y(n))}t.push(this.makeCode("\n}"))}else t.push(this.makeCode("{}"));return t}},{key:"astNode",value:function(e){var t,i,n,s,a;for(s=[],t=0,i=(n=this.specifiers).length;t<i;t++)a=n[t],s.push(a.ast(e));return s}}]),t}(m);return e.prototype.children=["specifiers"],e}.call(this),t.ImportSpecifierList=function(e){"use strict";function t(){return f(this,t),r(this,l(t).apply(this,arguments))}return c(t,e),t}(me),t.ExportSpecifierList=_=function(e){"use strict";function t(){return f(this,t),r(this,l(t).apply(this,arguments))}return c(t,e),t}(me),t.ModuleSpecifier=pe=function(){var e=function(e){"use strict";function t(e,i,n){var s,a,o,c,h;return f(this,t),(s=r(this,l(t).call(this))).original=e,s.alias=i,s.moduleDeclarationType=n,(s.original.comments||(null==(a=s.alias)?void 0:a.comments))&&(s.comments=[],s.original.comments&&(c=s.comments).push.apply(c,y(s.original.comments)),(null==(o=s.alias)?void 0:o.comments)&&(h=s.comments).push.apply(h,y(s.alias.comments))),s.identifier=null==s.alias?s.original.value:s.alias.value,s}return c(t,e),g(t,[{key:"compileNode",value:function(e){var t;return this.addIdentifierToScope(e),(t=[]).push(this.makeCode(this.original.value)),null!=this.alias&&t.push(this.makeCode(" as ".concat(this.alias.value))),t}},{key:"addIdentifierToScope",value:function(e){return e.scope.find(this.identifier,this.moduleDeclarationType)}},{key:"astNode",value:function(e){return this.addIdentifierToScope(e),a(l(t.prototype),"astNode",this).call(this,e)}}]),t}(m);return e.prototype.children=["original","alias"],e}.call(this),t.ImportSpecifier=U=function(e){"use strict";function t(e,i){return f(this,t),r(this,l(t).call(this,e,i,"import"))}return c(t,e),g(t,[{key:"addIdentifierToScope",value:function(e){var i;return i=this.identifier,0<=$t.call(e.importedSymbols,i)||e.scope.check(this.identifier)?this.error("'".concat(this.identifier,"' has already been declared")):e.importedSymbols.push(this.identifier),a(l(t.prototype),"addIdentifierToScope",this).call(this,e)}},{key:"astProperties",value:function(e){var t,i,n;return{imported:t=this.original.ast(e),local:null==(i=null==(n=this.alias)?void 0:n.ast(e))?t:i,importKind:null}}}]),t}(pe),t.ImportDefaultSpecifier=function(e){"use strict";function t(){return f(this,t),r(this,l(t).apply(this,arguments))}return c(t,e),g(t,[{key:"astProperties",value:function(e){return{local:this.original.ast(e)}}}]),t}(U),t.ImportNamespaceSpecifier=function(e){"use strict";function t(){return f(this,t),r(this,l(t).apply(this,arguments))}return c(t,e),g(t,[{key:"astProperties",value:function(e){return{local:this.alias.ast(e)}}}]),t}(U),t.ExportSpecifier=function(e){"use strict";function t(e,i){return f(this,t),r(this,l(t).call(this,e,i,"export"))}return c(t,e),g(t,[{key:"astProperties",value:function(e){var t,i,n;return{local:t=this.original.ast(e),exported:null==(i=null==(n=this.alias)?void 0:n.ast(e))?t:i}}}]),t}(pe),t.DynamicImport=function(e){"use strict";function t(){return f(this,t),r(this,l(t).apply(this,arguments))}return c(t,e),g(t,[{key:"compileNode",value:function(){return[this.makeCode("import")]}},{key:"astType",value:function(){return"Import"}}]),t}(m),t.DynamicImportCall=function(e){"use strict";function t(){return f(this,t),r(this,l(t).apply(this,arguments))}return c(t,e),g(t,[{key:"compileNode",value:function(e){return this.checkArguments(),a(l(t.prototype),"compileNode",this).call(this,e)}},{key:"checkArguments",value:function(){if(1!==this.args.length)return this.error("import() requires exactly one argument")}},{key:"astNode",value:function(e){return this.checkArguments(),a(l(t.prototype),"astNode",this).call(this,e)}}]),t}(w),t.Assign=h=function(){var e=function(e){"use strict";function t(e,i,n){var s,a=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{};f(this,t),(s=r(this,l(t).call(this))).variable=e,s.value=i,s.context=n,s.param=a.param,s.subpattern=a.subpattern,s.operatorToken=a.operatorToken,s.moduleDeclaration=a.moduleDeclaration;var o=a.originalContext;return s.originalContext=void 0===o?s.context:o,s.propagateLhs(),s}return c(t,e),g(t,[{key:"isStatement",value:function(e){return(null==e?void 0:e.level)===ce&&null!=this.context&&(this.moduleDeclaration||0<=$t.call(this.context,"?"))}},{key:"checkNameAssignability",value:function(e,t){if("import"===e.scope.type(t.value))return t.error("'".concat(t.value,"' is read-only"))}},{key:"assigns",value:function(e){return this["object"===this.context?"value":"variable"].assigns(e)}},{key:"unfoldSoak",value:function(e){return Pt(e,this,"variable")}},{key:"addScopeVariables",value:function(e){var t,i=this,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},s=n.allowAssignmentToExpansion,a=n.allowAssignmentToNontrailingSplat,r=n.allowAssignmentToEmptyArray,o=n.allowAssignmentToComplexSplat;if(!this.context||"**="===this.context)return(t=this.variable.unwrapAll()).isAssignable({allowExpansion:void 0!==s&&s,allowNontrailingSplat:void 0!==a&&a,allowEmptyArray:void 0!==r&&r,allowComplexSplat:void 0!==o&&o})||this.variable.error("'".concat(this.variable.compile(e),"' can't be assigned")),t.eachName((function(t){var n,s,a,r;if("function"!=typeof t.hasProperties||!t.hasProperties())return(r=kt(t.value))&&t.error(r),i.checkNameAssignability(e,t),i.moduleDeclaration?(e.scope.add(t.value,i.moduleDeclaration),t.isDeclaration=!0):i.param?e.scope.add(t.value,"alwaysDeclare"===i.param?"var":"param"):(n=e.scope.find(t.value),null==t.isDeclaration&&(t.isDeclaration=!n),!t.comments||e.scope.comments[t.value]||i.value instanceof k||!t.comments.every((function(e){return e.here&&!e.multiline}))?void 0:((a=new B(t.value)).comments=t.comments,s=[],i.compileCommentFragments(e,a,s),e.scope.comments[t.value]=s))}))}},{key:"compileNode",value:function(e){var t,i,n,s,a,r,o,l,c,h;if(n=this.variable instanceof Ke){if((this.variable.isArray()||this.variable.isObject())&&!this.variable.isAssignable())return this.variable.isObject()&&this.variable.base.hasSplat()?this.compileObjectDestruct(e):this.compileDestructuring(e);if(this.variable.isSplice())return this.compileSplice(e);if(this.isConditional())return this.compileConditional(e);if("//="===(o=this.context)||"%%="===o)return this.compileSpecialMath(e)}if(this.addScopeVariables(e),this.value instanceof T)if(this.value.isStatic)this.value.name=this.variable.properties[0];else if(2<=(null==(l=this.variable.properties)?void 0:l.length)){var p;a=u(this.variable.properties).slice(0),r=(p=d(Bt.call(a,-2),2))[0],s=p[1],"prototype"===(null==(c=r.name)?void 0:c.value)&&(this.value.name=s)}return h=this.value.compileToFragments(e,re),i=this.variable.compileToFragments(e,re),"object"===this.context?(this.variable.shouldCache()&&(i.unshift(this.makeCode("[")),i.push(this.makeCode("]"))),i.concat(this.makeCode(": "),h)):(t=i.concat(this.makeCode(" ".concat(this.context||"="," ")),h),e.level>re||n&&this.variable.base instanceof ye&&!this.nestedLhs&&!0!==this.param?this.wrapInParentheses(t):t)}},{key:"compileObjectDestruct",value:function(e){var i,n,s,a;return this.variable.base.reorderProperties(),n=this.variable.base.properties,a=d(Ht.call(n,-1),1)[0].name,i=[],s=new Ke(new B(e.scope.freeVariable("ref"))),n.splice(-1,1,new Pe(s)),i.push(new t(new Ke(new ye(n)),this.value).compileToFragments(e,re)),i.push(new t(new Ke(a),s).compileToFragments(e,re)),this.joinFragmentArrays(i,", ")}},{key:"compileDestructuring",value:function(e){var s,a,r,o,l,c,h,u,p,m,f,v,g,b,k,x,E,T,N,A,C,S,I,D,j,O,R,_,P,M,F,V,$,H,U=this;if(F=e.level===ce,V=this.value,E=this.variable.base.objects,0===(T=E.length))return r=V.compileToFragments(e),e.level>=oe?this.wrapInParentheses(r):r;var W=d(E,1);k=W[0],this.disallowLoneExpansion();var z=this.getAndCheckSplatsAndExpansions();return P=z.splats,u=z.expans,M=z.splatsAndExpans,v=0<(null==P?void 0:P.length),f=0<(null==u?void 0:u.length),$=V.compileToFragments(e,re),H=ut($),a=[],A=function(i,n){return a.push(new t(i,n,null,{param:U.param,subpattern:!0}).compileToFragments(e,re))},v&&((O=E[P[0]].name.unwrap())instanceof n||O instanceof ye)&&(_=new B(e.scope.freeVariable("ref")),E[P[0]].name=_,R=function(){return A(new Ke(O),_)}),(!(V.unwrap()instanceof B)||this.variable.assigns(H))&&(C=e.scope.freeVariable("ref"),a.push([this.makeCode(C+" = ")].concat(y($))),$=[this.makeCode(C)],H=C),o=(j=function(t){return function(n,s){var a,r,o=!!(2<arguments.length&&void 0!==arguments[2])&&arguments[2];return n instanceof Ke||(n=new B(n)),a=[n,new be(s)],o&&a.push(new be(o)),r=new Ke(new B(Ft(t,e)),[new i(new Ne("call"))]),new Ke(new w(r,a))}})("slice"),l=j("splice"),m=function(e){var i,n,s,a;for(a=[],i=n=0,s=e.length;n<s;i=++n)(k=e[i])instanceof t&&"object"===k.context&&a.push(i);return a},x=function(e){var t,i;for(t=0,i=e.length;t<i;t++)if(!(k=e[t]).isAssignable())return!0;return!1},c=function(e){return m(e).length||x(e)||1===T},b=function(e,n,s){var a,r,l,c,h,u,d,p;for(d=[],r=c=0,h=e.length;c<h;r=++c)if(!((k=e[r])instanceof L)){if(k instanceof t&&"object"===k.context){var m=k;l=m.variable.base,(n=m.value)instanceof t&&(n=n.variable),a=(l=n.this?n.properties[0].name:new Ne(n.unwrap().value)).unwrap()instanceof Ne,p=new Ke(V,[new(a?i:q)(l)])}else n=function(){switch(!1){case!(k instanceof Pe):return new Ke(k.name);default:return k}}(),p=function(){switch(!1){case!(k instanceof Pe):return o(s,r);default:return new Ke(new ue(s),[new q(new be(r))])}}();(u=kt(n.unwrap().value))&&n.error(u),d.push(A(n,p))}return d},s=function(e,t,i){var s;return t=new Ke(new n(e,!0)),s=i instanceof Ke?i:new Ke(new ue(i)),A(t,s)},N=function(e,t,i){return c(e)?b(e,t,i):s(e,t,i)},M.length?(h=M[0],g=E.slice(0,h+(v?1:0)),D=E.slice(h+1),0!==g.length&&N(g,$,H),0!==D.length&&(S=function(){switch(!1){case!v:return l(new Ke(E[h].name),-1*D.length);case!f:return o(H,-1*D.length)}}(),c(D)&&(I=S,S=e.scope.freeVariable("ref"),a.push([this.makeCode(S+" = ")].concat(y(I.compileToFragments(e,re))))),N(D,$,S))):N(E,$,H),"function"==typeof R&&R(),F||this.subpattern||a.push($),p=this.joinFragmentArrays(a,", "),e.level<re?p:this.wrapInParentheses(p)}},{key:"disallowLoneExpansion",value:function(){var e,t;if(this.variable.base instanceof n&&1===(null==(t=this.variable.base.objects)?void 0:t.length)&&(e=d(t,1)[0])instanceof j)return e.error("Destructuring assignment has no target")}},{key:"getAndCheckSplatsAndExpansions",value:function(){var e,t,i,s,a;return this.variable.base instanceof n?(i=this.variable.base.objects,s=function(){var e,n,s;for(s=[],t=e=0,n=i.length;e<n;t=++e)i[t]instanceof Pe&&s.push(t);return s}(),e=function(){var e,n,s;for(s=[],t=e=0,n=i.length;e<n;t=++e)i[t]instanceof j&&s.push(t);return s}(),1<(a=[].concat(y(s),y(e))).length&&i[a.sort()[1]].error("multiple splats/expansions are disallowed in an assignment"),{splats:s,expans:e,splatsAndExpans:a}):{splats:[],expans:[],splatsAndExpans:[]}}},{key:"compileConditional",value:function(e){var i,n,s,a=d(this.variable.cacheReference(e),2);return n=a[0],s=a[1],n.properties.length||!(n.base instanceof ue)||n.base instanceof Xe||e.scope.check(n.base.value)||this.throwUnassignableConditionalError(n.base.value),0<=$t.call(this.context,"?")?(e.isExistentialEquals=!0,new H(new D(n),s,{type:"if"}).addElse(new t(s,this.value,"=")).compileToFragments(e)):(i=new ke(this.context.slice(0,-1),n,new t(s,this.value,"=")).compileToFragments(e),e.level<=re?i:this.wrapInParentheses(i))}},{key:"compileSpecialMath",value:function(e){var i,n,s=d(this.variable.cacheReference(e),2);return i=s[0],n=s[1],new t(i,new ke(this.context.slice(0,-1),n,this.value)).compileToFragments(e)}},{key:"compileSplice",value:function(e){var t,i,n,s,a,r,o,l,c,h,u=this.variable.properties.pop().range;if(n=u.from,o=u.to,i=u.exclusive,(l=this.variable.unwrapAll()).comments&&(St(l,this),delete this.variable.comments),r=this.variable.compile(e),n){var p=d(this.cacheToCodeFragments(n.cache(e,oe)),2);s=p[0],a=p[1]}else s=a="0";o?(null==n?void 0:n.isNumber())&&o.isNumber()?(o=o.compile(e)-a,!i&&(o+=1)):(o=o.compile(e,se)+" - "+a,!i&&(o+=" + 1")):o="9e9";var m=d(this.value.cache(e,re),2);return c=m[0],h=m[1],t=[].concat(this.makeCode("".concat(Ft("splice",e),".apply(").concat(r,", [").concat(s,", ").concat(o,"].concat(")),c,this.makeCode(")), "),h),e.level>ce?this.wrapInParentheses(t):t}},{key:"eachName",value:function(e){return this.variable.unwrapAll().eachName(e)}},{key:"isDefaultAssignment",value:function(){return this.param||this.nestedLhs}},{key:"propagateLhs",value:function(){var e,t;return(null==(e=this.variable)?void 0:"function"==typeof e.isArray?e.isArray():void 0)||(null==(t=this.variable)?void 0:"function"==typeof t.isObject?t.isObject():void 0)?this.variable.base.propagateLhs(!0):void 0}},{key:"throwUnassignableConditionalError",value:function(e){return this.variable.error('the variable "'.concat(e,"\" can't be assigned with ").concat(this.context," because it has not been declared before"))}},{key:"isConditional",value:function(){var e;return"||="===(e=this.context)||"&&="===e||"?="===e}},{key:"astNode",value:function(e){var i;return this.disallowLoneExpansion(),this.getAndCheckSplatsAndExpansions(),this.isConditional()&&(i=this.variable.unwrap())instanceof B&&!e.scope.check(i.value)&&this.throwUnassignableConditionalError(i.value),this.addScopeVariables(e,{allowAssignmentToExpansion:!0,allowAssignmentToNontrailingSplat:!0,allowAssignmentToEmptyArray:!0,allowAssignmentToComplexSplat:!0}),a(l(t.prototype),"astNode",this).call(this,e)}},{key:"astType",value:function(){return this.isDefaultAssignment()?"AssignmentPattern":"AssignmentExpression"}},{key:"astProperties",value:function(e){var t,i;return i={right:this.value.ast(e,re),left:this.variable.ast(e,re)},this.isDefaultAssignment()||(i.operator=null==(t=this.originalContext)?"=":t),i}}]),t}(m);return e.prototype.children=["variable","value"],e.prototype.isAssignable=Ze,e.prototype.isStatementAst=ve,e}.call(this),t.FuncGlyph=function(e){"use strict";function t(e){var i;return f(this,t),(i=r(this,l(t).call(this))).glyph=e,i}return c(t,e),t}(m),t.Code=T=function(){var e=function(e){"use strict";function t(e,i,n,s){var a,o;return f(this,t),(a=r(this,l(t).call(this))).funcGlyph=n,a.paramStart=s,a.params=e||[],a.body=i||new v,a.bound="=>"===(null==(o=a.funcGlyph)?void 0:o.glyph),a.isGenerator=!1,a.isAsync=!1,a.isMethod=!1,a.body.traverseChildren(!1,(function(e){if((e instanceof ke&&e.isYield()||e instanceof et)&&(a.isGenerator=!0),(e instanceof ke&&e.isAwait()||e instanceof p)&&(a.isAsync=!0),e instanceof P&&e.isAwait())return a.isAsync=!0})),a.propagateLhs(),a}return c(t,e),g(t,[{key:"isStatement",value:function(){return this.isMethod}},{key:"makeScope",value:function(e){return new Oe(e,this.body,this)}},{key:"compileNode",value:function(e){var t,i,s,a,r,o,l,c,u,d,p,m,f,v,g,b,k,x,E,T,N,A,C,L,S,I,D,O,R,_,P,M,F,V,$,U,W,q,z,X,G,J,Y;for(this.checkForAsyncOrGeneratorConstructor(),this.bound&&((null==(O=e.scope.method)?void 0:O.bound)&&(this.context=e.scope.method.context),!this.context&&(this.context="this")),this.updateOptions(e),S=[],l=[],z=null==(R=null==(_=this.thisAssignments)?void 0:_.slice())?[]:R,I=[],d=!1,u=!1,this.checkForDuplicateParams(),this.disallowLoneExpansionAndMultipleSplats(),this.eachParamName((function(t,i,n,s){var a,r;if(i.this)return t=i.properties[0].name.value,0<=$t.call(ie,t)&&(t="_".concat(t)),r=new B(e.scope.freeVariable(t,{reserve:!1})),a=n.name instanceof ye&&s instanceof h&&"="===s.operatorToken.value?new h(new B(t),r,"object"):r,n.renameParam(i,a),z.push(new h(i,r))})),p=f=0,b=(P=this.params).length;f<b;p=++f)(C=P[p]).splat||C instanceof j?(d=!0,C.splat?(C.name instanceof n||C.name instanceof ye?(q=e.scope.freeVariable("arg"),S.push(D=new Ke(new B(q))),l.push(new h(new Ke(C.name),D))):(S.push(D=C.asReference(e)),q=ut(D.compileNodeWithoutComments(e))),C.shouldCache()&&l.push(new h(new Ke(C.name),D))):(q=e.scope.freeVariable("args"),S.push(new Ke(new B(q)))),e.scope.parameter(q)):((C.shouldCache()||u)&&(C.assignedInBody=!0,u=!0,null==C.value?l.push(new h(new Ke(C.name),C.asReference(e),null,{param:"alwaysDeclare"})):(o=new ke("===",C,new Ye),m=new h(new Ke(C.name),C.value),l.push(new H(o,m)))),d?(I.push(C),null!=C.value&&!C.shouldCache()&&(o=new ke("===",C,new Ye),m=new h(new Ke(C.name),C.value),l.push(new H(o,m))),null!=(null==(M=C.name)?void 0:M.value)&&e.scope.add(C.name.value,"var",!0)):(D=C.shouldCache()?C.asReference(e):null==C.value||C.assignedInBody?C:new h(new Ke(C.name),C.value,null,{param:!0}),C.name instanceof n||C.name instanceof ye?(C.name.lhs=!0,!C.shouldCache()&&C.name.eachName((function(t){return e.scope.parameter(t.value)}))):(L=null==C.value?D:C,e.scope.parameter(ut(L.compileToFragmentsWithoutComments(e)))),S.push(D)));for(0!==I.length&&l.unshift(new h(new Ke(new n([new Pe(new B(q))].concat(y(function(){var t,i,n;for(n=[],t=0,i=I.length;t<i;t++)C=I[t],n.push(C.asReference(e));return n}())))),new Ke(new B(q)))),X=this.body.isEmpty(),this.disallowSuperInParamDefaults(),this.checkSuperCallsInConstructorBody(),this.expandCtorSuper(z)||(G=this.body.expressions).unshift.apply(G,y(z)),(t=this.body.expressions).unshift.apply(t,y(l)),this.isMethod&&this.bound&&!this.isStatic&&this.classVariable&&(r=new Ke(new ue(Ft("boundMethodCheck",e))),this.body.expressions.unshift(new w(r,[new Ke(new Xe),this.classVariable]))),X||this.noReturn||this.body.makeReturn(),this.bound&&this.isGenerator&&(this.body.contains((function(e){return e instanceof ke&&"yield"===e.operator}))||this).error("yield cannot occur inside bound (fat arrow) functions"),N=[],this.isMethod&&this.isStatic&&N.push("static"),this.isAsync&&N.push("async"),this.isMethod||this.bound?this.isGenerator&&N.push("*"):N.push("function".concat(this.isGenerator?"*":"")),W=[this.makeCode("(")],null!=(null==(F=this.paramStart)?void 0:F.comments)&&this.compileCommentFragments(e,this.paramStart,W),p=v=0,k=S.length;v<k;p=++v){var K,Q;C=S[p],0!==p&&W.push(this.makeCode(", ")),d&&p===S.length-1&&W.push(this.makeCode("...")),U=e.scope.variables.length,(K=W).push.apply(K,y(C.compileToFragments(e,le))),U!==e.scope.variables.length&&(c=e.scope.variables.splice(U),(Q=e.scope.parent.variables).push.apply(Q,y(c)))}if(W.push(this.makeCode(")")),null!=(null==(V=this.funcGlyph)?void 0:V.comments)){for(g=0,x=($=this.funcGlyph.comments).length;g<x;g++)$[g].unshift=!1;this.compileCommentFragments(e,this.funcGlyph,W)}if(this.body.isEmpty()||(a=this.body.compileWithDeclarations(e)),this.isMethod){var Z=[e.scope,e.scope.parent];T=Z[0],e.scope=Z[1],"."===(A=this.name.compileToFragments(e))[0].code&&A.shift(),e.scope=T}return s=this.joinFragmentArrays(function(){var e,t,i;for(i=[],t=0,e=N.length;t<e;t++)E=N[t],i.push(this.makeCode(E));return i}.call(this)," "),N.length&&A&&s.push(this.makeCode(" ")),A&&(J=s).push.apply(J,y(A)),(i=s).push.apply(i,y(W)),this.bound&&!this.isMethod&&s.push(this.makeCode(" =>")),s.push(this.makeCode(" {")),(null==a?void 0:a.length)&&(Y=s).push.apply(Y,[this.makeCode("\n")].concat(y(a),[this.makeCode("\n".concat(this.tab))])),s.push(this.makeCode("}")),this.isMethod?mt(s,this):this.front||e.level>=se?this.wrapInParentheses(s):s}},{key:"updateOptions",value:function(e){return e.scope=at(e,"classScope")||this.makeScope(e.scope),e.scope.shared=at(e,"sharedScope"),e.indent+=Ue,delete e.bare,delete e.isExistentialEquals}},{key:"checkForDuplicateParams",value:function(){var e;return e=[],this.eachParamName((function(t,i){return 0<=$t.call(e,t)&&i.error("multiple parameters named '".concat(t,"'")),e.push(t)}))}},{key:"eachParamName",value:function(e){var t,i,n,s,a;for(a=[],t=0,i=(s=this.params).length;t<i;t++)n=s[t],a.push(n.eachName(e));return a}},{key:"traverseChildren",value:function(e,i){if(e)return a(l(t.prototype),"traverseChildren",this).call(this,e,i)}},{key:"replaceInContext",value:function(e,i){return!!this.bound&&a(l(t.prototype),"replaceInContext",this).call(this,e,i)}},{key:"disallowSuperInParamDefaults",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.forAst;return!!this.ctor&&this.eachSuperCall(v.wrap(this.params),(function(e){return e.error("'super' is not allowed in constructor parameter defaults")}),{checkForThisBeforeSuper:!t})}},{key:"checkSuperCallsInConstructorBody",value:function(){var e=this;return!!this.ctor&&this.eachSuperCall(this.body,(function(t){if("base"===e.ctor)return t.error("'super' is only allowed in derived class constructors")}))}},{key:"flagThisParamInDerivedClassConstructorWithoutCallingSuper",value:function(e){return e.error("Can't use @params in derived class constructors without calling super")}},{key:"checkForAsyncOrGeneratorConstructor",value:function(){if(this.ctor&&(this.isAsync&&this.name.error("Class constructor may not be async"),this.isGenerator))return this.name.error("Class constructor may not be a generator")}},{key:"disallowLoneExpansionAndMultipleSplats",value:function(){var e,t,i,n,s,a;for(a=!1,s=[],e=0,t=(n=this.params).length;e<t;e++)(i=n[e]).splat||i instanceof j?(a?i.error("only one splat or expansion parameter is allowed per function definition"):i instanceof j&&1===this.params.length&&i.error("an expansion parameter cannot be the only parameter in a function definition"),s.push(a=!0)):s.push(void 0);return s}},{key:"expandCtorSuper",value:function(e){var t,i,n,s;return!!this.ctor&&(s=this.eachSuperCall(this.body,(function(t){return t.expressions=e})),t=e.length&&e.length!==(null==(n=this.thisAssignments)?void 0:n.length),"derived"===this.ctor&&!s&&t&&(i=e[0].variable,this.flagThisParamInDerivedClassConstructorWithoutCallingSuper(i)),s)}},{key:"eachSuperCall",value:function(e,i){var n,s=this,a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},r=a.checkForThisBeforeSuper;return n=!1,e.traverseChildren(!0,(function(e){var a;return e instanceof Be?(!e.variable.accessor&&(a=e.args.filter((function(e){return!(e instanceof k)&&(!(e instanceof t)||e.bound)})),v.wrap(a).traverseChildren(!0,(function(e){if(e.this)return e.error("Can't call super with @params in derived class constructors")}))),n=!0,i(e)):(void 0===r||r)&&e instanceof Xe&&"derived"===s.ctor&&!n&&e.error("Can't reference 'this' before calling super in derived class constructors"),!(e instanceof Be)&&(!(e instanceof t)||e.bound)})),n}},{key:"propagateLhs",value:function(){var e,t,i,s,a,r;for(r=[],e=0,t=(a=this.params).length;e<t;e++)(i=(s=a[e]).name)instanceof n||i instanceof ye?r.push(i.propagateLhs(!0)):s instanceof j?r.push(s.lhs=!0):r.push(void 0);return r}},{key:"astAddParamsToScope",value:function(e){return this.eachParamName((function(t){return e.scope.add(t,"param")}))}},{key:"astNode",value:function(e){var i,n=this;return this.updateOptions(e),this.checkForAsyncOrGeneratorConstructor(),this.checkForDuplicateParams(),this.disallowSuperInParamDefaults({forAst:!0}),this.disallowLoneExpansionAndMultipleSplats(),i=this.checkSuperCallsInConstructorBody(),"derived"!==this.ctor||i||this.eachParamName((function(e,t){if(t.this)return n.flagThisParamInDerivedClassConstructorWithoutCallingSuper(t)})),this.astAddParamsToScope(e),this.body.isEmpty()||this.noReturn||this.body.makeReturn(null,!0),a(l(t.prototype),"astNode",this).call(this,e)}},{key:"astType",value:function(){return this.isMethod?"ClassMethod":this.bound?"ArrowFunctionExpression":"FunctionExpression"}},{key:"paramForAst",value:function(e){var t,i,n;return e instanceof j?e:(t=e.name,n=e.value,(i=e.splat)?new Pe(t,{lhs:!0,postfix:i.postfix}).withLocationDataFrom(e):null==n?t:new h(t,n,null,{param:!0}).withLocationDataFrom({locationData:Lt(t.locationData,n.locationData)}))}},{key:"methodAstProperties",value:function(e){var t,i,n,s,a,r=this;return t=function(){return!!(r.name instanceof q)||!!(r.name instanceof A)||!!(r.name.name instanceof A)},{static:!!this.isStatic,key:this.name.ast(e),computed:t(),kind:this.ctor?"constructor":"method",operator:null==(i=null==(n=this.operatorToken)?void 0:n.value)?"=":i,staticClassName:null==(s=null==(a=this.isStatic.staticClassName)?void 0:a.ast(e))?null:s,bound:!!this.bound}}},{key:"astProperties",value:function(e){var t,i;return Object.assign({params:function(){var i,n,s,a;for(a=[],i=0,n=(s=this.params).length;i<n;i++)t=s[i],a.push(this.paramForAst(t).ast(e));return a}.call(this),body:this.body.ast(Object.assign({},e,{checkForDirectives:!0}),ce),generator:!!this.isGenerator,async:!!this.isAsync,id:null,hasIndentedBody:this.body.locationData.first_line>(null==(i=this.funcGlyph)?void 0:i.locationData.first_line)},this.isMethod?this.methodAstProperties(e):{})}},{key:"astLocationData",value:function(){var e,i;return i=a(l(t.prototype),"astLocationData",this).call(this),this.isMethod?(e=Ct(this.name.astLocationData(),i),null!=this.isStatic.staticClassName&&(e=Ct(this.isStatic.staticClassName.astLocationData(),e)),e):i}}]),t}(m);return e.prototype.children=["params","body"],e.prototype.jumps=ve,e}.call(this),t.Param=xe=function(){var e=function(e){"use strict";function t(e,i,n){var s,a,o;return f(this,t),(s=r(this,l(t).call(this))).name=e,s.value=i,s.splat=n,(a=kt(s.name.unwrapAll().value))&&s.name.error(a),s.name instanceof ye&&s.name.generated&&(o=s.name.objects[0].operatorToken).error("unexpected ".concat(o.value)),s}return c(t,e),g(t,[{key:"compileToFragments",value:function(e){return this.name.compileToFragments(e,re)}},{key:"compileToFragmentsWithoutComments",value:function(e){return this.name.compileToFragmentsWithoutComments(e,re)}},{key:"asReference",value:function(e){var t,i;return this.reference?this.reference:((i=this.name).this?(t=i.properties[0].name.value,0<=$t.call(ie,t)&&(t="_".concat(t)),i=new B(e.scope.freeVariable(t))):i.shouldCache()&&(i=new B(e.scope.freeVariable("arg"))),(i=new Ke(i)).updateLocationDataIfMissing(this.locationData),this.reference=i)}},{key:"shouldCache",value:function(){return this.name.shouldCache()}},{key:"eachName",value:function(e){var t,i,n,s,a,r,o,l,c,u=this,d=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.name;if(i=function(e){var t;if((t=kt(e.value))&&e.error(t),!e.isAssignable())return e.error("'".concat(e.value,"' can't be assigned"))},t=function(t){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;return e("@".concat(t.properties[0].name.value),t,u,i)},d instanceof w&&d.error("Function invocation can't be assigned"),d instanceof ue)return i(d),e(d.value,d,this);if(d instanceof Ke)return t(d);for(n=0,s=(c=null==(l=d.objects)?[]:l).length;n<s;n++)a=o=c[n],o instanceof h&&null==o.context&&(o=o.variable),o instanceof h?(o=o.value instanceof h?o.value.variable:o.value,this.eachName(e,o.unwrap())):o instanceof Pe?(r=o.name.unwrap(),e(r.value,r,this)):o instanceof Ke?o.isArray()||o.isObject()?this.eachName(e,o.base):o.this?t(o,a):(i(o.base),e(o.base.value,o.base,this)):o instanceof L||!(o instanceof j)&&o.error("illegal parameter ".concat(o.compile()))}},{key:"renameParam",value:function(e,t){var i,n;return i=function(t){return t===e},n=function(e,i){var n;return i instanceof ye?(n=e,e.this&&(n=e.properties[0].name),e.this&&n.value===t.value?new Ke(t):new h(new Ke(n),t,"object")):t},this.replaceInContext(i,n)}}]),t}(m);return e.prototype.children=["name","value"],e}.call(this),t.Splat=Pe=function(){var e=function(e){"use strict";function t(e){var i,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},s=n.lhs,a=n.postfix;return f(this,t),(i=r(this,l(t).call(this))).lhs=s,i.postfix=void 0===a||a,i.name=e.compile?e:new ue(e),i}return c(t,e),g(t,[{key:"shouldCache",value:function(){return!1}},{key:"isAssignable",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.allowComplexSplat;return this.name instanceof ye||this.name instanceof Ee?void 0!==t&&t:this.name.isAssignable()&&(!this.name.isAtomic||this.name.isAtomic())}},{key:"assigns",value:function(e){return this.name.assigns(e)}},{key:"compileNode",value:function(e){var t;return t=[this.makeCode("...")].concat(y(this.name.compileToFragments(e,oe))),this.jsx?[this.makeCode("{")].concat(y(t),[this.makeCode("}")]):t}},{key:"unwrap",value:function(){return this.name}},{key:"propagateLhs",value:function(e){var t;return e&&(this.lhs=!0),this.lhs&&"function"==typeof(t=this.name).propagateLhs?t.propagateLhs(!0):void 0}},{key:"astType",value:function(){return this.jsx?"JSXSpreadAttribute":this.lhs?"RestElement":"SpreadElement"}},{key:"astProperties",value:function(e){return{argument:this.name.ast(e,oe),postfix:this.postfix}}}]),t}(m);return e.prototype.children=["name"],e}.call(this),t.Expansion=j=function(){var e=function(e){"use strict";function t(){return f(this,t),r(this,l(t).apply(this,arguments))}return c(t,e),g(t,[{key:"compileNode",value:function(){return this.throwLhsError()}},{key:"asReference",value:function(){return this}},{key:"eachName",value:function(){}},{key:"throwLhsError",value:function(){return this.error("Expansion must be used inside a destructuring assignment or parameter list")}},{key:"astNode",value:function(e){return this.lhs||this.throwLhsError(),a(l(t.prototype),"astNode",this).call(this,e)}},{key:"astType",value:function(){return"RestElement"}},{key:"astProperties",value:function(){return{argument:null}}}]),t}(m);return e.prototype.shouldCache=ve,e}.call(this),t.Elision=L=function(){var e=function(e){"use strict";function t(){return f(this,t),r(this,l(t).apply(this,arguments))}return c(t,e),g(t,[{key:"compileToFragments",value:function(e,i){var n;return(n=a(l(t.prototype),"compileToFragments",this).call(this,e,i)).isElision=!0,n}},{key:"compileNode",value:function(){return[this.makeCode(", ")]}},{key:"asReference",value:function(){return this}},{key:"eachName",value:function(){}},{key:"astNode",value:function(){return null}}]),t}(m);return e.prototype.isAssignable=Ze,e.prototype.shouldCache=ve,e}.call(this),t.While=Qe=function(){var e=function(e){"use strict";function t(e){var i,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},s=n.invert,a=n.guard,o=n.isLoop;return f(this,t),(i=r(this,l(t).call(this))).condition=e,i.invert=s,i.guard=a,i.isLoop=o,i}return c(t,e),g(t,[{key:"makeReturn",value:function(e,i){return e?a(l(t.prototype),"makeReturn",this).call(this,e,i):(this.returns=!this.jumps(),i?void(this.returns&&this.body.makeReturn(e,i)):this)}},{key:"addBody",value:function(e){return this.body=e,this}},{key:"jumps",value:function(){var e,t,i,n;if(!(e=this.body.expressions).length)return!1;for(t=0,n=e.length;t<n;t++)if(i=e[t].jumps({loop:!0}))return i;return!1}},{key:"compileNode",value:function(e){var t,i,n,s;return e.indent+=Ue,s="",(i=this.body).isEmpty()?i=this.makeCode(""):(this.returns&&(i.makeReturn(n=e.scope.freeVariable("results")),s="".concat(this.tab).concat(n," = [];\n")),this.guard&&(1<i.expressions.length?i.expressions.unshift(new H(new Ee(this.guard).invert(),new Me("continue"))):this.guard&&(i=v.wrap([new H(this.guard,i)]))),i=[].concat(this.makeCode("\n"),i.compileToFragments(e,ce),this.makeCode("\n".concat(this.tab)))),t=[].concat(this.makeCode(s+this.tab+"while ("),this.processedCondition().compileToFragments(e,le),this.makeCode(") {"),i,this.makeCode("}")),this.returns&&t.push(this.makeCode("\n".concat(this.tab,"return ").concat(n,";"))),t}},{key:"processedCondition",value:function(){return null==this.processedConditionCache?this.processedConditionCache=this.invert?this.condition.invert():this.condition:this.processedConditionCache}},{key:"astType",value:function(){return"WhileStatement"}},{key:"astProperties",value:function(e){var t,i;return{test:this.condition.ast(e,le),body:this.body.ast(e,ce),guard:null==(t=null==(i=this.guard)?void 0:i.ast(e))?null:t,inverted:!!this.invert,postfix:!!this.postfix,loop:!!this.isLoop}}}]),t}(m);return e.prototype.children=["condition","guard","body"],e.prototype.isStatement=Ze,e}.call(this),t.Op=ke=function(){var e,t,n=function(n){"use strict";function s(t,i,n,a){var c,h,u,d,p,m,v=4<arguments.length&&void 0!==arguments[4]?arguments[4]:{},g=v.invertOperator,b=v.originalOperator,y=void 0===b?t:b;return f(this,s),(c=r(this,l(s).call(this))).invertOperator=g,c.originalOperator=y,"new"===t?!((u=m=i.unwrap())instanceof w||(u=m.base)instanceof w)||u.do||u.isNew?(i instanceof Ee||i.unwrap()instanceof B||("function"==typeof i.hasProperties?i.hasProperties():void 0)||(i=new Ee(i)),(h=new w(i,[])).locationData=c.locationData,h.isNew=!0,r(c,h)):r(c,new Ke(u.newInstance(),u===m?[]:m.properties)):(c.operator=e[t]||t,c.first=i,c.second=n,c.flip=!!a,("--"===(p=c.operator)||"++"===p)&&(d=kt(c.first.unwrapAll().value))&&c.first.error(d),r(c,o(c)))}return c(s,n),g(s,[{key:"isNumber",value:function(){var e;return this.isUnary()&&("+"===(e=this.operator)||"-"===e)&&this.first instanceof Ke&&this.first.isNumber()}},{key:"isAwait",value:function(){return"await"===this.operator}},{key:"isYield",value:function(){var e;return"yield"===(e=this.operator)||"yield*"===e}},{key:"isUnary",value:function(){return!this.second}},{key:"shouldCache",value:function(){return!this.isNumber()}},{key:"isChainable",value:function(){var e;return"<"===(e=this.operator)||">"===e||">="===e||"<="===e||"==="===e||"!=="===e}},{key:"isChain",value:function(){return this.isChainable()&&this.first.isChainable()}},{key:"invert",value:function(){var e,i,n,a,r;if(this.isInOperator())return this.invertOperator="!",this;if(this.isChain()){for(e=!0,i=this;i&&i.operator;)e&&(e=i.operator in t),i=i.first;if(!e)return new Ee(this).invert();for(i=this;i&&i.operator;)i.invert=!i.invert,i.operator=t[i.operator],i=i.first;return this}return(a=t[this.operator])?(this.operator=a,this.first.unwrap()instanceof s&&this.first.invert(),this):this.second?new Ee(this).invert():"!"===this.operator&&(n=this.first.unwrap())instanceof s&&("!"===(r=n.operator)||"in"===r||"instanceof"===r)?n:new s("!",this)}},{key:"unfoldSoak",value:function(e){var t;return("++"===(t=this.operator)||"--"===t||"delete"===t)&&Pt(e,this,"first")}},{key:"generateDo",value:function(e){var t,i,n,s,a,r,o;for(a=[],i=0,n=(o=(e instanceof h&&(r=e.value.unwrap())instanceof T?r:e).params||[]).length;i<n;i++)(s=o[i]).value?(a.push(s.value),delete s.value):a.push(s);return(t=new w(e,a)).do=!0,t}},{key:"isInOperator",value:function(){return"in"===this.originalOperator}},{key:"compileNode",value:function(e){var t,i,n,a,r;if(this.isInOperator())return i=new W(this.first,this.second),(this.invertOperator?i.invert():i).compileNode(e);if(this.invertOperator)return this.invertOperator=null,this.invert().compileNode(e);if("do"===this.operator)return s.prototype.generateDo(this.first).compileNode(e);if((n=this.isChain())||(this.first.front=this.front),this.checkDeleteOperand(e),this.isYield()||this.isAwait())return this.compileContinuation(e);if(this.isUnary())return this.compileUnary(e);if(n)return this.compileChain(e);switch(this.operator){case"?":return this.compileExistence(e,this.second.isDefaultValue);case"//":return this.compileFloorDivision(e);case"%%":return this.compileModulo(e);default:return a=this.first.compileToFragments(e,oe),r=this.second.compileToFragments(e,oe),t=[].concat(a,this.makeCode(" ".concat(this.operator," ")),r),e.level<=oe?t:this.wrapInParentheses(t)}}},{key:"compileChain",value:function(e){var t,i,n=d(this.first.second.cache(e),2);return this.first.second=n[0],i=n[1],t=this.first.compileToFragments(e,oe).concat(this.makeCode(" ".concat(this.invert?"&&":"||"," ")),i.compileToFragments(e),this.makeCode(" ".concat(this.operator," ")),this.second.compileToFragments(e,oe)),this.wrapInParentheses(t)}},{key:"compileExistence",value:function(e,t){var i,n;return this.first.shouldCache()?(n=new B(e.scope.freeVariable("ref")),i=new Ee(new h(n,this.first))):n=i=this.first,new H(new D(i,t),n,{type:"if"}).addElse(this.second).compileToFragments(e)}},{key:"compileUnary",value:function(e){var t,i,n;return i=[],t=this.operator,i.push([this.makeCode(t)]),"!"===t&&this.first instanceof D?(this.first.negated=!this.first.negated,this.first.compileToFragments(e)):e.level>=se?new Ee(this).compileToFragments(e):(n="+"===t||"-"===t,("typeof"===t||"delete"===t||n&&this.first instanceof s&&this.first.operator===t)&&i.push([this.makeCode(" ")]),n&&this.first instanceof s&&(this.first=new Ee(this.first)),i.push(this.first.compileToFragments(e,oe)),this.flip&&i.reverse(),this.joinFragmentArrays(i,""))}},{key:"compileContinuation",value:function(e){var t,i,n;return i=[],t=this.operator,this.checkContinuation(e),0<=$t.call(Object.keys(this.first),"expression")&&!(this.first instanceof Ge)?null!=this.first.expression&&i.push(this.first.expression.compileToFragments(e,oe)):(e.level>=le&&i.push([this.makeCode("(")]),i.push([this.makeCode(t)]),""!==(null==(n=this.first.base)?void 0:n.value)&&i.push([this.makeCode(" ")]),i.push(this.first.compileToFragments(e,oe)),e.level>=le&&i.push([this.makeCode(")")])),this.joinFragmentArrays(i,"")}},{key:"checkContinuation",value:function(e){var t;if(null==e.scope.parent&&this.error("".concat(this.operator," can only occur inside functions")),(null==(t=e.scope.method)?void 0:t.bound)&&e.scope.method.isGenerator)return this.error("yield cannot occur inside bound (fat arrow) functions")}},{key:"compileFloorDivision",value:function(e){var t,n,a;return n=new Ke(new B("Math"),[new i(new Ne("floor"))]),a=this.second.shouldCache()?new Ee(this.second):this.second,t=new s("/",this.first,a),new w(n,[t]).compileToFragments(e)}},{key:"compileModulo",value:function(e){var t;return t=new Ke(new ue(Ft("modulo",e))),new w(t,[this.first,this.second]).compileToFragments(e)}},{key:"toString",value:function(e){return a(l(s.prototype),"toString",this).call(this,e,this.constructor.name+" "+this.operator)}},{key:"checkDeleteOperand",value:function(e){if("delete"===this.operator&&e.scope.check(this.first.unwrapAll().value))return this.error("delete operand may not be argument or var")}},{key:"astNode",value:function(e){return(this.isYield()||this.isAwait())&&this.checkContinuation(e),this.checkDeleteOperand(e),a(l(s.prototype),"astNode",this).call(this,e)}},{key:"astType",value:function(){if(this.isAwait())return"AwaitExpression";if(this.isYield())return"YieldExpression";if(this.isChain())return"ChainedComparison";switch(this.operator){case"||":case"&&":case"?":return"LogicalExpression";case"++":case"--":return"UpdateExpression";default:return this.isUnary()?"UnaryExpression":"BinaryExpression"}}},{key:"operatorAst",value:function(){return"".concat(this.invertOperator?"".concat(this.invertOperator," "):"").concat(this.originalOperator)}},{key:"chainAstProperties",value:function(e){var t,i,n,s;for(s=[this.operatorAst()],n=[this.second],t=this.first;;)if(s.unshift(t.operatorAst()),n.unshift(t.second),!(t=t.first).isChainable()){n.unshift(t);break}return{operators:s,operands:function(){var t,s,a;for(a=[],t=0,s=n.length;t<s;t++)i=n[t],a.push(i.ast(e,oe));return a}()}}},{key:"astProperties",value:function(e){var t,i,n,s,a;if(this.isChain())return this.chainAstProperties(e);switch(i=this.first.ast(e,oe),a=null==(s=this.second)?void 0:s.ast(e,oe),n=this.operatorAst(),!1){case!this.isUnary():return t=this.isYield()&&""===this.first.unwrap().value?null:i,this.isAwait()?{argument:t}:this.isYield()?{argument:t,delegate:"yield*"===this.operator}:{argument:t,operator:n,prefix:!this.flip};default:return{left:i,right:a,operator:n}}}}]),s}(m);return e={"==":"===","!=":"!==",of:"in",yieldfrom:"yield*"},t={"!==":"===","===":"!=="},n.prototype.children=["first","second"],n}.call(this),t.In=W=function(){var e=function(e){"use strict";function t(e,i){var n;return f(this,t),(n=r(this,l(t).call(this))).object=e,n.array=i,n}return c(t,e),g(t,[{key:"compileNode",value:function(e){var t,i,n,s;if(this.array instanceof Ke&&this.array.isArray()&&this.array.base.objects.length){for(i=0,n=(s=this.array.base.objects).length;i<n;i++)if(s[i]instanceof Pe){t=!0;break}if(!t)return this.compileOrTest(e)}return this.compileLoopTest(e)}},{key:"compileOrTest",value:function(e){var t,i,n,s,a,r,o,l,c,h,u=d(this.object.cache(e,oe),2);c=u[0],o=u[1];var p=d(this.negated?[" !== "," && "]:[" === "," || "],2);for(t=p[0],i=p[1],h=[],n=a=0,r=(l=this.array.base.objects).length;a<r;n=++a)s=l[n],n&&h.push(this.makeCode(i)),h=h.concat(n?o:c,this.makeCode(t),s.compileToFragments(e,se));return e.level<oe?h:this.wrapInParentheses(h)}},{key:"compileLoopTest",value:function(e){var t,i,n,s=d(this.object.cache(e,re),2);return n=s[0],i=s[1],t=[].concat(this.makeCode(Ft("indexOf",e)+".call("),this.array.compileToFragments(e,re),this.makeCode(", "),i,this.makeCode(") "+(this.negated?"< 0":">= 0"))),ut(n)===ut(i)?t:(t=n.concat(this.makeCode(", "),t),e.level<re?t:this.wrapInParentheses(t))}},{key:"toString",value:function(e){return a(l(t.prototype),"toString",this).call(this,e,this.constructor.name+(this.negated?"!":""))}}]),t}(m);return e.prototype.children=["object","array"],e.prototype.invert=fe,e}.call(this),t.Try=function(){var e=function(e){"use strict";function t(e,i,n,s){var a;return f(this,t),(a=r(this,l(t).call(this))).attempt=e,a.catch=i,a.ensure=n,a.finallyTag=s,a}return c(t,e),g(t,[{key:"jumps",value:function(e){var t;return this.attempt.jumps(e)||(null==(t=this.catch)?void 0:t.jumps(e))}},{key:"makeReturn",value:function(e,t){var i,n;return t?(null!=(i=this.attempt)&&i.makeReturn(e,t),void(null!=(n=this.catch)&&n.makeReturn(e,t))):(this.attempt&&(this.attempt=this.attempt.makeReturn(e)),this.catch&&(this.catch=this.catch.makeReturn(e)),this)}},{key:"compileNode",value:function(e){var t,i,n,s,a;return s=e.indent,e.indent+=Ue,a=this.attempt.compileToFragments(e,ce),t=this.catch?this.catch.compileToFragments(At(e,{indent:s}),ce):this.ensure||this.catch?[]:(n=e.scope.freeVariable("error",{reserve:!1}),[this.makeCode(" catch (".concat(n,") {}"))]),i=this.ensure?[].concat(this.makeCode(" finally {\n"),this.ensure.compileToFragments(e,ce),this.makeCode("\n".concat(this.tab,"}"))):[],[].concat(this.makeCode("".concat(this.tab,"try {\n")),a,this.makeCode("\n".concat(this.tab,"}")),t,i)}},{key:"astType",value:function(){return"TryStatement"}},{key:"astProperties",value:function(e){var t,i;return{block:this.attempt.ast(e,ce),handler:null==(t=null==(i=this.catch)?void 0:i.ast(e))?null:t,finalizer:null==this.ensure?null:Object.assign(this.ensure.ast(e,ce),Ct(xt(this.finallyTag.locationData),this.ensure.astLocationData()))}}}]),t}(m);return e.prototype.children=["attempt","catch","ensure"],e.prototype.isStatement=Ze,e}.call(this),t.Catch=function(){var e=function(e){"use strict";function t(e,i){var n,s,a;return f(this,t),(n=r(this,l(t).call(this))).recovery=e,n.errorVariable=i,null!=(a=n.errorVariable)&&"function"==typeof(s=a.unwrap()).propagateLhs&&s.propagateLhs(!0),n}return c(t,e),g(t,[{key:"jumps",value:function(e){return this.recovery.jumps(e)}},{key:"makeReturn",value:function(e,t){var i;if(i=this.recovery.makeReturn(e,t),!t)return this.recovery=i,this}},{key:"compileNode",value:function(e){var t,i;return e.indent+=Ue,t=e.scope.freeVariable("error",{reserve:!1}),i=new B(t),this.checkUnassignable(),this.errorVariable&&this.recovery.unshift(new h(this.errorVariable,i)),[].concat(this.makeCode(" catch ("),i.compileToFragments(e),this.makeCode(") {\n"),this.recovery.compileToFragments(e,ce),this.makeCode("\n".concat(this.tab,"}")))}},{key:"checkUnassignable",value:function(){var e;if(this.errorVariable&&(e=kt(this.errorVariable.unwrapAll().value)))return this.errorVariable.error(e)}},{key:"astNode",value:function(e){var i;return this.checkUnassignable(),null!=(i=this.errorVariable)&&i.eachName((function(t){var i;return i=e.scope.find(t.value),t.isDeclaration=!i})),a(l(t.prototype),"astNode",this).call(this,e)}},{key:"astType",value:function(){return"CatchClause"}},{key:"astProperties",value:function(e){var t,i;return{param:null==(t=null==(i=this.errorVariable)?void 0:i.ast(e))?null:t,body:this.recovery.ast(e,ce)}}}]),t}(m);return e.prototype.children=["recovery","errorVariable"],e.prototype.isStatement=Ze,e}.call(this),t.Throw=Ge=function(){var e=function(e){"use strict";function t(e){var i;return f(this,t),(i=r(this,l(t).call(this))).expression=e,i}return c(t,e),g(t,[{key:"compileNode",value:function(e){var t;return t=this.expression.compileToFragments(e,re),Mt(t,this.makeCode("throw ")),t.unshift(this.makeCode(this.tab)),t.push(this.makeCode(";")),t}},{key:"astType",value:function(){return"ThrowStatement"}},{key:"astProperties",value:function(e){return{argument:this.expression.ast(e,re)}}}]),t}(m);return e.prototype.children=["expression"],e.prototype.isStatement=Ze,e.prototype.jumps=ve,e.prototype.makeReturn=We,e}.call(this),t.Existence=D=function(){var e=function(e){"use strict";function t(e){var i,n,s=!!(1<arguments.length&&void 0!==arguments[1])&&arguments[1];return f(this,t),(i=r(this,l(t).call(this))).expression=e,i.comparisonTarget=s?"undefined":"null",n=[],i.expression.traverseChildren(!0,(function(e){var t,i,s,a;if(e.comments){for(i=0,s=(a=e.comments).length;i<s;i++)t=a[i],0>$t.call(n,t)&&n.push(t);return delete e.comments}})),nt(n,o(i)),St(i.expression,o(i)),i}return c(t,e),g(t,[{key:"compileNode",value:function(e){var t,i,n;if(this.expression.front=this.front,n=this.expression.compile(e,oe),this.expression.unwrap()instanceof B&&!e.scope.check(n)){var s=d(this.negated?["===","||"]:["!==","&&"],2);t=s[0],i=s[1],n="typeof ".concat(n," ").concat(t,' "undefined"')+("undefined"===this.comparisonTarget?"":" ".concat(i," ").concat(n," ").concat(t," ").concat(this.comparisonTarget))}else t="null"===this.comparisonTarget?this.negated?"==":"!=":this.negated?"===":"!==",n="".concat(n," ").concat(t," ").concat(this.comparisonTarget);return[this.makeCode(e.level<=ae?n:"(".concat(n,")"))]}},{key:"astType",value:function(){return"UnaryExpression"}},{key:"astProperties",value:function(e){return{argument:this.expression.ast(e),operator:"?",prefix:!1}}}]),t}(m);return e.prototype.children=["expression"],e.prototype.invert=fe,e}.call(this),t.Parens=Ee=function(){var e=function(e){"use strict";function t(e){var i;return f(this,t),(i=r(this,l(t).call(this))).body=e,i}return c(t,e),g(t,[{key:"unwrap",value:function(){return this.body}},{key:"shouldCache",value:function(){return this.body.shouldCache()}},{key:"compileNode",value:function(e){var t,i,n,s,a;return a=null==(s=(i=this.body.unwrap()).comments)?void 0:s.some((function(e){return e.here&&!e.unshift&&!e.newLine})),i instanceof Ke&&i.isAtomic()&&!this.jsxAttribute&&!a?(i.front=this.front,i.compileToFragments(e)):(n=i.compileToFragments(e,le),t=e.level<oe&&!a&&(i instanceof ke&&!i.isInOperator()||i.unwrap()instanceof w||i instanceof P&&i.returns)&&(e.level<ae||3>=n.length),this.jsxAttribute?this.wrapInBraces(n):t?n:this.wrapInParentheses(n))}},{key:"astNode",value:function(e){return this.body.unwrap().ast(e,le)}}]),t}(m);return e.prototype.children=["body"],e}.call(this),t.StringWithInterpolations=Ve=function(){var e=function(e){"use strict";function t(e){var i,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},s=n.quote,a=n.startQuote;return f(this,t),(i=r(this,l(t).call(this))).body=e,i.quote=s,i.startQuote=a,i}return c(t,e),g(t,[{key:"unwrap",value:function(){return this}},{key:"shouldCache",value:function(){return this.body.shouldCache()}},{key:"extractElements",value:function(e){var t,i,n,s=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},a=s.includeInterpolationWrappers,r=s.isJsx;return i=this.body.unwrap(),t=[],n=[],i.traverseChildren(!1,(function(i){var s,o,l,c,h,u,d,p,m,f,v,g;if(i instanceof Fe)return i.comments&&((g=n).push.apply(g,y(i.comments)),delete i.comments),t.push(i),!0;if(i instanceof z){if(0!==n.length){for(c=0,u=n.length;c<u;c++)(s=n[c]).unshift=!0,s.newLine=!0;nt(n,i)}if(!((v=null==(p=i.expression)?void 0:p.unwrapAll())instanceof Te&&v.generated)||r&&e.compiling){if(i.expression||a){var b;i.comments&&(b=null==(m=i.expression)?void 0:null==m.comments?m.comments=[]:m.comments).push.apply(b,y(i.comments)),t.push(a?i:i.expression)}}else if(e.compiling){var w;(o=new Fe("").withLocationDataFrom(i)).comments=v.comments,i.comments&&(w=null==o.comments?o.comments=[]:o.comments).push.apply(w,y(i.comments)),t.push(new Ke(o))}else(l=(new z).withLocationDataFrom(i)).comments=i.comments,t.push(l);return!1}if(i.comments){if(0===t.length||t[t.length-1]instanceof Fe){var k;(k=n).push.apply(k,y(i.comments))}else{for(h=0,d=(f=i.comments).length;h<d;h++)(s=f[h]).unshift=!1,s.newLine=!0;nt(i.comments,t[t.length-1])}delete i.comments}return!0})),t}},{key:"compileNode",value:function(e){var i,n,s,a,r,o,l,c,h;if(null==this.comments&&(this.comments=null==(l=this.startQuote)?void 0:l.comments),this.jsxAttribute)return(h=new Ee(new t(this.body))).jsxAttribute=!0,h.compileNode(e);for(s=this.extractElements(e,{isJsx:this.jsx}),a=[],this.jsx||a.push(this.makeCode("`")),r=0,o=s.length;r<o;r++)if((n=s[r])instanceof Fe)c=this.jsx?n.unquotedValueForJSX:n.unquotedValueForTemplateLiteral,a.push(this.makeCode(c));else{var u;this.jsx||a.push(this.makeCode("$")),i=n.compileToFragments(e,le),(!this.isNestedTag(n)||i.some((function(e){var t;return null==(t=e.comments)?void 0:t.some((function(e){return!1===e.here}))})))&&((i=this.wrapInBraces(i))[0].isStringWithInterpolations=!0,i[i.length-1].isStringWithInterpolations=!0),(u=a).push.apply(u,y(i))}return this.jsx||a.push(this.makeCode("`")),a}},{key:"isNestedTag",value:function(e){var t;return t="function"==typeof e.unwrapAll?e.unwrapAll():void 0,this.jsx&&t instanceof J}},{key:"astType",value:function(){return"TemplateLiteral"}},{key:"astProperties",value:function(e){var t,i,n,s,a,r,o,l,c,h,u;for(i=this.extractElements(e,{includeInterpolationWrappers:!0}),l=d(Ht.call(i,-1),1)[0],u=[],a=[],r=o=0,c=i.length;o<c;r=++o)(t=i[r])instanceof Fe?u.push(new ze(t.originalValue,{tail:t===l}).withLocationDataFrom(t).ast(e)):(h=null==(s=t.expression)?((n=new S).locationData=rt({interpolationNode:t,openingBrace:"#{",closingBrace:"}"}),n):s.unwrapAll(),a.push(it(h,e)));return{expressions:a,quasis:u,quote:this.quote}}}],[{key:"fromStringLiteral",value:function(e){var i,n;return i=e.withoutQuotesInLocationData(),n=new Ke(i).withLocationDataFrom(i),new t(v.wrap([n]),{quote:e.quote}).withLocationDataFrom(e)}}]),t}(m);return e.prototype.children=["body"],e}.call(this),t.TemplateElement=ze=function(e){"use strict";function t(e){var i,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},s=n.tail;return f(this,t),(i=r(this,l(t).call(this))).value=e,i.tail=s,i}return c(t,e),g(t,[{key:"astProperties",value:function(){return{value:{raw:this.value},tail:!!this.tail}}}]),t}(m),t.Interpolation=z=function(){var e=function(e){"use strict";function t(e){var i;return f(this,t),(i=r(this,l(t).call(this))).expression=e,i}return c(t,e),t}(m);return e.prototype.children=["expression"],e}.call(this),t.EmptyInterpolation=S=function(e){"use strict";function t(){return f(this,t),r(this,l(t).call(this))}return c(t,e),t}(m),t.For=P=function(){var e=function(e){"use strict";function t(e,i){var n;return f(this,t),(n=r(this,l(t).call(this))).addBody(e),n.addSource(i),n}return c(t,e),g(t,[{key:"isAwait",value:function(){var e;return null!=(e=this.await)&&e}},{key:"addBody",value:function(e){var t,i;return this.body=v.wrap([e]),(i=this.body.expressions).length&&null==(t=this.body).locationData&&(t.locationData=Lt(i[0].locationData,i[i.length-1].locationData)),this}},{key:"addSource",value:function(e){var t,i,n,s,a,r,o,l,c,h,u,d,p=this,m=e.source;for(this.source=void 0!==m&&m,a=0,o=(i=["name","index","guard","step","own","ownTag","await","awaitTag","object","from"]).length;a<o;a++)this[t=i[a]]=null==(c=e[t])?this[t]:c;if(!this.source)return this;if(this.from&&this.index&&this.index.error("cannot use index with for-from"),this.own&&!this.object&&this.ownTag.error("cannot use own with for-".concat(this.from?"from":"in")),this.object){var f=[this.index,this.name];this.name=f[0],this.index=f[1]}for(((null==(h=this.index)?void 0:"function"==typeof h.isArray?h.isArray():void 0)||(null==(u=this.index)?void 0:"function"==typeof u.isObject?u.isObject():void 0))&&this.index.error("index cannot be a pattern matching expression"),this.await&&!this.from&&this.awaitTag.error("await must be used with for-from"),this.range=this.source instanceof Ke&&this.source.base instanceof Ae&&!this.source.properties.length&&!this.from,this.pattern=this.name instanceof Ke,this.pattern&&"function"==typeof(s=this.name.unwrap()).propagateLhs&&s.propagateLhs(!0),this.range&&this.index&&this.index.error("indexes do not apply to range loops"),this.range&&this.pattern&&this.name.error("cannot pattern match over range loops"),this.returns=!1,r=0,l=(d=["source","guard","step","name","index"]).length;r<l;r++)this[n=d[r]]&&(this[n].traverseChildren(!0,(function(e){var t,i,s,a;if(e.comments){for(i=0,s=(a=e.comments).length;i<s;i++)(t=a[i]).newLine=t.unshift=!0;return St(e,p[n])}})),St(this[n],this));return this}},{key:"compileNode",value:function(e){var t,i,n,s,a,r,o,l,c,u,p,m,f,g,b,y,w,k,x,E,T,N,A,C,L,S,I,D,j,O,R,_,P,M,F;if(L=(t=v.wrap([this.body])).expressions,(null==(E=d(Ht.call(L,-1),1)[0])?void 0:E.jumps())instanceof Le&&(this.returns=!1),O=this.range?this.source.base:this.source,j=e.scope,this.pattern||(N=this.name&&this.name.compile(e,re)),y=this.index&&this.index.compile(e,re),N&&!this.pattern&&j.find(N),y&&!(this.index instanceof Ke)&&j.find(y),this.returns&&(D=j.freeVariable("results")),this.from?this.pattern&&(w=j.freeVariable("x",{single:!0})):w=this.object&&y||j.freeVariable("i",{single:!0}),x=(k=(this.range||this.from)&&N||y||w)===w?"":"".concat(k," = "),this.step&&!this.range){var V=d(this.cacheToCodeFragments(this.step.cache(e,re,Ot)),2);R=V[0],P=V[1],this.step.isNumber()&&(_=Dt(P))}return this.pattern&&(N=w),F="",f="",o="",g=this.tab+Ue,this.range?p=O.compileToFragments(At(e,{index:w,name:N,step:this.step,shouldCache:Ot})):(M=this.source.compile(e,re),(N||this.own)&&!(this.source.unwrap()instanceof B)&&(o+="".concat(this.tab).concat(C=j.freeVariable("ref")," = ").concat(M,";\n"),M=C),N&&!this.pattern&&!this.from&&(A="".concat(N," = ").concat(M,"[").concat(k,"]")),!this.object&&!this.from&&(R!==P&&(o+="".concat(this.tab).concat(R,";\n")),l=0>_,!(this.step&&null!=_&&l)&&(T=j.freeVariable("len")),a="".concat(x).concat(w," = 0, ").concat(T," = ").concat(M,".length"),r="".concat(x).concat(w," = ").concat(M,".length - 1"),n="".concat(w," < ").concat(T),s="".concat(w," >= 0"),this.step?(null==_?(n="".concat(P," > 0 ? ").concat(n," : ").concat(s),a="(".concat(P," > 0 ? (").concat(a,") : ").concat(r,")")):l&&(n=s,a=r),b="".concat(w," += ").concat(P)):b="".concat(k===w?"".concat(w,"++"):"++".concat(w)),p=[this.makeCode("".concat(a,"; ").concat(n,"; ").concat(x).concat(b))])),this.returns&&(S="".concat(this.tab).concat(D," = [];\n"),I="\n".concat(this.tab,"return ").concat(D,";"),t.makeReturn(D)),this.guard&&(1<t.expressions.length?t.expressions.unshift(new H(new Ee(this.guard).invert(),new Me("continue"))):this.guard&&(t=v.wrap([new H(this.guard,t)]))),this.pattern&&t.expressions.unshift(new h(this.name,this.from?new B(k):new ue("".concat(M,"[").concat(k,"]")))),A&&(F="\n".concat(g).concat(A,";")),this.object?(p=[this.makeCode("".concat(k," in ").concat(M))],this.own&&(f="\n".concat(g,"if (!").concat(Ft("hasProp",e),".call(").concat(M,", ").concat(k,")) continue;"))):this.from&&(p=this.await?(p=new ke("await",new Ee(new ue("".concat(k," of ").concat(M))))).compileToFragments(e,ce):[this.makeCode("".concat(k," of ").concat(M))]),(i=t.compileToFragments(At(e,{indent:g}),ce))&&0<i.length&&(i=[].concat(this.makeCode("\n"),i,this.makeCode("\n"))),m=[this.makeCode(o)],S&&m.push(this.makeCode(S)),u=this.await?"for ":"for (",c=this.await?"":")",m=m.concat(this.makeCode(this.tab),this.makeCode(u),p,this.makeCode("".concat(c," {").concat(f).concat(F)),i,this.makeCode(this.tab),this.makeCode("}")),I&&m.push(this.makeCode(I)),m}},{key:"astNode",value:function(e){var i,n,s;return i=function(t){var i;return i=e.scope.find(t.value),t.isDeclaration=!i},null!=(n=this.name)&&n.eachName(i,{checkAssignability:!1}),null!=(s=this.index)&&s.eachName(i,{checkAssignability:!1}),a(l(t.prototype),"astNode",this).call(this,e)}},{key:"astType",value:function(){return"For"}},{key:"astProperties",value:function(e){var t,i,n,s,a,r,o,l,c;return{source:null==(t=this.source)?void 0:t.ast(e),body:this.body.ast(e,ce),guard:null==(i=null==(n=this.guard)?void 0:n.ast(e))?null:i,name:null==(s=null==(a=this.name)?void 0:a.ast(e))?null:s,index:null==(r=null==(o=this.index)?void 0:o.ast(e))?null:r,step:null==(l=null==(c=this.step)?void 0:c.ast(e))?null:l,postfix:!!this.postfix,own:!!this.own,await:!!this.await,style:function(){switch(!1){case!this.from:return"from";case!this.object:return"of";case!this.name:return"in";default:return"range"}}.call(this)}}}]),t}(Qe);return e.prototype.children=["body","source","guard","step"],e}.call(this),t.Switch=function(){var e=function(e){"use strict";function t(e,i,n){var s;return f(this,t),(s=r(this,l(t).call(this))).subject=e,s.cases=i,s.otherwise=n,s}return c(t,e),g(t,[{key:"jumps",value:function(){var e,t,i,n,s,a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{block:!0};for(e=0,i=(n=this.cases).length;e<i;e++)if(t=n[e].block.jumps(a))return t;return null==(s=this.otherwise)?void 0:s.jumps(a)}},{key:"makeReturn",value:function(e,t){var i,n,s,a;for(i=0,n=(s=this.cases).length;i<n;i++)s[i].block.makeReturn(e,t);return e&&(this.otherwise||(this.otherwise=new v([new ue("void 0")]))),null!=(a=this.otherwise)&&a.makeReturn(e,t),this}},{key:"compileNode",value:function(e){var t,i,n,s,a,r,o,l,c,h,u,d,p,m,f,v;for(l=e.indent+Ue,c=e.indent=l+Ue,r=[].concat(this.makeCode(this.tab+"switch ("),this.subject?this.subject.compileToFragments(e,le):this.makeCode("false"),this.makeCode(") {\n")),o=h=0,d=(m=this.cases).length;h<d;o=++h){var g=m[o];for(s=g.conditions,t=g.block,u=0,p=(f=ht([s])).length;u<p;u++)n=f[u],this.subject||(n=n.invert()),r=r.concat(this.makeCode(l+"case "),n.compileToFragments(e,le),this.makeCode(":\n"));if(0<(i=t.compileToFragments(e,ce)).length&&(r=r.concat(i,this.makeCode("\n"))),o===this.cases.length-1&&!this.otherwise)break;!((a=this.lastNode(t.expressions))instanceof Le||a instanceof Ge||a instanceof ue&&a.jumps()&&"debugger"!==a.value)&&r.push(n.makeCode(c+"break;\n"))}return this.otherwise&&this.otherwise.expressions.length&&(v=r).push.apply(v,[this.makeCode(l+"default:\n")].concat(y(this.otherwise.compileToFragments(e,ce)),[this.makeCode("\n")])),r.push(this.makeCode(this.tab+"}")),r}},{key:"astType",value:function(){return"SwitchStatement"}},{key:"casesAst",value:function(e){var t,i,n,s,a,r,o,l,c,h,u,d,p,m,f,v,g,b,y;for(n=[],t=a=0,h=(p=this.cases).length;a<h;t=++a){var w=o=p[t];for(y=w.conditions,s=w.block,c=(y=ht([y])).length-1,b=r=0,u=y.length;r<u;b=++r)g=b===c?s:null,i=(v=y[b]).locationData,(null==g?void 0:g.expressions.length)&&(i=Lt(i,g.expressions[g.expressions.length-1].locationData)),0===b&&(i=Lt(i,o.locationData,{justLeading:!0})),b===c&&(i=Lt(i,o.locationData,{justEnding:!0})),n.push(new He(v,g,{trailing:b===c}).withLocationDataFrom({locationData:i}))}for((null==(m=this.otherwise)?void 0:m.expressions.length)&&n.push(new He(null,this.otherwise).withLocationDataFrom(this.otherwise)),f=[],l=0,d=n.length;l<d;l++)o=n[l],f.push(o.ast(e));return f}},{key:"astProperties",value:function(e){var t,i;return{discriminant:null==(t=null==(i=this.subject)?void 0:i.ast(e,le))?null:t,cases:this.casesAst(e)}}}]),t}(m);return e.prototype.children=["subject","cases","otherwise"],e.prototype.isStatement=Ze,e}.call(this),He=function(){var e=function(e){"use strict";function t(e,i){var n,s=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},a=s.trailing;return f(this,t),(n=r(this,l(t).call(this))).test=e,n.block=i,n.trailing=a,n}return c(t,e),g(t,[{key:"astProperties",value:function(e){var t,i,n,s;return{test:null==(t=null==(i=this.test)?void 0:i.ast(e,le))?null:t,consequent:null==(n=null==(s=this.block)?void 0:s.ast(e,ce).body)?[]:n,trailing:!!this.trailing}}}]),t}(m);return e.prototype.children=["test","block"],e}.call(this),t.SwitchWhen=function(){var e=function(e){"use strict";function t(e,i){var n;return f(this,t),(n=r(this,l(t).call(this))).conditions=e,n.block=i,n}return c(t,e),t}(m);return e.prototype.children=["conditions","block"],e}.call(this),t.If=H=function(){var e=function(e){"use strict";function t(e,i){var n,s=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};return f(this,t),(n=r(this,l(t).call(this))).condition=e,n.body=i,n.elseBody=null,n.isChain=!1,n.soak=s.soak,n.postfix=s.postfix,n.type=s.type,n.condition.comments&&St(n.condition,o(n)),n}return c(t,e),g(t,[{key:"bodyNode",value:function(){var e;return null==(e=this.body)?void 0:e.unwrap()}},{key:"elseBodyNode",value:function(){var e;return null==(e=this.elseBody)?void 0:e.unwrap()}},{key:"addElse",value:function(e){return this.isChain?(this.elseBodyNode().addElse(e),this.locationData=Lt(this.locationData,this.elseBodyNode().locationData)):(this.isChain=e instanceof t,this.elseBody=this.ensureBlock(e),this.elseBody.updateLocationDataIfMissing(e.locationData),null!=this.locationData&&null!=this.elseBody.locationData&&(this.locationData=Lt(this.locationData,this.elseBody.locationData))),this}},{key:"isStatement",value:function(e){var t;return(null==e?void 0:e.level)===ce||this.bodyNode().isStatement(e)||(null==(t=this.elseBodyNode())?void 0:t.isStatement(e))}},{key:"jumps",value:function(e){var t;return this.body.jumps(e)||(null==(t=this.elseBody)?void 0:t.jumps(e))}},{key:"compileNode",value:function(e){return this.isStatement(e)?this.compileStatement(e):this.compileExpression(e)}},{key:"makeReturn",value:function(e,t){var i,n;return t?(null!=(i=this.body)&&i.makeReturn(e,t),void(null!=(n=this.elseBody)&&n.makeReturn(e,t))):(e&&(this.elseBody||(this.elseBody=new v([new ue("void 0")]))),this.body&&(this.body=new v([this.body.makeReturn(e)])),this.elseBody&&(this.elseBody=new v([this.elseBody.makeReturn(e)])),this)}},{key:"ensureBlock",value:function(e){return e instanceof v?e:new v([e])}},{key:"compileStatement",value:function(e){var i,n,s,a,r,o;return s=at(e,"chainChild"),at(e,"isExistentialEquals")?new t(this.processedCondition().invert(),this.elseBodyNode(),{type:"if"}).compileToFragments(e):(o=e.indent+Ue,a=this.processedCondition().compileToFragments(e,le),n=this.ensureBlock(this.body).compileToFragments(At(e,{indent:o})),r=[].concat(this.makeCode("if ("),a,this.makeCode(") {\n"),n,this.makeCode("\n".concat(this.tab,"}"))),s||r.unshift(this.makeCode(this.tab)),this.elseBody?(i=r.concat(this.makeCode(" else ")),this.isChain?(e.chainChild=!0,i=i.concat(this.elseBody.unwrap().compileToFragments(e,ce))):i=i.concat(this.makeCode("{\n"),this.elseBody.compileToFragments(At(e,{indent:o}),ce),this.makeCode("\n".concat(this.tab,"}"))),i):r)}},{key:"compileExpression",value:function(e){var t,i,n,s;return n=this.processedCondition().compileToFragments(e,ae),i=this.bodyNode().compileToFragments(e,re),t=this.elseBodyNode()?this.elseBodyNode().compileToFragments(e,re):[this.makeCode("void 0")],s=n.concat(this.makeCode(" ? "),i,this.makeCode(" : "),t),e.level>=ae?this.wrapInParentheses(s):s}},{key:"unfoldSoak",value:function(){return this.soak&&this}},{key:"processedCondition",value:function(){return null==this.processedConditionCache?this.processedConditionCache="unless"===this.type?this.condition.invert():this.condition:this.processedConditionCache}},{key:"isStatementAst",value:function(e){return e.level===ce}},{key:"astType",value:function(e){return this.isStatementAst(e)?"IfStatement":"ConditionalExpression"}},{key:"astProperties",value:function(e){var t,i,n,s,a;return t=this.isStatementAst(e),{test:this.condition.ast(e,t?le:ae),consequent:t?this.body.ast(e,ce):this.bodyNode().ast(e,ce),alternate:this.isChain?this.elseBody.unwrap().ast(e,t?ce:ae):t||1!==(null==(i=this.elseBody)||null==(n=i.expressions)?void 0:n.length)?null==(s=null==(a=this.elseBody)?void 0:a.ast(e,ce))?null:s:this.elseBody.expressions[0].ast(e,ce),postfix:!!this.postfix,inverted:"unless"===this.type}}}]),t}(m);return e.prototype.children=["condition","body","elseBody"],e}.call(this),t.Sequence=Re=function(){var e=function(e){"use strict";function t(e){var i;return f(this,t),(i=r(this,l(t).call(this))).expressions=e,i}return c(t,e),g(t,[{key:"astNode",value:function(e){return 1===this.expressions.length?this.expressions[0].ast(e):a(l(t.prototype),"astNode",this).call(this,e)}},{key:"astType",value:function(){return"SequenceExpression"}},{key:"astProperties",value:function(e){var t;return{expressions:function(){var i,n,s,a;for(a=[],i=0,n=(s=this.expressions).length;i<n;i++)t=s[i],a.push(t.ast(e));return a}.call(this)}}}]),t}(m);return e.prototype.children=["expressions"],e}.call(this),Je={modulo:function(){return"function(a, b) { return (+a % (b = +b) + b) % b; }"},boundMethodCheck:function(){return"function(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new Error('Bound instance method accessed before binding'); } }"},hasProp:function(){return"{}.hasOwnProperty"},indexOf:function(){return"[].indexOf"},slice:function(){return"[].slice"},splice:function(){return"[].splice"}},ce=1,le=2,re=3,ae=4,oe=5,se=6,Ue="  ",Ie=/^[+-]?\d+$/,De=/\s*\n\s*/g,ne=/^[^\n\S]*\n/,qe=/\n[^\n\S]*$/,je=/((?:\\\\)+)|\\[^\S\n]*\n\s*/g,F=/((?:\\\\)+)|\\(\s)|\s+(?:#.*)?/g,Ft=function(e,t){var i,n;return e in(n=t.scope.root).utilities?n.utilities[e]:(i=n.freeVariable(e),n.assign(i,Je[e](t)),n.utilities[e]=i)},It=function(e,t){var i,n=!(2<arguments.length&&void 0!==arguments[2])||arguments[2];return i="\n"===e[e.length-1],e=(e=(n?t:"")+e.replace(/\n/g,"$&".concat(t))).replace(/\s+$/,""),i&&(e+="\n"),e},mt=function(e,t){var i,n,s,a;for(n=s=0,a=e.length;s<a;n=++s){if(!(i=e[n]).isHereComment){e.splice(n,0,t.makeCode("".concat(t.tab)));break}i.code=It(i.code,t.tab)}return e},pt=function(e){var t,i,n;if(!e.comments)return!1;for(t=0,i=(n=e.comments).length;t<i;t++)if(!1===n[t].here)return!0;return!1},St=function(e,t){if(null!=e&&e.comments)return nt(e.comments,t),delete e.comments},Mt=function(e,t){var i,n,s,a;for(n=!1,i=s=0,a=e.length;s<a;i=++s)if(!e[i].isComment){e.splice(i,0,t),n=!0;break}return n||e.push(t),e},vt=function(e){return e instanceof B&&"arguments"===e.value},gt=function(e){return e instanceof Xe||e instanceof T&&e.bound},Ot=function(e){return e.shouldCache()||("function"==typeof e.isAssignable?e.isAssignable():void 0)},Pt=function(e,t,i){var n;if(n=t[i].unfoldSoak(e))return t[i]=n.body,n.body=new Ke(t),n},Nt=function(e){var t,i,n,s=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},a=s.delimiter,r=s.escapeNewlines,o=s.double,l=s.includeDelimiters,c=s.escapeDelimiter,h=void 0===c||c,u=s.convertTrailingNullEscapes;return""===e&&"/"===a&&(e="(?:)"),t="`"===a,n=RegExp("(\\\\\\\\)|(\\\\0(?=\\d))".concat(u?/|(\\0)$/.source:"").concat(h?RegExp("|\\\\?(".concat(a,")")).source:"").concat(t?/|\\?(\$\{)/.source:"","|\\\\?(?:").concat(r?"(\n)|":"","(\\r)|(\\u2028)|(\\u2029))|(\\\\.)"),"g"),e=e.replace(n,(function(e,i,n){for(var s,a,l,c,d,p,m,f,v=arguments.length,g=Array(3<v?v-3:0),b=3;b<v;b++)g[b-3]=arguments[b];switch(f=u?g.shift():void 0,a=h?g.shift():void 0,m=t?g.shift():void 0,l=r?g.shift():void 0,s=g[0],c=g[1],p=g[2],d=g[3],!1){case!i:return o?i+i:i;case!n:case!f:return"\\x00";case!a:return"\\".concat(a);case!m:return"\\${";case!l:return"\\n";case!s:return"\\r";case!c:return"\\u2028";case!p:return"\\u2029";case!d:return o?"\\".concat(d):d}})),"".concat(i=void 0===l||l?a:"").concat(e).concat(i)},Rt=function(e){var t,i,n,s,a,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},o=r.notFinalExpression;for(i=0,n=e.length-1,s=[];i<=n&&(i!==n||!o);)if((a=null==(t=e[i])?void 0:"function"==typeof t.unwrap?t.unwrap():void 0)instanceof Te&&a.generated)i++;else{if(!(t instanceof Ke&&t.isString())||t.unwrap().shouldGenerateTemplateLiteral())break;e[i]=new C(t).withLocationDataFrom(t),s.push(i++)}return s},it=function(e,t){var i;return(i=e.unwrap())instanceof v&&1<i.expressions.length?(i.makeReturn(null,!0),i.ast(t,ce)):e.ast(t,le)},Et=function(e,t){return e<t?e:t},dt=function(e,t){return e>t?e:t},ft=function(e,t){return!!(e.line>t.line)||e.line===t.line&&e.column>t.column},yt=function(e,t){return!!(e.first_line>t.first_line)||e.first_line===t.first_line&&e.first_column>t.first_column},bt=function(e,t){return!!(e.last_line>t.last_line)||e.last_line===t.last_line&&e.last_column>t.last_column},t.mergeLocationData=Lt=function(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},n=i.justLeading,s=i.justEnding;return Object.assign(s?{first_line:e.first_line,first_column:e.first_column}:yt(e,t)?{first_line:t.first_line,first_column:t.first_column}:{first_line:e.first_line,first_column:e.first_column},n||bt(e,t)?{last_line:e.last_line,last_column:e.last_column,last_line_exclusive:e.last_line_exclusive,last_column_exclusive:e.last_column_exclusive}:{last_line:t.last_line,last_column:t.last_column,last_line_exclusive:t.last_line_exclusive,last_column_exclusive:t.last_column_exclusive},{range:[s?e.range[0]:Et(e.range[0],t.range[0]),n?e.range[1]:dt(e.range[1],t.range[1])]})},t.mergeAstLocationData=Ct=function(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},n=i.justLeading,s=i.justEnding;return{loc:{start:s?e.loc.start:ft(e.loc.start,t.loc.start)?t.loc.start:e.loc.start,end:n||ft(e.loc.end,t.loc.end)?e.loc.end:t.loc.end},range:[s?e.range[0]:Et(e.range[0],t.range[0]),n?e.range[1]:dt(e.range[1],t.range[1])],start:s?e.start:Et(e.start,t.start),end:n?e.end:dt(e.end,t.end)}},t.jisonLocationDataToAstLocationData=xt=function(e){var t=e.first_line,i=e.first_column,n=e.last_line_exclusive,s=e.last_column_exclusive,a=e.range;return{loc:{start:{line:t+1,column:i},end:{line:n+1,column:s}},range:[a[0],a[1]],start:a[0],end:a[1]}},Vt=function(e){var t=d(e.range,2)[1],i=e.last_line_exclusive,n=e.last_column_exclusive;return{first_line:i,first_column:n,last_line:i,last_column:n,last_line_exclusive:i,last_column_exclusive:n,range:[t,t]}},lt=function(e){return function(t){var i=d(t.range,1)[0],n=t.first_line,s=t.first_column;return{first_line:n,first_column:s,last_line:n,last_column:s+e-1,last_line_exclusive:n,last_column_exclusive:s+e,range:[i,i+e]}}},ct=function(e){return function(t){var i=d(t.range,2)[1],n=t.last_line,s=t.last_column,a=t.last_line_exclusive,r=t.last_column_exclusive;return{first_line:n,first_column:s-(e-1),last_line:n,last_column:s,last_line_exclusive:a,last_column_exclusive:r,range:[i-e,i]}}},rt=function(e){var t=e.interpolationNode,i=e.openingBrace,n=e.closingBrace;return{first_line:t.locationData.first_line,first_column:t.locationData.first_column+i.length,last_line:t.locationData.last_line,last_column:t.locationData.last_column-n.length,last_line_exclusive:t.locationData.last_line,last_column_exclusive:t.locationData.last_column,range:[t.locationData.range[0]+i.length,t.locationData.range[1]-n.length]}}}.call(this),{exports:t}.exports}(),s["./sourcemap"]=function(){var t={exports:{}};return function(){var i,n;i=function(){"use strict";function e(t){f(this,e),this.line=t,this.columns=[]}return g(e,[{key:"add",value:function(e,t){var i=d(t,2),n=i[0],s=i[1],a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};return this.columns[e]&&a.noReplace?void 0:this.columns[e]={line:this.line,column:e,sourceLine:n,sourceColumn:s}}},{key:"sourceLocation",value:function(e){for(var t;!((t=this.columns[e])||0>=e);)e--;return t&&[t.sourceLine,t.sourceColumn]}}]),e}(),n=function(){var t,n,s,a,r=function(){"use strict";function r(){f(this,r),this.lines=[]}return g(r,[{key:"add",value:function(e,t){var n,s,a,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},o=d(t,2);return a=o[0],s=o[1],((n=this.lines)[a]||(n[a]=new i(a))).add(s,e,r)}},{key:"sourceLocation",value:function(e){for(var t,i=d(e,2),n=i[0],s=i[1];!((t=this.lines[n])||0>=n);)n--;return t&&t.sourceLocation(s)}},{key:"generate",value:function(){var e,t,i,n,s,a,r,o,l,c,h,u,d,p,m,f,v,g=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;for(v=0,n=0,a=0,s=0,u=!1,e="",c=t=0,r=(d=this.lines).length;t<r;c=++t)if(l=d[c])for(i=0,o=(p=l.columns).length;i<o;i++)if(h=p[i]){for(;v<h.line;)n=0,u=!1,e+=";",v++;u&&(e+=",",u=!1),e+=this.encodeVlq(h.column-n),n=h.column,e+=this.encodeVlq(0),e+=this.encodeVlq(h.sourceLine-a),a=h.sourceLine,e+=this.encodeVlq(h.sourceColumn-s),s=h.sourceColumn,u=!0}return m=g.sourceFiles?g.sourceFiles:g.filename?[g.filename]:["<anonymous>"],f={version:3,file:g.generatedFile||"",sourceRoot:g.sourceRoot||"",sources:m,names:[],mappings:e},(g.sourceMap||g.inlineMap)&&(f.sourcesContent=[b]),f}},{key:"encodeVlq",value:function(t){var i,r,o,l;for(i="",o=0>t?1:0,l=(e(t)<<1)+o;l||!i;)r=l&a,(l>>=s)&&(r|=n),i+=this.encodeBase64(r);return i}},{key:"encodeBase64",value:function(e){return t[e]||function(){throw new Error("Cannot Base64 encode value: ".concat(e))}()}}]),r}();return a=(n=1<<(s=5))-1,t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r}.call(this),t.exports=n}.call(this),t.exports}(),s["./coffeescript"]=function(){var e={};return function(){var i,n,a,r,o,l,c,h,u,p,m,f,v,g,y,w,k=[].indexOf;n=s("./lexer").Lexer;var x=s("./parser");f=x.parser,u=s("./helpers"),a=s("./sourcemap"),m=s("../../package.json"),e.VERSION=m.version,e.FILE_EXTENSIONS=i=[".coffee",".litcoffee",".coffee.md"],e.helpers=u,r=function(e){switch(!1){case"function"!=typeof Buffer:return Buffer.from(e).toString("base64");case"function"!=typeof btoa:return btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,(function(e,i){return t("0x"+i)})));default:throw new Error("Unable to base64 encode inline sourcemap.")}},w=function(e){return function(t){var i,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};try{return e.call(this,t,n)}catch(e){if(i=e,"string"!=typeof t)throw i;throw u.updateSyntaxError(i,t,n.filename)}}},y={},g={},e.registerCompiled=v=function(e,t,i){if(null==y[e]&&(y[e]=[]),y[e].push(t),null!=i)return null==g[e]&&(g[e]=[]),g[e].push(i)},e.compile=l=w((function(e){var t,i,n,s,l,c,h,d,m,g,y,w,k,x,E,T,N,A,C,L,S,I,D,j,O,R,_,P,M,F,V=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(d=(V=Object.assign({},V)).sourceMap||V.inlineMap||null==V.filename,l=V.filename||"<anonymous>",o(l,e),d&&(E=new a),R=p.tokenize(e,V),V.referencedVars=function(){var e,t,i;for(i=[],e=0,t=R.length;e<t;e++)"IDENTIFIER"===(O=R[e])[0]&&i.push(O[1]);return i}(),null==V.bare||!0!==V.bare)for(g=0,k=R.length;g<k;g++)if("IMPORT"===(C=(O=R[g])[0])||"EXPORT"===C){V.bare=!0;break}if(N=f.parse(R),V.ast)return N.allCommentTokens=u.extractAllCommentTokens(R),I=(e.match(/\r?\n/g)||"").length+1,S=/.*$/.exec(e)[0],t=N.ast(V),A=[0,e.length],t.start=t.program.start=A[0],t.end=t.program.end=A[1],t.range=t.program.range=A,t.loc.start=t.program.loc.start={line:1,column:0},t.loc.end.line=t.program.loc.end.line=I,t.loc.end.column=t.program.loc.end.column=S.length,t.tokens=R,t;for(h=N.compileToFragments(V),n=0,V.header&&(n+=1),V.shiftLine&&(n+=1),i=0,w="",y=0,x=h.length;y<x;y++)c=h[y],d&&(c.locationData&&!/^[;\s]*$/.test(c.code)&&E.add([c.locationData.first_line,c.locationData.first_column],[n,i],{noReplace:!0}),n+=T=u.count(c.code,"\n"),T?i=c.code.length-(c.code.lastIndexOf("\n")+1):i+=c.code.length),w+=c.code;if(V.header&&(m="Generated by CoffeeScript ".concat(this.VERSION),w="// ".concat(m,"\n").concat(w)),d&&(F=E.generate(V,e)),V.transpile){if("object"!==b(V.transpile))throw new Error("The transpile option must be given an object with options to pass to Babel");_=V.transpile.transpile,delete V.transpile.transpile,P=Object.assign({},V.transpile),F&&null==P.inputSourceMap&&(P.inputSourceMap=F),w=(M=_(w,P)).code,F&&M.map&&(F=M.map)}return V.inlineMap&&(s=r(JSON.stringify(F)),D="//# sourceMappingURL=data:application/json;base64,".concat(s),j="//# sourceURL=".concat(null==(L=V.filename)?"coffeescript":L),w="".concat(w,"\n").concat(D,"\n").concat(j)),v(l,e,E),V.sourceMap?{js:w,sourceMap:E,v3SourceMap:JSON.stringify(F,null,2)}:w})),e.tokens=w((function(e,t){return p.tokenize(e,t)})),e.nodes=w((function(e,t){return"string"==typeof e&&(e=p.tokenize(e,t)),f.parse(e)})),e.run=e.eval=e.register=function(){throw new Error("require index.coffee, not this file")},p=new n,f.lexer={yylloc:{range:[]},options:{ranges:!0},lex:function(){var e,t;if(t=f.tokens[this.pos++]){var i=d(t,3);e=i[0],this.yytext=i[1],this.yylloc=i[2],f.errorToken=t.origin||t,this.yylineno=this.yylloc.first_line}else e="";return e},setInput:function(e){return f.tokens=e,this.pos=0},upcomingInput:function(){return""}},f.yy=s("./nodes"),f.yy.parseError=function(e,t){t.token;var i,n,s,a,r,o=f;a=o.errorToken,r=o.tokens;var l=d(a,3);return n=l[0],s=l[1],i=l[2],s=function(){switch(!1){case a!==r[r.length-1]:return"end of input";case"INDENT"!==n&&"OUTDENT"!==n:return"indentation";case"IDENTIFIER"!==n&&"NUMBER"!==n&&"INFINITY"!==n&&"STRING"!==n&&"STRING_START"!==n&&"REGEX"!==n&&"REGEX_START"!==n:return n.replace(/_START$/,"").toLowerCase();default:return u.nameWhitespaceCharacter(s)}}(),u.throwSyntaxError("unexpected ".concat(s),i)},c=function(e,t){var i,n,s,a,r,o,l,c,h,u,d;return a=void 0,s="",e.isNative()?s="native":(e.isEval()?!(a=e.getScriptNameOrSourceURL())&&(s="".concat(e.getEvalOrigin(),", ")):a=e.getFileName(),a||(a="<anonymous>"),s=(h=t(a,l=e.getLineNumber(),n=e.getColumnNumber()))?"".concat(a,":").concat(h[0],":").concat(h[1]):"".concat(a,":").concat(l,":").concat(n)),r=e.getFunctionName(),o=e.isConstructor(),e.isToplevel()||o?o?"new ".concat(r||"<anonymous>"," (").concat(s,")"):r?"".concat(r," (").concat(s,")"):s:(c=e.getMethodName(),d=e.getTypeName(),r?(u=i="",d&&r.indexOf(d)&&(u="".concat(d,".")),c&&r.indexOf(".".concat(c))!==r.length-c.length-1&&(i=" [as ".concat(c,"]")),"".concat(u).concat(r).concat(i," (").concat(s,")")):"".concat(d,".").concat(c||"<anonymous>"," (").concat(s,")"))},h=function(e,t,n){var s,a,r,o,c;if(!("<anonymous>"===e||(r=e.slice(e.lastIndexOf(".")),0<=k.call(i,r))))return null;if("<anonymous>"!==e&&null!=g[e])return g[e][g[e].length-1];if(null!=g["<anonymous>"])for(s=(o=g["<anonymous>"]).length-1;0<=s;s+=-1)if(null!=(null==(c=(a=o[s]).sourceLocation([t-1,n-1]))?void 0:c[0])&&null!=c[1])return a;return null==y[e]?null:l(y[e][y[e].length-1],{filename:e,sourceMap:!0,literate:u.isLiterate(e)}).sourceMap},Error.prepareStackTrace=function(t,i){var n,s,a;return a=function(e,t,i){var n,s;return null!=(s=h(e,t,i))&&(n=s.sourceLocation([t-1,i-1])),null==n?null:[n[0]+1,n[1]+1]},s=function(){var t,s,r;for(r=[],t=0,s=i.length;t<s&&(n=i[t]).getFunction()!==e.run;t++)r.push("    at ".concat(c(n,a)));return r}(),"".concat(t.toString(),"\n").concat(s.join("\n"),"\n")},o=function(e,t){var i,n,s,a;if(1<(null==(i=null==(a=null==(n=t.split(/$/m)[0])?void 0:n.match(/^#!\s*([^\s]+\s*)(.*)/))||null==(s=a[2])?void 0:s.split(/\s/).filter((function(e){return""!==e})))?void 0:i.length))return console.error("The script to be run begins with a shebang line with more than one\nargument. This script will fail on platforms such as Linux which only\nallow a single argument."),console.error("The shebang line was: '".concat(n,"' in file '").concat(e,"'")),console.error("The arguments were: ".concat(JSON.stringify(i)))}}.call(this),{exports:e}.exports}(),s["./browser"]=function(){var e={exports:{}};return function(){var t,n,a=[].indexOf;t=s("./coffeescript"),n=t.compile,t.eval=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return null==t.bare&&(t.bare=!0),("undefined"!=typeof window&&null!==window?window:i.g).eval(n(e,t))},t.run=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return t.bare=!0,t.shiftLine=!0,Function(n(e,t))()},e.exports=t,"undefined"==typeof window||null===window||("undefined"!=typeof btoa&&null!==btoa&&"undefined"!=typeof JSON&&null!==JSON&&(n=function(e){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return i.inlineMap=!0,t.compile(e,i)}),t.load=function(e,i){var n,s=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},a=!!(3<arguments.length&&void 0!==arguments[3])&&arguments[3];return s.sourceFiles=[e],(n=window.ActiveXObject?new window.ActiveXObject("Microsoft.XMLHTTP"):new window.XMLHttpRequest).open("GET",e,!0),"overrideMimeType"in n&&n.overrideMimeType("text/plain"),n.onreadystatechange=function(){var r,o;if(4===n.readyState){if(0!==(o=n.status)&&200!==o)throw new Error("Could not load ".concat(e));var l;if(r=[n.responseText,s],a||(l=t).run.apply(l,y(r)),i)return i(r)}},n.send(null)},t.runScripts=function(){var e,i,n,s,r,o,l,c,h;for(h=window.document.getElementsByTagName("script"),i=["text/coffeescript","text/literate-coffeescript"],e=function(){var e,t,n,s;for(s=[],e=0,t=h.length;e<t;e++)n=(c=h[e]).type,0<=a.call(i,n)&&s.push(c);return s}(),r=0,n=function(){var i,s;if((i=e[r])instanceof Array)return(s=t).run.apply(s,y(i)),r++,n()},s=o=0,l=e.length;o<l;s=++o)!function(s,a){var r,o;r={literate:s.type===i[1]},(o=s.src||s.getAttribute("data-src"))?(r.filename=o,t.load(o,(function(t){return e[a]=t,n()}),r,!0)):(r.filename=s.id&&""!==s.id?s.id:"coffeescript".concat(0===a?"":a),r.sourceFiles=["embedded"],e[a]=[s.innerHTML,r])}(e[s],s);return n()},this===window&&(window.addEventListener?window.addEventListener("DOMContentLoaded",t.runScripts,!1):window.attachEvent("onload",t.runScripts)))}.call(this),e.exports}(),s["./browser"]}(),void 0===(n=function(){return s}.call(t,i,t,e))||(e.exports=n)}},t={};function i(n){if(t[n])return t[n].exports;var s=t[n]={exports:{}};return e[n].call(s.exports,s,s.exports,i),s.exports}i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n={};return(()=>{"use strict";function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function t(e){return function(e){if(Array.isArray(e))return a(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||s(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){if(e){if("string"==typeof e)return a(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?a(e,t):void 0}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function r(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return i?v(e)?t:e:g(e)?t:e}function o(e){return d(e)&&0===e.length}function l(t){return t instanceof Date||"object"===e(t)&&"[object Date]"===Object.prototype.toString.call(t)}function c(e){return"string"==typeof e||e instanceof String}function h(e){return"function"==typeof e}function u(t){return!g(t)&&"object"===e(t)}function d(e){return!g(e)&&"function"==typeof e[Symbol.iterator]}function p(e){return d(e)&&!c(e)}function m(e){return null===e}function f(e){return!e||c(e)&&(0===e.length||/^\s*$/.test(e))}function v(e){return void 0===e}function g(e){return m(e)||v(e)}function b(e,t){var i=e.getDate(),n=e.getMonth()+1,s=e.getFullYear().toString(),a=e.getHours(),r=e.getMinutes(),o=e.getSeconds(),l=function(e){return e<10?"0".concat(e):e};return t.replace("yyyy",s).replace("yy",s.slice(-2)).replace("mm",l(n)).replace("m",n).replace("dd",l(i)).replace("d",i).replace("hh",l(a)).replace("h",a).replace("MM",l(r)).replace("M",r).replace("ss",l(o)).replace("s",o)}function y(e){return b(function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(g(e))return new Date;if(l(e))return e;var i=new Date(e),n=i.getTime();return Number.isNaN(n)?new Date:t?new Date(n+6e4*i.getTimezoneOffset()):i}(e,!1),"yyyy-mm-dd hh:MM")}i.r(n),i.d(n,{activateEditor:()=>Aa,createEditor:()=>Ca});var w=Object.prototype.hasOwnProperty,k=(Object.prototype.isPrototypeOf,function(e,t){return w.call(e,t)});function x(e){if(g(e)||!u(e))return e;var t=e.constructor();for(var i in e)k(e,i)&&(e.isActiveClone=null,t[i]=x(e[i]),delete e.isActiveClone);return t}function E(e){return f(e)?e:function(e){return f(e)?e:e.toLowerCase().replace(/\b\w/g,(function(e){return e.toUpperCase()}))}(e.replace(/[_-]+/g," ").replace(/\s+/g," ").trim()).replace(/\s+/g,"")}function T(e){var t=r(e,!1);return c(t)&&"true"===t.toLowerCase()||Number.isInteger(t)&&1===t||!0===t}var N=function(e){return!g(e)&&e.nodeType===Node.ELEMENT_NODE},A=function(e){return e instanceof Node},C=function(e){return N(e)&&e instanceof Element},L=function(e,t){return!!(N(e)&&e instanceof HTMLElement)&&(!d(t)||(i=e,n=Array.isArray(t)?t:[t],a=function(e){return i instanceof e},r=function(e){return i.tagName===e.toUpperCase()},l=function(e){return Array.isArray(e)?e.includes(i.type):i.type===e},n.some((function(e){if(!d(e))return!1;var t,i,n=e,c=null;if(Array.isArray(e)){var h=(i=2,function(e){if(Array.isArray(e))return e}(t=e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var i=[],n=!0,s=!1,a=void 0;try{for(var r,o=e[Symbol.iterator]();!(n=(r=o.next()).done)&&(i.push(r.value),!t||i.length!==t);n=!0);}catch(e){s=!0,a=e}finally{try{n||null==o.return||o.return()}finally{if(s)throw a}}return i}}(t,i)||s(t,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}());n=h[0],c=h[1]}n=n.toLowerCase();var u="HTML".concat(k(S,n)?S[n]:E(n),"Element");return!(!a(window[u])&&!r(n))&&(!(p(c)&&!o(c))||l(c))}))));var i,n,a,r,l},S={a:"Anchor",br:"BR",dl:"DList",datalist:"DataList",fieldset:"FieldSet",frameset:"FrameSet",hr:"HR",h1:"Heading",h2:"Heading",h3:"Heading",h4:"Heading",h5:"Heading",h6:"Heading",li:"LI",ol:"OList",optgroup:"OptGroup",p:"Paragraph",q:"Quote",blockquote:"Quote",caption:"TableCaption",td:"TableCell",th:"TableCell",col:"TableCol",tr:"TableRow",tbody:"TableSection",thead:"TableSection",tfoot:"TableSection",textarea:"TextArea",ul:"UList"},I=function(e){return function(e){return!g(e)&&e.nodeType===Node.DOCUMENT_FRAGMENT_NODE}(e)&&e instanceof DocumentFragment};function D(e,t){if(!c(t))return null;var i=document.createElement("template");return i.innerHTML=t.trim(),i.content[e]}var j=D.bind(null,"firstChild");function O(e,t,i){e[t]=i}function R(e,t,i){e.setAttribute(t,i)}D.bind(null,"childNodes");var _="accesskey,autocapitalize,class,dataset,editable,draggable,hidden,id,inputmode,lang,html,style,tabindex,text,title",P={accesskey:[O,"accessKey"],autocapitalize:[O,"autocapitalize"],class:[function(e,i){var n;if(!L(e))throw new Error("Bad argument: The passed `element` argument is not a valid HTML Element");return(n=e.classList).add.apply(n,t(Array.isArray(i)?i:[i])),e}],dataset:[function(e,t,i){Object.assign(e[t],i)},"dataset"],draggable:[O,"draggable"],editable:[O,"contentEditable"],hidden:[O,"hidden"],id:[O,"id"],inputmode:[O,"inputMode"],lang:[O,"lang"],html:[O,"innerHTML"],style:[O,"style"],tabindex:[O,"tabIndex"],text:[O,"textContent"],title:[O,"title"],data:[O,"data"],cite:[O,"cite"],download:[O,"download"],ping:[O,"ping"],target:[O,"target"],coords:[O,"coords"],shape:[O,"shape"],autoplay:[O,"autoplay"],buffered:[O,"buffered"],controls:[O,"controls"],loop:[O,"loop"],muted:[O,"muted"],playsinline:[R,"playsinline"],poster:[O,"poster"],preload:[O,"preload"],crossorigin:[O,"crossOrigin"],decoding:[O,"decoding"],height:[O,"height"],ismap:[O,"isMap"],loading:[O,"loading"],srcset:[O,"srcset"],width:[O,"width"],alt:[O,"alt"],as:[O,"as"],media:[O,"media"],rel:[O,"rel"],src:[O,"src"],sizes:[O,"sizes"],reversed:[O,"reversed"],start:[O,"start"],accept:[O,"accept"],"accept-charset":[O,"acceptCharset"],action:[O,"action"],autocomplete:[O,"autocomplete"],autofocus:[O,"autofocus"],capture:[O,"capture"],checked:[O,"checked"],cols:[O,"cols"],disabled:[O,"disabled"],dirname:[O,"dirName"],enctype:[O,"enctype"],for:[O,"for"],form:[O,"form"],formaction:[O,"formAction"],formenctype:[O,"formEnctype"],formmethod:[O,"formMethod"],formnovalidate:[O,"formNoValidate"],formtarget:[O,"formTarget"],high:[O,"high"],label:[O,"label"],list:[O,"list"],low:[O,"low"],max:[O,"max"],maxlength:[O,"maxLength"],method:[O,"method"],min:[O,"min"],minlength:[O,"minLength"],multiple:[O,"multiple"],name:[O,"name"],novalidate:[O,"noValidate"],optimum:[O,"optimum"],pattern:[O,"pattern"],placeholder:[O,"placeholder"],readonly:[O,"readOnly"],required:[O,"required"],rows:[O,"rows"],selected:[O,"selected"],size:[O,"size"],spellcheck:[R,"spellcheck"],step:[O,"step"],wrap:[O,"wrap"],default:[O,"default"],kind:[O,"kind"],srclang:[O,"srclang"],abbr:[O,"abbr"],colspan:[O,"colSpan"],span:[O,"span"],rowspan:[O,"rowSpan"],scope:[O,"scope"],href:[O,"href"],hreflang:[O,"hreflang"],datetime:[O,"dateTime"],type:[O,"type"],value:[O,"value"],usemap:[O,"useMap"]};function M(e,i,n){var s=document.createElement(e);return L(s)?(u(n)&&function(e,i){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(!L(e))throw new Error("Bad argument: The given element argument is not a valid HTML Element");if(!u(i))return e;for(var s=function(e){return _.includes(e)||n.includes(e)},a=0,r=Object.keys(i);a<r.length;a++){var o=r[a];if(s(o)){var l=i[o],c=P[o].slice(0);c.shift().apply(void 0,[e].concat(t(c),[l]))}}}(s,n,r(i,"")),s):null}function F(e,t,i,n){var s=M(e,t,i);return L(s)?(g(n)||be(s,n),s):null}function V(e,t,i,n,s){var a=M(e,t,n);return L(a)?(g(s)||be(a,s,i),a):null}function $(e){var t=document.createDocumentFragment();return g(e)||be(t,e),t}M.bind(null,"link","as,crossorigin,disabled,href,hreflang,media,rel,sizes,type"),F.bind(null,"template","");var B=F.bind(null,"header",""),H=(F.bind(null,"footer",""),F.bind(null,"main",""),F.bind(null,"article",""),F.bind(null,"section","")),U=(F.bind(null,"nav",""),F.bind(null,"aside","")),W=(F.bind(null,"h1",""),F.bind(null,"h2",""),F.bind(null,"h3","")),q=F.bind(null,"h4",""),z=(F.bind(null,"h5",""),F.bind(null,"h6",""),F.bind(null,"div","")),X=(F.bind(null,"object","data,height,name,type,usemap,width"),M.bind(null,"embed","height,src,type,width"),M.bind(null,"br",""),M.bind(null,"hr",""),F.bind(null,"p","")),G=(F.bind(null,"blockquote","cite"),function(e){return L(e,"li")?e:Y(null,e)}),J=V.bind(null,"ul","",G),Y=(V.bind(null,"ol","reversed,start,type",G),F.bind(null,"li","value")),K=(F.bind(null,"dl",""),F.bind(null,"dt",""),F.bind(null,"dd",""),F.bind(null,"a","download,href,hreflang,ping,rel,target,type")),Q=(M.bind(null,"area","alt,coords,download,href,hreflang,media,ping,rel,shape,target"),M.bind(null,"base","href,target"),M.bind(null,"img","alt,crossorigin,decoding,height,ismap,loading,sizes,src,srcset,usemap,width")),Z=F.bind(null,"audio","autoplay,controls,crossorigin,loop,muted,preload,src"),ee=(F.bind(null,"video","autoplay,controls,crossorigin,height,loop,muted,playsinline,poster,preload,src,width"),M.bind(null,"source","media,sizes,src,srcset,type"),M.bind(null,"track","default,kind,label,src,srclang"),F.bind(null,"picture",""),F.bind(null,"figure",""),F.bind(null,"figcaption",""),F.bind(null,"span","")),te=(F.bind(null,"strong",""),F.bind(null,"em","")),ie=(F.bind(null,"mark",""),F.bind(null,"samp",""),F.bind(null,"sub",""),F.bind(null,"sup",""),F.bind(null,"del","cite,datetime"),F.bind(null,"ins","cite,datetime"),F.bind(null,"q","cite"),F.bind(null,"abbr",""),F.bind(null,"b",""),F.bind(null,"i","")),ne=(F.bind(null,"s",""),F.bind(null,"u",""),F.bind(null,"cite",""),F.bind(null,"time","datetime"),F.bind(null,"code",""),F.bind(null,"form","accept-charset,action,autocomplete,enctype,method,name,novalidate,rel,target"),M.bind(null,"input","accept,alt,autocomplete,autofocus,capture,checked,dirname,disabled,height,max,maxlength,minlength,min,multiple,name,pattern,placeholder,readonly,required,size,src,step,type,value,width")),se=F.bind(null,"textarea","autocomplete,autofocus,cols,disabled,maxlength,minlength,name,placeholder,readonly,required,rows,spellcheck,value,wrap"),ae=F.bind(null,"label","for"),re=(V.bind(null,"select","autocomplete,autofocus,disabled,multiple,name,required,size",(function(e){return L(e,["option","optgroup"])?e:Array.isArray(e)?le(null,e):re(null,e)})),F.bind(null,"option","disabled,label,selected,value")),oe=function(e){return L(e,"option")?e:re(null,e)},le=V.bind(null,"optgroup","disabled,label",oe),ce=(F.bind(null,"fieldset","disabled,name"),F.bind(null,"legend",""),V.bind(null,"datalist","",oe),F.bind(null,"meter","high,low,max,min,optimum,value"),F.bind(null,"progress","max,value"),F.bind(null,"output","name,value"),F.bind(null,"button","autofocus,disabled,formaction,formenctype,formmethod,formnovalidate,formtarget,name,type,value")),he=F.bind(null,"table",""),ue=(F.bind(null,"caption",""),function(e){return L(e,"tr")?e:fe(null,e)}),de=V.bind(null,"thead","",ue),pe=V.bind(null,"tbody","",ue),me=V.bind(null,"tfoot","",ue),fe=(M.bind(null,"col","span"),V.bind(null,"colgroup","span",(function(e){return L(e,"col")?e:null})),V.bind(null,"tr","",(function(e){return L(e,["th","td"])?e:ge(null,e)}))),ve=F.bind(null,"th","abbr,colspan,rowspan,scope"),ge=F.bind(null,"td","colspan,rowspan");function be(e,t,i){var n=Array.isArray(t)?t:[t];return h(i)&&(n=n.map((function(e){return i(e)}))),function(e,t){if(!A(e))throw new TypeError("Bad argument: The given `parent` is not a valid Node");if(!(t instanceof HTMLCollection||p(t)))throw new TypeError("Bad argument: The given `children` is not a valid HTMLCollection/HTMLElement array");var i=I(e)?e:document.createDocumentFragment();Array.from(t).forEach((function(e){var t;g(e)||i.appendChild(A(e)?e:(t=e.toString(),document.createTextNode(t.toString())))})),e!==i&&e.appendChild(i)}(e,n),e}var ye=function(e){return/^\.[a-zA-Z0-9_-]+$/.test(e)};function we(e,t){var i=r(t,document);return f(e)?null:I(i)?i.querySelector(e):function(e){return/^#[a-zA-Z0-9_-]+$/.test(e)}(e)?document.getElementById(e.substring(1)):ye(e)?i.getElementsByClassName(e.substring(1))[0]:i.querySelector(e)}function ke(e,t){var i=r(t,document);return f(e)?null:I(i)?i.querySelectorAll(e):ye(e)?i.getElementsByClassName(e.substring(1)):i.querySelectorAll(e)}function xe(e,t,i){if(!L(t))return null;var n=t[e];if(h(i))for(;C(n)&&!i(n);)n=n[e];return n}function Ee(e,t,i){if(!C(e))throw new TypeError("Bad argument: The given target parameter is not a valid HTML Element");if(!h(t))throw new TypeError("Bad argument: The given pred parameter is not a valid Function");var n=e.parentElement;return i>0?Ne(n,t,i-1):Te(n,t)}function Te(e,t){return g(e)?null:t(e)?e:Te(e.parentElement,t)}function Ne(e,t,i){return g(e)||0===i?null:t(e)?e:Ne(e.parentElement,t,i-1)}function Ae(e,t){if(!A(e))throw new TypeError("Bad argument: The given `node` is not a valid Node");return h(t)?(Array.from(e.childNodes).forEach((function(i){t(i)&&e.removeChild(i)})),e):function(e){for(;e.hasChildNodes();)e.removeChild(e.lastChild);return e}(e)}function Ce(e){if(g(e))return!1;var t=se({value:L(e)?e.textContent:e.toString(),readonly:!0});return!!L(t)&&(document.body.appendChild(t),t.select(),document.execCommand("copy"),t.remove(),!0)}xe.bind(null,"previousElementSibling"),xe.bind(null,"nextElementSibling");var Le=function(e){return e.dataset.state},Se=function(e,t){return e.dataset.state=t},Ie=function(e,t){return Se(e,r(t,"checked"))},De=function(e,t){return Se(e,r(t,"unchecked"))},je={name:"form-selector",container:null,items:null,selectedIndex:null,selectedItem:null,beforeChange:null,afterChange:null,get value(){return this.selectedItem.value},setSelectedItem:function(e){return this.items.includes(e)?(this.selectedItem&&this.selectedItem.setChecked(!1),this.selectedItem=e,this.selectedItem.setChecked(!0),!0):null},init:function(){for(var e=this.container.dataset.value,t=null,i=0;i<this.items.length;i++){var n=this.items[i];n.isChecked()&&this.setSelectedItem(n),n.value===e&&(t=n)}return m(this.selectedItem)&&!m(t)&&this.setSelectedItem(t),this.bindEvents(),this},bindEvents:function(){var e=this;this.container.addEventListener("change",(function(t){var i=t.target,n=!1;if(h(e.beforeChange)&&(n=!1===e.beforeChange(e,t)),n)return i.checked=!1,void e.items[e.selectedIndex].setChecked(!0);var s=e.items.find((function(e){return e.index===+r(i.dataset.selectorIndex,-1)}));g(s)||(e.setSelectedItem(s),h(e.afterChange)&&e.afterChange(e,t))}))}},Oe=function(e){return'[data-type="'.concat(e.name,'"]')},Re={BaseSelector:Oe({name:"selector",container:null,items:null,selectedIndex:null,selectedItem:null,beforeChange:null,afterChange:null,get value(){return this.selectedItem.value},setSelectedItem:function(e){return this.items.includes(e)?(this.selectedItem&&this.selectedItem.setChecked(!1),this.selectedItem=e,this.selectedItem.setChecked(!0),!0):null},init:function(){for(var e=this.container.dataset.value,t=null,i=0;i<this.items.length;i++){var n=this.items[i];n.isChecked()&&this.setSelectedItem(n),n.value===e&&(t=n)}return m(this.selectedItem)&&!m(t)&&this.setSelectedItem(t),this.bindEvents(),this},bindEvents:function(){var e=this;this.container.addEventListener("click",(function(t){var i=t.target;if(k(i.dataset,"selector")){var n=!1;if(h(e.beforeChange)&&(n=!1===e.beforeChange(e,t)),!n){var s=e.items.find((function(e){return e.index===+r(i.dataset.selectorIndex,-1)}));g(s)||(e.setSelectedItem(s),h(e.afterChange)&&e.afterChange(e,t))}}}))}}),FormSelector:Oe(je)};new Error("Missing container: A selector requires a container"),new Error("Missing input: FormSelector requires an input in the container"),[Re.BaseSelector,Re.FormSelector].join(","),new Error("Missing container: A switch requires a container"),new Error("Missing input: FormSwitch requires an input in the container");var _e="on",Pe=function(e){return'[data-type="'.concat(e.name,'"]')},Me={name:"form-switch",container:null,input:null,beforeChange:null,afterChange:null,get value(){return this.input.value},isChecked:function(){return Le(this.container)===_e},setChecked:function(e){return!g(e)&&(this.input.checked=e,e?Ie(this.container,_e):De(this.container,"off"),!0)},toggle:function(){this.isChecked()?this.setChecked(!1):this.setChecked(!0)},init:function(e){return Object.assign(this,e),this.input.checked&&this.setChecked(!0),this.bindEvents(),this},bindEvents:function(){var e=this;this.input.addEventListener("change",(function(t){var i=!1;h(e.beforeChange)&&(i=!1===e.beforeChange(e,t)),i?e.input.checked=!e.input.checked:(e.toggle(),h(e.afterChange)&&e.afterChange(e,t))}))}};function Fe(e){let t=0;if(0!==window.getSelection().rangeCount){const i=window.getSelection().getRangeAt(0),n=i.cloneRange();n.selectNodeContents(e),n.setEnd(i.endContainer,i.endOffset),t=n.toString().length}return t}[Pe({name:"switch",container:null,beforeChange:null,afterChange:null,get value(){return this.container.dataset.value},isChecked:function(){return Le(this.container)===_e},setChecked:function(e){return!g(e)&&(e?Ie(this.container,_e):De(this.container,"off"),!0)},toggle:function(){this.isChecked()?this.setChecked(!1):this.setChecked(!0)},init:function(e){return Object.assign(this,e),this.isChecked()&&Ie(this.container,_e),this.bindEvents(),this},bindEvents:function(){var e=this;this.container.addEventListener("click",(function(t){var i=!1;h(e.beforeChange)&&(i=!1===e.beforeChange(e,t)),i||(e.toggle(),h(e.afterChange)&&e.afterChange(e,t))}))}}),Pe(Me)].join(","),new Error("Missing container: A collapsible requires a container"),new Error("Missing container: An accordion requires a container"),encodeURIComponent;const Ve="hidden",$e="collapsed",Be="highlighted",He="shake",Ue="selected";function We(e){return L(e)?(e.classList.remove(Ve),e):e}function qe(e){return L(e)?(e.classList.add(Ve),e):e}function ze(e){return L(e)?(e.classList.toggle(Ve),e):e}function Xe(e){e.classList.contains(He)||(e.classList.add(He),setTimeout((()=>{e.classList.remove(He)}),1e3))}function Ge(e){return L(e)?(e.classList.remove(Be),e):e}const Je={backspace:"Backspace",tab:"Tab",enter:"Enter",ctrl:"Control",shift:"Shift",alt:"Alt",escape:"Escape",spacebar:" ",page_up:"PageUp",page_down:"PageDown",insert:"Insert",end:"End",home:"Home",left_arrow:"ArrowLeft",up_arrow:"ArrowUp",right_arrow:"ArrowRight",down_arrow:"ArrowDown",delete:"Delete",period:"."},Ye={NORMAL:"normal",WARNING:"warning",SUCCESS:"success",ERROR:"error"},Ke="error";function Qe(e){const t=e=>!k(e.dataset,"ignore");return t(e)?e:Ee(e,t,10)}function Ze(e){if(!L)throw new TypeError("Bad parameter");return e.hidden||"none"===window.getComputedStyle(e).display}const et=e=>L(e,["input","textarea"])||"true"===e.contentEditable,tt=e=>+e.substring(0,e.indexOf("px")),it={top:e=>e.marginTop,right:e=>e.marginRight,bottom:e=>e.marginBottom,left:e=>e.marginLeft},nt={top:e=>e.paddingTop,right:e=>e.paddingRight,bottom:e=>e.paddingBottom,left:e=>e.paddingLeft},st={top:e=>e.borderTopWidth,right:e=>e.borderRightWidth,bottom:e=>e.borderBottomWidth,left:e=>e.borderLeftWidth};function at(e,t,i){const n=window.getComputedStyle(e),s=window.getComputedStyle(t),a=it[i](n),r=nt[i](s),o=st[i](s);return l=e.getBoundingClientRect()[i]+tt(a),c=t.getBoundingClientRect()[i]-tt(r)-tt(o),Math.abs(l-c)<2;var l,c}function rt(e,t,i,n){return"up"===t?function(e,t,i=!0){const n=t.children,{top:s,left:a}=e.getBoundingClientRect();if(i&&at(e,t,"top"))return null;let r=null,o=99999,l=99999;for(let t=0;t<n.length;t++){const i=n[t];if(Ze(i)||i.classList.contains("badge")||i===e)continue;const{bottom:c,left:h}=i.getBoundingClientRect();let u=Math.abs(s-c),d=Math.abs(a-h);s>=c-1&&(u<o||u===o&&d<l)&&(r=i,o=u,l=d)}return r}(e,i,n):"down"===t?function(e,t,i=!0){const n=t.children,{bottom:s,left:a}=e.getBoundingClientRect();if(i&&at(e,t,"bottom"))return null;let r=null,o=99999,l=99999;for(let t=0;t<n.length;t++){const i=n[t];if(Ze(i)||i.classList.contains("badge")||i===e)continue;const{top:c,left:h}=i.getBoundingClientRect();let u=Math.abs(s-c),d=Math.abs(a-h);s<=c+1&&(u<o||u===o&&d<l)&&(r=i,o=u,l=d)}return r}(e,i,n):"left"===t?function(e,t,i=!0){const n=t.children,{top:s,left:a}=e.getBoundingClientRect();if(i&&at(e,t,"left"))return null;let r=null,o=99999,l=99999;for(let t=0;t<n.length;t++){const i=n[t];if(Ze(i)||i.classList.contains("badge")||i===e)continue;const{top:c,right:h}=i.getBoundingClientRect();let u=Math.abs(s-c),d=Math.abs(a-h);a>=h-1&&(d<l||d===l&&u<o)&&(r=i,o=u,l=d)}return r}(e,i,n):"right"===t?function(e,t,i=!0){const n=t.children,{top:s,right:a}=e.getBoundingClientRect();if(i&&at(e,t,"right"))return null;let r=null,o=99999,l=99999;for(let t=0;t<n.length;t++){const i=n[t];if(Ze(i)||i.classList.contains("badge")||i===e)continue;const{top:c,left:h}=i.getBoundingClientRect();let u=Math.abs(s-c),d=Math.abs(a-h);a<=h+1&&(d<l||d===l&&u<o)&&(r=i,o=u,l=d)}return r}(e,i,n):(console.error("unknown direction",t),null)}function ot(e,t){const i=e.children,{top:n,left:s}=e.getBoundingClientRect();if(0===i.length)return null;const a=h(t);let r=null,o=99999,l=99999;for(let e=0;e<i.length;e++){const c=i[e];if(a&&!t(c))continue;if(Ze(c)||c.classList.contains("badge"))continue;const{top:h,left:u}=c.getBoundingClientRect();let d=Math.abs(n-h),p=Math.abs(s-u);n<=h+1&&(d<o||d===o&&p<l)&&(r=c,o=d,l=p)}return r}function lt(e,t){const i=e.children,{top:n,left:s}=e.getBoundingClientRect();if(0===i.length)return null;const a=h(t);let r=null,o=99999,l=99999;for(let e=0;e<i.length;e++){const c=i[e];if(a&&!t(c))continue;if(Ze(c)||c.classList.contains("badge"))continue;const{top:h,left:u}=c.getBoundingClientRect();let d=Math.abs(n-h),p=Math.abs(s-u);s<=u+1&&(p<l||p===l&&d<o)&&(r=c,o=d,l=p)}return r}function ct(e,t){const i=e.children,{top:n,right:s}=e.getBoundingClientRect();if(0===i.length)return null;const a=h(t);let r=null,o=99999,l=99999;for(let e=0;e<i.length;e++){const c=i[e];if(a&&!t(c))continue;if(Ze(c)||c.classList.contains("badge"))continue;const{top:h,right:u}=c.getBoundingClientRect();let d=Math.abs(n-h),p=Math.abs(s-u);s>=u-1&&(p<l||p===l&&d<o)&&(r=c,o=d,l=p)}return r}function ht(e,t){const i=e.children,{bottom:n,left:s}=e.getBoundingClientRect();if(0===i.length)return null;const a=h(t);let r=null,o=99999,l=99999;for(let e=0;e<i.length;e++){const c=i[e];if(a&&!t(c))continue;if(Ze(c)||c.classList.contains("badge"))continue;const{bottom:h,left:u}=c.getBoundingClientRect();let d=Math.abs(n-h),p=Math.abs(s-u);n>=h-1&&(d<o||d===o&&p<l)&&(r=c,o=d,l=p)}return r}function ut(e){return L(e)?e:c(e)&&!f(e)?we(e):null}const dt=e=>JSON.parse(JSON.stringify(e)),pt=function(){var e={},t=[];for(let e=0;e<256;e++)t[e]=e<16?"0"+e.toString(16):e.toString(16);return e.generate=function(){var e=4294967296*Math.random()>>>0,i=4294967296*Math.random()>>>0,n=4294967296*Math.random()>>>0,s=4294967296*Math.random()>>>0;return t[255&e]+t[e>>8&255]+t[e>>16&255]+t[e>>24&255]+"-"+t[255&i]+t[i>>8&255]+"-"+t[i>>16&15|64]+t[i>>24&255]+"-"+t[63&n|128]+t[n>>8&255]+"-"+t[n>>16&255]+t[n>>24&255]+t[255&s]+t[s>>8&255]+t[s>>16&255]+t[s>>24&255]},e}(),mt={create(e,t){const i=Object.create(this);return i.concept=e,i.schema=t,i},model:null,schema:null,source:null,id:null,value:null,object:"structure",init(e){throw new Error("This function has not been implemented")}};Object.defineProperty(mt,"model",{get(){return this.concept.model}}),Object.defineProperty(mt,"name",{get(){return this.schema.name}}),Object.defineProperty(mt,"required",{get(){return r(this.schema.required,!0)}});const ft={object:"attribute",target:null,init(e){return this.target=this.model.createConcept(this.schema.target,{value:r(e,this.schema.value),parent:this.concept,ref:this}),this},getValue(){return this.target.getValue()},hasValue(){return this.target.hasValue()},copy(){return this.target.hasValue()?this.target.copy(!1):null},clone(){return this.target.hasValue()?this.target.clone():null},export(){return this.target.hasValue()?{id:this.target.id,name:this.target.name}:null},toString(){return{[`attribute.${this.name}`]:this.target.toString()}},toXML(){return this.target.hasValue()?this.target.toXML():""}},vt=Object.assign(Object.create(mt),ft),gt={attributes:null,attributes_created:null,initAttribute(){return this.attributes=[],this.attributes_created=new Set,this.attributes_updated=new Set,this.attributes_deleted=new Set,Array.isArray(this.attributeSchema)&&this.attributeSchema.filter((e=>r(e.required,!0))).forEach((e=>this.createAttribute(e.name))),this},getAttributes(){return this.attributes},getAttribute(e){if(g(e))throw new TypeError("Bad argument");return this.getAttributeByName(e)},getAttributeSchema(e){if(f(e))throw new TypeError("Bad argument");if(!this.hasAttribute(e))throw new Error(`Attribute '${e}' does not exist`);return x(this.attributeSchema.find((t=>t.name===e)))},getAttributeByName(e){if(f(e))throw new TypeError("Bad argument");var t=this.attributes.find((t=>t.name===e));return g(t)&&(t=this.createAttribute(e)),t},createAttribute(e,t){if(!this.hasAttribute(e))throw new Error(`Attribute not found: The concept '${this.name}' does not contain an attribute named '${e}'`);if(this.isAttributeCreated(e)){let i=this.getAttributeByName(e);if(t){let e=this.model.getValue(t);i.target.initValue(e)}return i}const i=this.getAttributeSchema(e);let n=this.model.getValue(t);var s=vt.create(this,i).init(n);return this.addAttribute(s),s},addAttribute(e){if(g(e)||"attribute"!==e.object)throw new Error("Bad argument: 'attribute' must be an attribute object");return this.attributes.push(e),this.attributes_created.add(e.name),this.notify("attribute.added",e),this},hasAttributes(){return!o(this.attributeSchema)||!o(this.attributes)},hasAttribute(e){return-1!==this.attributeSchema.findIndex((t=>t.name===e))},isAttributeRequired(e){return r(this.getAttributeSchema(e).required,!0)},isAttributeCreated(e){return this.attributes_created.has(e)},listAttributes(){const e=[];return this.attributeSchema.forEach((t=>{e.push({type:"attribute",name:t.name,target:t.target,accept:t.accept,required:this.isAttributeRequired(name),created:this.isAttributeCreated(name)})})),e},removeAttribute(e){if(this.isAttributeRequired(e))return{message:`The attribute '${e}' is required.`,success:!1};var t=this.attributes.findIndex((t=>t.name===e));if(-1===t)return{message:`The attribute '${e}' was not found.`,success:!1};var i=this.attributes.splice(t,1)[0];return this.attributes_created.delete(e),this.notify("attribute.removed",i),{message:`The attribute '${e}' was successfully removed.`,success:!0}}},bt={listeners:null,initObserver(){return this.listeners=[],this},register(e){return this.listeners.includes(e)||this.listeners.push(e),!0},unregister(e){var t=this.listeners.indexOf(e);return-1!==t&&(this.listeners.splice(t,1),!0)},unregisterAll(){this.listeners=[]},notify(e,t){this.listeners.forEach((i=>{i.update(e,t,this)}))}},yt={model:null,schema:null,source:null,id:null,name:null,ref:null,actions:null,operations:null,accept:null,parent:null,references:null,errors:null,value:null,values:null,action:null,shadows:null,kind:"concept",init(e={}){return this.accept=e.accept,this.parent=e.parent,this.ref=e.ref,this.properties=r(this.schema.properties,[]),Array.isArray(e.properties)&&this.properties.push(...e.properties),this.default=r(this.schema.default,null),this.values=r(e.values,r(this.schema.values,[])),this.src=r(this.schema.src,[]),this.constraint=this.schema.constraint,this.errors=[],this.initObserver(),this.initAttribute(),this.initValue(e.value),this},isRoot(){return g(this.parent)},initValue(){throw new Error("This function has not been implemented")},getName(){return this.ref&&"attribute"===this.ref.object?this.ref.name:this.name},getCandidates(){return this.values.forEach((e=>{u(e)&&(e.type="value")})),this.values},getStructure(){return[...this.listAttributes()]},getProperty(e,t){if("refname"===e){if(g(this.ref))return;return this.ref.name}if("name"===e)return this.name;if("value"===e)return this.value;if(!this.hasProperty(e))return;let i=this.properties.find((t=>t.name===e));const{type:n,value:s}=i;return"string"===n?wt.call(this,s):"number"===n?+s:"boolean"===n?T(s):s},hasProperty(e){return!!["refname","name","value"].includes(e)||-1!==r(this.schema.properties,[]).findIndex((t=>t.name===e))},getConstraint(e){if(this.hasConstraint(e))return this.constraint[e]},hasConstraint(e){return!g(this.constraint)&&(!!g(e)||k(this.constraint,e))},hasParent(){return!this.isRoot()},getParent(e){if(this.isRoot())return null;if(f(e))return this.parent;const t=this.parent;return t.name===e?t:t.getParent(e)},getParentWith(e){if(this.isRoot())return null;if(f(e))return this.parent;const t=this.parent;return t.hasPrototype(e)?t:t.getParentWith(e)},getPrototype(){return g(this.prototype)?null:this.prototype},hasPrototype(e){if(g(this.schema.prototype))return!1;if(g(e))return!0;let t=this.model.getConceptSchema(this.schema.prototype);for(;!g(t);){if(t.name===e)return!0;t=this.model.getConceptSchema(t.prototype)}return!1},getAncestor(e){const t=[];for(var i=this.getParent(e);i;)t.push(i),i=i.getParent(e);return t},getChildren(e){const t=[];return g(e)?this.getAttributes().forEach((e=>{t.push(e.target)})):this.getAttributes().forEach((i=>{i.target.name===e?t.push(i.target):t.push(...i.target.getChildren(e))})),t},getDescendant(e){const t=[];return this.getChildren(e).forEach((i=>{t.push(i),t.push(...i.getDescendant(e))})),t},delete(e=!1){if(!e){const{object:e}=this.ref;let t={success:!0};if("concept"===e?t=this.getParent().removeValue(this):"attribute"===e&&(t=this.getParent().removeAttribute(this.ref.name)),!t.success)return t}this.getChildren().forEach((e=>{e&&e.delete(!0)}));try{this.model.removeConcept(this.id)&&this.notify("delete")}catch(e){return console.error(this),{message:"Concept not found",success:!1}}return{message:`The concept '${this.name}' was successfully deleted.`,success:!0}},copy(e=!0){const t={name:this.name,nature:this.nature};var i=[];return this.getAttributes().forEach((e=>{i.push({name:e.name,value:e.copy(!1)})})),t.attributes=i,e&&this.model.addValue(t),t},clone(){const e={id:this.id,name:this.name};var t=[];return this.getAttributes().forEach((e=>{t.push({name:e.name,value:e.clone()})})),e.attributes=t,e},export(){const e={id:this.id,root:this.isRoot(),name:this.name};var t=[];return this.getAttributes().forEach((e=>{t.push({name:e.name,value:e.export()})})),e.attributes=t,e},toString(){var e={};return this.attributes.forEach((t=>{Object.assign(e,t.toString())})),e},toXML(){let e=this.getName().replace(" ","-");return`<${e} id="${this.id}">`+this.attributes.map((e=>e.toXML())).join("")+`</${e}>`}};function wt(e){if(c(e))return e;const{type:t}=e;switch(t){case"concat":return xt.call(this,e.concat)}}function kt(e,t){const{type:i}=e;return"string"===i?wt.call(this,e.value):"property"===i?this.getProperty(e.name):t||e}function xt(e,t=""){if(!Array.isArray(e))throw new TypeError("Terms need to be an array");return e.length<2?kt.call(this,e[0]):e.map((e=>kt.call(this,e))).join(t)}const Et=Object.assign(yt,bt,gt);Object.defineProperty(Et,"attributeSchema",{get(){return this.schema.attributes}}),Object.defineProperty(Et,"_prototype",{get(){return this.schema.prototype}}),Object.defineProperty(Et,"hasError",{get(){return this.errors&&!o(this.errors)}});const Tt={nature:"primitive",init(e={}){return this.parent=e.parent,this.ref=e.ref,this.default=r(this.schema.default,!0),this.constraint=this.schema.constraint,this.errors=[],this.initObserver(),this.initAttribute(),this.initValue(e.value),this},initValue(e){if(g(e))return this.value=this.default,this;if(u(e)){const{id:t="",value:i}=e;t.length>10&&(this.id=t),this.setValue(i)}else this.setValue(e);return this},hasValue(){return!g(this.value)},getValue(){return this.value},setValue(e){let t=u(e)?e.value:e;return 200!==this.validate(t)?{success:!1,message:"Validation failed: The value could not be updated."}:(this.value=T(t),this.notify("value.changed",t),{success:!0,message:"The value has been successfully updated."})},restore(e){const{value:t}=e;this.setValue(t)},update:(e,t)=>!0,getCandidates:()=>[!0,!1],getChildren:e=>[],validate(e){return this.errors=[],c(e)&&["true","false"].includes(e.toLowerCase())||Number.isInteger(e)&&[1,0].includes(e)||[!0,!1].includes(e)?200:400},copy(e=!0){if(!this.hasValue())return null;const t={name:this.name,nature:this.nature,value:this.getValue()};return e&&this.model.addValue(t),t},clone(){return{id:this.id,name:this.name,value:this.getValue()}},export(){return{id:this.id,name:this.name,root:this.isRoot(),value:this.getValue()}},toString(){return this.value},toXML(){let e=this.getName();return`<${e} id="${this.id}">`+this.getValue()+`</${e}>`}},Nt=Object.assign(Object.create(Et),Tt);function At(e,t){switch(e){case 400:return{success:!1,message:"The value is not a number."};case 401:return{success:!1,message:`Valid values: ${t}`};case 403:return{success:!1,message:`Maximum allowed: ${t.value}.`};case 402:return{success:!1,message:`Minimum allowed: ${t.value}.`};case 404:return{success:!1,message:`Value allowed: ${t.value}.`}}}const Ct={nature:"primitive",initValue(e){if(g(e))return this.value=this.default,this;if(u(e)){const{id:t="",value:i}=e;t.length>10&&(this.id=t),this.setValue(i)}else this.setValue(e);return this},hasValue(){return"number"==typeof this.value&&!isNaN(this.value)},getValue(){return this.hasValue()?+this.value:null},setValue(e){let t=u(e)?e.value:e;const{code:i,ctx:n}=this.validate(t);return this.value!==t&&(this.value=f(t)?null:+t,this.notify("value.changed",t)),200!==i?{success:!1,message:"Validation failed."}:{success:!0,message:"The value has been successfully updated."}},removeValue(){return this.value=null,this.notify("value.changed",this.value),{success:!0,message:"The value has been successfully updated."}},restore(e){const{value:t}=e;this.setValue(t)},getCandidates(){return this.values.forEach((e=>{u(e)&&(e.type="value")})),this.values},getChildren:e=>[],update:(e,t)=>!0,validate(e){if(this.errors=[],isNaN(e)){let e=400;return this.errors.push(At.call(this,e).message),{code:e}}if(!this.hasConstraint())return{code:200};if(this.hasConstraint("value")){let t=this.getConstraint("value");const{type:i}=t;if("range"===i){const{min:n,max:s}=t[i];if(n&&+e<n.value){let e=402;return this.errors.push(At.call(this,e,n).message),{code:e,ctx:n}}if(s&&+e>s.value){let e=403;return this.errors.push(At.call(this,e,s).message),{code:e,ctx:s}}}else if("fixed"===i){const{value:n}=t[i];if(e!==n){let e=404;return this.errors.push(At.call(this,e,t[i]).message),{code:e,ctx:t[i]}}}}if(this.hasConstraint("values")){let t=this.getConstraint("values").map((e=>Lt.call(this,e))).flat(),i=!1;for(let n=0;!i&&n<t.length;n++){const s=t[n];i=u(s)?s.value===e:s===e}if(!i){let e=401;return this.errors.push(At.call(this,e,t).message),{code:e,ctx:t}}}return{code:200}},copy(e=!0){if(!this.hasValue())return null;const t={name:this.name,nature:this.nature,value:this.getValue()};return e&&this.model.addValue(t),t},clone(){return{id:this.id,name:this.name,value:this.getValue()}},export(){return{id:this.id,name:this.name,root:this.isRoot(),value:this.getValue()}},toString(){return this.value},toXML(){let e=this.getName();return`<${e} id="${this.id}">`+this.getValue()+`</${e}>`}};function Lt(e){if("reference"===e.type){let e=[];return this.model.isPrototype("model concept")&&(e=this.model.getConceptsByPrototype("model concept")),e.map((e=>e.getChildren(this.name))).flat().map((e=>e.value))}return e}const St=Object.assign(Object.create(Et),Ct),It={nature:"primitive",reference:null,path:null,init(e={}){return this.parent=e.parent,this.ref=e.ref,this.accept=this.schema.accept,this.path=this.schema.path,this.values=r(this.schema.values,[]),this.constraint=this.schema.constraint,this.errors=[],this.initObserver(),this.initAttribute(),this.initValue(e.value),this},initValue(e){return g(e)||this.setValue(e.value),this},restore(e){const{value:t}=e;this.setValue(t)},hasValue(){return!f(this.value)},getValue(e=!1){return g(this.value)?null:e?this.reference:this.value},removeValue(){return this.reference&&this.reference.unregister(this),this.reference=null,this.value=null,this.notify("value.changed",this.value),{success:!0,message:"The value has been successfully updated."}},getReference(){return g(this.reference)?null:this.reference},setValue(e,t=!0){let i=u(e)?e.id:e;return 200!==this.validate(i)?{success:!1,message:"Validation failed: The value could not be updated."}:g(i)||this.value===i?{success:!0,message:"The value has been ignored."}:(this.reference&&this.reference.unregister(this),this.value=i,this.reference=this.model.getConcept(i),g(this.reference)&&t?setTimeout((()=>this.setValue(e,!1)),20):(this.reference.register(this),this.notify("value.changed",this.reference)),{success:!0,message:"The value has been successfully updated."})},getCandidates(){if(g(this.accept))throw new Error("Bad reference: 'accept' property is not defined");var e=Dt.call(this,this.accept);return this.path&&jt(this,this.path).map((e=>({type:this.accept.type,value:e}))),e},getChildren(e){return g(this.reference)||e&&this.reference.name!==e?[]:[this.reference]},delete(e=!1){if(!e){const{object:e}=this.ref;let t={success:!0};if("concept"===e?t=this.getParent().removeValue(this):"attribute"===e&&(t=this.getParent().removeAttribute(this.ref.name)),!t.success)return t}return this.reference&&this.reference.unregister(this),this.model.removeConcept(this.id),this.notify("delete"),{message:`The concept '${name}' was successfully deleted.`,success:!0}},update(e,t){switch(e){case"delete":this.reference.unregister(this),this.value=null,this.reference=null,this.notify("value.changed",this.reference)}return!0},validate(e){return this.errors=[],g(e)||this.model.hasConcept(e)?200:(this.errors.push("This element is not valid"),401)},copy(e=!0){if(!this.hasValue())return null;const t={name:this.name,nature:this.nature,value:this.getValue()};return e&&this.model.addValue(t),t},clone(){return{id:this.id,name:this.name,value:this.getValue()}},export(){return{id:this.id,name:this.name,root:this.isRoot(),value:this.getValue()}},toString(){var e=[];return this.value.forEach((t=>{e.push(t.toString())})),e},toXML(){let e=this.getName();return`<${e} id="${this.id}">`+this.getValue()+`</${e}>`}};function Dt(e){const{name:t,scope:i,rel:n}=e;return"parent"===n?this.getParent(i).getChildren(t):"children"===n?this.getChildren(t):this.model.isPrototype(t)?this.model.getConceptsByPrototype(t):this.model.getConcepts(t)}function jt(e,t){if(g(t))return e;const{target:i,value:n,rel:s}=t;var a=[];return"parent"===s?a.push(e.getParentWith(i)):"children"===s?a.push(...e.getChildren(i)):"property"===s&&a.push(e.getProperty(i)),a.map((e=>jt(e,n))).flat()}const Ot=Object.assign({},Et,It),Rt={SUCCESS:200,INVALID_VALUE:401,MIN_CARDINALITY_ERROR:402,MAX_CARDINALITY_ERROR:403,FIX_CARDINALITY_ERROR:404};function _t(e,t){switch(e){case Rt.INVALID_VALUE:return{success:!1,message:`Valid values: ${t}`};case Rt.MAX_CARDINALITY_ERROR:return{success:!1,message:`Maximum cardinality: ${this.value.length}/${t.value}.`};case Rt.MIN_CARDINALITY_ERROR:return{success:!1,message:`Minimum cardinality: ${this.value.length}/${t.value}.`};case Rt.FIX_CARDINALITY_ERROR:return{success:!1,message:`Fixed cardinality: ${t.value}.`};case Rt.PATTERN_ERROR:return{success:!1,message:"The value is not valid."}}}const Pt={nature:"primitive",init(e={}){return this.parent=e.parent,this.ref=e.ref,this.accept=this.schema.accept,this.ordered=r(this.schema.ordered,!0),this.constraint=this.schema.constraint,this.value=[],this.initObserver(),this.initAttribute(),this.initValue(e.value),this},initValue(e){this.removeAllElement();let t=Mt.call(this);if(g(e)){let e=t;for(let t=0;t<e;t++)this.createElement();return this}const{id:i="",name:n,value:s}=e;i.length>10&&(this.id=i);for(let e=0;e<s.length;e++)this.createElement(s[e]);let a=t-s.length;for(let e=0;e<a;e++)this.createElement();return this},hasValue(){return!o(this.value)},getValue(e=!1){const t=this.value.map((e=>this.model.getConcept(e)));return e?t.map((e=>e.getValue())):t},removeValue(e){return this.hasValue()?(this.removeElement(e),{success:!0,message:"The value has been successfully updated."}):{success:!0,message:"The value has been successfully updated."}},isValidElement(e){const{name:t,accept:i}=this.accept;return this.model.isPrototype(t)?g(i)?this.model.hasPrototype(e.name,t):Array.isArray(i)?i.some((t=>t.name===e.name)):i.name===e.name:this.accept.name===e.name},setValue(e){let t=e.value||e;if(Array.isArray(t)){this.removeAllElement();for(let e=0;e<t.length;e++)this.createElement(t[e]);this.notify("value.changed",t)}else this.isValidElement(t)&&(this.createElement(t),this.notify("value.changed",t))},restore(e){const{value:t}=e;t.forEach(((e,t)=>{this.value.includes(e.id)||this.createElement(e)}))},getElements(){return this.value.map((e=>this.model.getConcept(e)))},getElement(e){var t=this.value.find((t=>t===e));if(!g(t))return this.model.getConcept(t)},getElementAt(e){if(!(e<0||e>=this.value.length))return this.model.getConcept(this.value[e])},getFirstElement(){return this.getElementAt(0)},getLastElement(){return this.getElementAt(this.count-1)},addElement(e){return!g(e)&&(this.value.push(e.id),e.index=this.value.length-1,this.validate(),this.notify("value.added",e),!0)},addElementAt(e,t=0){return g(e)&&(e=this.createElement()),this.value.splice(t,0,e.id),this.validate(),this.notify("value.added",e),this},swapElement(e,t){if(!this.ordered)return this;let i=this.value[e];this.value[e]=this.value[t],this.value[t]=i;let n=this.getElementAt(e);n.index=+e;let s=this.getElementAt(t);return s.index=+t,this.notify("value.swapped",[n,s]),this},removeElement(e){let t=this.value.indexOf(e.id);return-1!==t&&this.removeElementAt(t)},removeElementAt(e){let t=this.getElementAt(e);if(g(t))return{message:`The element at index '${e}' was not found.`,success:!1};t.delete(!0),this.value.splice(e,1);const i=this.getValue();for(let t=e;t<i.length;t++)i[t].index=t;return this.validate(),this.notify("value.removed",t),{message:`The element '${t.name}' was successfully removed.`,success:!0}},removeAllElement(){return this.value.forEach((e=>{this.model.removeConcept(e)})),this.value=[],this.notify("value.changed",this.value),this},createElement(e){const t={value:this.model.getValue(e),parent:this,ref:this},i=this.model.createConcept(this.accept,t);return this.addElement(i),i},getProperty(e,t){if("refname"===e)return this.ref.name;if("name"===e)return this.name;if("value"===e)return this.value;if("length"===e||"cardinality"===e)return this.value.length;let i=this.properties.find((t=>t.name===e));if(g(i))return;const{type:n,value:s}=i;return"string"===n?s:"number"===n?+s:"boolean"===n?T(s):s},hasProperty(e){return!!["refname","name","value","length","cardinality"].includes(e)||-1!==this.properties.findIndex((t=>t.name===e))},getCandidates(){return Ft.call(this,this.accept)},getChildren(e){if(!this.hasValue())return[];const t=this.getElements();return g(e)?t:t.filter((t=>t.name===e))},validate(){if(this.errors=[],!this.hasConstraint())return{code:Rt.SUCCESS};if(this.hasConstraint("cardinality")){let e=this.getConstraint("cardinality");const{type:t}=e;if("range"===t){const{min:i,max:n}=e[t];if(i&&this.value.length<i.value){let e=Rt.MIN_CARDINALITY_ERROR;return this.errors.push(_t.call(this,e,i).message),{code:e,ctx:i}}if(n&&this.value.length>n.value){let e=Rt.MAX_CARDINALITY_ERROR;return this.errors.push(_t.call(this,e,n).message),{code:e,ctx:n}}}else if("fixed"===t){const{value:i}=e[t];if(this.value.length!==i){let i=Rt.FIX_CARDINALITY_ERROR;return this.errors.push(_t.call(this,i,e[t]).message),{code:i,ctx:e[t]}}}}return{code:Rt.SUCCESS}},copy(e=!0){if(!this.hasValue())return null;const t={name:this.name,nature:this.nature,value:this.getValue().map((e=>e.copy(!1)))};return e&&this.model.addValue(t),t},clone(){return{id:this.id,name:this.name,value:this.getValue().map((e=>e.clone()))}},export(){return{id:this.id,name:this.name,root:this.isRoot(),value:this.value}},toString(){return this.getValue().map((e=>e.toString()))},toXML(){let e=this.getName();return`<${e} id="${this.id}">`+this.getValue().map((e=>e.toXML())).join("")+`</${e}>`}};function Mt(){if(!this.hasConstraint("cardinality"))return 0;const e=this.getConstraint("cardinality"),{type:t}=e;if("range"===t){const{min:i}=e[t];return i.value}if("fixed"===t){const{value:i}=e[t];return i}return 0}function Ft(e){return this.model.getConceptSchema(e)}const Vt=Object.assign(Object.create(Et),Pt);Object.defineProperty(Vt,"count",{get(){return this.value.length}}),Object.defineProperty(Vt,"canAddValue",{get:()=>!0});const $t=200,Bt=405;function Ht(e,t){switch(e){case 401:return{success:!1,message:`Valid values: ${t}`};case 403:return{success:!1,message:`Maximum length: ${t.value}.`};case 402:return{success:!1,message:`Minimum length: ${t.value}.`};case 404:return{success:!1,message:`Fixed length: ${t.value}.`};case Bt:return{success:!1,message:"The value is not valid."};case 406:return{success:!1,message:"The value is already used."}}}const Ut={nature:"primitive",initValue(e){if(g(e))return this.value=this.default,this;if(u(e)){const{id:t="",value:i}=e;t.length>10&&(this.id=t),this.setValue(i)}else this.setValue(e);return this},restore(e){const{value:t}=e;this.setValue(t)},hasValue(){return!f(this.value)},getValue(){return this.value},removeValue(){return this.value=null,this.notify("value.changed",this.value),{success:!0,message:"The value has been successfully updated."}},setValue(e){let t=u(e)?e.value:e;var{code:i,ctx:n}=this.validate(t);return this.value!==t&&(this.value=t,this.notify("value.changed",t)),i!==$t?{success:!1,message:"Validation failed."}:{success:!0,message:"The value has been successfully updated."}},getProperty(e,t){if("refname"===e)return this.ref.name;if("name"===e)return this.name;if("value"===e)return this.value;if("length"===e)return this.value.length;let i=this.properties.find((t=>t.name===e));if(g(i))return;const{type:n,value:s}=i;return"string"===n?s:"number"===n?+s:"boolean"===n?T(s):s},hasProperty(e){return!!["refname","name","value","length"].includes(e)||-1!==this.properties.findIndex((t=>t.name===e))},getCandidates(){let e=r(this.getConstraint("values"),[]);return o(e)?[...this.src.map((e=>{if("reference"===e.type){const{source:t,target:i}=e;let n=this.model.environment.getModel(t.name||t);if(g(n))return null;let s=n.concept||n;if(!Array.isArray(s))return null;if(s.forEach((e=>{const t=function(e,t){var i=t;const n=[],s=t=>{let i=e.find((e=>e.name===t));if(!g(i))return dt(i)};for(;!g(i);){const e=r(s(i),{});a=e.attributes,Array.isArray(a)&&a.forEach((e=>{const t=n.find((t=>t.name===e.name));g(t)?n.push(e):e.required&&(t.required=e.required)})),i=e.prototype}var a;return{attributes:n}}(s,e.prototype);e.attributes.push(...t.attributes)})),g(i.rel))return s.map((e=>e[i.value]));let a=qt.call(this,i,s);return g(a)?[]:a}return e}))].flat().filter((e=>!g(e))):e.map((e=>Wt.call(this,e))).flat().filter((e=>!f(e)))},getChildren:e=>[],update:(e,t)=>!0,validate(e){if(this.errors=[],f(e))return{code:$t};if(!this.hasConstraint())return{code:$t};if(this.hasConstraint("length")){let t=this.getConstraint("length");const{type:i}=t;if("range"===i){const{min:n,max:s}=t[i];if(n&&e.length<n.value){let e=402;return this.errors.push(Ht.call(this,e,n).message),{code:e,ctx:n}}if(s&&e.length>s.value){let e=403;return this.errors.push(Ht.call(this,e,s).message),{code:e,ctx:s}}}else if("fixed"===i){const{value:n}=t[i];if(e.length!==n){let e=404;return this.errors.push(Ht.call(this,e,t[i]).message),{code:e,ctx:t[i]}}}}if(this.hasConstraint("value")){let t=this.getConstraint("value");const{type:i}=t;if("pattern"===i){const{value:i,insensitive:n=!0,global:s=!0}=t.pattern;let a="";if(n&&(a+="g"),s&&(a+="i"),!new RegExp(i,a).test(e)){let e=Bt;return this.errors.push(Ht.call(this,e,t.pattern).message),{code:e,ctx:t.pattern}}}else if(i==="match".startsWith){const{start:n,end:s}=t[i];if(n&&!e.startsWith<n.value){let e=Bt;return this.errors.push(Ht.call(this,e,t.match).message),{code:e,ctx:t.match}}if(s&&e.length>s.value){let e=Bt;return this.errors.push(Ht.call(this,e,t.match).message),{code:e,ctx:t.match}}}else if("unique"===i){const{rel:i="parent",prototype:n}=t.unique;let s=this.getParent(),a=[];if(n?(s.hasPrototype()||(a=[]),a=this.model.getConceptsByPrototype(s._prototype)):a=this.model.getConcepts(s.name),a.some((t=>t!==s&&Xt(t,this.ref.name)===e))){let e=406;return this.errors.push(Ht.call(this,e,t.unique).message),{code:e,ctx:t.unique}}}}if(this.hasConstraint("values")){let t=this.getConstraint("values").map((e=>Wt.call(this,e))).flat(),i=!1;for(let n=0;!i&&n<t.length;n++){const s=t[n];i=u(s)?s.value===e:s===e}if(!i){let e=401;return this.errors.push(Ht.call(this,e,t).message),{code:e,ctx:t}}}return{code:$t}},copy(e=!0){if(!this.hasValue())return null;const t={name:this.name,nature:this.nature,value:this.getValue()};return e&&this.model.addValue(t),t},clone(){return{id:this.id,name:this.name,value:this.getValue()}},export(){return{id:this.id,name:this.name,root:this.isRoot(),value:this.getValue()}},toString(){return this.value},toXML(){let e=this.getName();return`<${e} id="${this.id}">`+this.getValue()+`</${e}>`}};function Wt(e){if("reference"===e.type){let e=[];return this.model.isPrototype("model concept")&&(e=this.model.getConceptsByPrototype("model concept")),e.map((e=>e.getChildren(this.name))).flat().map((e=>e.value))}if("meta-reference"===e.type){let e=[];return this.model.isPrototype("model concept")&&(e=this.model.getConceptsByPrototype("model concept")),e.map((e=>e.getChildren(this.name))).flat().map((e=>e.value))}return e}function qt(e,t){const{name:i,rel:n,scope:s,value:a}=e;let r=null;if("parent"===n){let e=this.getParent(i);if(g(a))return e;if("reference"===a.type)return qt.call(e,a);if("attribute"===a.type)return e.getAttributeByName(a.name).getValue()}if("children"===n){let e=this.getChildren(i);if(g(a))return e;if("reference"===a.type)return e.map((e=>qt.call(e,a)));if("attribute"===a.type)return e.filter((e=>Jt(e,a.name)&&Gt(e,a.name))).map((e=>Xt(e,a.name)))}if(e.source){const{type:t,value:i}=e.source;r="reference"===t?qt.call(this,e.source):i}if(g(r))return t.map((e=>e[i].map((e=>e[a]))));if(d(r)&&o(r))return[];let l=t.find((e=>Array.isArray(r)?r.includes(e.name):e.name===r));return g(l)||!k(l,i)?[]:l[i].map((e=>e[a]))}const zt=(e,t)=>e.getAttributeByName(t).target,Xt=(e,t)=>zt(e,t).getValue(),Gt=(e,t)=>zt(e,t).hasValue(),Jt=(e,t)=>e.isAttributeCreated(t),Yt=Object.assign(Object.create(Et),Ut),Kt={nature:"concrete",initValue(e){if(g(e))return!1;const{id:t="",attributes:i=[]}=e;return t.length>10&&(this.id=t),i.forEach((e=>{const{name:t,id:i,value:n}=e;this.createAttribute(t,n)})),!0},restore(e){const{attributes:t}=e;t.forEach((e=>{const{name:t,id:i,value:n}=e;this.isAttributeCreated(t)||this.createAttribute(t,n)}))},hasValue:()=>!0,getValue(){return{name:this.name,attributes:this.getAttributes().map((e=>({name:e.name,value:e.copy(!1)})))}},setValue(e){const{attributes:t=[]}=e;return t.forEach((e=>{const{name:t,id:i,value:n}=e;this.hasAttribute(t)&&this.createAttribute(t,n)})),!0}},Qt=Object.assign(Object.create(Et),Kt),Zt=200;function ei(e){switch(e){case 401:return{success:!1,message:"The value is not included in the list of valid values."}}}const ti={name:"prototype",nature:"prototype",initValue(e){if(g(e)){if(this.default){let e=this.createConcept(this.default);this.setValue(e)}return this}const{id:t="",value:i}=e;t.length>10&&(this.id=t);let n=null;return i?(n=this.createConcept(i.name,i),this.setValue(n)):e.name&&e.attributes&&(n=this.createConcept(e.name,e),this.setValue(n)),this},getValue(e=!1){return g(this.value)?null:e?this.target:this.value},getTarget(){return this.target},restore(e){const{value:t}=e;if(g(t))return;let i=this.createConcept(t.name,t);this.setValue(i)},setValue(e){let t=e.name||e;if(this.validate(t)!==Zt)return{success:!1,message:"Validation failed: The value could not be updated."};let i=e;if(e&&"concept"===e.object&&k(e,"id")||(i=e.attributes?this.createConcept(t,e):this.createConcept(t)),this.target){let e=this.target.copy(!1);this.target.delete(!0),i.setValue(e)}return this.target=i,this.value=t,this.notify("value.changed",this.value),{success:!0,message:"The value has been successfully updated."}},removeValue(){return g(this.value)||(this.value=null,this.notify("value.changed",this.value)),{success:!0,message:"The value has been successfully updated."}},hasValue(){return!g(this.value)},getCandidates(){return this.candidates||(this.candidates=ii.call(this,this.schema.accept).map((e=>({type:"meta-concept",name:e.name,concept:Object.create(ni,{object:{value:"meta-concept"},type:{value:"meta-concept"},name:{value:e.name},model:{value:this.model},schema:{value:e}})})))),this.candidates},getChildren(e){if(!this.hasValue())return[];const t=[];return(g(e)||this.target.name===e)&&t.push(this.target),t},createConcept(e,t){let i=this.model.getValue(t);const n={parent:this,ref:this};i&&(n.value=i);const s=this.model.createConcept(e,n);return s.prototype=this,s},validate(e){if(f(e))return Zt;if(o(this.values))return Zt;var t=!1;for(let i=0;!t&&i<this.values.length;i++){const n=this.values[i];t=u(n)?n.value===e:n===e}if(!t){let e=401;return this.errors.push(ei.call(this,e).message),e}return Zt},copy(e=!0){if(!this.hasValue())return null;const t={name:this.name,nature:this.nature,value:this.target.copy(!1)};return e&&this.model.addValue(t),t},clone(){let e=null;return this.hasValue()&&(e=this.target.clone()),{id:this.id,name:this.name,value:e}},export(){let e=null;return this.hasValue()&&(e={id:this.target.id,name:this.target.name}),{id:this.id,name:this.name,root:this.isRoot(),value:e}},toXML(){if(!this.hasValue())return"";let e=this.getName();return`<${e} id="${this.id}">`+this.target.attributes.map((e=>e.toXML())).join("")+`</${e}>`}};function ii(e){const t=this.model.getConcreteConcepts(this.name);return g(e)?t:Array.isArray(e)?t.filter((t=>e.some((e=>e.name===t.name)))):t.filter((t=>e===t.name))}const ni={getProperty(e,t){if("refname"===e)return this.name;if("name"===e)return this.name;let i=this.properties.find((t=>t.name===e));if(g(i))return;const{type:n,value:s}=i;return"string"===n?s:"number"===n?+s:"boolean"===n?T(s):s},hasPrototype(e){if(g(this.schema.prototype))return!1;let t=this.model.getConceptSchema(this.schema.prototype);for(;!g(t);){if(t.name===e)return!0;t=this.model.getConceptSchema(t.prototype)}return!1}},si=Object.assign({},Et,ti);function ai(e){switch(e){case 401:return{success:!1,message:"The value is not included in the list of valid values."}}}const ri={name:"meta",reference:null,initValue(e){return g(e)||this.setValue(e.value),this},hasValue(){return!f(this.value)},getValue(){return g(this.value)?null:this.value},getProperty(e){const t=this.schema[e];if(u(t)){const e=[];for(const i in t){const n=t[i];e.push(Object.assign({},{name:i},n))}return e}return t},setValue(e){var t=this.validate(e);return 200!==t?{success:!1,message:"Validation failed: The value could not be updated.",errors:[ai(t).message]}:g(e)||this.value===e?void 0:(this.reference&&this.reference.unregister(this),this.reference=this.model.getConcept(e),this.reference.register(this),this.value=e,this.notify("value.changed",this.reference),{success:!0,message:"The value has been successfully updated."})},getChildren:e=>[],delete(e=!1){if(!e){let e=this.getParent().remove(this);if(!e.success)return e}return this.reference&&this.reference.unregister(this),this.model.removeConcept(this.id),this.notify("delete"),{message:`The concept '${name}' was successfully deleted.`,success:!0}},update(e,t){switch(e){case"delete":this.reference.unregister(this),this.value=null,this.reference=null,this.notify("value.changed",this.reference)}return!0},validate(e){return f(e)||o(this.values),200},export(){return{id:this.id,name:this.name,value:this.value}},toString(){var e=[];return this.value.forEach((t=>{e.push(t.toString())})),e}},oi=Object.assign({},Et,ri);function li(e,t){return{object:{value:"concept"},type:{value:"concept"},model:{value:e},name:{value:t.name},base:{value:t.base},schema:{value:t,writable:!0}}}const ci={boolean:(e,t)=>Object.create(Nt,li(e,t)),number:(e,t)=>Object.create(St,li(e,t)),reference:(e,t)=>Object.create(Ot,li(e,t)),set:(e,t)=>Object.create(Vt,li(e,t)),string:(e,t)=>Object.create(Yt,li(e,t)),meta:(e,t)=>Object.create(oi,li(e,t))},hi={primitive:(e,t)=>ci[t.name](e,t),prototype:(e,t)=>Object.create(si,li(e,t)),concrete:(e,t)=>Object.create(Qt,li(e,t)),derivative:(e,t)=>ci[t.base](e,t)},ui={createConcept(e,t,i){const{name:n,nature:s}=t,a=hi[s];if(g(a))throw new Error(`Missing handler: The '${n}' concept could not be handled`);const r=a(e,t);if(g(r))throw new Error(`Bad request: The '${n}' concept could not be created`);return r.init(i),g(r.id)&&(r.id=pt.generate()),r}};var di=0;const pi={concepts:null,values:null,listeners:null,get hasError(){return this.concepts.some((e=>e.hasError))},init(e){return this.concepts=[],this.values=[],this.listeners=[],Array.isArray(e)&&(this.values=e,e.filter((e=>e.root)).forEach((e=>{this.createConcept({name:e.name},{value:e})})),this.values=e.filter((e=>e.id.startsWith("value")))),this},done(){return this.concepts.forEach((e=>{e.unregisterAll()})),this.concepts=[],!0},createConcept(e,t){const i=this.getCompleteModelConcept(e);var n=ui.createConcept(this,i,t);return this.addConcept(n),n},getConcepts(e){if(d(e)){const t=Array.isArray(e)?t=>e.includes(t.name):t=>t.name===e;return this.concepts.filter((e=>t(e)))}return this.concepts.slice()},getRootConcepts(){return this.concepts.filter((e=>e.isRoot()))},getConceptsByPrototype(e){return this.concepts.filter((t=>t.hasPrototype(e)))},getConcept(e){if(!c(e)||o(e))throw new TypeError("Bad request: The 'id' argument must be a non-empty string");return this.concepts.find((t=>t.id===e))},addConcept(e){if(g(e))throw new TypeError("Bad request: The 'concept' argument must be a Concept");return this.concepts.push(e),e.register(this.environment),this},removeConcept(e){if(!u(e)&&!c(e))throw new TypeError("Bad request: The 'id' argument must be a non-empty string");var t=this.concepts.findIndex((t=>t.id===e));return-1===t?null:this.concepts.splice(t,1)[0]},hasConcept(e){if(!u(e)&&!c(e))throw new TypeError("Bad request: The 'id' argument must be a non-empty string");if(o(this.concepts))return!1;let t=e.id||e;return e.name,this.concepts.some((e=>e.id===t))},getValues(e){if(d(e)){const t=Array.isArray(e)?t=>e.includes(t.name):t=>t.name===e;return this.values.filter((e=>t(e)))}return this.values.slice()},getValue(e){return g(e)?null:k(e,"value")||k(e,"attributes")?e:k(e,"id")?this.values.find((t=>t.id===e.id)):this.values.find((t=>t.id===e))},addValue(e){if(g(e))throw new TypeError("Bad request: The 'value' argument must be a Value");return this.values.some((t=>{return n=e,(i=t).name===n.name&&(i.value?i.value===n.value:JSON.stringify(i.attributes)===JSON.stringify(n.attributes));var i,n}))||(e.id="value"+di++,this.values.push(e),this.notify("value.added",e)),this},removeValue(e){if(!u(e)&&!c(e))throw new TypeError("Bad request: The 'id' argument must be a non-empty string");var t=this.values.findIndex((t=>t.id===e));if(-1===t)return null;let i=this.values.splice(t,1)[0];return this.notify("value.removed",i),i},register(e){return this.listeners.includes(e)||this.listeners.push(e),!0},unregister(e){let t=this.listeners.indexOf(e);return-1!==t&&(this.listeners.splice(t,1),!0)},unregisterAll(){this.listeners=[]},notify(e,t){this.listeners.forEach((i=>{i.update(e,t)}))},isConcept(e){return!!c(e)&&-1!==this.schema.findIndex((t=>t.name===e))},isConcrete(e){if(!c(e))return!1;const t=this.schema.find((t=>t.name===e));return!g(t)&&"concrete"===t.nature},isPrototype(e){if(!c(e))return!1;const t=this.schema.find((t=>t.name===e));return!g(t)&&"prototype"===t.nature},hasPrototype(e,t){if(!this.isConcept(e))return!1;let i=this.getConceptSchema(e);for(;!g(i);){if(i.prototype===t)return!0;i=this.model.getConceptSchema(i.prototype)}return!1},getSchema(e){if(d(e)){const t=Array.isArray(e)?t=>e.includes(t.nature):t=>t.nature===e;return this.schema.filter((e=>t(e)))}return this.schema.slice()},getConceptSchema(e){const t=vi(this.schema,e);if(!g(t))return dt(t)},getCompleteModelConcept(e){let t=e;c(e)&&(t={name:e});const i=this.getConceptSchema(t.name);if(g(i))return;Object.assign(i,t),k(i,"attributes")||(i.attributes=[]);const n=mi.call(this,i.prototype);return i.attributes.push(...n.attributes),i},getConcreteConcepts(e){const t=t=>{for(var i=t.prototype;!g(i);){if(i===e)return!0;i=r(vi(this.schema,i),{}).prototype}return!1},i=this.schema.filter((e=>"concrete"===e.nature));return e?i.filter((e=>t(e))):i},getDerivedConcepts(e){if(g(e))throw new TypeError("Bad argument");return this.schema.filter((t=>t.base===e))},export(){const e=[];return this.getConcepts().forEach((t=>{e.push(t.export())})),e.push(...this.getValues()),e},toString(){return JSON.stringify({[this.root.name]:this.root.toString()})},toXML(){return"<model:gentleman>"+this.getRootConcepts().map((e=>e.toXML())).join("")+"</model:gentleman>"}};function mi(e){var t=e;const i=[];for(;!g(t);){const e=r(this.getConceptSchema(t),{});n=e.attributes,Array.isArray(n)&&n.forEach((e=>{const t=i.find((t=>t.name===e.name));g(t)?i.push(e):e.required&&(t.required=e.required)})),t=e.prototype}var n;return{attributes:i}}const fi=[{name:"string",nature:"primitive"},{name:"number",nature:"primitive"},{name:"boolean",nature:"primitive"},{name:"reference",nature:"primitive"},{name:"set",nature:"primitive"}];function vi(e,t){let i=e.find((e=>e.name===t));return g(i)&&(i=fi.find((e=>e.name===t))),i}const gi=[],bi={createModel(e,t){var i=Object.create(pi,{schema:{value:e},environment:{value:t}});return gi.push(i),i}};function yi(e){const{type:t}=e;let i=this.concept||this.source;return"property"===t?r(i.getProperty(e.name),""):"param"===t?this.projection.getParam(e.name):e}const wi={css:function(e,t){return d(t)?(Ni(e,t),e):e},ref:function(e,t){return d(t)?(t.forEach((t=>{const{style:i={}}=r(this.model.getStyleSchema(t),{});i.gss?xi.call(this,e,i):Ei.call(this,e,i)})),e):e},gss:Ei,text:Ti,box:Si,html:function(e,t){return d(t)?(t.forEach((t=>{let i=`style${n=t.name,f(n)?n:n.charAt(0).toUpperCase()+n.slice(1)}`;var n;e.dataset[i]=yi.call(this,t.value),"property"===t.value.type&&this.registerHandler("value.changed",(n=>{e.dataset[i]=yi.call(this,t.value)}))})),e):e}},ki={text:Ti,box:Si};function xi(e,t){if(!u(t))return e;for(const i in t){const n=t[i];let s=wi[i];h(s)&&s.call(this,e,n)}return e}function Ei(e,t){if(!u(t))return e;for(const i in t){const n=t[i];let s=ki[i];h(s)&&s.call(this,e,n)}return e}function Ti(e,t){for(const i in t){const n=t[i];if(!1!==n)switch(i){case"bold":e.style.fontWeight=Ci(n);break;case"italic":e.style.fontStyle="italic";break;case"underline":e.style.textDecoration="underline";break;case"strikethrough":e.style.textDecoration="line-through";break;case"color":e.style.color=Ai(n);break;case"font":e.style.fontFamily=n.toString();break;case"size":e.style.fontSize=Li(n);break;case"transform":e.style.textTransform=n}}return e}function Ni(e,t){if(Array.isArray(t))e.classList.add(...t);else{let i=t.replace(/\s+/g," ").trim();f(e.className)?e.className=i:Ni(e,i.split(" "))}return e}function Ai(e){if(g(e))return"";const{type:t,value:i}=e;switch(t){case"rgb":return u(i)?`rgb(${i.red}, ${i.green}, ${i.blue})`:i;case"rgba":return u(i)?`rgba(${i.red}, ${i.green}, ${i.blue}, ${i.opacity/100})`:i;case"name":case"hexadecimal":return i;default:return i||e}}function Ci(e){if(g(e))return"";const{type:t,value:i}=e;return Number.isInteger(e)?`${e}`:"bold"}function Li(e){if(g(e))return"";const{value:t,unit:i}=e;return g(t)?"":`${t}${i}`}function Si(e,t){for(const i in t){const n=t[i];if(!1!==n)switch(i){case"inner":Ii.call(this,e,n,"padding");break;case"outer":Ii.call(this,e,n,"margin");break;case"border":Oi.call(this,e,n);break;case"corner":Ri.call(this,e,n);break;case"background":Di.call(this,e,n);break;case"width":e.style.width=Li.call(this,n);break;case"height":e.style.height=Li.call(this,n);break;case"opacity":e.style.opacity=n/100;break;case"shadow":ji.call(this,e,n,"shadow")}}return e}function Ii(e,t,i){if(!g(t))for(const n in t){const s=t[n];switch(n){case"all":e.style[`${[i]}`]=Li.call(this,s);break;case"top":e.style[`${[i]}Top`]=Li.call(this,s);break;case"right":e.style[`${[i]}Right`]=Li.call(this,s);break;case"bottom":e.style[`${[i]}Bottom`]=Li.call(this,s);break;case"left":e.style[`${[i]}Left`]=Li.call(this,s)}}}function Di(e,t){if(g(t))return;const{color:i,image:n}=t;i&&(e.style.backgroundColor=Ai.call(this,i)),n&&(e.style.backgroundImage=`url(${n})`)}function ji(e,t){if(g(t))return null;const{offsetX:i,offsetY:n,blur:s,spread:a,inset:r=!1,color:o}=t;if(g(i)||g(n))return null;let l=Li.call(this,i),c=Li.call(this,n),h=Li.call(this,s),u=Li.call(this,a),d=Ai.call(this,o);e.style.boxShadow=r?`inset ${l} ${c} ${h} ${u} ${d}`.trim():`${l} ${c} ${h} ${u} ${d}`.trim()}function Oi(e,t){if(!g(t))for(const i in t){const n=t[i];switch(i){case"all":e.style.borderStyle=r(n.type,"solid"),e.style.borderWidth=Li.call(this,n.width),e.style.borderColor=Ai.call(this,n.color);break;case"top":e.style.borderTopStyle=r(n.type,"solid"),e.style.borderTopWidth=Li.call(this,n.width),e.style.borderTopColor=Ai.call(this,n.color);break;case"right":e.style.borderRightStyle=r(n.type,"solid"),e.style.borderRightWidth=Li.call(this,n.width),e.style.borderRightColor=Ai.call(this,n.color);break;case"bottom":e.style.borderBottomStyle=r(n.type,"solid"),e.style.borderBottomWidth=Li.call(this,n.width),e.style.borderBottomColor=Ai.call(this,n.color);break;case"left":e.style.borderLeftStyle=r(n.type,"solid"),e.style.borderLeftWidth=Li.call(this,n.width),e.style.borderLeftColor=Ai.call(this,n.color)}}}function Ri(e,t){if(g(t))return null;for(const i in t){const n=t[i];switch(i){case"all":e.style.borderRadius=Li.call(this,n);break;case"top-left":e.style.borderTopLeftRadius=Li.call(this,n);break;case"top-right":e.style.borderTopRightRadius=Li.call(this,n);break;case"bottom-right":e.style.borderBottomRightRadius=Li.call(this,n);break;case"bottom-left":e.style.borderBottomLeftRadius=Li.call(this,n)}}}function _i(e,t){if(!Array.isArray(t))return!1;e.currentState=null;for(let i=0;i<t.length;i++){const n=t[i],{rule:s,result:a}=n;if(g(s))return a;let r=!1,o=Pi[s.type];if(h(o)&&(r=o.call(this,s[s.type])),r)return e.currentState=i,a}return null}const Pi={ref:function(e){const{rule:t={}}=r(this.model.getRuleSchema(e),{});let i=Pi[t.type];return!!h(i)&&i.call(this,t[t.type])},eq:function(e){if(!Array.isArray(e))throw new TypeError("Terms need to be an array");if(e.length<2)return null;return Mi.call(this,e[0])==Mi.call(this,e[1])},ne:function(e){if(!Array.isArray(e))throw new TypeError("Terms need to be an array");if(e.length<2)return null;return Mi.call(this,e[0])!=Mi.call(this,e[1])},lt:function(e){if(!Array.isArray(e))throw new TypeError("Terms need to be an array");if(e.length<2)return null;return Mi.call(this,e[0])<Mi.call(this,e[1])},le:function(e){if(!Array.isArray(e))throw new TypeError("Terms need to be an array");if(e.length<2)return null;return Mi.call(this,e[0])<=Mi.call(this,e[1])},gt:function(e){if(!Array.isArray(e))throw new TypeError("Terms need to be an array");if(e.length<2)return null;return Mi.call(this,e[0])>Mi.call(this,e[1])},ge:function(e){if(!Array.isArray(e))throw new TypeError("Terms need to be an array");if(e.length<2)return null;return Mi.call(this,e[0])>=Mi.call(this,e[1])},and:function(e){return Fi.call(this,e[0])&&Fi.call(this,e[1])},or:function(e){return Fi.call(this,e[0])||Fi.call(this,e[1])},not:function(e){return!Fi.call(this,e[0])},no:function(e){let t=Mi.call(this,e);return d(t)?o(t):g(t)}};function Mi(e,t){if(e&&"property"===e.type){const{name:t}=e;let i=`get${E(t)}`;return this[i]?this[i]():this[t]}if(e&&"param"===e.type){const{name:t}=e;return this.projection.getParam(t)}if(u(e)){let t=`get${E(e.prop)}`;return this[t]?this[t]():this[e.prop]}return t||e}function Fi(e){let t=Pi[e.type];return h(t)?t.call(this,e[e.type]):T(Mi.call(this,e))}const Vi={init(){throw new Error("This function has not been implemented")},element:null,statusElement:null,attached:null,children:null,readonly:!1,visible:!1,disabled:!1,active:!1,focused:!1,get hasError(){return this.source.hasError},get hasAttached(){return!o(this.attached)},attach(e,t){this.attached.push(e)},detach(e){this.attached.slice(this.attached.indexOf(e),1)},getAttached(e){return h(e)?this.attached.filter((t=>e(t))):this.attached},show(){return We(this.element),this.visible=!0,this.active=!0,this},hide(){return qe(this.element),this.visible=!1,this},toggle(){return ze(this.container),this.visible=!this.visible,this},focus(e){return this.element.contentEditable=!1,this.element.focus(),this.focused=!0,this},getContainer(){return this.element},notify(e,t,i){Xe(this.element),this.environment.notify(e,t)},append(e){if(!L(e))throw new TypeError("Bad argument: The 'element' argument must be an HTML Element");return this.element.append(e),this},_focusIn:e=>!1,enable(){return this.disabled=!1,this},disable(){return this.disabled=!0,this},clear:()=>!0,delete(){var e=this.source.delete();e.success?(this.clear(),Ae(this.element),this.element.remove()):(this.environment.notify(e.message),Xe(this.element))},spaceHandler(e){return console.warn(`SPACE_HANDLER NOT IMPLEMENTED FOR ${this.name}`),!1},_spaceHandler(e){return console.warn(`CTRL_SPACE_HANDLER NOT IMPLEMENTED FOR ${this.name}`),!1},escapeHandler(e){return console.warn(`ESCAPE_HANDLER NOT IMPLEMENTED FOR ${this.name}`),!1},enterHandler(e){this.focusOut()},deleteHandler(e){if(this.projection.element!==this)return Xe(e),!1;if(!this.projection.optional)return Xe(this.element),!1;let t=Ee(e,(e=>0===e.tabIndex)),i=this.container.cloneNode(!0);this.source.hasParent()&&this.environment.save(this.source.getParent(),i),this.source.delete();let n=this.environment.resolveElement(t);return g(n)||n.focus(),!1},backspaceHandler(e){return console.warn(`BACKSPACE_HANDLER NOT IMPLEMENTED FOR ${this.name}`),!1},arrowHandler(e,t){return console.warn(`ARROW_HANDLER NOT IMPLEMENTED FOR ${this.name}`),!1},_arrowHandler(e,t){return console.warn(`CTRL_ARROW_HANDLER NOT IMPLEMENTED FOR ${this.name}`),!1},clickHandler(e){return console.warn(`CLICK_HANDLER NOT IMPLEMENTED FOR ${this.name}`),!1},controlHandler(e){this.toolbar&&this.toolbar.remove()},shiftHandler(e,t){return console.warn(`SHIFT_HANDLER NOT IMPLEMENTED FOR ${this.name}`),!1}},$i=Object.assign(Vi);function Bi(e){if(!L(e))return!1;const{nature:t,id:i}=e.dataset;return"field-component"===t&&i===this.id}i(779);const Hi={init(){return this.elements=new Map,this},render(){const e=$(),{content:t="Add",items:i}=this.schema;L(this.element)||(this.element=z({id:this.id,class:["field","add-button"],tabindex:-1,dataset:{nature:"field",view:"list",id:this.id}}),this.readonly&&this.element.classList.add("readonly"),xi.call(this.projection,this.element,this.schema.style));let n=ce({class:["field-action","field--list__add"],tabindex:0,dataset:{nature:"field-component",view:"list",component:"action",id:this.id,action:"add"}});return g(i)||(this.item=i),n.append(t),e.appendChild(n),e.hasChildNodes()&&this.element.append(e),this.bindEvent(),this.element},focusIn(){},clickHandler(e){const t=(e=>Bi.call(this,e)?e:Ee(e,(e=>Bi.call(this,e)),5))(e);if(g(t))return;const{action:i,index:n,name:s}=t.dataset;"add"===i?(this.parent.prio=this.element,this.createElement()):"remove"===i&&this.delete(t.parentElement),this.parent.prio=this.element},createElement(){this.source.createElement()},addItem(e){return this.parent.addItem(e,this),this},removeItem(e){this.parent.removeItem(e)},refresh(){this.element&&this.source.getValue().forEach((e=>{this.addItem(e)}))},focusOut(){},bindEvent(){this.projection.registerHandler("value.added",(e=>{this.addItem(e)})),this.projection.registerHandler("value.removed",(e=>{this.removeItem(e)}))}},Ui=Object.assign(Object.create($i),Hi);function Wi(e){const{type:t}=e;return"property"===t?(this.hasProperty=!0,r(this.source.getProperty(e.name),"")):"param"===t?this.projection.getParam(e.name):"html"===t?j(e.html):"raw"===t?j(e.raw):e}const qi={input:null,label:null,value:"",state:null,init(){const{focusable:e=!0}=this.schema;return this.focusable=e,this.children=[],this},refresh(){if(r(_i.call(this,this.schema,this.schema.state),this.schema),this.schema.state){let e=this.schema.state[this.getValue().toString()];if(e&&e.content){const{style:t,content:i,value:n}=e;let s=$();i.forEach((e=>{s.append(rs.call(this,e))})),Ae(this.label).append(s),xi.call(this.projection,this.label,t)}}this.input.checked?this.element.dataset.state="on":this.element.dataset.state="off",this.hasError?(this.element.classList.add("error"),this.input.classList.add("error")):(this.element.classList.remove("error"),this.input.classList.remove("error"))},render(){const e=$(),{checkbox:t}=this.schema;var i;if(L(this.element)||(this.element=(i=this.id,z({id:i,class:["field","field--binary"],tabindex:-1,dataset:{nature:"field",view:"binary",id:i}})),this.readonly&&this.element.classList.add("readonly"),xi.call(this.projection,this.element,this.schema.style)),!L(this.input)){if(this.input=function(e){return ne({id:`checkbox${e}`,type:"checkbox",class:["field--binary__input"],tabindex:0,dataset:{nature:"field-component",view:"binary",id:e}})}(this.id),this.input.checked=this.source.getValue(),this.value=this.input.checked,this.readonly&&(this.input.classList.add("readonly"),this.input.disabled=!0),t){const{style:e}=t;xi.call(this.projection,this.input,e)}else qe(this.input);e.append(this.input)}if(!L(this.label)){if(this.label=ae({class:["field--checkbox__label"],for:this.input.id,tabindex:0,dataset:{nature:"field-component",view:"binary",id:this.id}}),this.label.htmlFor=this.input.id,t&&t.label){const{content:e}=t.label;if(Array.isArray(e))e.forEach((e=>{let t=Wi.call(this,e),i=ee({class:["field--checkbox__label-content"],dataset:{ignore:"all"}},t);xi.call(this.projection,i,e.style),this.label.append(i)}));else{let t=Wi.call(this,e);this.label.append(t)}xi.call(this.projection,this.label,t.label.style)}e.append(this.label)}return e.hasChildNodes()&&(this.element.append(e),this.bindEvents()),this.refresh(),this.element},focusIn(){return this.focused=!0,this.value=this.input.checked,this.element.classList.add("active"),this},focusOut(){if(!this.readonly)return this.hasChanges()&&this.setValue(this.input.checked),this.messageElement&&(qe(this.messageElement),Ae(this.messageElement)),this.choice&&qe(this.choice),this.input.blur(),this.element.classList.remove("active"),this.refresh(),this.focused=!1,this},hasChanges(){return this.value!==this.input.checked},hasValue(){return this.input.checked},getValue(){return this.input.checked},setValue(e,t=!1){var i;(i=t?this.source.setValue(e):{success:!0}).success||this.environment.notify(i.message,"error"),this.input.checked=e,this.value=e,this.refresh()},getCandidates(){return this.source.getCandidates()},enable(){this.input.disabled=!1,this.input.tabIndex=0,this.disabled=!1},disable(){this.input.disabled=!0,this.input.tabIndex=-1,this.disabled=!0},escapeHandler(e){let t=!0;if(this.messageElement&&!Ze(this.messageElement)&&(qe(this.messageElement),t=!1),t){let t=Ee(e,(e=>0===e.tabIndex));return this.environment.resolveElement(t).focus(t),!0}},backspaceHandler(e){return this.arrowHandler("left",e)},enterHandler(e){this.setValue(!this.input.checked,!0)},arrowHandler(e,t){return!!this.parent&&this.parent.arrowHandler(e,this.element)},bindEvents(){this.element.addEventListener("change",(e=>{this.setValue(this.getValue(),!0)})),this.projection.registerHandler("value.changed",(e=>{this.setValue(e)}))}},zi=Object.assign(Object.create($i),qi);function Xi(e){const t=e=>e.parentElement===this.choices;return t(e)?e:Ee(e,t,5)}function Gi(e){const{type:t}=e.dataset;return t}function Ji(e){const{type:t,value:i}=e.dataset;return"concept"===t?this.values.find((e=>e.id===i)).id:"meta-concept"===t?this.values.find((e=>e.name===i)).name:"value"===t?i:"placeholder"===t?null:i}const Yi=(e,t)=>"concept"===e.type?Yi(e.id,t):"concept"===t.type?Yi(e,t.id):"meta-concept"===e.type?Yi(e.name,t):"meta-concept"===t.type?Yi(e,t.name):e===t,Ki={value:null,placeholder:null,expanded:null,values:null,choices:null,input:null,items:null,selection:null,selectList:null,selectListValue:null,icoToggle:null,init(){const{focusable:e=!0,placeholder:t=!1,expanded:i=!0}=this.schema;return this.items=new Map,this.focusable=e,this.expanded=i,this.placeholder=t,this.children=[],k(this.schema,"choice")||(this.schema.choice={}),k(this.schema.choice,"option")||(this.schema.choice.option={}),this},hasChanges(){return this.value!=this.source.getValue()},reset(){this.source.removeValue()},hasValue(){return!g(this.value)},getValue(){return this.selection},setValue(e,t=!1){var i=null;if(t)return(i=this.source.setValue(e)).success||this.environment.notify(i.message,Ye.ERROR),!0;g(e)?(this.selection&&this.selection.classList.remove("selected"),this.expanded||Ae(this.selectListValue),this.selection=null):this.setChoice(e),g(e)?this.value=null:"concept"===e.type?this.value=e.id:"meta-concept"===e.type?this.value=e.name:this.value=e;const{template:n={}}=this.schema.choice.option;if(this.selection&&!this.expanded&&e)if(Ae(this.selectListValue),"meta-concept"===e.type){let t=this.model.getProjectionSchema(e.concept,r(n.tag))[0],i=t.type,s={type:i,[i]:t.content||t.projection},a=rs.call(this,s,e.concept,{focusable:!1,meta:e.name});this.selectListValue.append(a)}else if("concept"===e.type){let t=this.model.createProjection(e,n.tag).init({focusable:!1});t.readonly=!0,t.focusable=!1,t.parent=this.projection,this.selectListValue.append(t.render())}else this.selectListValue.append(e.toString());this.refresh()},refresh(){return this.hasValue()?(this.element.classList.remove("empty"),this.element.dataset.value=this.value.name||this.value):(this.element.classList.add("empty"),this.element.dataset.value="",!this.expanded&&this.placeholder&&Ae(this.selectListValue).append(this.placeholder)),this.input&&(this.element.dataset.input=this.input.value),this.element.classList.remove("querying"),this.hasError?(this.element.classList.add("error"),this.input&&this.input.classList.add("error")):(this.element.classList.remove("error"),this.input&&this.input.classList.remove("error")),this},render(){const e=$(),{choice:t,input:i,style:n}=this.schema;if(L(this.element)||(this.element=z({id:this.id,class:["field","field--choice"],tabindex:-1,dataset:{nature:"field",view:"choice",input:"",id:this.id}})),!L(this.input)&&i){const{placeholder:t="",type:n,style:s}=i;let a=is.call(this,t);this.input=ne({class:["field--choice__input"],type:r(n,"text"),placeholder:a,title:a,dataset:{nature:"field-component",view:this.type,id:this.id}}),xi.call(this,this.input,s),e.append(this.input)}if(!L(this.choices)){const{style:i}=t;this.choices=J({class:["bare-list","field--choice__choices"],tabindex:-1,dataset:{nature:"field-component",view:"choice",id:this.id}}),xi.call(this,this.choices,i),e.append(this.choices)}if(!this.expanded){let t=z({class:["field--choice__select-wrapper"],tabindex:-1,dataset:{nature:"field-component",view:"choice",id:this.id}});this.selectListValue=z({class:["field--choice__select-value"],tabindex:-1,dataset:{nature:"field-component",view:"choice",id:this.id}}),this.icoToggle=ie({class:["field--choice__select-icon"],dataset:{nature:"field-component",view:"choice",id:this.id}}),t.append(this.selectListValue,this.icoToggle),this.selectList=z({class:["field--choice__select-list","hidden"],dataset:{nature:"field-component",view:"choice",id:this.id}}),this.input&&this.selectList.append(this.input),this.selectList.append(this.choices),e.append(t),e.append(this.selectList)}if(xi.call(this,this.element,n),e.hasChildNodes()&&(this.element.append(e),this.bindEvents()),Ae(this.choices),this.placeholder){const{style:e}=this.schema.choice.option;let t=Y({class:["field--choice__choice","field--choice__choice--placeholder"],tabindex:0,dataset:{nature:"field-component",view:"choice",id:this.id,type:"placeholder"}},this.placeholder);this.choices.append(t),xi.call(this,t,e)}return this.values=this.source.getCandidates(),this.values.forEach((e=>{this.choices.append(this.createChoiceOption(e))})),this.source.hasValue()&&this.setValue(this.source.getValue()),this.refresh(),this.element},focus(e){if(this.expanded)if(this.choices.hasChildNodes()){let e=function(e){for(let t=0;t<e.children.length;t++){const i=e.children[t];if(!Ze(i))return i}return null}(this.choices);e&&e.focus()}else this.input&&!Ze(this.input)?this.input.focus():this.selection&&this.selection.focus();else this.input&&!Ze(this.input)?this.input.focus():this.selectListValue.focus();return this.element.classList.add("active"),this},navigate(e,t,i){let n=null;if("up"===e?n=ht(this.element):"down"===e?n=ot(this.element):"left"===e?n=ct(this.element):"right"===e&&(n=lt(this.element)),g(n))return!1;n.focus()},focusIn(){this.focused=!0,this.element.classList.add("active");const e=$();return this.source.getCandidates().filter((e=>!this.values.some((t=>Yi(t,e))))).forEach((t=>{e.append(this.createChoiceOption(t)),this.values.push(t)})),this.choices.append(e),this.expanded||(We(this.selectList),this.selectList.dataset.state="open"),this},focusOut(){if(this.readonly)return;this.input&&f(this.input.value)&&(this.input.value=""),this.messageElement&&(qe(this.messageElement),Ae(this.messageElement)),this.input&&this.input.blur(),this.element.classList.remove("active"),this.element.classList.remove("querying");const{children:e}=this.choices;for(let t=0;t<e.length;t++){const i=e[t];We(i),i.hidden=!1}return this.expanded||(qe(this.selectList),this.selectList.dataset.state="close"),this.focused=!1,this},showChoices(){const{children:e}=this.choices;for(let t=0;t<e.length;t++){const i=e[t];We(i),i.hidden=!1}},enable(){return this.input&&(this.input.disabled=!1,this.input.tabIndex=0),this.disabled=!1,this},disable(){return this.input&&(this.input.disabled=!0,this.input.tabIndex=-1),this.disabled=!0,this},filterChoice(e){const{children:t}=this.choices;if(this.element.dataset.input=e.trim(),f(e)){for(let e=0;e<t.length;e++){const i=t[e];We(i),i.hidden=!1}return}this.element.classList.add("querying");let i=e.trim().toLowerCase().replace(/\s+/g," ").split(" ");for(let e=0;e<t.length;e++){const n=t[e];let s=n.textContent.toLowerCase(),a=s.replace(/[_-]+/g," ").replace(/\s+/g,"").trim();i.some((e=>s.includes(e)||a.includes(e)))?(We(n),n.hidden=!1):(qe(n),n.hidden=!0)}return!0},createChoiceOption(e){const{template:t={},style:i}=this.schema.choice.option,n=u(e),s=Y({class:["field--choice__choice"],tabindex:0,dataset:{nature:"field-component",view:"choice",id:this.id,type:n?"concept":"value",value:n?e.id:e}});if(xi.call(this,s,i),this.items.set(e.id,s),"meta-concept"===e.type){let i=this.model.getProjectionSchema(e.concept,r(t.tag))[0],n=i.type,a={type:n,[n]:i.content||i.projection},o=rs.call(this,a,e.concept,{focusable:!1,meta:e.name});s.dataset.type="meta-concept",s.dataset.value=e.name,s.append(o)}else if(n){if(!this.model.hasProjectionSchema(e,t.tag))return s;let i=this.model.createProjection(e,t.tag).init({focusable:!1});i.readonly=!0,i.focusable=!1,i.parent=this.projection,s.append(i.render())}else s.append(e.toString());return s},setChoice(e){const{children:t}=this.choices;let i=!1;for(let n=0;n<t.length;n++){const s=t[n];let a=Ji.call(this,s);a&&Yi(a,e)?(s.classList.add("selected"),s.dataset.selected="selected",this.selection=s,We(s),i=!0):(s.classList.remove("selected"),delete s.dataset.selected)}return this},delete(){if(this.hasValue())this.reset();else{let e=this.source.delete();e.success?(this.clear(),Ae(this.element),this.element.remove()):(this.environment.notify(e.message),Xe(this.element))}},_spaceHandler(e){let t=this.source.getCandidates();if(o(t))return void this.notify("No candidates found.",Ye.INFO);const i=$();if(t.forEach((e=>{i.append(this.createChoiceOption(e))})),Ae(this.choices),this.placeholder){const{style:e}=this.schema.choice.option;let t=Y({class:["field--choice__choice","field--choice__choice--placeholder"],tabindex:0,dataset:{nature:"field-component",view:"choice",id:this.id,type:"placeholder"}},this.placeholder);this.choices.append(t),xi.call(this,t,e)}this.choices.append(i),this.filterChoice(this.input.value),We(this.choices),this.element.classList.add("querying")},escapeHandler(e){let t=!0;if(this.messageElement&&!Ze(this.messageElement)&&(qe(this.messageElement),t=!1),!this.expanded&&"open"===this.selectList.dataset.state)return qe(this.selectList),this.selectList.dataset.state="close",!0;if(t){let t=Ee(e,(e=>0===e.tabIndex));return this.environment.resolveElement(t).focus(t),!0}this.focus()},enterHandler(e){const t=Xi.call(this,e);L(t)&&this.selection!==t&&("placeholder"===Gi(t)?this.source.removeValue():this.setValue(Ji.call(this,t),!0),this.expanded||(qe(this.selectList),this.selectList.dataset.state="close",this.focus()))},backspaceHandler(e){Xi.call(this,e)&&this.input&&this.input.focus()},clickHandler(e){const t=Xi.call(this,e);L(t)&&this.selection!==t?("placeholder"===Gi(t)?this.source.removeValue():this.setValue(Ji.call(this,t),!0),this.expanded||(qe(this.selectList),this.selectList.dataset.state="close")):e===this.selectListValue&&(We(this.selectList),this.selectList.dataset.state="open")},arrowHandler(e,t){if(!L(t))return!1;const{parentElement:i}=t,n=()=>!!this.parent&&this.parent.arrowHandler(e,this.element);if(!this.expanded&&t===this.selectListValue)return this.arrowHandler(e,this.selectListValue.parentElement);let s=Xi.call(this,t);if(s){let t=rt(s,e,this.choices,!1);return L(t)?(t.focus(),!0):this.arrowHandler(e,this.choices)}if(this.expanded&&i!==this.element)return n();let a=rt(t,e,i,!1);return L(a)?(a===this.selectList&&(a=this.input||this.choices),a===this.choices&&this.choices.hasChildNodes()&&("up"===e?a=ht(this.choices):"down"===e?a=ot(this.choices):"left"===e?a=ct(this.choices):"right"===e&&(a=lt(this.choices))),a.focus(),!0):n()},bindEvents(){L(this.input)&&this.element.addEventListener("input",(e=>{this.filterChoice(this.input.value)})),this.projection.registerHandler("value.changed",((e,t)=>{this.setValue(e)}))}},Qi=Object.assign(Object.create($i),Ki),Zi={init(){return this},render(){const e=$(),{content:t,markers:i,marker:n,self:s}=this.schema;var a=new DOMParser;return L(this.element)||(this.element=z({id:this.id,class:[],dataset:{nature:"field",view:"dynamic",id:this.id}})),L(this.content)||(this.content=a.parseFromString(t.replace(/\&nbsp;/g,""),"image/svg+xml").documentElement,e.appendChild(this.content)),g(this.place)&&(this.place=this.content.querySelector("[data-"+n+"]")),g(this.markers)&&(this.markers=new Map,this.content.querySelectorAll("[data-"+n+"]").forEach((e=>{let t=e.getAttribute("data-"+n);g(this.markers.get(t))?this.markers.set(t,[e]):this.markers.set(t,this.markers.get(t).concat([e]))}))),g(this.aliases)&&(this.aliases=new Map,i.forEach((e=>{let t=[];e.aliases.forEach((e=>{let i=this.markers.get(e.mv);const n=[];i.forEach((t=>{const i={};i.target=t;let s=[];e.props.forEach((e=>{const i={};i.property=e.props,i.value=e.value,g(t.style)||g(t.style[e.props])?i.default=t[e.props]:i.default=t.style[e.props],s.push(i)})),i.impacts=s,n.push(i)})),t.push(n)})),this.aliases.set(e.mv,t)}))),g(this.self)&&!o(s)&&(this.self=[],s.forEach((e=>{const t={};t.property=e,g(this.place.style[e])?t.default=this.place[e]:t.default=this.place.style[e],this.self.push(t)}))),e.hasChildNodes()&&this.element.appendChild(e),this.update=this.refresh,this.clear=this.clean,this},refresh(e){let t=this.aliases.get(e.toString());g(t)||t.forEach((e=>{e.forEach((e=>{e.impacts.forEach((t=>{g(e.target[t.property])?e.target.style[t.property]=t.value:e.target[t.property]=t.value}))}))})),g(this.self)||this.self.forEach((t=>{g(this.place.style[t.property])?this.place[t.property]=e:this.place.style[t.property]=e}))},clean(e){let t=this.aliases.get(e);g(t)||t.forEach((e=>{e.forEach((e=>{e.impacts.forEach((t=>{g(e.target.style[t.property])?e.target[t.property]=t.default:e.target.style[t.property]=t.default}))}))})),g(this.self)||this.self.forEach((e=>{g(this.place.style[e.property])?this.place[e.property]=e.default:this.place.style[e.property]=e.default}))}},en=Object.assign(Object.create($i),Zi),tn={content:"",init(e){return this.transform=e,this},render(){const e=$(),{content:t,source:i,marker:n,markers:s,dd:a,sd:r,self:l}=this.schema;var c=new DOMParser;if(L(this.element)||(this.element=z({id:this.id,class:[],dataset:{nature:"field",view:"interactive",id:this.id}})),L(this.content)||(this.content=c.parseFromString(t.replace(/\&nbsp;/g,""),"image/svg+xml").documentElement,e.appendChild(this.content)),g(this.place)&&(this.place=this.content.querySelector("[data-"+i.marker+"]")),!L(this.field)&&!g(i.tag))switch(i.type="external",this.field=rs.call(this,i,null,this.args),this.field.type){case"text":let e=this.field.element.querySelector(".field--textbox__input");e.classList.remove("field--textbox__input"),e.classList.add("field--svg__input");break;case"choice":let t=100/this.field.choices.childNodes.length,i=t-10,n=this.field.element.querySelector(".bare-list");n.style.width="inherit",n.style.height="inherit",this.field.element.querySelectorAll(".field--choice__choice").forEach((e=>{e.style.width=t+"%",e.style["font-size"]=i+"%"}));break;case"binary":let s=this.field.element;if(s.style.display="flex",s.style.border="1px solid black",""!==this.field.label.innerHTML){let e=this.field.element.querySelector(".field--checkbox__label");e.style.width="75%",e.style["font-size"]="70%",this.field.element.querySelector(".field--binary__input").style.width="25%"}}return!g(this.self)||o(l)||g(l)||(this.self=[],l.forEach((e=>{const t={};t.property=e,g(this.place.style[e])?t.default=this.place[e]:t.default=this.place.style[e],this.self.push(t)}))),!g(this.sd)||o(r)||g(r)||(this.sd=new Map,r.forEach((e=>{e.type="template";var t=rs.call(this,e,null,this.args);this.sd.set(t.mv,t)}))),!g(this.dd)||o(a)||g(a)||(this.dd=[],a.forEach((e=>{e.type="template";var t=rs.call(this,e,null,this.args);this.dd.push(t);var i=this.content.querySelector("[data-"+e.marker+"]");g(i)?this.content.appendChild(t.content):i.appendChild(t.content)}))),L(this.foreign)||(this.foreign=this.createForeign()),e.hasChildNodes()&&this.element.appendChild(e),this.initValue=this.update,this.bindEvents(),this.element},createForeign(){let e,t,i=document.createElementNS("http://www.w3.org/2000/svg","foreignObject");if(g(this.place.getAttribute("width"))?i.setAttribute("width",30):i.setAttribute("width",this.place.getAttribute("width")),g(this.place.getAttribute("height"))?i.setAttribute("height",15):i.setAttribute("height",this.place.getAttribute("height")),e=g(this.place.getAttribute("x"))?Number(this.place.getAttribute("cx")):Number(this.place.getAttribute("x")),t=g(this.place.getAttribute("y"))?Number(this.place.getAttribute("cy")):Number(this.place.getAttribute("y")),"text"===this.place.tagName||"ellipse"===this.place.tagName){let i,n,s,a=this.place.getBBox();switch(i=0===a.width?30:a.width,n=0===a.height?15:a.height,g(this.place.style["text-anchor"]),s=this.place.getAttribute("text-anchor"),g(s)&&(s="middle"),s){case"middle":e-=i/2;break;case"end":e-=i}t-=n}return i.setAttribute("x",e),i.setAttribute("y",t),i.classList.add("field--svg__foreign"),i.appendChild(this.field.element),g(this.place.getAttribute("transform"))||i.setAttribute("transform",this.place.getAttribute("transform")),i},selfUpdate(){let e;g(this.aliases)||(e=this.aliases.get(this.value)),g(e)||e.forEach((e=>{e.forEach((e=>{e.impacts.forEach((t=>{g(e.target[t.property])?e.target.style[t.property]=t.value:e.target[t.property]=t.value}))}))})),g(this.self)||this.self.forEach((e=>{g(this.place.style[e.property])?this.place[e.property]=this.value:this.place.style[e.property]=this.value}))},clear(){let e;g(this.aliases)||(e=this.aliases.get(this.value)),g(e)||e.forEach((e=>{e.forEach((e=>{e.impacts.forEach((t=>{g(e.target.style[t.property])?e.target[t.property]=t.default:e.target.style[t.property]=t.default}))}))})),g(this.self)||this.self.forEach((e=>{g(this.place.style[e.property])?this.place[e.property]=e.default:this.place.style[e.property]=e.default}))},updateStatics(){if(!g(this.sd)){let e=this.sd.get(this.value);g(e)||this.content.appendChild(e.content)}},clearStatics(){if(!g(this.sd)){let e=this.sd.get(this.value);g(e)||e.content.parentNode.removeChild(e.content)}},updateDynamics(e){g(this.dd)||this.dd.forEach((t=>{t.update(e)}))},clearDynamics(e){g(this.dd)||this.dd.forEach((t=>{t.clear(e)}))},update(e){g(this.value)||(this.clearStatics(),this.clearDynamics(this.value),this.clear()),""===e?this.value=this.attributeName:g(this.property)?this.value=e:this.value=this.translateProperty(e),this.selfUpdate(),this.updateDynamics(this.value),this.updateStatics()},bindEvents(){this.place.addEventListener("click",(e=>{this.place.replaceWith(this.foreign),this.field.focus(),this.parent.setIndex(this)}))},getContent(){return L(this.content)||(this.content=parser.parseFromString(content.replace(/\&nbsp;/g,""),"image/svg+xml").documentElement),this.content},arrowHandler(e,t){return this.parent.arrowHandler(e,this)},focus(){this.focusIn()},focusIn(){this.place.replaceWith(this.foreign),this.field.focus()},focusOut(){this.foreign.replaceWith(this.place),""===this.field.value?this.update(this.attributeName):this.update(this.field.value)},translateProperty(e){let t,i=new Map;return this.property.forEach((n=>{switch(n.type){case"affectation":i.set(n.target,this.translateProc(n.proc,i,e));break;case"result":return t=this.translateProc(n.proc,i,e),t.value}})),t.value},translateProc(e,t,i){let n={};const s={};let a;switch(e.type){case"filter":let r;if(a=t.get(e.target),"V"===e.order[0]?(n.value=i,n.type=this.source.name):n=t.get(e.order[0]),"string"===n.type){r="";for(let e=0;e<n.value.length;e++){const t={type:"string"};t.value=n.value.charAt(e),this.evaluate(a,t)&&(r+=n.value.charAt(e))}}else r=[],n.value.forEach((e=>{this.evaluate(a,e)&&r.push(e)}));return s.type=n.type,s.value=r,s;case"lenght":return s.type="int","V"===e.target?(n.value=i,n.type=this.source.name):n=t.get(e.target),s.value=n.value.length,s;case"check":return a=t.get(e.pred),s.type="bool","V"===e.param?(n.value=i,n.type=this.source.name):n=t.get(e.param),s.value=this.evaluate(a,n),s;case"pred":return e}},evaluate(e,t){switch(e.vars.value=t.value,e.op){case"!=":return e.vars.name===e.order[0]?t.value!==e.order[1]:t.value!=e.order[0];case"=":return e.vars.name===e.order[0]?t.value===e.order[1]:t.value===e.order[0];case"<=":return e.vars.name===e.order[0]?t.value<=e.order[1]:t.value<=e.order[0];case"<":return e.vars.name===e.order[0]?t.value<e.order[1]:t.value<e.order[0];case"<=":return e.vars.name===e.order[0]?t.value<=e.order[1]:t.value<=e.order[0];case">":return e.vars.name===e.order[0]?t.value>e.order[1]:t.value>e.order[0];case"function":return window[proc.fun](...proc.args)}}},nn=Object.assign(Object.create($i),tn),sn={content:[{type:"static",static:{type:"text",content:"+",focusable:!1}}]};function an(e){if(!L(e))return!1;const{nature:t,id:i}=e.dataset;return"field-component"===t&&i===this.id}function rn(e){const t=e=>e.parentElement===this.list;return t(e)?e:Ee(e,t,3)}const on={list:null,items:null,elements:null,selection:null,content:null,init(){const{focusable:e=!0}=this.schema;return this.items=new Map,this.elements=new Map,this.children=[],this.focusable=e,k(this.schema,"list")||(this.schema.list={item:{}}),this},hasChanges:()=>!1,hasValue(){return this.items.size>0},getValue(){return this.list.children},setValue(e,t=!1){t&&this.source.setValue(e),this.list&&(Ae(this.list),e.forEach((e=>{var t=this.createItem(e);this.list.append(t)}))),this.refresh()},clear(){this.items.clear(),this.list&&Ae(this.list)},focus(e){if(this.hasValue()&&this.list)this.list.firstElementChild.focus();else{let e=ot(this.element,(e=>e!==this.list));if(!L(e))return this;e.focus()}return this},navigate(e,t,i){let n=null;if("up"===e?n=ht(this.element,(e=>e!==this.notification&&e.hasChildNodes())):"down"===e?n=ot(this.element,(e=>e!==this.notification&&e.hasChildNodes())):"left"===e?n=ct(this.element,(e=>e!==this.notification&&e.hasChildNodes())):"right"===e&&(n=lt(this.element,(e=>e!==this.notification&&e.hasChildNodes()))),!L(n))return!1;let s=this.environment.resolveElement(n);return!g(s)&&(s.focus(),!0)},focusIn(e){this.focused=!0,this.element.classList.add("active");const{component:t}=e.dataset},focusOut(){if(!this.readonly)return this.messageElement&&(qe(this.messageElement),Ae(this.messageElement)),this.element.classList.remove("active"),this.refresh(),this.focused=!1,this},createElement(){return this.source.createElement()},getItem(e){return g(e)?null:k(e,"id")?this.items.get(e.id):this.items.get(e)},getItemIndex:e=>L(e)?e.dataset.index:null,createItem(e){const{template:t={},style:i}=this.schema.list.item;if(!this.model.hasProjectionSchema(e,t.tag))return"";let n=this.model.createProjection(e,t.tag);n.optional=!0,n.parent=this.projection;let s=n.init().render();return s.dataset.index=e.index,n.element.parent=this,xi.call(this.projection,s,i),this.items.set(e.id,s),s},addItem(e){if(!L(this.list))return;const t=this.createItem(e);e.index?this.list.children[e.index-1].after(t):this.list.append(t),this.refresh()},removeItem(e){this.hasList&&!g(e)&&(this.items.delete(e.id),this.items.forEach(((e,t)=>{let i=this.source.getElement(t);i&&(e.dataset.index=i.index)})),this.refresh())},moveItem(e,t,i=!1){return this.list.children[t].before(e),e.dataset.index=t,i&&this.source.swapElement(+this.getItemIndex(e),+t),this},swapItem(e,t,i=!1){const n=this.getItemIndex(e),s=this.getItemIndex(t);return this.moveItem(t,n),this.moveItem(e,s),i&&this.source.swapElement(+n,+s),this},delete(e){if(e===this.element)return this.environment.save(this.source.getParent()),void this.source.remove();const{index:t}=e.dataset;var i=this.source.removeElementAt(+t);if(i.success)if(this.hasValue()){let e=+t<this.list.childElementCount?+t:this.list.childElementCount-1;this.list.children[e].focus()}else this.focus();else this.environment.notify(`This element cannot be deleted: ${i.message}`),Xe(e)},refresh(){this.hasValue()?(this.element.classList.remove("empty"),this.list&&this.list.classList.remove("empty")):(this.element.classList.add("empty"),this.list&&this.list.classList.add("empty")),this.elements.forEach(((e,t)=>{if(!Array.isArray(t.state))return;const{currentState:i}=t,n=_i.call(this,t,t.state);if(i===t.currentState)return;let s=t.content;n&&(s=n.content);let a=$();s.forEach((e=>{let t=rs.call(this,e,null,{focusable:!1});a.append(t)})),Ae(e).append(a)})),this.hasError?this.element.classList.add("error"):this.element.classList.remove("error")},render(){const e=$(),{list:t,style:i,action:n={}}=this.schema;if(L(this.element)||(this.element=z({id:this.id,class:["field","field--list"],tabindex:-1,dataset:{nature:"field",view:"list",id:this.id}}),this.readonly&&this.element.classList.add("readonly"),xi.call(this.projection,this.element,this.schema.style)),t&&!L(this.list)){const{style:i}=t;this.list=z({class:["field--list__list"],dataset:{nature:"field-component",view:"list",id:this.id}}),this.source.hasValue()||this.list.classList.add("empty"),t.currentState=null,this.elements.set(t,this.list),xi.call(this.projection,this.list,i),e.append(this.list)}let s=r(n.add,sn);if(s){const{position:t="after",content:i,help:n,style:a}=s;let r=ce({class:["field-action","field--list__add"],tabindex:0,title:n,dataset:{nature:"field-component",view:"list",component:"action",id:this.id,action:"add"}});i.forEach((e=>{let t=rs.call(this,e,null,{focusable:!1});r.append(t)})),s.currentState=null,this.elements.set(s,r),xi.call(this.projection,r,a),"before"===t&&this.list?this.list.before(r):e.append(r)}return this.list&&this.source.getValue().forEach((e=>{var t=this.createItem(e);this.list.append(t)})),xi.call(this.projection,this.element,i),e.hasChildNodes()&&(this.element.append(e),this.bindEvents()),this.refresh(),this.element},_spaceHandler(e){this.notify(`Add or remove ${this.source.accept.name}`)},spaceHandler(e){return!!L(e)&&e.parentElement===this.list&&(this.createElement(),!0)},deleteHandler(e){return!(!an.call(this,e)||e.parentElement!==this.list||(this.delete(e),0))},escapeHandler(e){let t=!0;if(this.messageElement&&!Ze(this.messageElement)&&(qe(this.messageElement),t=!1),t){let t=Ee(e,(e=>0===e.tabIndex));return this.environment.resolveElement(t).focus(t),!0}return this.focus(),!1},enterHandler(e){const t=(e=>an.call(this,e)?e:Ee(e,(e=>an.call(this,e)),5))(e);if(g(t))return this.focus(),!1;const{action:i,index:n,component:s}=t.dataset;return"add"===i?(this.createElement(),!0):"remove"===i&&(this.delete(t.parentElement),!0)},backspaceHandler:e=>!1,clickHandler(e){const t=(e=>an.call(this,e)?e:Ee(e,(e=>an.call(this,e)),5))(e);if(g(t))return;const{action:i,index:n,name:s}=t.dataset;"add"===i?this.createElement():"remove"===i&&this.delete(t.parentElement)},_arrowHandler(e,t){if(!L(t))return!1;let i=rn.call(this,t);if(i){let t=rt(i,e,this.list);return!!L(t)&&(this.swapItem(i,t,!0),i.focus(),!0)}return!1},arrowHandler(e,t){if(!L(t))return!1;const{parentElement:i}=t,n=()=>!!this.parent&&this.parent.arrowHandler(e,this.element);if(i===this.list){let i=rt(t,e,this.list);return L(i)?(this.environment.resolveElement(i).focus(),!0):this.arrowHandler(e,this.list)}if(i!==this.element)return n();let s=rt(t,e,this.element);if(!L(s))return n();if(s===this.notification)return this.arrowHandler(e,s);if(s===this.list){if(!this.list.hasChildNodes())return n();"up"===e?s=ht(this.list):"down"===e?s=ot(this.list):"left"===e?s=ct(this.list):"right"===e&&(s=lt(this.list))}return s.focus(),!0},bindEvents(){this.projection.registerHandler("value.added",(e=>{this.addItem(e)})),this.projection.registerHandler("value.removed",(e=>{this.removeItem(e)})),this.projection.registerHandler("value.changed",(e=>{this.clear(),this.list&&this.source.getValue().forEach((e=>{let t=this.createItem(e);this.list.append(t)}))})),this.projection.registerHandler("value.swapped",(e=>{const[t,i]=e;let n=this.getItem(t),s=this.getItem(i),a=+this.getItemIndex(n);this.getItemIndex(s),a!==t.index&&this.swapItem(n,s)}))}},ln=Object.assign(Object.create($i),on);Object.defineProperty(ln,"size",{get(){return this.items.size}}),Object.defineProperty(ln,"hasList",{get(){return L(this.list)}});const cn={init(){return this},render(){const e=$(),{content:t,mv:i}=this.schema;var n=new DOMParser;return L(this.element)||(this.element=z({id:this.id,class:[],dataset:{nature:"field",view:"static",id:this.id}})),L(this.content)||(this.content=n.parseFromString(t.replace(/\&nbsp;/g,""),"image/svg+xml").documentElement,e.appendChild(this.content)),g(this.mv)&&(this.mv=i),e.hasChildNodes()&&this.element.appendChild(e),this}},hn=Object.assign(Object.create($i),cn);var un=0;const dn={content:{type:"static",static:{type:"text",content:"Add"}}},pn={content:{type:"static",static:{type:"text",content:"Remove"}}},mn={table:null,header:null,body:null,footer:null,elements:null,contentElements:null,content:null,init(){const{content:e=[],template:t,focusable:i=!0}=this.schema;return this.elements=new Map,this.focusable=i,this.content=e,this.contentElements=new Map,this.template=this.model.getProjectionSchema(this.source.accept,t.tag)[0].projection,this},render(){const{content:e,action:t={}}=this.schema,{disposition:i}=this.template,n=$();if(!Array.isArray(e))throw new Error("Empty content for listfield");if(L(this.element)||(this.element=z({class:["field","field--table"],id:this.id,tabindex:-1,dataset:{nature:"field",view:"table",id:this.id}}),this.readonly&&this.element.classList.add("readonly"),xi.call(this.projection,this.element,this.schema.style)),e.forEach((e=>{if("table"===e.type){let t=r(e.table,{});const{style:i,header:s,body:a={},footer:o}=t;if(this.table=he({class:["field--table__table"],tabindex:0,dataset:{nature:"field-component",view:"table",id:this.id}}),s){const{style:e}=s;this.header=de({class:["field--table-header"],dataset:{nature:"field-component",view:"table",id:this.id}}),xi.call(this.projection,this.header,e),this.table.append(this.header)}if(a){const{style:e}=a;this.body=pe({class:["field--table-body"],dataset:{nature:"field-component",view:"table",id:this.id}}),xi.call(this.projection,this.body,e),this.table.append(this.body)}if(o){const{style:e}=o;this.footer=me({class:["field--table-footer"],dataset:{nature:"field-component",view:"table",id:this.id}}),xi.call(this.projection,this.footer,e),this.table.append(this.footer)}t.currentState=null,this.contentElements.set(t,this.table),xi.call(this.projection,this.table,i),n.append(this.table)}else if("action"===e.type){let t=r(e,dn);const{content:i,style:s}=t;let a=rs.call(this,i,null),o=ce({class:["field-action","field--table__add"],tabindex:0,dataset:{nature:"field-component",view:"table",component:"action",id:this.id,action:"add"}},[a]);t.currentState=null,this.contentElements.set(t,o),xi.call(this.projection,o,s),n.append(o)}else{let t=rs.call(this,e);this.contentElements.set(e,t),n.append(t)}})),this.header){let e=fe({class:["field--table-header-row"],tabindex:-1,dataset:{nature:"field-component",view:"table",id:this.id}});i.forEach((t=>{const{header:i}=t,{style:n,content:s}=i;var a=rs.call(this,s),r=ve({class:["field--table-header-cell"],dataset:{nature:"field-component",view:"table",id:this.id}},a);xi.call(this.projection,r,n),e.append(r)}));let t=ge({class:["field--table-header-cell","field--table-header-cell--action"]},"Action");e.append(t),this.header.append(e)}return this.source.hasValue()&&this.source.getValue().forEach((e=>{this.addRow(e)})),n.hasChildNodes()&&(this.element.append(n),this.bindEvents()),this.refresh(),this.element},hasChanges:()=>!1,hasValue(){return this.body.rows.length>0},getValue(){return this.body.rows},focusIn(){return this.focused=!0,this.element.classList.add("active"),this},focusOut(){if(!this.readonly)return this.messageElement&&(qe(this.messageElement),Ae(this.messageElement)),this.element.classList.remove("active"),this.refresh(),this.focused=!1,this},refresh(){this.hasValue()?(this.element.classList.remove("empty"),this.table.classList.remove("empty")):(this.element.classList.add("empty"),this.table.classList.add("empty")),this.contentElements.forEach(((e,t)=>{if(!Array.isArray(t.state))return;const{currentState:i}=t,n=_i.call(this,t,t.state);if(i===t.currentState)return;let s=null;s=n?rs.call(this,n.content,null):rs.call(this,t.content,null),Ae(e).append(s)})),this.hasError?this.element.classList.add("error"):this.element.classList.remove("error")},createElement(){return this.source.createElement()},addRow(e){const{action:t={},before:i={},after:n={}}=this.schema,{disposition:s}=this.template,a=r(e.index,this.table.rows.length),o="row"+un++,l=fe({class:["field--table-row"],tabindex:-1,dataset:{nature:"field-component",view:"table",id:this.id,index:a,elementId:o}});this.elements.set(o,l),s.forEach((t=>{const{body:i}=t,{style:n,content:s}=i;var a=rs.call(this,s,e),r=ge({class:["field--table-cell"],dataset:{nature:"field-component",view:"table",id:this.id}},a);xi.call(this.projection,r,n),l.append(r)}));var c=ge({class:["field--table__cell-action"]}),{content:h,style:u}=r(t.remove,pn),d=rs.call(this,h),p=ce({class:["btn","field--table__button"],dataset:{nature:"field-component",view:"list",component:"action",id:this.id,action:"remove",rowId:o}},d),m=ce({class:["btn","field--table__button"],dataset:{nature:"field-component",id:this.id,action:"move-up",rowId:o}},"Move up"),f=ce({class:["btn","field--table__button"],dataset:{nature:"field-component",id:this.id,action:"move-down",rowId:o}},"Move down");xi.call(this.projection,p,u),c.append(p,m,f),l.append(c),this.body.append(l),this.refresh()},removeRow(e){var t=this.body.rows.item(e.index);if(!L(t))throw new Error("Table error: Row not found");Ae(t),t.remove();for(let t=e.index;t<this.body.rows.length;t++){const e=this.body.rows.item(t),{index:i}=e.dataset;e.dataset.index=+i-1}this.refresh()},removeElement(e){return this.source.removeElement(e)},delete(e){if(e===this.element||e===this.table)return void this.source.delete();const{index:t}=e.dataset;this.source.removeElementAt(+t)||(this.environment.notify("This element cannot be deleted"),Xe(e))},bindEvents(){this.element.addEventListener("click",(e=>{const{target:t}=e,i=function(e){const t="field-component";return e.dataset.nature===t?e:Ee(e,(e=>e.dataset.nature===t))}(t);if(!L(i))return;const{id:n,action:s}=i.dataset;if(n===this.id)if("add"===s)this.createElement();else if("remove"===s){const{rowId:e}=i.dataset;let t=this.elements.get(e);this.delete(t)}else if("move-up"===s){const{rowId:e}=i.dataset;let t=this.elements.get(e),n=t.previousElementSibling;n&&n.before(t)}else if("move-down"===s){const{rowId:e}=i.dataset;let t=this.elements.get(e),n=t.nextElementSibling;n&&n.after(t)}}),!0),this.projection.registerHandler("value.added",(e=>{this.addRow(e)})),this.projection.registerHandler("value.removed",(e=>{this.removeRow(e)})),this.projection.registerHandler("value.changed",(e=>{Ae(this.body),this.source.getValue().forEach((e=>{this.addRow(e)}))}))}},fn=Object.assign(Object.create($i),mn),vn=e=>L(e,["input","textarea"]),gn="error";function bn(){return L(this.choice)||(this.choice=J({class:["bare-list","field--textbox__choices"],dataset:{nature:"field-component",view:"text",component:"choice",id:this.id}}),this.append(this.choice)),this.choice}function yn(e){return Y({class:["field--textbox__choice"],tabindex:0,dataset:{nature:"field-component",view:"text",component:"choice-item",value:e,id:this.id}},e)}function wn(e){return e.parentElement===this.choice?e:Ee(e,(e=>e.parentElement===this.choice),3)}function kn(e){const{placeholder:t="",type:i}=e;let n=is.call(this,t);return this.readonly||this.resizable?ee({class:["field--textbox__input","field--textbox__input-pseudo"],editable:!this.readonly,title:n,dataset:{placeholder:n,nature:"field-component",view:this.type,id:this.id}}):this.multiline?se({class:["field--textbox__input"],placeholder:n,title:n,dataset:{nature:"field-component",view:this.type,id:this.id}}):ne({class:["field--textbox__input"],type:r(i,"text"),placeholder:n,title:n,dataset:{nature:"field-component",view:this.type,id:this.id}})}const xn={input:null,choice:null,value:"",placeholder:null,multiline:!1,resizable:!1,content:null,init(){const{multiline:e=!1,resizable:t=!1,focusable:i=!0}=this.schema;return this.multiline=e,this.focusable=i,this.resizable=t,this.children=[],k(this.schema,"choice")||(this.schema.choice={}),this},focus(e){return this.input.focus(),this},focusIn(){return this.focused=!0,this.value=this.getValue(),this.element.classList.add("active"),this.element.classList.add("focus"),this},focusOut(){return this.hasChanges()&&this.setValue(this.getValue(),!0),f(this.getValue())&&(this.input.textContent=""),this.messageElement&&(qe(this.messageElement),Ae(this.messageElement)),this.choice&&qe(this.choice),this.input.blur(),this.element.classList.remove("active"),this.element.classList.remove("focus"),this.refresh(),this.focused=!1,this},hasChanges(){return this.value!=this.getValue()},hasValue(){return!o(this.getValue())},getValue(){return vn(this.input)?this.input.value:this.input.textContent},setValue(e,t=!1){var i;(i=t?this.source.setValue(e):{success:!0}).success||(Xe(this.element),this.environment.notify(i.message,"error")),this.setInputValue(e),this.value=e,this.refresh()},setInputValue(e){vn(this.input)?this.input.value=e:this.input.textContent=e},getCandidates(){let e=this.source.getCandidates();return Array.isArray(e)?e:[]},enable(){return this.input.disabled=!1,this.input.tabIndex=0,this.disabled=!1,this.element.classList.add("disabled"),this},disable(){return this.input.disabled=!0,this.input.tabIndex=-1,this.disabled=!0,this.element.classList.remove("disabled"),this},refresh(){_i.call(this,this.schema,this.schema.state),this.hasValue()?this.element.classList.remove("empty"):this.element.classList.add("empty"),this.element.dataset.value=this.value,this.hasError?(this.element.classList.add(gn),this.input.classList.add(gn)):(this.element.classList.remove(gn),this.input.classList.remove(gn)),this.choice&&this.filterChoice(this.getValue())},render(){const e=$(),{container:t,input:i={},style:n}=this.schema;if(L(this.element)||(this.element=z({id:this.id,class:["field","text-field","field--textbox"],dataset:{nature:"field",view:"text",id:this.id,disabled:this.disabled,readonly:this.readonly,value:""}}),this.readonly&&this.element.classList.add("readonly"),this.disabled&&this.element.classList.add("disabled"),xi.call(this.projection,this.element,this.schema.style)),t){const{content:i=[],style:n}=t;i.forEach((t=>{if("input"===t.type){const{style:i}=t.input;this.input=kn.call(this,t.input),this.disabled&&(this.input.disabled=!0),this.focusable?this.input.tabIndex=0:this.input.dataset.ignore="all",xi.call(this.projection,this.input,i),this.multiline&&this.input.classList.add("field--textbox__input--multiline"),e.append(this.input)}else{let i=rs.call(this,t,null,{focusable:!1});e.append(i)}})),xi.call(this.projection,this.element,n)}else{if(!L(this.input)){const{style:t}=i;this.input=kn.call(this,i),this.disabled&&(this.input.disabled=!0),this.focusable?this.input.tabIndex=0:this.input.dataset.ignore="all",xi.call(this,this.input,t),this.multiline&&this.input.classList.add("field--textbox__input--multiline"),e.append(this.input)}xi.call(this.projection,this.element,n)}return e.hasChildNodes()&&(this.element.append(e),this.bindEvents()),this.source.hasValue()&&this.setValue(this.source.getValue()),this.refresh(),this.element},filterChoice(e){const{children:t}=this.choice;if(f(e)){for(let e=0;e<t.length;e++){const i=t[e];We(i),i.hidden=!1}return!0}let i=e.trim().toLowerCase().replace(/\s+/g," ").split(" ");for(let e=0;e<t.length;e++){const n=t[e],{value:s}=n.dataset;i.some((e=>s.toLowerCase().includes(e)))?(We(n),n.hidden=!1):(qe(n),n.hidden=!0)}return!0},selectChoice(e){if(!L(e))return;const t=function(e){return e.dataset.value}(e);return this.setValue(t,!0),this.input.focus(),qe(this.choice),this},_spaceHandler(e){const t=new Set(this.getCandidates());if(0===t.size)this.notify("Enter any text.",Ye.INFO);else{bn.call(this);const e=$();t.forEach((t=>e.append(yn.call(this,t)))),Ae(this.choice).append(e),this.filterChoice(this.getValue()),We(this.choice)}},escapeHandler(e){let t=!0;if(this.messageElement&&!Ze(this.messageElement)&&(qe(this.messageElement),t=!1),this.choice&&!Ze(this.choice)&&(qe(this.choice),t=!1),t){let t=Ee(e,(e=>0===e.tabIndex)),i=this.environment.resolveElement(t);return i&&i.focus(t),!1}return this.input.focus(),!0},enterHandler(e){const t=wn.call(this,e);return t?this.selectChoice(t):this.multiline||(e===this.input?this.setValue(this.getValue(),!0):this.focus()),!0},backspaceHandler(e){wn.call(this,e)&&this.input.focus()},clickHandler(e){const t=wn.call(this,e);L(t)&&this.selectChoice(t)},arrowHandler(e,t){if(!L(t))return!1;const{parentElement:i}=t,n=()=>!!this.parent&&this.parent.arrowHandler(e,this.element);let s=wn.call(this,t);if(L(s)){let t=rt(s,e,this.choice);return L(t)?(t.focus(),!0):this.arrowHandler(e,this.choice)}if(i!==this.element)return n();let a=null;if("right"===e){if(t===this.input&&!(this.getValue().length<Fe(this.input)+1))return!1;a=rt(t,e,this.element,!1)}else if("left"===e){if(t===this.input&&0!==Fe(this.input))return!1;a=rt(t,e,this.element,!1)}else a=rt(t,e,this.element,!1);return L(a)&&a.dataset.id===this.id?("up"===e?a=ht(this.choice):"down"===e?a=ot(this.choice):"left"===e?a=ct(this.choice):"right"===e&&(a=lt(this.choice)),a.focus(),!0):n()},bindEvents(){this.element.addEventListener("input",(e=>{this.hasError&&this.source.setValue(this.getValue(),!0),this.refresh()})),this.projection.registerHandler("value.changed",(e=>{this.setValue(e)}))}},En=Object.assign(Object.create($i),xn),Tn={init(){return this.arrowStyle=this.schema.arrowStyle,this},render(){const{decorator:e}=this.schema;return L(this.element)||(this.element=document.createElementNS("http://www.w3.org/2000/svg","path"),this.element.style.fill="transparent",this.element.id=this.id,this.element.classList.add("field"),this.element.tabindex=-1,this.element.dataset.nature="field",this.element.dataset.view="arrow",this.element.dataset.id=this.id),this.source.getAttributeByName("target").target.register(this.projection),this.source.getAttributeByName("source").target.register(this.projection),L(this.decorator)||g(e.attribute.dynamic.name)||(this.decorator=rs.call(this,e.attribute),this.base="left",this.ratio=.02),g(this.registered)&&(this.registered=[]),this.computeStyle(),this.bindEvent(),this.element},getStyle(){},signal(){g(this.valSource)||g(this.valTarget)||this.projection.parent.accept(this.valSource,this.valTarget,this)},computeStyle(){const{stroke:e,dasharray:t,width:i,linecap:n,end:s,start:a}=this.schema.arrowStyle;this.element.style.stroke=e,g(t)||(this.element.style["stroke-dasharray"]=t),this.element.style["stroke-width"]=r(i,1),this.element.style["stroke-linecap"]=n,s&&this.createMarkerEnd()},createMarkerEnd(){g(this.definitions)&&(this.definitions=document.createElementNS("http://www.w3.org/2000/svg","defs")),this.end=document.createElementNS("http://www.w3.org/2000/svg","marker"),this.end.id="marker"+this.id,this.end.setAttribute("refY",5),this.end.setAttribute("refX",10),this.end.setAttribute("markerUnit","strokeWidth"),this.end.setAttribute("markerWidth",10),this.end.setAttribute("markerHeight",10),this.end.setAttribute("orient","auto"),this.end.classList.add("end");let e=document.createElementNS("http://www.w3.org/2000/svg","path");e.setAttribute("d","M 0 0 L 10 5 L 0 10 z"),e.setAttribute("fill","black"),this.end.appendChild(e),this.definitions.appendChild(this.end),this.element.setAttribute("marker-end","url(#"+this.end.id+")")},createMarkerStart(){g(this.definitions)&&(this.definitions=document.createElementNS("http://www.w3.org/2000/svg","defs")),this.start=document.createElementNS("http://www.w3.org/2000/svg","marker"),this.start.id="marker"+this.id,this.start.setAttribute("refY",5),this.start.setAttribute("refX",1),this.start.setAttribute("markerUnit","strokeWidth"),this.start.setAttribute("markerWidth",10),this.start.setAttribute("markerHeight",10),this.start.setAttribute("orient","auto"),this.start.classList.add("start");let e=document.createElementNS("http://www.w3.org/2000/svg","path");e.setAttribute("d","M 0 0 L 10 5 L 0 10 z"),e.setAttribute("fill","black"),this.start.appendChild(e),this.definitions.appendChild(this.end),this.element.setAttribute("marker-start","url(#"+this.end.id+")")},setValues(){g(this.source.getAttributeByName("target").target.value)||(this.valTarget=this.source.getAttributeByName("target").target.value),g(this.source.getAttributeByName("source").target.value)||(this.valSource=this.source.getAttributeByName("source").target.value)},refresh(){this.setValues(),this.updateRegister(),this.signal()},deleteRef(e,t){this.valTarget!==e.id&&this.valSource!==e.id||this.projection.parent.removeArrow(this,t)},setLine(e,t){this.element.setAttribute("d","M "+e.x+", "+e.y+"L "+t.x+", "+t.y)},setPath(e){this.element.setAttribute("d",e)},updateRegister(){for(let e=0;e<this.registered.length;e++)this.registered[e]={name:this.registered[e].name,value:this.source.getAttributeByName(this.registered[e].name).target.value}},register(e){g(this.getAttribute)&&(this.registered.push({name:e,value:this.source.getAttributeByName(e).target.value}),this.source.getAttributeByName(e).target.register(this.projection),this.projection.registerHandler("value.added",(e=>{this.refresh()})))},get(e){console.log(this.registered);for(let t=0;t<this.registered.length;t++)if(this.registered[t].name===e)return this.registered[t].value},bindEvent(){this.projection.registerHandler("value.changed",(e=>{console.log(e),this.refresh()})),this.projection.registerHandler("displayed",(()=>{this.refresh()}))}},Nn=Object.assign(Object.create($i),Tn),An={init(){return this},render(){const{content:e,x:t,y:i}=this.schema;var n=new DOMParser;return g(this.element)&&(this.element=n.parseFromString(e.replace(/\&nbsp;/g,""),"image/svg+xml").documentElement,console.log(this.element),this.element.id=this.id,this.element.classList.add("field"),this.element.tabindex=-1,this.element.dataset.nature="field",this.element.dataset.view="svg",this.element.dataset.id=this.id),this.element.setAttribute("x",t),this.element.setAttribute("y",i),console.log(this.element),this.element}},Cn=Object.assign(Object.create($i),An),Ln={binary:(e,t,i)=>Object.create(zi,{object:{value:"field"},name:{value:"binary-field"},type:{value:"binary"},id:{value:In()},model:{value:e},schema:{value:t},projection:{value:i},source:{value:i.concept}}),choice:(e,t,i)=>Object.create(Qi,{object:{value:"field"},name:{value:"choice-field"},type:{value:"choice"},id:{value:In()},model:{value:e},schema:{value:t},projection:{value:i},source:{value:i.concept}}),list:(e,t,i)=>Object.create(ln,{object:{value:"field"},name:{value:"list-field"},type:{value:"list"},id:{value:In()},model:{value:e},schema:{value:t},projection:{value:i},source:{value:i.concept}}),table:(e,t,i)=>Object.create(fn,{object:{value:"field"},name:{value:"table-field"},type:{value:"table"},id:{value:In()},model:{value:e},schema:{value:t},projection:{value:i},source:{value:i.concept}}),text:(e,t,i)=>Object.create(En,{object:{value:"field"},name:{value:"text-field"},type:{value:"text"},id:{value:In()},model:{value:e},schema:{value:t},projection:{value:i},source:{value:i.concept}}),interactive:(e,t,i)=>Object.create(nn,{object:{value:"field"},name:{value:"interactive-field"},type:{value:"interactive"},id:{value:In()},model:{value:e},schema:{value:t},projection:{value:i},source:{value:i.concept}}),static:(e,t,i)=>Object.create(hn,{object:{value:"field"},name:{value:"static-field"},type:{value:"static"},id:{value:In()},model:{value:e},schema:{value:t},projection:{value:i},source:{value:i.concept}}),dynamic:(e,t,i)=>Object.create(en,{object:{value:"field"},name:{value:"dynamic-field"},type:{value:"dynamic"},id:{value:In()},model:{value:e},schema:{value:t},projection:{value:i},source:{value:i.concept}}),add:(e,t,i)=>Object.create(Ui,{object:{value:"field"},name:{value:"add-field"},type:{value:"add"},id:{value:In()},model:{value:e},schema:{value:t},projection:{value:i},source:{value:i.concept}}),arrow:(e,t,i)=>Object.create(Nn,{object:{value:"field"},name:{value:"arrow"},type:{value:"arrow"},id:{value:In()},model:{value:e},schema:{value:t},projection:{value:i},source:{value:i.concept}}),svg:(e,t,i)=>Object.create(Cn,{object:{value:"field"},name:{value:"svg"},type:{value:"svg"},id:{value:In()},model:{value:e},schema:{value:t},projection:{value:i},source:{value:i.concept}})};var Sn=0;const In=()=>"field"+Sn++,Dn={createField(e,t,i){const{type:n}=t,s=Ln[n];if(g(s))throw new Error(`Missing handler: The '${n}' field could not be handled`);var a=s(e,t,i);if(g(a))throw new Error(`Bad request: The '${n}' field could not be created`);return a.errors=[],a.readonly=r(t.readonly,!1),g(a.id)&&(a.id=In()),a}},jn={init(){throw new Error("This function has not been implemented")},element:null,children:null,statusElement:null,attached:null,readonly:!1,visible:!1,disabled:!1,active:!1,focused:!1,get hasAttached(){return!o(this.attached)},attach(e,t){this.attached.push(e)},detach(e){this.attached.slice(this.attached.indexOf(e),1)},getAttached(e){return h(e)?this.attached.filter((t=>e(t))):this.attached},show(){return We(this.element),this.visible=!0,this.active=!0,this},hide(){return qe(this.element),this.visible=!1,this},toggle(){return ze(this.container),this.visible=!this.visible,this},focus(){return this.element.focus(),this.focused=!0,this.active=!0,this},_focusIn:e=>!1,navigate(e,t,i){return this.focusable?(this.element.focus(),!0):this.parent.arrowHandler(e,this.element)},clear:()=>!0,delete(){this.environment.notify("This element cannot be removed",Ye.WARNING,1500),Xe(this.element)},spaceHandler(e){return this.arrowHandler("right",e)},_spaceHandler(e){return this.environment.notify("Nothing do here.",Ye.NORMAL,1500),!1},escapeHandler(e){let t=Ee(e,(e=>0===e.tabIndex));return this.projection.resolveElement(t).focus(t),!0},enterHandler(e){this.element.click()},deleteHandler(e){return this.environment.notify("This element cannot be removed",Ye.WARNING,1500),Xe(this.element),!1},backspaceHandler(e){return this.arrowHandler("left",e)},arrowHandler(e,t){return!!this.parent&&this.parent.arrowHandler(e,t)},clickHandler:e=>(console.warn("CLICK_HANDLER NOT IMPLEMENTED"),!1),controlHandler:e=>(console.warn("CONTROL NOT IMPLEMENTED"),!1)},On=Object.assign(jn),Rn={init(){return this.children=[],this},render(){const e=$(),{help:t,style:i,content:n}=this.schema;return L(this.element)||(this.element=Z({class:["static","audio-static"],src:n,dataset:{nature:"static",static:"audio",id:this.id,ignore:"all"}})),g(t)||(this.element.title=t),xi.call(this.projection,this.element,i),e.hasChildNodes()&&(this.element.append(e),this.bindEvents()),this.refresh(),this.element},focusIn(){return this.focused=!0,this.element.classList.add("active"),this},focusOut(){return this.messageElement&&(qe(this.messageElement),Ae(this.messageElement)),this.element.classList.remove("active"),this.refresh(),this.focused=!1,this},refresh(){return this},bindEvents(){}},_n=Object.assign(Object.create(On),Rn);function Pn(e){return f(e)?"":e.startsWith("http://")||e.startsWith("https://")?new URL(e).href:Pn(`https://${e}`)}const Mn={url:null,alt:null,width:null,height:null,init(){const{url:e,width:t,height:i,alt:n}=this.schema;return this.url=Pn(e),this.width=t,this.height=i,this.alt=n,this},render(){const{help:e,style:t}=this.schema;return L(this.element)||(this.element=Q({class:["static","image-static"],src:this.url,alt:this.alt,dataset:{nature:"static",static:"image",id:this.id,ignore:"all"}})),g(this.width)||isNaN(this.width)||(this.element.width=this.width),g(this.height)||isNaN(this.height)||(this.element.height=this.height),g(e)||(this.element.title=e),xi.call(this.projection,this.element,t),this.refresh(),this.element},focusIn(){return this.focused=!0,this.element.classList.add("active"),this},focusOut(){return this.messageElement&&(qe(this.messageElement),Ae(this.messageElement)),this.element.classList.remove("active"),this.refresh(),this.focused=!1,this},refresh(){return this}},Fn=Object.assign(Object.create(On),Mn),Vn={email:e=>`mailto:${e}`,phone:e=>`tel:${e}`,link:e=>`${e}`};function $n(e){return e.startsWith("http://")||e.startsWith("https://")?new URL(e).href:$n(`https://${e}`)}const Bn={url:null,urlType:null,href:null,content:null,init(){const{url:e,content:t=[],urlType:i="link"}=this.schema;this.url=$n(e),this.content=t,this.urlType=i,this.children=[];const n=Vn[this.urlType];if(!h(n))throw new TypeError("type not handled");return this.href=n(this.url),this},render(){if(f(this.url))throw new Error("There is no URL defined for this link");if(o(this.content))throw new Error("There is no content defined for this link");const e=$(),{help:t,style:i}=this.schema;return L(this.element)||(this.element=K({class:["static","link"],href:this.href,target:"_blank",dataset:{nature:"static",static:"link",id:this.id,ignore:"all"}})),this.content.forEach((t=>{let i=rs.call(this,t,this.projection.concept,{focusable:!1});e.append(i)})),g(t)||(this.element.title=t),xi.call(this.projection,this.element,i),e.hasChildNodes()&&this.element.append(e),this.refresh(),this.element},focusIn(){return this.focused=!0,this.element.classList.add("active"),this},focusOut(){return this.messageElement&&(qe(this.messageElement),Ae(this.messageElement)),this.element.classList.remove("active"),this.refresh(),this.focused=!1,this},refresh(){return this}},Hn=Object.assign(Object.create(On),Bn);function Un(e){const{type:t}=e;return"property"===t?(this.hasProperty=!0,r(this.source.getProperty(e.name),"")):"param"===t?this.projection.getParam(e.name):"html"===t?j(e.html):"raw"===t?j(e.raw):e}const Wn={editable:null,focusable:null,hasProperty:!1,asHTML:!1,init(e={}){Object.assign(this.schema,e);const{content:t,editable:i=!1,focusable:n=!1}=this.schema;return this.children=[],this._content=t,this.editable=i,this.focusable=n,this},render(){let e=!1;const{content:t,help:i,style:n}=this.schema;if(!L(this.element)){if(this.element=ee({class:["text","static","text-static"],editable:this.editable,dataset:{nature:"static",view:"text",static:"text",id:this.id,ignore:"all"}}),this.focusable&&(this.element.tabIndex=0),Array.isArray(t))t.forEach((e=>{let t=Un.call(this,e),i=ee({class:["text","static","text-static"],dataset:{nature:"static-component",view:"text",static:"text",content:t,id:this.id,ignore:"all"}},t);xi.call(this.projection,i,e.style),this.element.append(i)}));else{let e=Un.call(this,t);this.element.append(e),this.element.content=e}e=!0}return g(i)||(this.element.title=i),xi.call(this.projection,this.element,n),e&&this.bindEvents(),this.refresh(),this.element},focusIn(){return this.focused=!0,this.element.classList.add("active"),this},focusOut(){return this.messageElement&&(qe(this.messageElement),Ae(this.messageElement)),this.element.classList.remove("active"),this.refresh(),this.focused=!1,this},getLength(){return this.element.textContent.length},backspaceHandler(e){return this.arrowHandler("left",e)},arrowHandler(e,t){if(!this.editable&&this.parent)return this.parent.arrowHandler(e,t);if("right"===e){if(this.getLength()<Fe(this.element)+1&&this.parent)return this.parent.arrowHandler(e,t)}else if("left"===e){if(0===Fe(this.element)&&this.parent)return this.parent.arrowHandler(e,t)}else if(this.parent)return this.parent.arrowHandler(e,t);return!1},escapeHandler(e){let t=Ee(e,(e=>0===e.tabIndex));this.projection.resolveElement(t).focus(t)},update(){const{content:e}=this.schema;return Ae(this.element),Array.isArray(e)?e.forEach((e=>{this.element.append(ee({class:["text","static","text-static"],dataset:{nature:"static-component",view:"text",static:"text",id:this.id,ignore:"all"}},Un.call(this,e)))})):this.element.append(Un.call(this,e)),this},refresh(){return this},bindEvents(){this.hasProperty&&(this.projection.registerHandler("value.changed",(e=>{this.update()})),this.projection.registerHandler("value.added",(e=>{this.update()})),this.projection.registerHandler("value.removed",(e=>{this.update()})))}},qn=Object.assign(Object.create(On),Wn),zn={contentType:null,editable:null,focusable:null,init(e={}){Object.assign(this.schema,e);const{focusable:t=!0}=this.schema;return this.children=[],this.focusable=t,this},render(){const e=$(),{help:t,style:i,content:n}=this.schema;if(L(this.element)||(this.element=ce({class:["btn","static"],dataset:{nature:"static",view:"plink",static:"plink",id:this.id,ignore:"all"}}),this.focusable&&(this.element.tabIndex=0)),Array.isArray(n))n.forEach((t=>{let i=rs.call(this,t,this.projection.concept,{focusable:!1});e.append(i)}));else{const t={type:"static",static:{type:"text",content:n}};let i=rs.call(this,t,this.projection.concept,{focusable:!1});e.append(i)}return g(t)||(this.element.title=t),xi.call(this.projection,this.element,i),e.hasChildNodes()&&(this.element.append(e),this.bindEvents()),this.refresh(),this.element},focusIn(){return this.focused=!0,this.element.classList.add("active"),this},focusOut(){return this.messageElement&&(qe(this.messageElement),Ae(this.messageElement)),this.element.classList.remove("active"),this.refresh(),this.focused=!1,this},arrowHandler(e,t){return(!this.editable&&this.parent||!!this.parent)&&this.parent.arrowHandler(e,t)},escapeHandler(e){let t=Ee(e,(e=>0===e.tabIndex));this.environment.resolveElement(t).focus(t)},enterHandler(e){const t=this.projection.schema.findIndex((e=>e.tags.includes(this.schema.tag)));return this.projection.changeView(t),!1},clickHandler(e){const t=this.projection.schema.findIndex((e=>e.tags.includes(this.schema.tag)));return this.projection.changeView(t),!1},refresh(){return this},bindEvents(){}},Xn=Object.assign(Object.create(On),zn),Gn={template:null,selector:null,content:null,init(){var e;return this.selector=this.schema.selector,this.template=(e=this.selector,"content"in document.createElement("template")?we(e,undefined):null),this},render(){const{style:e,content:t}=this.schema;var i;return A(this.element)||(this.element=(i=this.template)?document.importNode(i.content,r(undefined,!0)):i),this.refresh(),this.element},focusIn(){return this.focused=!0,this.element.classList.add("active"),this},focusOut(){return this.element.classList.remove("active"),this.refresh(),this.focused=!1,this},refresh(){return this}},Jn=Object.assign(Object.create(On),Gn),Yn={contentType:null,editable:null,focusable:null,disabled:null,init(e={}){Object.assign(this.schema,e);const{focusable:t=!0,disabled:i=!1}=this.schema;return this.children=[],this.focusable=t,this.disabled=i,this},render(){const e=$(),{help:t,style:i,content:n}=this.schema;return L(this.element)||(this.element=ce({class:["btn","static"],dataset:{nature:"static",view:"button",static:"button",id:this.id,ignore:"all"}}),this.focusable&&(this.element.tabIndex=0)),n.forEach((t=>{let i=rs.call(this,t,this.projection.concept,{focusable:!1});e.append(i)})),g(t)||(this.element.title=t),xi.call(this.projection,this.element,i),e.hasChildNodes()&&(this.element.append(e),this.bindEvents()),this.refresh(),this.element},focusIn(){return this.focused=!0,this.element.classList.add("active"),this},focusOut(){return this.messageElement&&(qe(this.messageElement),Ae(this.messageElement)),this.element.classList.remove("active"),this.refresh(),this.focused=!1,this},arrowHandler(e,t){return(!this.editable&&this.parent||!!this.parent)&&this.parent.arrowHandler(e,t)},escapeHandler(e){let t=Ee(e,(e=>0===e.tabIndex));this.environment.resolveElement(t).focus(t)},enterHandler(e){const t=this.projection.schema.findIndex((e=>e.tags.includes(this.schema.tag)));return this.projection.changeView(t),!1},clickHandler(e){let t=this.source;if(this.schema.bind&&(t=this.source.getValue(!0)),this.schema.action){const{type:e,value:i}=this.schema.action;return t.createElement(),!1}return g(this.visualizer)?(this.environment.triggerEvent({name:this.schema.trigger,args:[t]}),!1):(this.environment.triggerEvent({name:this.schema.trigger,args:[this.visualizer]}),!1)},refresh(){return this},bindEvents(){}},Kn=Object.assign(Object.create(On),Yn);var Qn=0;const Zn=()=>"static"+Qn++,es={audio:(e,t,i)=>Object.create(_n,{object:{value:"static"},name:{value:"audio-static"},type:{value:"audio"},id:{value:Zn()},model:{value:e},schema:{value:t},projection:{value:i}}),plink:(e,t,i)=>Object.create(Xn,{object:{value:"static"},name:{value:"plink-static"},type:{value:"plink"},id:{value:Zn()},model:{value:e},schema:{value:t},projection:{value:i}}),image:(e,t,i)=>Object.create(Fn,{object:{value:"static"},name:{value:"image-static"},type:{value:"image"},id:{value:Zn()},model:{value:e},schema:{value:t},projection:{value:i}}),link:(e,t,i)=>Object.create(Hn,{object:{value:"field"},name:{value:"link-static"},type:{value:"link"},id:{value:Zn()},model:{value:e},schema:{value:t},projection:{value:i}}),text:(e,t,i)=>Object.create(qn,{object:{value:"static"},name:{value:"text-static"},type:{value:"text"},id:{value:Zn()},model:{value:e},schema:{value:t},projection:{value:i}}),html:(e,t,i)=>Object.create(Jn,{object:{value:"static"},name:{value:"html-static"},type:{value:"html"},id:{value:Zn()},model:{value:e},schema:{value:t},projection:{value:i}}),button:(e,t,i)=>Object.create(Kn,{object:{value:"static"},name:{value:"button-static"},type:{value:"button"},id:{value:Zn()},model:{value:e},schema:{value:t},projection:{value:i}})},ts={createStatic(e,t,i){const{type:n}=t,s=es[n];if(g(s))throw new Error(`Missing handler: The '${n}' static could not be handled`);var a=s(e,t,i);if(g(a))throw new Error(`Bad request: The '${n}' static could not be created`);return g(a.id)&&(a.id=Zn()),a}};function is(e){return"property"===e.type?this.projection.concept.getProperty(e.name):e}function ns(e,t){const{name:i,tag:n,placeholder:s={},style:a}=e;if(!t.hasAttribute(i)){let e=`Attribute '${i}' does not exist in the concept '${t.name}'`;return this.environment.notify(e,Ye.ERROR),this.environment.addError({source:"projection",code:"attribute_not_found",message:e}),ie({hidden:!0},i)}r(e.required,t.isAttributeRequired(i))&&!t.isAttributeCreated(i)&&t.createAttribute(i);const o={name:i,get created(){return t.isAttributeCreated(i)},schema:e,placeholder:ie({class:["projection-element"],hidden:!0},i),parent:this,projection:this.projection,element:null};if(this.projection.attributes.push(o),!o.created){const{content:e}=s;return o.placeholder=e?rs.call(this,e,t,{focusable:!0}):ie({class:["projection-element","projection-element--placeholder"],tabindex:0,dataset:{object:"attribute",id:i}},`Add ${i}`),o.placeholder.addEventListener("click",(e=>{t.createAttribute(i),this.projection.resolveElement(o.element).focus()})),o.placeholder}{const{target:e,schema:s}=t.getAttributeByName(i);let r=this.projection.model.createProjection(e,n).init();if(r.parent=this.projection,r._style=a,o.element=r.render(),g(o.element))return ie({hidden:!0},i);r.element.parent=this}return o.element}function ss(e,t){const{value:i,placement:n}=e,{target:s,description:a}=t.getAttributeByName(i);let r=this.projection.model.createProjection(s,n.tag).init();r.parent=this.projection,r.render(),g(s.value)||r.element.initValue(s.value),r.element.parent=this;let o=i[0].toUpperCase()+i.substring(1);return r.element.attributeName=o,r.element}function as(e,t){let i=this.projection.model.createProjection(t,e.tag).init();return i.parent=this.projection,i.render(),i.element.parent=this,i.element}function rs(e,t,i={}){const n=r(t,this.projection.concept);if("layout"===e.type){let t=Os.createLayout(this.model,e.layout,this.projection);return t.source=n,t.parent=this,t.init(i),this.model.registerLayout(t),t.render()}if("field"===e.type){let t=Dn.createField(this.model,e.field,this.projection);return t.parent=this,t.init(i),this.model.registerField(t),t.render()}if("static"===e.type){let t=ts.createStatic(this.model,e.static,this.projection);return t.source=n,t.parent=this,t.init(i),this.model.registerStatic(t),t.render()}if("dynamic"===e.type)return rs.call(this,e.dynamic,t,i);if("attribute"===e.type)return ns.call(this,e,n);if("svg-attribute"===e.type)return ss.call(this,e,n);if("external"===e.type)return as.call(this,e,n);if("g-fragment"===e.type){let t=e.name,i=this.model.getGFragmentSchema(t.toLowerCase());return(new DOMParser).parseFromString(i.content.content.replace(/\&nbsp;/g,""),"image/svg+xml").documentElement}if("template"===e.type){let n=e.name;"param"===n.type&&(n=this.projection.getParam(n.name));let s=this.model.getTemplateSchema(n);s.param&&(e.param&&s.param.forEach((t=>{Object.assign(t,e.param.find((e=>e.name===t.name)))})),this.projection.addParam(s.param));const a=$();let r,o=!1;return s.content.forEach((e=>{let n=rs.call(this,e,t,i);if(!L(n))return o=!0,void(r=n);a.append(rs.call(this,e,t,i))})),o?r:a}if("projection"===e.type){const{tag:t,style:i,required:s=!1}=e,a={schema:e,placeholder:ie({class:["projection-element"],hidden:!0}),parent:this,projection:this.projection,element:null};return a.update=function(e,s,r){if(a.element&&(a.element.remove(),a.element=null),n.hasValue()){let e=n.getValue(!0),s=this.projection.model.createProjection(e,t).init();s.placeholder=a.placeholder,s.parent=this.projection,a.element=s.render(),a.placeholder&&a.placeholder.after(a.element),L(a.element)&&xi.call(this.projection,a.element,i),s.element.parent=this.projection.element}},n.register(a),a.update(),a.element||a.placeholder}if("property"===e.type){const{name:t}=e;return this.projection.concept.getProperty(t)}if("html"===e.type){const{html:t}=e;return j(t)}if("state"===e.type){let n={},s=_i.call(this,n,e.state);return rs.call(this,s.content,t,i)}throw console.error(e),new TypeError("Bad argument: The type is not recognized")}const os={focusable:null,readonly:!1,visible:!1,editable:!1,active:!1,container:null,elements:null,children:null,editing:!1,getStyle(){return this.schema.style},setStyle(e){return this.schema.style=e,xi.call(this.projection,this.container,e),this.refresh(),!0},getContainer(){return this.container},isRoot(){return g(this.parent)},getField(e){return this.projection.getField(e)},getStatic(e){return this.projection.getStatic(e)},getLayout(e){return this.environment.getLayout(e)},show(){return We(this.element),this.visible=!0,this.active=!0,this},hide(){return qe(this.element),this.visible=!1,this},toggle(){return ze(this.container),this.visible=!this.visible,this},_focusIn:e=>!1,spaceHandler(e){return e===this.container&&!g(this.parent)&&this.parent.spaceHandler(this.container)},_spaceHandler(e){return console.warn(`CTRL_SPACE_HANDLER NOT IMPLEMENTED FOR ${this.name}`),!1},escapeHandler(e){if(this.isRoot())return!1;let t=Ee(e,(e=>0===e.tabIndex)),i=this.environment.resolveElement(t);return!g(i)&&(i.focus(t),!0)},enterHandler(e){let t=we('[tabindex]:not([tabindex="-1"])',this.container),i=this.environment.resolveElement(t);return!g(i)&&(i.focus(),!0)},delete(){var e=this.source.delete();e.success||this.environment.notify(e.message)},deleteHandler(e){if(this.projection.element!==this)return!1;if(!this.projection.optional)return Xe(this.container),!1;let t=Ee(e,(e=>0===e.tabIndex)),i=this.container.cloneNode(!0);this.source.hasParent()&&this.environment.save(this.source.getParent(),i),this.source.delete();let n=this.environment.resolveElement(t);return g(n)||n.focus(),!1},backspaceHandler(e){return console.warn(`BACKSPACE_HANDLER NOT IMPLEMENTED FOR ${this.name}`),!1},arrowHandler(e,t){if(t===this.container)return!g(this.parent)&&this.parent.arrowHandler(e,this.container);let i=rt(t,e,this.container);if(!L(i))return!g(this.parent)&&"layout"===this.parent.object&&this.parent.arrowHandler(e,this.container);let n=this.environment.resolveElement(i);return n&&(h(n.navigate)?n.navigate(e):n.focus()),!0},shiftHandler(e,t){if("up"===e){let e=tt(window.getComputedStyle(this.container).marginTop);this.container.style.marginTop=`${e+1}px`}return!0},_arrowHandler(e,t){return console.warn(`CTRL_ARROW_HANDLER NOT IMPLEMENTED FOR ${this.name}`),!1},clickHandler(e){return console.warn(`CLICK_HANDLER NOT IMPLEMENTED FOR ${this.name}`),!1},controlHandler(e){this.toolbar&&this.toolbar.remove()}},ls={HORIZONTAL:"horizontal",VERTICAL:"vertical"},cs=[{concept:{name:"stack-layout"},type:"layout",tags:[],projection:{type:"stack",orientation:"vertical",disposition:[{type:"attribute",name:"orientation"}]}}],hs={orientation:null,args:null,init(e={}){const{orientation:t=ls.HORIZONTAL,editable:i=!0,focusable:n=!1}=this.schema;return this.orientation=t,this.focusable=n,this.editable=i,this.elements=[],this.children=[],this.args=e,Object.assign(this,e),this},getOrientation(){return this.orientation},setOrientation(e){this.orientation=e,this.refresh()},render(){const{disposition:e,style:t,help:i}=this.schema;if(!Array.isArray(e))throw new SyntaxError("Bad disposition");const n=$();L(this.container)||(this.container=z({class:["layout-container","stack-layout"],title:i,dataset:{nature:"layout",layout:"stack",id:this.id}})),g(this.informations)&&(this.informations=new Map);for(let t=0;t<e.length;t++){let i=rs.call(this,e[t],null,this.args),s=e[t],a=this.environment.resolveElement(i);if("dynamic"===s.type&&"attribute"===s.dynamic.type){switch(a.object){case"field":this.informations.set(s.dynamic.name,a);break;case"layout":a.informations.forEach(((e,t)=>{this.informations.set(t,e)}))}g(this.informations.get("undefined"))||(this.informations.set(s.dynamic.name,this.informations.get("undefined")),this.informations.delete("undefined"))}"field"===s.type&&this.informations.set("undefined",a),"layout"===s.type&&a.informations.forEach(((e,t)=>{this.informations.set(t,e)})),a&&(a.parent=this),this.elements.push(i),n.append(i)}return this.focusable?this.container.tabIndex=0:this.container.dataset.ignore="all",xi.call(this.projection,this.container,t),n.hasChildNodes()&&(this.container.append(n),this.bindEvents()),this.container.style.display="flex",this.container.style.flexWrap="nowrap",this.refresh(),this.container},design(){return{concept:[{name:"stack-layout",nature:"concrete",attributes:[{name:"orientation",target:{name:"string",default:this.orientation,constraint:{values:["horizontal","vertical"]}}}]}],projection:cs,handlers:{orientation:(e,t)=>{this.setOrientation(t)}}}},refresh(){return this.orientation===ls.VERTICAL?this.container.style.flexDirection="column":this.orientation===ls.HORIZONTAL&&(this.container.style.flexDirection="row"),this},focus(e){if(this.focusable)this.container.focus();else{let e=we('[tabindex]:not([tabindex="-1"])',this.container);if(g(e))return!1;let t=this.environment.resolveElement(e);t&&t.focus(e)}},focusIn(){return this.focused=!0,this.container.classList.add("active"),this.container.classList.add("focus"),this},focusOut(){return this.container.classList.remove("active"),this.container.classList.remove("focus"),this.focused=!1,this},bindEvents(){this.container.addEventListener("change",(e=>{const{target:t}=e,{prop:i}=t.dataset;"orientation"===i&&this.setOrientation(t.value)})),this.projection.registerHandler("view.changed",((e,t)=>{t&&t.parent===this.projection&&(e.parent=this)}))}},us=Object.assign({},os,hs),ds={args:null,init(e={}){const{editable:t=!0,focusable:i=!1}=this.schema;return this.focusable=i,this.editable=t,this.elements=[],this.children=[],this.args=e,Object.assign(this,e),this},render(){const{disposition:e,style:t,help:i}=this.schema;if(!Array.isArray(e))throw new SyntaxError("Bad disposition");const n=$();L(this.container)||(this.container=z({class:["layout-container"],title:i,dataset:{nature:"layout",layout:"wrap",id:this.id}})),g(this.informations)&&(this.informations=new Map);for(let t=0;t<e.length;t++){let i=rs.call(this,e[t],this.source,this.args),s=e[t],a=this.environment.resolveElement(i);if("dynamic"===s.type&&"attribute"===s.dynamic.type){switch(a.object){case"field":this.informations.set(s.dynamic.name,a);break;case"layout":a.informations.forEach(((e,t)=>{this.informations.set(t,e)}))}g(this.informations.get("undefined"))||(this.informations.set(s.dynamic.name,this.informations.get("undefined")),this.informations.delete("undefined"))}"field"===s.type&&this.informations.set("undefined",a),"layout"===s.type&&a.informations.forEach(((e,t)=>{this.informations.set(t,e)})),a&&(a.parent=this),this.elements.push(i),n.append(i)}return this.focusable?this.container.tabIndex=0:this.container.dataset.ignore="all",xi.call(this.projection,this.container,t),n.hasChildNodes()&&(this.container.append(n),this.bindEvents()),this.collapsed&&this.collapse(!0),this.container.style.display="inline-flex",this.container.style.alignItems="baseline",this.refresh(),this.container},refresh(){return this.collapsed?this.container.classList.add("collapsed"):this.container.classList.remove("collapsed"),this},focusIn(){return this.focused=!0,this.container.classList.add("active"),this.container.classList.add("focus"),this},focusOut(){return this.container.classList.remove("active"),this.container.classList.remove("focus"),this.focused=!1,this},focus(e){if(this.focusable)this.container.focus();else{let e=we('[tabindex]:not([tabindex="-1"])',this.container);if(g(e))return!1;let t=this.environment.resolveElement(e);t&&t.focus(e)}},bindEvents(){this.projection.registerHandler("view.changed",((e,t)=>{t&&t.parent===this.projection&&(e.parent=this)}))}},ps=Object.assign({},os,ds),ms={elements:null,edit:!1,btnEdit:!1,btnCollapse:!1,menu:!1,collapsed:!1,init(e={}){const{editable:t=!0,collapsible:i=!1,focusable:n=!1}=this.schema;return this.focusable=n,this.collapsible=i,this.editable=t,this.elements=[],this.children=[],Object.assign(this,e),this},collapse(e){if(!this.collapsed)return this.collapseContainer=z({class:"layout-container-collapse"},this.elements),this.btnCollapse.after(this.collapseContainer),this.collapsed=!0,this.refresh(),this},expand(e){if(!this.collapsed)return;let t=$(Array.from(this.collapseContainer.children));return this.btnCollapse.after(t),this.collapseContainer.remove(),this.collapsed=!0,this.refresh(),this},refresh(){return this.collapsed?this.container.classList.add("collapsed"):this.container.classList.remove("collapsed"),this},render(){const{disposition:e,style:t,help:i}=this.schema;if(!Array.isArray(e))throw new SyntaxError("Bad disposition");const n=$();L(this.container)||(this.container=z({class:["layout-container"],dataset:{nature:"layout",layout:"table"}})),this.focusable?this.container.tabIndex=-1:this.container.dataset.ignore="all";for(let t=0;t<e.length;t++){let i=e[t],s=z({class:["table-row"]});s.style.display="table-row";for(let e=0;e<i.length;e++){const t=i[e];let n=z({class:["table-cell"]},rs.call(this,t.content));n.style.display="table-cell",xi.call(this.projection,n,t.style),s.append(n)}n.append(s)}return xi.call(this.projection,this.container,t),n.hasChildNodes()&&(this.container.append(n),this.bindEvents()),this.container.style.display="table",this.refresh(),this.container},bindEvents(){this.projection.registerHandler("view.changed",((e,t)=>{t&&t.parent===this.projection&&(e.parent=this)})),this.btnCollapse&&this.btnCollapse.addEventListener("click",(e=>{this.collapsed?this.expand():this.collapse()}))}},fs=Object.assign({},os,ms),vs={ROW:"row",COLUMN:"column"},gs={start:"flex-start",end:"flex-end","flex-start":"flex-start","flex-end":"flex-end",center:"center",stretch:"stretch",baseline:"baseline"},bs={start:"flex-start",end:"flex-end","flex-start":"flex-start","flex-end":"flex-end",center:"center","space-between":"space-between","space-around":"space-around","space-evenly":"space-evenly"},ys={orientation:null,wrappable:null,alignItems:null,justifyContent:null,args:null,init(e={}){const{orientation:t=vs.ROW,wrappable:i=!0,alignItems:n,justifyContent:s,editable:a=!0,focusable:r=!1}=this.schema;return this.orientation=t,this.wrappable=i,this.alignItems=n,this.justifyContent=s,this.focusable=r,this.editable=a,this.elements=[],this.children=[],this.args=e,Object.assign(this,e),this},getOrientation(){return this.orientation},setOrientation(e){k(vs,e)&&(this.orientation=e,this.refresh())},collapse(e=!1){if(!this.collapsed||e)return this.collapseContainer=z({class:"layout-container-collapse"},this.elements),this.btnCollapse.after(this.collapseContainer),this.collapsed=!0,this.refresh(),this},expand(e=!1){if(!this.collapsed&&!e)return;let t=$(Array.from(this.collapseContainer.children));return this.btnCollapse.after(t),this.collapseContainer.remove(),this.collapsed=!1,this.refresh(),this},render(){const{disposition:e,style:t,help:i}=this.schema;if(!Array.isArray(e))throw new SyntaxError("Bad disposition");const n=$();L(this.container)||(this.container=z({class:["layout-container"],dataset:{nature:"layout",layout:"flex",id:this.id}})),i&&(this.container.title=i),g(this.informations)&&(this.informations=new Map);for(let t=0;t<e.length;t++){let i=rs.call(this,e[t],null,this.args),s=e[t],a=this.environment.resolveElement(i);if("dynamic"===s.type&&"attribute"===s.dynamic.type){switch(a.object){case"field":this.informations.set(s.dynamic.name,a);break;case"layout":a.informations.forEach(((e,t)=>{this.informations.set(t,e)}))}g(this.informations.get("undefined"))||(this.informations.set(s.dynamic.name,this.informations.get("undefined")),this.informations.delete("undefined"))}"field"===s.type&&this.informations.set("undefined",a),"layout"===s.type&&a.informations.forEach(((e,t)=>{this.informations.set(t,e)})),a&&(a.parent=this),this.elements.push(i),n.append(i)}return this.focusable?this.container.tabIndex=0:this.container.dataset.ignore="all",xi.call(this.projection,this.container,t),n.hasChildNodes()&&(this.container.append(n),this.bindEvents()),this.collapsed&&this.collapse(!0),this.container.style.display="flex",this.refresh(),this.container},refresh(){return this.container.style.flexDirection=this.orientation,this.container.style.justifyContent=bs[this.justifyContent],this.container.style.alignItems=gs[this.alignItems],this.wrappable?this.container.style.flexWrap="wrap":this.container.style.flexWrap="nowrap",this},focus(e){if(this.focusable)this.container.focus();else{let e=we('[tabindex]:not([tabindex="-1"])',this.container);if(g(e))return!1;let t=this.environment.resolveElement(e);t&&t.focus(e)}},focusIn(){return this.focused=!0,this.container.classList.add("active"),this.container.classList.add("focus"),this},focusOut(){return this.container.classList.remove("active"),this.container.classList.remove("focus"),this.focused=!1,this},bindEvents(){this.container.addEventListener("change",(e=>{const{target:t}=e,{prop:i}=t.dataset;"orientation"===i&&this.setOrientation(t.value)})),this.projection.registerHandler("view.changed",((e,t)=>{t&&t.parent===this.projection&&(e.parent=this)})),this.btnCollapse&&this.btnCollapse.addEventListener("click",(e=>{this.collapsed?this.expand():this.collapse()}))}},ws=Object.assign({},os,ys),ks={content:"",init(){return this},render(){const e=$(),{content:t,attributes:i=[],link:n}=this.schema;var s=new DOMParser;if(L(this.element)||(this.element=z({id:this.id,class:[],dataset:{nature:"layout",view:"svg",id:this.id}})),this.element.setAttribute("tabIndex",0),this.focusable=!0,L(this.content)||(this.content=s.parseFromString(t.replace(/\&nbsp;/g,""),"image/svg+xml").documentElement,e.appendChild(this.content)),g(this.link)&&!g(n)){this.link=this.projection.schema.findIndex((e=>e.tags.includes(n.tag)));let e=this.content.querySelector("[data-"+n.marker+"]");n.type="svg-link",n.external?e.addEventListener("click",(e=>{let t=this.source,i=this.environment.createProjection(t,n.tag),s=this.environment.findWindow("side-instance");g(s)&&(s=this.environment.createWindow("side-instance"),s.container.classList.add("model-projection-sideview")),s.instances.size>0&&Array.from(s.instances)[0].delete();let a=this.environment.createInstance(t,i,{type:"projection",close:"DELETE-PROJECTION"});s.addInstance(a)})):e.addEventListener("click",(e=>{this.projection.changeView(this.link)}))}return g(this.deciders)&&!o(i)&&(this.deciders=this.attributeHandler(i),this.update()),e.hasChildNodes()&&this.element.appendChild(e),this.element},attributeHandler(e){let t=[];return e.forEach((e=>{switch(e.placement.type){case"in-place":let i=this.content.querySelector("[data-"+e.placement.marker+"]");e.type="svg-attribute";let n=rs.call(this,e,null,this.args);g(e.property)||(n.property=xs(e.property)),t.push(n),i.appendChild(n.content);break;case"link-place":let{type:s,sd:a=[],dd:r=[]}=e.placement;g(this.linkAttr)&&(this.linkAttr=[]);let l={};l.name=e.value,l.field=this.informations.get(e.value),"list"===l.field.type?l.value=l.field.items:l.value=l.field.value,g(e.property)||(l.property=xs(e.property)),o(a)||(l.sd=new Map,a.forEach((e=>{e.type="template";const t={};var i=rs.call(this,e,null,this.args);t.render=i,t.parent=this.content.querySelector("[data-"+e.marker+"]"),l.sd.set(i.mv,t)}))),!g(this.dd)||o(r)||g(r)||(l.dd=[],r.forEach((e=>{e.type="template";var t=rs.call(this,e,null,this.args);l.dd.push(t),t.property=l.property;var i=this.content.querySelector("[data-"+e.marker+"]");g(i)?"before"===this.content.getAttribute("data-"+e.marker)?this.content.prepend(t.content):this.content.appendChild(t.content):"before"===i.getAttribute("data-"+e.marker)?i.prepend(t.content):i.appendChild(t.content)}))),this.linkAttr.push(l)}})),t},update(){g(this.linkAttr)||this.linkAttr.forEach((e=>{this.clearStatics(e.sd,e.value),g(e.property)?this.clearDynamics(e.dd,e.value):this.clearDynamics(e.dd,this.translateProperty(e.value,e.property)),"list"===e.field.type?e.value=e.field.items:e.value=e.field.value,g(e.property)?this.updateDynamics(e.dd,e.value):this.updateDynamics(e.dd,this.translateProperty(e.value,e.property)),this.updateStatics(e.sd,e.value)})),g(this.deciders)||o(this.deciders)||this.deciders.forEach((e=>{e.update(e.field.value)}))},clearDynamics(e,t){g(e)||e.forEach((e=>{e.clear(t)}))},updateDynamics(e,t){g(e)||e.forEach((e=>{e.update(t)}))},clearStatics(e,t){if(!g(e)){let i=e.get(t);g(i)||i.parent.removeChild(i.render.content)}},updateStatics(e,t){if(!g(e)){let i=e.get(t);g(i)||i.parent.appendChild(i.render.content)}},focus(){return this.element.focus(),this.focused=!0,g(this.deciders)||this.deciders.forEach((e=>{e.focusOut()})),this},focusIn(){return this.focus(),this},focusOut(){return this.focused=!1,this},arrowHandler(e,t){if(t===this.element)return!g(this.parent)&&this.parent.arrowHandler(e,this.element);let i=function(e,t,i,n){return"up"===t?function(e,t,i=!0){const n=t.deciders,s=e.getAttribute("y"),a=e.getAttribute("x");if(i&&at(e,t,"top"))return null;let r=null,o=99999,l=99999;for(let t=0;t<n.length;t++){const i=n[t].foreign;if(i===e)continue;const c=Number(i.getAttribute("y"))+Number(i.getAttribute("height")),h=i.getAttribute("x");let u=Math.abs(s-c),d=Math.abs(a-h),p=u+1.2*d;Number(s)>=Number(c)-1&&(p<o||p===o&&d<l)&&(r=n[t],o=p,l=d)}return r}(e,i,n):"down"===t?function(e,t,i=!0){const n=t.deciders,s=Number(e.getAttribute("y"))+Number(e.getAttribute("height")),a=e.getAttribute("x");if(i&&at(e,t,"bottom"))return null;let r=null,o=99999,l=99999;for(let t=0;t<n.length;t++){const i=n[t].foreign;if(i===e)continue;const c=i.getAttribute("y"),h=i.getAttribute("x");let u=Math.abs(s-c),d=Math.abs(a-h),p=u+1.2*d;Number(s)<=Number(c)+1&&(p<o||p===o&&d<l)&&(r=n[t],o=p,l=d)}return r}(e,i,n):"left"===t?function(e,t,i=!0){const n=t.deciders,s=e.getAttribute("y"),a=e.getAttribute("x");if(i&&at(e,t,"left"))return null;let r=null,o=99999,l=99999;for(let t=0;t<n.length;t++){const i=n[t].foreign;if(i===e)continue;const c=i.getAttribute("y"),h=Number(i.getAttribute("x"))+Number(i.getAttribute("width"));let u=Math.abs(s-c),d=1.2*u+Math.abs(a-h);a>=h-1&&(d<o||d===o&&$vist<vist)&&(r=n[t],l=u,o=d)}return r}(e,i,n):"right"===t?function(e,t,i=!0){const n=t.deciders,s=e.getAttribute("y"),a=Number(e.getAttribute("x"))+Number(e.getAttribute("width"));if(i&&at(e,t,"bottom"))return null;let r=null,o=99999,l=99999;for(let t=0;t<n.length;t++){const i=n[t].foreign;if(i===e)continue;const c=i.getAttribute("y"),h=i.getAttribute("x");let u=Math.abs(s-c),d=1.2*u+Math.abs(a-h);Number(a)<=Number(h)+1&&(d<o||d===o&&u<l)&&(r=n[t],l=u,o=d)}return r}(e,i,n):(console.error("unknown direction",t),null)}(t.foreign,e,this,!1);return!g(i)&&(t.focusOut(),i.focus(),!0)},enterHandler(e){this.index=0,this.deciders[0].focusIn()},escapeHandler(e){if(e!==this.element)return this.focus();let t=Ee(e,(e=>0===e.tabIndex)),i=this.environment.resolveElement(t);return i&&i.focus(t),!1},setIndex(e){let t=0;this.deciders.forEach((i=>{i.id!==e.id?t++:this.index=t}))},translateProperty(e,t){let i,n=new Map;return t.forEach((t=>{switch(t.type){case"affectation":n.set(t.target,this.translateProc(t.proc,n,e));break;case"result":return i=this.translateProc(t.proc,n,e),i.value}})),i.value},translateProc(e,t,i){let n={};const s={};let a;switch(e.type){case"filter":let r;if(a=t.get(e.target),"V"===e.order[0]?(n.value=i,n.type=this.source.name):n=t.get(e.order[0]),s.type=n.type,"string"===n.type){r="";for(let e=0;e<n.value.length;e++){const t={type:"string"};t.value=n.value.charAt(e),this.evaluate(a,t)&&(r+=n.value.charAt(e))}return s.result=r,s}return"table"===n.type?(r=[],n.value.forEach(((e,t)=>{const i={type:"table"};i.value=this.projection.resolveElement(e).value;let n=this.evaluate(a,i);n&&r.push(n)}))):(r=[],n.value.forEach((e=>{this.evaluate(a,e)&&r.push(e)}))),s.type=n.type,s.value=r,s;case"lenght":return s.type="int","V"===e.target?(n.value=i,i instanceof Map?n.type="list":n.type=this.source.name):n=t.get(e.target),"list"===n.type?s.value=n.value.size:s.value=n.value.length,s;case"check":return a=t.get(e.pred),s.type="bool","V"===e.param?(n.value=i,n.type=this.source.name):n=t.get(e.param),s.value=this.evaluate(a,n),s;case"pred":return e}},evaluate(e,t){switch(e.vars.value=t.value,e.op){case"!=":return e.vars.name===e.order[0]?t.value!==e.order[1]:t.value!=e.order[0];case"=":return e.vars.name===e.order[0]?t.value===e.order[1]:t.value===e.order[0];case"<=":return e.vars.name===e.order[0]?t.value<=e.order[1]:t.value<=e.order[0];case"<":return e.vars.name===e.order[0]?t.value<e.order[1]:t.value<e.order[0];case"<=":return e.vars.name===e.order[0]?t.value<=e.order[1]:t.value<=e.order[0];case">":return e.vars.name===e.order[0]?t.value>e.order[1]:t.value>e.order[0];case"funI":return t.value[e.fun].call(t.value,e.order[0]);case"funO":return window[e.fun](...e.args)}}};function xs(e){let t=e.split(";"),i=[];return t.forEach((e=>{const t={};let n=e.indexOf(":"),s=e.substring(0,n).replace(/\s/g,""),a=e.substring(n+1,n.lenght).replace(/\s/g,"");switch(s){case"VAR":t.type="affectation";let e=a.indexOf("=");t.target=a.substring(0,e).replace(/\s/g,"");let n=a.substring(e+1,a.lenght).replace(/\s/g,"");t.proc=Es(n),i.push(t);break;case"RETURN":t.type="result",t.proc=Es(a.replace(/\s/g,"")),i.push(t)}})),i}function Es(e){const t={};let i,n,s,a={},r=e.indexOf("(");if(-1===r)return t.type="value",t.value=e,t;let o=e.substring(0,r),l=e.substring(r+1,e.length-1);switch(o){case"COUNT":return t.type="lenght",t.target=l,t;case"PREDICATE":t.type="pred";let e=l.lastIndexOf("}")+1,o=l.substring(1,e-1);for(i=o.indexOf(",");-1!==i;)a.name=o.substring(0,i),a.value="",o=o.substring(i+1,o.lenght),i=o.indexOf(",");""!==o&&(a.name=o,a.value=""),t.vars=a;let c=l.substring(e+1,l.length-1);r=c.indexOf("("),t.op=c.substring(0,r);let h=c.substring(r+1,c.lenght);switch(n=[],i=h.indexOf(","),t.op){case"funI":for(t.fun=h.substring(0,i),h=h.substring(i+1,h.length),i=h.indexOf(","),t.caller=h.substring(0,i),h=h.substring(i+1,h.length),i=h.indexOf(",");-1!==i;)n.push(h.substring(0,i)),h=h.substring(i+1,h.lenght),i=h.indexOf(",");""!==h&&n.push(h),t.order=n;break;default:for(;-1!==i;)n.push(h.substring(0,i)),h=h.substring(i+1,h.lenght),i=h.indexOf(",");""!==h&&n.push(h),t.order=n}return t;case"FILTER":if(t.type="filter",r=l.indexOf("("),-1===r)return t.target=l,t;for(s=l.substring(r+1,l.length-1),t.target=l.substring(0,r),n=[],i=s.indexOf(",");-1!==i;)n.push(s.substring(0,i)),s=s.substring(i+1,s.length),i=s.indexOf(",");return""!==s&&n.push(s),t.order=n,t;case"CHECK":t.type="check",r=l.indexOf("(");let u=l.substring(r+1,l.length-1);return t.pred=l.substring(0,r),t.param=u,t}}const Ts=Object.assign(Object.create(os),ks);function Ns(e){const{placeholder:t="",type:i}=e;let n=is.call(this,t);return this.readonly||this.resizable?createSpan({class:["field--textbox__input","field--textbox__input-pseudo"],editable:!this.readonly,title:n,dataset:{placeholder:n,nature:"field-component",view:this.type,id:this.id}}):this.multiline?createTextArea({class:["field--textbox__input"],placeholder:n,title:n,dataset:{nature:"field-component",view:this.type,id:this.id}}):ne({class:["field--textbox__input"],type:r(i,"text"),placeholder:n,title:n,dataset:{nature:"field-component",view:this.type,id:this.id}})}const As={init(){return this},render(){const e=$(),{current:t={},root:i}=this.schema;this.isRoot=i;var n=new DOMParser;if(L(this.element)||(this.element=z({id:this.id,dataset:{nature:"layout",view:"visualizer",id:this.id}})),!L(this.content)&&(this.svg=this.source.value,!g(this.svg))){if(this.content=n.parseFromString(this.svg.replace(/\&nbsp;/g,""),"image/svg+xml").documentElement,"svg"!==this.content.tagName){let e=n.parseFromString('<svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg"/>',"image/svg+xml").documentElement;e.appendChild(this.content),this.content=e}e.appendChild(this.content)}if(!L(this.input)){const{placeholder:i="",type:n,style:s}=t;this.input=Ns.call(this,t),this.disabled&&(this.input.disabled=!0),this.focusable?this.input.tabIndex=0:this.input.dataset.ignore="all",xi.call(this,this.input,s),this.multiline&&this.input.classList.add("field--textbox__input--multiline"),e.append(this.input)}if(i&&g(this.buttons)){this.buttons=[];const t={type:"static",static:{type:"button",trigger:"make interactive",content:[{type:"static",static:{type:"text",content:"Interactive",focusable:!0}}]}};this.mkeInteractive=rs.call(this,t,null,this.args);let i=this.environment.resolveElement(this.mkeInteractive);i.parent=this,i.visualizer=this,this.buttons.push(i),e.append(this.mkeInteractive);const n={type:"static",static:{type:"button",trigger:"make dynamic",content:[{type:"static",static:{type:"text",content:"Dynamic",focusable:!0}}]}};this.mkeDynamic=rs.call(this,n,null,this.args),i=this.environment.resolveElement(this.mkeDynamic),i.visualizer=this,i.parent=this,this.buttons.push(i),e.append(this.mkeDynamic);const s={type:"static",static:{type:"button",trigger:"make static",content:[{type:"static",static:{type:"text",content:"Static",focusable:!0}}]}};this.mkeStatic=rs.call(this,s,null,this.args),i=this.environment.resolveElement(this.mkeStatic),i.visualizer=this,i.parent=this,this.buttons.push(i),e.append(this.mkeStatic)}return e.hasChildNodes()&&this.element.appendChild(e),this.bindEvent(),this.element},focusIn(e){return this.input.focus()},focusOut(){},createProj(){let e=this.current;"tspan"===e.tagName.toLowerCase()&&(e=e.parentNode);let t=new XMLSerializer;return this.cleanInput(),this.updateInput(t.serializeToString(this.content)),'<g xmlns="http://www.w3.org/2000/svg">'+t.serializeToString(e)+"</g>"},cleanInput(){this.input.value="",this.current.parentNode.removeChild(this.current)},updateInput(e){this.source.setValue(e)},bindEvent(){this.content.addEventListener("click",(e=>{var t=new XMLSerializer;let i=e.target;"tspan"===i.tagName.toLowerCase()&&(i=i.parentNode);var n=t.serializeToString(i);this.input.value=n,this.current=i})),this.input.addEventListener("keydown",(e=>{if(""!==this.input.value&&!g(this.current)&&"Enter"===e.key){var t=(new DOMParser).parseFromString(this.input.value.replace(/\&nbsp;/g,""),"image/svg+xml").documentElement;this.current!==this.content?this.current.replaceWith(t):this.content=t,this.current=t;var i=new XMLSerializer;this.isRoot?this.updateInput(i.serializeToString(this.content)):this.updateInput(i.serializeToString(this.content.childNodes[0]))}}))}},Cs=Object.assign(Object.create(os),As),Ls={init(){return this.startingPoint=r(this.schema.startingPoint,{x:129,y:190}),this.next=r(this.schema.next,{x:0,y:40}),this.items=new Map,this.places=new Map,this.color="#d5d5d5",this},render(){const{base:e,attributes:t=[],anchor:i="top",width:n=400,height:s=400,baseX:a,baseY:r,baseRatio:o=.2}=this.schema,l=$();if(L(this.element)||(this.element=z({id:this.id,class:[],dataset:{nature:"layout",view:"pattern",id:this.id}})),g(this.svgArea)&&(this.svgArea=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.templateArea=document.createElementNS("http://www.w3.org/2000/svg","g"),this.itemsArea=document.createElementNS("http://www.w3.org/2000/svg","g"),this.svgArea.appendChild(this.templateArea),this.svgArea.appendChild(this.itemsArea),l.appendChild(this.svgArea)),L(this.base)||(this.base=rs.call(this,e.pattern),this.baseHolder=this.createHolder(this.base),this.baseHolder.setAttribute("x",0),this.baseHolder.setAttribute("y",0),this.svgArea.prepend(this.baseHolder)),g(this.buttons)){this.buttons=new Map,this.button=rs.call(this,t[0].attribute);let e=this.createHolder(this.button);e.setAttribute("x",this.startingPoint.x),e.setAttribute("y",this.startingPoint.y),e.dataset.x=this.startingPoint.x,e.dataset.y=this.startingPoint.y,this.places.set("x"+this.startingPoint.x+"y"+this.startingPoint.y,e),this.button.parentNode.style.background="white",this.buttons.set(this.button,e),this.itemsArea.appendChild(e)}return l.hasChildNodes()&&this.element.append(l),this.bindEvents(),this.element},createHolder(e,t){let i=document.createElementNS("http://www.w3.org/2000/svg","svg"),n=document.createElementNS("http://www.w3.org/2000/svg","foreignObject");return i.appendChild(n),n.appendChild(e),g(t)||(n.style.background=this.color),i},adapt(e){return this.adaptForeign(e.parentNode,e),this.adaptSVG(e.parentNode.parentNode,e.parentNode)},adaptForeign(e,t){t.style.width="fit-content";let i=t.getBoundingClientRect();e.setAttribute("width",i.width),e.setAttribute("height",i.height)},adaptSVG(e,t){let i=Number(t.getAttribute("width")),n=Number(t.getAttribute("height"));return e.setAttribute("width",i),e.setAttribute("height",n),e.setAttribute("viewBox","0 0 "+i+" "+n),{w:i,h:n}},upSize(e,t){g(this.svgArea.getAttribute("width"))&&(this.svgArea.setAttribute("width",e),this.svgArea.setAttribute("height",t));let i=Number(this.svgArea.getAttribute("width")),n=Number(this.svgArea.getAttribute("height"));if(i<e||n<t){console.log(this.schema.attributes[0].template);const e=this.schema.attributes[0].template,t=rs.call(this,{type:"g-fragment",name:e});let i=this.createHolder(t,this.color);this.svgArea.prepend(i),this.adapt(t),g(this.last)&&(this.last=this.svgArea),this.addTemplate(i),this.last=i}},bindEvents(){this.projection.registerHandler("displayed",(e=>{const t=this.adapt(this.base);this.upSize(t.w,t.h);const i=this.adapt(this.button);this.center(i,this.buttons.get(this.button))}))},createItem(e,t){const i=t.item;if(!this.model.hasProjectionSchema(e,i.tag))return"";let n=this.model.createProjection(e);return n.optional=!0,n.parent=this.projection,n.init().render()},addTemplate(e){let t=Number(this.last.getAttribute("width"))/2+Number(this.last.getAttribute("x"))-e.getAttribute("width")/2,i=Number(this.last.getAttribute("height"))+Number(this.last.getAttribute("y"));e.setAttribute("x",t),e.setAttribute("y",i);let n=Number(this.svgArea.getAttribute("height"))+Number(e.getAttribute("height"));this.svgArea.setAttribute("height",n),console.log(e)},addItem(e,t){if(!g(this.items.get(e.id))||this.prio!=t.element)return;let i=this.buttons.get(t.element),n=this.createItem(e,t),s=this.createHolder(n,this.color);this.items.set(e.id,s),this.itemsArea.appendChild(s);let a=this.adapt(n);this.placeItem(s,i),this.center(a,s),this.placeButton(i,t.element)},placeItem(e,t){let i=Number(t.getAttribute("x")),n=Number(t.getAttribute("y"));e.setAttribute("x",i),e.setAttribute("y",n);let s=Number(t.dataset.x),a=Number(t.dataset.y);e.dataset.x=s,e.dataset.y=a,this.places.set("x"+s+"y"+a,e)},center(e,t){t.setAttribute("x",Number(t.dataset.x)-e.w/2)},placeButton(e,t){let i=Number(e.getAttribute("x"))+this.next.x,n=Number(e.dataset.x)+this.next.x,s=Number(e.getAttribute("y"))+this.next.y,a=Number(e.dataset.y)+this.next.y;g(this.places.get("x"+n+"y"+a))?(e.setAttribute("x",i),e.dataset.x=n,e.setAttribute("y",s),e.dataset.y=a,this.places.set("x"+n+"y"+a,e),this.upSize(i+Number(e.getAttribute("width")),s+Number(e.getAttribute("height")))):(e.remove(),this.buttons.delete(t))},removeItem(e){let t=this.items.get(e.id);g(t)||(this.createNewButton(t),t.remove(),this.items.delete(e.id))},createNewButton(e){let t=Number(e.dataset.x),i=Number(e.dataset.y),n=rs.call(this,this.schema.attributes[0].attribute);this.createHolder(n);let s=this.createHolder(n);s.setAttribute("x",t),s.setAttribute("y",i),s.dataset.x=t,s.dataset.y=i,this.places.set("x"+this.startingPoint.x+"y"+this.startingPoint.y,s),n.parentNode.style.background="white",this.itemsArea.appendChild(s);const a=this.adapt(n);this.center(a,s),this.buttons.set(n,s)}},Ss=Object.assign({},os,Ls);var Is=0;const Ds=()=>"layout"+Is++,js={stack:(e,t,i)=>Object.create(us,{object:{value:"layout"},name:{value:"stack-layout"},type:{value:"stack"},id:{value:Ds()},model:{value:e},schema:{value:t},projection:{value:i},source:{value:i.concept,writable:!0}}),wrap:(e,t,i)=>Object.create(ps,{object:{value:"layout"},name:{value:"wrap-layout"},type:{value:"wrap"},id:{value:Ds()},model:{value:e},schema:{value:t},projection:{value:i},source:{value:i.concept,writable:!0}}),table:(e,t,i)=>Object.create(fs,{object:{value:"layout"},name:{value:"table-layout"},type:{value:"table"},id:{value:Ds()},model:{value:e},schema:{value:t},projection:{value:i},source:{value:i.concept,writable:!0}}),flex:(e,t,i)=>Object.create(ws,{object:{value:"layout"},name:{value:"flex-layout"},type:{value:"flex"},id:{value:Ds()},model:{value:e},schema:{value:t},projection:{value:i},source:{value:i.concept,writable:!0}}),svg:(e,t,i)=>Object.create(Ts,{object:{value:"layout"},name:{value:"svg-layout"},type:{value:"svg"},id:{value:Ds()},model:{value:e},schema:{value:t},projection:{value:i},source:{value:i.concept,writable:!0}}),visualizer:(e,t,i)=>Object.create(Cs,{object:{value:"layout"},name:{value:"svg-layout"},type:{value:"svg"},id:{value:Ds()},model:{value:e},schema:{value:t},projection:{value:i},source:{value:i.concept,writable:!0}}),pattern:(e,t,i)=>Object.create(Ss,{object:{value:"layout"},name:{value:"pattern-layout"},type:{value:"pattern"},id:{value:Ds()},model:{value:e},schema:{value:t},projection:{value:i},source:{value:i.concept,writable:!0}})},Os={createLayout(e,t,i){const{type:n}=t,s=js[n];if(g(s))throw new TypeError(`Missing handler: The '${n}' layout could not be handled`);const a=s(e,t,i);if(g(a))throw new Error(`Bad request: The '${n}' layout could not be created`);return a.createLayout=this.createLayout,g(a.id)&&(a.id=Ds()),a}},Rs={},_s={init(){const{dimensions:e={}}=this.schema;return this.ratio=.4,this.width=r(e.width,500),this.height=r(e.height,500),this.buttons=[],this.dummies=[],this.transLink=[],this.transLinkId=[],this.arrowInventory=[],this.linkInventory={},this},render(){const{attributes:e=[],center:t,direction:i,intensity:n,fixed:s=[],arrowManagement:a}=this.schema;switch(this.center=t,this.intensity=500,i){case"-":this.direction=-1;break;default:this.direction=1}const r=$();if(g(this.instances)&&(this.instances=new Map),g(this.holders)&&(this.holders=new Map),L(this.container)||(this.container=z({class:["algorithm-container"],dataset:{nature:"algorithm",algorithm:"force",id:this.id},tabindex:1}),this.container.style.border="solid 1px black"),L(this.interactionsArea)||(this.interactionsArea=z({class:["layout-container","projection"],dataset:{nature:"layout",layout:"flex",id:"iA"+this.id,projection:-1},tabindex:1}),r.append(this.interactionsArea)),this.focusable=!0,L(this.ids)||(this.ids=[]),o(e)||e.forEach((e=>{let t=rs.call(this,e);this.interactionsArea.append(t);let i=this.environment.resolveElement(t);i.parent=this,this.buttons.push(i)})),L(this.svgArea)||(this.svgArea=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.svgArea.setAttribute("width",this.width),this.svgArea.setAttribute("height",this.height),this.linksArea=document.createElementNS("http://www.w3.org/2000/svg","g"),this.linksArea.classList.add("linkArea"),this.nodesArea=document.createElementNS("http://www.w3.org/2000/svg","g"),this.nodesArea.classList.add("nodeArea"),this.definitionsArea=document.createElementNS("http://www.w3.org/2000/svg","g"),this.definitionsArea.classList.add("definitionArea"),this.svgArea.appendChild(this.linksArea),this.svgArea.appendChild(this.nodesArea),this.svgArea.appendChild(this.definitionsArea),this.svgArea.setAttribute("tabindex",1),this.svgArea.setAttribute("data-projection",-1),this.svgArea.setAttribute("id","sA"+this.id)),r.append(this.svgArea),!L(this.openArrow))switch(a.type){case"interaction-management":this.openArrow=z({class:["button-container","projection"],dataset:{nature:"layout",layout:"flex",id:"iA"+this.id,projection:-1},tabindex:1}),this.openArrow.innerHTML=a.content,this.openArrow.addEventListener("click",(e=>{let t=this.environment.findWindow("side-instance");g(t)&&(t=this.environment.createWindow("side-instance"),t.container.classList.add("model-projection-sideview")),t.instances.size>0&&Array.from(t.instances)[0].delete(),a.attribute.forEach((e=>{let i=this.source.getAttributeByName(e.dynamic.name).target,n=this.environment.createProjection(i,e.dynamic.tag),s=this.environment.createInstance(i,n,{type:"projection",close:"DELETE-PROJECTION"});t.addInstance(s)})),this.environment.setActiveReceiver(this,this.projection.rtags[0])})),this.interactionsArea.append(this.openArrow)}return r.hasChildNodes()&&this.container.append(r),this.bindEvents(),this.container},setUpForce(e,t,i,n,s,a){let r=300;this.isRoot||(r=150),this.force=d3.layout.force().size([e,t]).nodes([]).linkDistance(r).charge(n*i).on("tick",this.ticked.bind(this));var o=d3.select("#sA"+this.id),l=o.select(".nodeArea"),c=o.select(".linkArea");this.nodes=this.force.nodes(),this.node=l.selectAll(".node"+this.id),this.links=this.force.links(),this.link=c.selectAll(".link"+this.id),this.force.start()},restart(){let e=d3.select("#sA"+this.id).select(".linkArea");this.link=e.selectAll(".link"+this.id).data(this.links);let t=d3.select("#sA"+this.id).select(".nodeArea");this.node=t.selectAll(".node"+this.id).data(this.nodes),this.force.start(),this.isRoot||this.environment.getRootReceiver(this.projection.rtags[0]).restart()},branchRoot(e,t){let i=this.createHolder(e);return this.nodesArea.append(i),this.adapt(e),i},branch(){const{attributes:e=[],center:t,direction:i,intensity:n,fixed:s=[]}=this.schema;!o(s)&&g(this.fixedArea)&&s.forEach((e=>{this.setUpForce(this.width,this.height,this.intensity,this.direction),this.nodes.push({x:e.coordinates.width,y:e.coordinates.height,fixed:!0,nbLink:0,points:[]});let t=rs.call(this,e.attribute),i=this.environment.getRootReceiver(this.projection.rtags[0]).branchRoot(t,e.ratio);this.nodesArea.appendChild(i),i.classList.add("node"+this.id),this.nodes[this.nodes.length-1].width=Number(i.getAttribute("width")),this.nodes[this.nodes.length-1].height=Number(i.getAttribute("height")),g(this.instances)&&(this.instances=new Map),this.registerShape(i),this.instances.set(this.environment.resolveElement(t).source.id,t),this.ids.push(i),this.restart()})),this.buttons.forEach((e=>{e.refresh()})),this.openArrow.click()},addItem(e,t){g(this.force)&&this.setUpForce(this.width,this.height,this.intensity,this.direction);let i=this.environment.getRootReceiver(this.projection.rtags[0]),{item:n,holder:s,id:a}=i.addItemRoot(e,t);"algorithm"===n.dataset.nature&&this.environment.resolveElement(n).branch(),this.instances.set(a,n),this.nodes.push({nbLink:0,points:[]}),s.classList.add("node"+this.id),s.id=this.nodes.length-1,this.nodesArea.append(s),this.nodes[this.nodes.length-1].size=this.getRadius(s),this.nodes[this.nodes.length-1].width=Number(s.getAttribute("width")),this.nodes[this.nodes.length-1].height=Number(s.getAttribute("height")),this.registerShape(s),this.holders.set(n,s),this.ids.push(s),this.restart()},addItemRoot(e,t){let{item:i,id:n}=this.createItemRoot(e,t),s=this.createHolder(i);return this.nodesArea.append(s),this.adapt(i),{item:i,holder:s,id:n}},registerShape(e){let t=e.querySelector("[data-shape]");const i={};let n;if(!g(t))switch(t.tagName){case"ellipse":if(this.environment.getRootReceiver(this.projection.rtags[0])!==this){let s=e.getBoundingClientRect(),a=Number(e.getAttribute("width"))/s.width,r=Number(e.getAttribute("height"))/s.height;n=t.getBoundingClientRect(),i.rx=n.width*a,i.ry=n.height*r}else n=t.getBoundingClientRect(),i.rx=n.width,i.ry=n.height;return this.nodes[this.nodes.length-1].ellipse=i,void(this.nodes[this.nodes.length-1].tag="ellipse");case"polygon":let s=t.getAttribute("data-shape").split(",");const a={w:Number(s[0]),h:Number(s[1])};let r=[];return t.getAttribute("points").split(" ").forEach((e=>{let t=e.split(",");r.push({x:Number(t[0]),y:Number(t[1]),rW:Number(t[0])/a.w,rH:Number(t[1])/a.h})})),i.points=r,this.nodes[this.nodes.length-1].polygon=i,this.nodes[this.nodes.length-1].tag="polygon",console.log("Schema"),void console.log(i)}n=e.getBoundingClientRect(),i.width=n.width/2,i.height=n.height/2,this.nodes[this.nodes.length-1].rect=i,this.nodes[this.nodes.length-1].tag="svg"},adjustShape(e,t,i,n){switch(t.tag){case"ellipse":const s={};return s.rx=t.ellipse.rx*i,s.ry=t.ellipse.ry*n,e.ellipse=s,void(e.tag="ellipse");case"rect":case"svg":const a={};return a.width=t.rect.width*i,a.height=t.rect.height*n,e.rect=a,void(e.tag="svg")}},adapt(e,t=.5){this.adaptForeign(e.parentNode,e),this.adaptSVG(e.parentNode.parentNode,e.parentNode,t)},createHolder(e){let t=document.createElementNS("http://www.w3.org/2000/svg","svg"),i=document.createElementNS("http://www.w3.org/2000/svg","foreignObject");return t.appendChild(i),i.appendChild(e),t},createItemRoot(e,t){t.item;let i=this.model.createProjection(e);return i.optional=!0,{item:i.init().render(),id:i.element.source.id}},createItem(e,t){t.item;let i=this.model.createProjection(e);i.optional=!0,i.parent=this.projection;let n=i.init().render();return this.instances.set(i.element.source.id,n),n},removeItem(e){this.force.stop();let t=this.holders.get(this.instances.get(e.id));this.nodes.splice(t.id,1),t.remove();for(let t=0;t<this.arrowInventory.length;t++)this.arrowInventory[t].deleteRef(e,t);this.restart()},removeDummy(e){for(let t=0;t<this.dummies.length;t++){let i=this.dummies[t];i.ref===e&&(i.item.remove(),this.dummies.splice(t,1),t--)}for(let t=0;t<this.nodes.length;t++)this.nodes[t].ref===e&&(this.nodes.splice(t,1),t--)},removeArrow(e,t=-1){let i,n;this.force.stop();for(let t=0;t<this.links.length;t++)if(this.links[t].cID===e.id){i=this.links[t].ref,n=this.links[t].dummy,this.links.splice(t,1);break}g(i)?this.restart():(this.removeDummy(i),e.element.remove(),t>0?this.arrowInventory.splice(t,1):this.restart())},adaptForeign(e,t){t.style.width="fit-content";let i=t.getBoundingClientRect();e.setAttribute("width",i.width),e.setAttribute("height",i.height)},adaptSVG(e,t,i=.4){e.setAttribute("width",Number(t.getAttribute("width"))*i),e.setAttribute("height",Number(t.getAttribute("height"))*i),e.setAttribute("viewBox","0 0 "+t.getAttribute("width")+" "+t.getAttribute("height"))},adaptSVGSimple(e,t,i,n){e.setAttribute("width",i),e.setAttribute("height",n),e.setAttribute("viewBox","0 0 "+t.getAttribute("width")+" "+t.getAttribute("height"))},ticked(){var e=this.computeBorders,t=this.computeSelfBorders,i=this.adjustShape,n=Ps.getPerpendicularLine,s=Ps.getPointConstructedEllipse,a=Ps.getEllipseCenter,r=this.svgArea,l=this.linkInventory;let c=this.links,h=this.width,u=this.height;this.link.attr("d",(function(i){if(i.source!==i.target){let t=e(i,i.source,i.target),n=e(i,i.target,i.source),s=n.x-t.x,a=n.y-t.y,r=Math.sqrt(s*s+a*a),o=l[i.source.index+","+i.target.index].length;return o>1&&(r/=1+1/o*(i.linkIndex-1)),i.source.points[i.sourceIndex]=t,i.target.points[i.targetIndex]=n,i.dr=r,i.s=t,i.t=n,"M"+n.x+","+n.y+"A"+r+","+r+" 0 0 1,"+t.x+","+t.y+"A"+r+","+r+" 0 0 0,"+n.x+","+n.y}{let e,n,s=t(i);switch(s.direction){case"top":e={x:-.03*h,y:-.05*u},n={x:.03*h,y:-.05*u};break;case"bot":e={x:-.03*h,y:.05*u},n={x:.03*h,y:.05*u};break;case"left":e={x:-.03*h,y:.05*u},n={x:-.03*h,y:-.05*u};break;default:e={x:.03*h,y:-.05*u},n={x:.03*h,y:.05*u}}return l[i.source.index+","+i.target.index].length>1&&(e.x=e.x*i.linkIndex,e.y=e.y*i.linkIndex,n.x=n.x*i.linkIndex,n.y=n.y*i.linkIndex),"M"+s.x+","+s.y+"c"+e.x+","+e.y+" "+n.x+","+n.y+" 0, 0"}}));let d=!0;for(;d;)this.nodes.forEach((e=>{this.nodes.forEach((t=>{d=this.collide(e,t)}))}));g(this.node)||this.node.attr("x",(function(e){if(!g(e.ref)){let t=a(c[e.ref].dr,c[e.ref].s,c[e.ref].t,r),i=n(c[e.ref].s,c[e.ref].t),o=s(i,c[e.ref].dr,c[e.ref].dr,t),l=Ps.getCloserBorder(o,c[e.ref].t);return e.fx=l.x,l.x-e.width/2}return(e.x=Math.max(e.width/2,Math.min(h-e.width/2,e.x)))-e.width/2})).attr("y",(function(e){if(!g(e.ref)){let t=a(c[e.ref].dr,c[e.ref].s,c[e.ref].t,r),i=n(c[e.ref].s,c[e.ref].t),o=s(i,c[e.ref].dr,c[e.ref].dr,t),l=Ps.getCloserBorder(o,c[e.ref].t);return e.fy=l.y,l.y-e.height/2}return(e.y=Math.max(e.height/2,Math.min(u-e.height/2,e.y)))-e.height/2})).attr("id",(function(e){return g(e.ref),e.index})),o(this.transLink)||this.transLink.forEach((t=>{let n=t.arrow,s=t.source,a=t.target,r={};g(s.rW)?r=s.source:(r.x=s.source.x*s.rW+s.base.x-s.base.width/2,r.y=(s.source.y+s.off)*s.rH+s.base.y-s.base.height/2,i(r,s.source,s.rW,s.rH));let o={};g(a.rW)?o=a.source:(o.x=a.source.x*a.rW+a.base.x-a.base.width/2,o.y=(a.source.y+a.off)*a.rH+a.base.y-a.base.height/2,i(o,a.source,a.rW,a.rH));let l=e(t,r,o),c=e(t,o,r),h=c.x-l.x,u=c.y-l.y,d=Math.sqrt(h*h+u*u);n.setAttribute("d","M"+c.x+","+c.y+"A"+d+","+d+" 0 0 1,"+l.x+","+l.y+"A"+d+","+d+" 0 0 0,"+c.x+","+c.y)}))},collide(e,t){if(!g(e.ref))return console.log(e.ref),!1;if(!g(t.ref)&&t!==e)if(console.log(e.ref),e.x<t.fx&&e.y<t.fy&&e.x+e.width/2>t.fx-t.width/2&&e.y+e.height/2>t.fx-t.height/2){console.log("hoho1");let i=e.x+e.width/2-(t.fx-t.width/2),n=1.1*(e.y+e.height/2-(t.fy-t.height/2));switch(Math.min(i,n)){case i:e.x-=i;break;case n:e.y-=n}}else if(e.x>t.fx&&e.y<t.fy&&t.fx+t.width/2>e.x-e.width/2&&e.y+e.height/2>t.fy-t.height/2){console.log("hoho2");let i=e.x+e.width/2-(t.fx-t.width/2),n=1.1*(e.y+e.height/2-(t.fy-t.height/2));switch(Math.min(i,n)){case i:e.x-=i;break;case n:e.y-=n}}else if(e.x>t.fx&&e.y>t.fy&&t.fx+t.width/2>e.x-e.width/2&&t.fy+t.height/2>e.y-e.height/2){console.log("hoho3");let i=t.fx+t.width/2-(e.x-e.width/2),n=1.1*(t.fy+t.height/2-(e.y-e.height/2));switch(Math.min(i,n)){case i:e.x+=i;break;case n:e.y+=n}}else if(e.x<t.fx&&e.y>t.fy&&e.x+e.width/2>t.fx-t.width/2&&e.y-e.height/2<t.fy+t.height/2){console.log("hoho4");let i=e.x+e.width/2-(t.fx-t.width/2),n=1.1*(t.fy+t.height/2-(e.y-e.height/2));switch(Math.min(i,n)){case i:e.x-=i;break;case n:e.y+=n}}if(t&&t!==e)if(e.x<t.x&&e.y<t.y&&e.x+e.width/2>t.x-t.width/2&&e.y+e.height/2>t.x-t.height/2){let i=e.x+e.width/2-(t.x-t.width/2),n=1.1*(e.y+e.height/2-(t.y-t.height/2));switch(Math.min(i,n)){case i:e.x-=i/2,t.x+=i/2;break;case n:e.y-=n/2,t.y+=n/2}}else if(e.x>t.x&&e.y<t.y&&t.x+t.width/2>e.x-e.width/2&&e.y+e.height/2>t.y-t.height/2){let i=t.x+t.width/2-(e.x-e.width/2),n=1.1*(e.y+e.height/2-(t.y-t.height/2));switch(Math.min(i,n)){case i:e.x+=i/2,t.x-=i/2;break;case n:e.y-=n/2,t.y+=n/2}}else if(e.x>t.x&&e.y>t.y&&t.x+t.width/2>e.x-e.width/2&&t.y+t.height/2>e.y-e.height/2){let i=t.x+t.width/2-(e.x-e.width/2),n=1.1*(t.y+t.height/2-(e.y-e.height/2));switch(Math.min(i,n)){case i:e.x+=i/2,t.x-=i/2;break;case n:e.y+=n/2,t.y-=n/2}}else if(e.x<t.x&&e.y>t.y&&e.x+e.width/2>t.x-t.width/2&&e.y-e.height/2<t.y+t.height/2){let i=e.x+e.width/2-(t.x-t.width/2),n=1.1*(t.y+t.height/2-(e.y-e.height/2));switch(Math.min(i,n)){case i:e.x-=i/2,t.x+=i/2;break;case n:e.y+=n/2,t.y-=n/2}}return!1},computeBorders(e,t,i){let n,s;switch(t.tag){case"ellipse":return n=Ps.getPointEllipse(t,i,t.ellipse),s=Ps.getCloserBorder(n,i),s;case"polygon":return s=Ps.getPointPolygon(t,i,t.polygon),s;case"rect":case"svg":return n=Ps.getPointRect(t,i,t.rect),s=Ps.getCloserBorder(n,i),s}},computeSelfBorders(e){switch(e.source.tag){case"ellipse":return Ps.getSelfPointEllipse(e.source);case"rect":case"svg":schema=Ps.getSelfPointRect(e.source)}},getRadius(e){let t=e.getAttribute("width"),i=e.getAttribute("height");return Math.sqrt(t/2*(t/2)+i/2*(i/2))},accept(e,t,i){let n=this.instances.get(e),s=this.environment.findReceiverInstance(e,this.projection.rtags[0]),a=this.instances.get(t),r=this.environment.findReceiverInstance(t,this.projection.rtags[0]);if(this.environment.getRootReceiver(this.projection.rtags[0]).checkTransLinkId(i))return void this.environment.getRootReceiver(this.projection.rtags[0]).acceptTransArrow(i,s,r,e,t);if(s.container!=this||r.container!=this)return s.container===r.container?void s.container.accept(e,t,i):void this.environment.getRootReceiver(this.projection.rtags[0]).acceptTransArrow(i,s,r,e,t);let o=Number(n.parentNode.parentNode.id),l=Number(a.parentNode.parentNode.id),c=this.checkValue(i.id,i.source.id,o,l);if(-2!==c){if(this.linksArea.append(i.element),i.definitions&&this.definitionsArea.append(i.definitions),i.element.classList.add("link"+this.id),c>=0){let e=this.links[c].target,t=this.links[c].source;return this.linkInventory[t.index+","+e.index]=this.linkInventory[t.index+","+e.index].filter((e=>e!==i.id)),this.links[c].target=l,this.links[c].source=o,g(this.linkInventory[o+","+l])?(this.linkInventory[o+","+l]=[i.id],this.links[this.links.length-1].linkIndex=1):(this.linkInventory[o+","+l].push(i.id),this.links[this.links.length-1].linkIndex=this.linkInventory[o+","+l].length),void this.restart()}if(this.links.push({source:o,target:l,cID:i.id,concept:i.source.id,ref:this.links.length}),o!==l?(this.nodes[o].nbLink++,this.nodes[l].nbLink++,this.links[this.links.length-1].sourceIndex=this.nodes[o].nbLink,this.links[this.links.length-1].targetIndex=this.nodes[l].nbLink):(this.nodes[o].nbLink++,this.links[this.links.length-1].sourceIndex=this.nodes[o].nbLink),this.nodes.push({ref:this.links.length-1,fixed:!0,width:.1*this.height,height:.1*this.height}),this.arrowInventory.push(i),g(this.linkInventory[o+","+l])?(this.linkInventory[o+","+l]=[i.id],this.links[this.links.length-1].linkIndex=1):(this.linkInventory[o+","+l].push(i.id),this.links[this.links.length-1].linkIndex=this.linkInventory[o+","+l].length),i.decorator)this.decoratorHandler(i.decorator),this.links[this.links.length-1].dummy=!1;else{let e=document.createElementNS("http://www.w3.org/2000/svg","svg");e.classList.add("node"+this.id),this.nodesArea.append(e),this.dummies.push({item:e,ref:this.links.length-1}),this.links[this.links.length-1].dummy=!0,this.ids.push(e)}this.restart()}},acceptTransArrow(e,t,i,n,s){let a={};if(this.transLinkId.includes(e.id)){let a,r;for(r=0;r<this.transLink.length;r++)if(this.transLink[r].arrow===e.element){a=this.transLink[r];break}let o={};if(t.container===i.container){for(this.transLink.splice(r,1),r=0;r<this.transLinkId.length;r++)if(this.transLinkId[r]===e.id){this.transLinkId.splice(r,1);break}return void t.container.accept(n,s,e)}t.container!=this?this.setTransSchema(o,t):o.source=this.nodes[Number(t.instance.parentNode.parentNode.id)];let l={};i.container!=this?this.setTransSchema(l,i):l.source=this.nodes[Number(i.instance.parentNode.parentNode.id)],this.transLink[r]={arrow:e.element,source:o,target:l,s:n,t:s}}else{this.transLinkId.push(e.id),t.container!=this?this.setTransSchema(a,t):a.source=this.nodes[Number(t.instance.parentNode.parentNode.id)];let r={};i.container!=this?this.setTransSchema(r,i):r.source=this.nodes[Number(i.instance.parentNode.parentNode.id)],this.linksArea.append(e.element),e.definitions&&this.definitionsArea.append(e.definitions),this.transLink.push({arrow:e.element,source:a,target:r,s:n,t:s})}this.restart()},setTransSchema(e,t){let i=t.container,n=t.container.container.parentNode.parentNode,s=t.container.container.parentNode,a=Number(n.getAttribute("width"))/Number(s.getAttribute("width")),r=Number(n.getAttribute("height"))/Number(s.getAttribute("height")),o=Number(s.getAttribute("height"))-i.height;e.rH=r,e.rW=a,e.off=o,e.base=this.nodes[Number(n.id)],e.source=i.nodes[Number(t.instance.parentNode.parentNode.id)]},checkTransLinkId(e){let t=!1;return this.transLinkId.forEach((i=>{i!==e.id||(t=!0)})),t},decoratorHandler(e,t=1){let i=this.createHolder(e);this.nodesArea.append(i),this.adapt(e,t),i.classList.add("node"+this.id),this.nodes[this.nodes.length-1].width=Number(i.getAttribute("width")),this.nodes[this.nodes.length-1].height=Number(i.getAttribute("height")),this.ids.push(i)},checkValue(e,t,i,n){for(let e=0;e<this.links.length;e++){if(this.links[e].concept===t&&this.links[e].target.index===n&&this.links[e].source.index===i)return-2;if(this.links[e].concept===t)return e}return-1},focus(){return this.container.focus(),this},focusIn(){return this.focused=!0,this.container.classList.add("active"),this.container.classList.add("focus"),this.container.focus(),this},focusOut(){return this.focused=!1,this.container.classList.remove("active"),this.container.classList.remove("focus"),this},enterHandler(){this.focused&&this.interactionsArea.focus()},bindEvents(){this.svgArea.addEventListener("click",(e=>{const{target:t}=e;t===this.svgArea&&(this.svgArea.classList.add("active"),this.svgArea.classList.add("focus"),this.svgArea.focus())}))}},Ps={getPointEllipse(e,t,i){const n=i.rx/2,s=i.ry/2,a=e.x,r=e.y,o=this.getDeq(e,t);let l=s*s+n*n*o.a*o.a,c=2*n*n*o.a*o.b-2*a*s*s-2*r*o.a*n*n,h=c*c-4*l*(a*a*s*s+n*n*r*r+n*n*o.b*o.b-2*r*n*n*o.b-n*n*s*s);if(h>=0){let e=(-c-Math.sqrt(h))/(2*l),t=e*o.a+o.b,i=(-c+Math.sqrt(h))/(2*l);return{x1:{x:e,y:t},x2:{x:i,y:i*o.a+o.b}}}console.log("Nothing found")},getPointConstructedEllipse(e,t,i,n){const s=t,a=i,r=n.x,o=n.y;let l=a*a+s*s*e.a*e.a,c=2*s*s*e.a*e.b-2*r*a*a-2*o*e.a*s*s,h=c*c-4*l*(r*r*a*a+s*s*o*o+s*s*e.b*e.b-2*o*s*s*e.b-s*s*a*a);if(h>=0){let t=(-c-Math.sqrt(h))/(2*l),i=t*e.a+e.b,n=(-c+Math.sqrt(h))/(2*l);return{x1:{x:t,y:i},x2:{x:n,y:n*e.a+e.b}}}},getEllipseCenter(e,t,i,n){let s=(t.x-i.x)/2,a=(t.y-i.y)/2,r=-Math.sqrt((e*e*(e*e)-e*e*(a*a)-e*e*(s*s))/(e*e*(a*a)+e*e*s*s)),o=r*(-e*s/e);return{x:r*(e*a/e)+(t.x+i.x)/2,y:o+(t.y+i.y)/2}},getPerpendicularLine(e,t){let i=(e.x+t.x)/2,n=(e.y+t.y)/2,s=-1/Ps.getDeq(e,t).a;return{a:s,b:n-s*i}},getSelfPointEllipse(e){let t={x:e.x-e.ellipse.rx/2,y:e.y},i={x:e.x+e.ellipse.rx/2,y:e.y},n={x:e.x,y:e.y-e.ellipse.ry/2},s={x:e.x,y:e.y-e.ellipse.ry/2},a=0,r=0,o=0,l=0;switch(e.points.forEach((e=>{a+=Math.sqrt((e.x-t.x)*(e.x-t.x)+(e.y-t.y)*(e.y-t.y)),r+=Math.sqrt((e.x-i.x)*(e.x-i.x)+(e.y-i.y)*(e.y-i.y)),o+=Math.sqrt((e.x-n.x)*(e.x-n.x)+(e.y-n.y)*(e.y-n.y)),l+=Math.sqrt((e.x-s.x)*(e.x-s.x)+(e.y-s.y)*(e.y-s.y))})),Math.max(a,r,o,l)){case o:return{x:n.x,y:n.y,direction:"top"};case r:return{x:i.x,y:i.y,direction:"right"};case l:return{x:s.x,y:s.y,direction:"bot"};default:return{x:t.x,y:t.y,direction:"left"}}},getPointPolygon(e,t,i){let n=[];i.points.forEach((t=>{n.push({x:t.rW*e.width+e.x-e.width/2,y:t.rH*e.height+e.y-e.height/2})}));let s=n[0].x-t.x,a=n[0].y-t.y,r=Math.sqrt(s*s+a*a),o=r,l=0;for(let e=1;e<n.length;e++)s=n[e].x-t.x,a=n[e].y-t.y,r=Math.sqrt(s*s+a*a),r<o&&(o=r,l=e);return n[l]},getPointRect(e,t,i){const n={};let s=this.getDeq(e,t),a=(e.x-i.width)*s.a+s.b,r=(e.x+i.width)*s.a+s.b;if(a>=e.y-i.height&&a<=e.y+i.height)return n.x1={x:e.x-i.width,y:a},n.x2={x:e.x+i.width,y:r},n;let o=(e.y-i.height-s.b)/s.a,l=(e.y+i.height-s.b)/s.a;return o>=e.x-i.width&&l<=e.x+i.width?(n.x1={x:o,y:e.y-i.height},n.x2={x:l,y:e.y+i.height},n):void 0},getDeq(e,t){let i=(t.y-e.y)/(t.x-e.x);return{a:i,b:e.y-i*e.x}},getCloserBorder(e,t){let i=Math.sqrt((e.x1.x-t.x)*(e.x1.x-t.x)+(e.x1.y-t.y)*(e.x1.y-t.y));return Math.sqrt((e.x2.x-t.x)*(e.x2.x-t.x)+(e.x2.y-t.y)*(e.x2.y-t.y))<i?e.x2:e.x1}},Ms=Object.assign({},Rs,_s),Fs={init(){return this.width=r(this.schema.dimensions.width,500),this.height=r(this.schema.dimensions.height,500),this.buttons=[],this.anchors=new Map,this.items={},this.patterns=[],this.augmentCount=0,this.anchorIndex=0,this.arrowInventory=new Map,this.childs=new Map,this.holders=new Map,this},render(){const{pattern:e,dimensions:t,arrow:i,attributes:n,anchorAttr:s}=this.schema,a=$();if(L(this.container)||(this.container=z({class:["pattern-container"],dataset:{nature:"algorithm",algorithm:"pattern",id:this.id},tabindex:1})),L(this.interactionsArea)||(this.interactionsArea=z({class:["layout-container","projection"],dataset:{nature:"layout",layout:"flex",orientation:"row",id:"iA"+this.id,projection:-1},tabindex:1}),a.append(this.interactionsArea),this.interactionsArea.style.backgroundColor="white"),!o(n)&&g(this.attributes)&&(this.attributes=[],n.forEach((e=>{let t=rs.call(this,e);this.attributes.push(t),this.interactionsArea.append(t)}))),!g(e.size.ratio)&&g(this.patternInventory)){this.patternInventory=new Map,this.anchorInventory=new Map;let t=rs.call(this,e.attribute),i=this.environment.resolveElement(t);i.buttonIndex=this.buttons.length,this.buttons.push(i),this.registerPattern(e,t),this.interactionsArea.append(t)}return!o(s)&&g(this.anchorAttr)&&(this.anchorAttr=new Map,s.forEach((e=>{let t=rs.call(this,e.attribute);this.anchorAttr.set(t,e.placement),this.registerPattern(e,t),this.interactionsArea.append(t)}))),L(this.svgArea)||(this.svgArea=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.svgArea.setAttribute("width",this.width),this.svgArea.setAttribute("height",this.height),this.arrowsArea=document.createElementNS("http://www.w3.org/2000/svg","g"),this.svgArea.append(this.arrowsArea),this.arrowsArea.classList.add("arrowArea"),this.definitionsArea=document.createElementNS("http://www.w3.org/2000/svg","g"),this.svgArea.append(this.definitionsArea),this.definitionsArea.classList.add("definitionArea"),this.patternArea=document.createElementNS("http://www.w3.org/2000/svg","g"),this.svgArea.append(this.patternArea),this.waitingArea=document.createElementNS("http://www.w3.org/2000/svg","g"),this.svgArea.append(this.waitingArea),a.appendChild(this.svgArea)),g(this.openArrow)&&!g(i)&&(this.openArrow=z({class:["button-container","projection"],dataset:{nature:"layout",layout:"flex",id:"iA"+this.id,projection:-1},tabindex:1}),this.openArrow.innerHTML=i.content,this.openArrow.addEventListener("click",(e=>{let t=this.environment.findWindow("side-instance");g(t)&&(t=this.environment.createWindow("side-instance"),t.container.classList.add("model-projection-sideview")),t.instances.size>0&&Array.from(t.instances)[0].delete(),i.attribute.forEach((e=>{let i=this.source.getAttributeByName(e.dynamic.name).target,n=this.environment.createProjection(i,e.dynamic.tag),s=this.environment.createInstance(i,n,{type:"projection",close:"DELETE-PROJECTION"});t.addInstance(s)})),g(i.ranking)||(this.orderRef=i.ranking.target,this.order=i.ranking.order,this.setOrderFunctions()),this.environment.setActiveReceiver(this,this.projection.rtags[0])})),this.interactionsArea.append(this.openArrow)),a.hasChildNodes()&&this.container.append(a),this.container},registerPattern(e,t){let i={},n=e.placement,s={};switch(n.type){case"evolutive-anchors":s.type="fixed",s.current={x:n.first.x,y:n.first.y},s.next={x:n.next.x,y:n.next.y},i.placement=s,console.log(i.placement);break;case"anchor-based":s.type="duo",s.from="start",s.to="end",i.placement=s}if(e.size){let t=e.size,n={};switch(t.type){case"ratio-sized":n.type="parent",n.ratio=t.ratio;break;case"absolute-sized":n.type="auto",n.ratio=t.ratio;break;case"inherited-size":n.type="relative",n.marker=t.marker,n.property=t.property}i.size=n}this.patternInventory.set(t,i),this.anchorInventory.set(t,{data:{first:{x:.5,y:.5},next:{x:0,y:40}},inventory:new Map})},setOrderFunctions(){switch(this.order){case"Ascending":this.acceptOrder=this.acceptAscending,this.modifyOrder=this.modifyAscending;break;case"Descending":break;case"MinMax":this.acceptOrder=this.acceptMinMax,this.modifyOrder=this.modifyMinMax}},createItem(e,t){const i=t.item;if(!this.model.hasProjectionSchema(e,i.tag))return"";let n=this.model.createProjection(e,i.tag);return n.optional=!0,n.parent=this.projection,n.init().render()},addItem(e,t){let i=this.patternInventory.get(t.element),n={x:0,y:0},s=this.computePlacement(i,n);if(s)return void this.addToWaitingList(t,i.placement,e);let a=this.createItem(e,t),r=this.createHolder(a);if(g(this.refHolder)&&!s&&(this.refHolder=r),r.setAttribute("x",n.x),r.setAttribute("y",n.y),r.dataset.source=e.id,r.dataset.buttonIndex=t.buttonIndex,g(this.items[t.element])&&(this.items[t.element]=[]),r.dataset.items=this.items[t.element].length,this.items[t.element].push(r),this.patternArea.append(r),this.patterns.push(e.id),this.holders.set(e.id,r),this.adapt(a,i.size),this.registerAnchor(this.anchorInventory.get(t.element),r,e),this.augmentCount>0){let e=r;for(let t=0;t<this.augmentCount;t++)e=this.augmentItem(e);for(let t=0;t<this.anchorIndex;t++)this.nextAnchor(e.dataset.source)}},computePlacement(e,t){let i=e.placement;switch(i.type){case"fixed":t.x=i.current.x,t.y=i.current.y;let n=i.current;return n.x+=i.next.x,n.y+=i.next.y,e.placement.current=n,!1;case"duo":return!0}},computePlacementChild(e,t,i,n,s){let a=this.anchors.get(i),r=this.anchors.get(n),o=this.findFreeIndex(a,r);if(-1===o){let e=this.nextAnchor(i);if(r.index<e){let t=r.index;for(;t<e;)t=this.nextAnchor(n)}o=e,a=this.anchors.get(i),r=this.anchors.get(n)}let l=a.indexes[o],c=r.indexes[o],h=l.x-c.x,u=l.y-c.y,d=Math.sqrt(h*h+u*u);return s.updateWidth(d),s.updateHeight(a.next.y),this.adaptSimple(t,d),e.setAttribute("x",Math.min(l.x,c.x)),e.setAttribute("y",Math.min(l.y,c.y)),e.style.boder="solid black 3",this.svgArea.append(e),this.registerAnchorOccupation(i,o),this.registerAnchorOccupation(n,o),o},addToWaitingList(e,t,i){g(this.waiting)&&(this.waiting=[]);let n=this.environment.findWindow("side-instance");g(n)&&(n=this.environment.createWindow("side-instance"),n.container.classList.add("model-projection-sideview")),n.instances.size>0&&Array.from(n.instances)[0].delete();let s=i,a=this.environment.createProjection(s,e.item.tag),r=this.environment.createInstance(s,a,{type:"projection",close:"DELETE-PROJECTION"});n.addInstance(r),console.log(a),console.log(s),s.getAttributeByName(t.from).target.register(a),s.getAttributeByName(t.to).target.register(a),a.registerHandler("value.changed",(e=>{this.notifyValue(a)})),this.waiting.push({projection:a,from:t.from,to:t.to})},setForWaiting(e,t,i,n){this.interactionsArea.appendChild(i.interactionsArea),this.adaptForWaiting(i.interactionsArea,t),this.waitingRoom.append(e),i.registerWaiter(this,n)},registerAnchor(e,t,i){let n=e.data;{n.type;let s={x:t.x.baseVal.value+e.data.first.x*t.width.baseVal.value,y:t.y.baseVal.value+e.data.first.y*t.height.baseVal.value},a=document.createElementNS("http://www.w3.org/2000/svg","circle");a.setAttribute("cx",s.x),a.setAttribute("cy",s.y),a.setAttribute("r",3),a.style.fill="red",this.svgArea.append(a),this.anchors.set(i.id,{current:s,next:n.next,index:0,free:[0],indexes:[s]})}},nextAnchor(e,t=!0){let i=this.anchors.get(e),n={x:i.current.x,y:i.current.y};n.x+=i.next.x,n.y+=i.next.y;let s=i.index+1,a=i.indexes;a.push(n);let r=i.free;return r.push(i.index+1),this.anchors.set(e,{current:n,next:i.next,indexes:a,index:s,free:r}),s>this.anchorIndex&&(this.anchorIndex=s),t&&this.checkAugment(this.holders.get(e)),s},nextAnchorChild(e,t){let i=this.childAnchors.get(t),n=i.get(e),s=n.current;s.x+=n.next.x,s.y+=n.next.y;let a=n.index+1,r=n.indexes;r.push(s);let o=n.free;return o.push(n.index+1),i.set(e,{current:s,next:n.next,index:n.index+1,free:o,indexes:r}),this.childAnchors.set(t,i),a},createHolder(e){let t=document.createElementNS("http://www.w3.org/2000/svg","svg"),i=document.createElementNS("http://www.w3.org/2000/svg","foreignObject");return t.appendChild(i),i.appendChild(e),t},adapt(e,t){this.adaptForeign(e.parentNode,e),this.adaptSVG(e.parentNode.parentNode,e.parentNode,t)},adaptSimple(e,t){this.adaptForeign(e.parentNode,e),this.adaptSVGSimple(e.parentNode.parentNode,e.parentNode,t)},adaptForeign(e,t){t.style.width="fit-content";let i=t.getBoundingClientRect();e.setAttribute("width",i.width),e.setAttribute("height",i.height)},adaptSVG(e,t,i){let n=Number(t.getAttribute("width")),s=Number(t.getAttribute("height"));switch(e.setAttribute("viewBox","0 0 "+n+" "+s),i.type){case"parent":let t=this.width*i.ratio,a=s*(t/n);e.setAttribute("width",t),e.setAttribute("height",a);break;case"auto":e.setAttribute("width",n*i.ratio),e.setAttribute("height",s*i.ratio);break;case"relative":let r=this.items[this.buttons[0].element][0].dataset.source,o=this.items[this.buttons[0].element][3].dataset.source,l=this.findFreeIndex(this.anchors.get(r),this.anchors.get(o));this.registerAnchorOccupation(r,l),this.registerAnchorOccupation(o,l);let c=this.anchors.get(r),h=this.anchors.get(o),u=c.indexes[l],d=h.indexes[l];this.adaptRelative(e,u,d,i)}},adaptSVGSimple(e,t,i){e.setAttribute("width",i),e.setAttribute("height",i/Number(t.getAttribute("width"))*Number(t.getAttribute("height"))),e.setAttribute("viewBox","0 0 "+t.getAttribute("width")+" "+t.getAttribute("height"))},adaptRatioSVG(e,t,i){e.setAttribute("width",this.width*i),e.setAttribute("height",this.width*i*Number(t.getAttribute("height"))/Number(t.getAttribute("width"))),e.setAttribute("viewBox","0 0 "+t.getAttribute("width")+" "+t.getAttribute("height"))},adaptForWaiting(e,t){let i=e.getBoundingClientRect(),n=t.parentNode;n.setAttribute("width",400),n.setAttribute("height",i.height+100);let s=n.parentNode;s.setAttribute("width",400),s.setAttribute("height",i.height+100),s.setAttribute("viewBox","0 0 400 "+i.height+100),this.waitingRoom.setAttribute("width",400),this.waitingRoom.setAttribute("height",i.height+100),t.remove(),n.appendChild(e)},focusIn(){},focusOut(){},clickHandler(e){},updateWidth(e){this.width=e,this.svgArea.setAttribute("width",e)},updateHeight(e){this.height=e,this.svgArea.setAttribute("height",e)},augmentItem(e){this.local(e.querySelector("svg")),e.remove();let t=this.createHolder(e.childNodes[0].childNodes[0]);t.setAttribute("x",Number(e.getAttribute("x"))),t.setAttribute("y",Number(e.getAttribute("y"))),t.dataset.source=e.dataset.source,t.dataset.buttonIndex=e.dataset.buttonIndex,t.dataset.items=e.dataset.items,this.items[this.buttons[t.dataset.buttonIndex].element][t.dataset.items]=t,this.patternArea.append(t);let i=this.patternInventory.get(this.buttons[Number(t.dataset.buttonIndex)].element);return this.adapt(t.childNodes[0].childNodes[0],i.size),this.holders.set(e.dataset.source,t),t},local(e){let t=e.querySelector("[data-extension]"),i=t.getAttribute("data-extension"),n=Number(t.getAttribute(i)),s=Number(t.getAttribute("data-add"));t.setAttribute(i,n+s),this.arrange(e,i,s)},arrange(e,t,i){switch(t){case"height":e.height.baseVal.valueInSpecifiedUnits+=i,e.viewBox.baseVal.height+=i;break;case"width":e.width.baseVal.valueInSpecifiedUnits+=i,e.viewBox.baseVal.width+=i}},augmentChild(e,t){let i=e.container.parentNode,n=i.parentNode;n.setAttribute("height",Number(n.getAttribute("height"))+t.y);let s=Number(n.getAttribute("height")),a=Number(i.getAttribute("width")),r=a/Number(n.getAttribute("width"))*s;i.setAttribute("height",r),n.setAttribute("viewBox","0 0 "+a+" "+r),(n.x.baseVal.value+n.width.baseVal.value>this.refHolder.width.baseVal.value||n.y.baseVal.value+n.height.baseVal.value>this.refHolder.height.baseVal.value)&&this.items[this.buttons[0].element].forEach((e=>{this.augmentItem(e)}))},arrangeAbsolute(e,t,i){switch(t){case"height":e.height.baseVal.valueInSpecifiedUnits=i,e.viewBox.baseVal.height=i;break;case"width":e.width.baseVal.valueInSpecifiedUnits=i,e.viewBox.baseVal.width=i}},branch(){this.buttons.forEach((e=>{e.refresh()}))},checkAugment(e){let t=this.anchors.get(e.dataset.source);if(e.x.baseVal.value+e.width.baseVal.value<t.current.x||e.y.baseVal.value+e.height.baseVal.value<t.current.y){let i=this.augmentItem(e);this.augmentCount++,this.items[this.buttons[e.dataset.buttonIndex].element].filter((e=>e!==i)).forEach((e=>{for(;this.nextAnchor(e.dataset.source,!1)<t.index;);this.augmentItem(e)})),this.refHolder=this.items[this.buttons[e.dataset.buttonIndex].element][0]}},checkForChildGrowth(e,t,i){let n=this.childs.get(e);(n.x.baseVal.value+n.width.baseVal.value<t.x||n.y.baseVal.value+n.height.baseVal.value<t.y)&&this.augmentChild(e,i)},accept(e,t,i){let n,s;if(!g(this.targetWaiter))return void this.targetWaiter.acceptAsChild(e,t,i,this);let a=this.arrowInventory.get(i.source.id);if(!g(a)){if(a.projID!==i.id)return;return void this.modifyArrow(e,t,i,a.index)}if(!g(this.orderRef))return void this.acceptOrder(e,t,i);let r=this.anchors.get(e),l=this.anchors.get(t);if(e===t){let n;return o(r.free)?(n=this.nextAnchor(e),r=this.anchors.get(e)):n=r.free[0],i.setPath("M "+r.indexes[n].x+" "+r.indexes[n].y+"l 30 0 l 0 20 l -30 0"),i.definitions&&this.definitionsArea.append(i.definitions),this.arrowsArea.append(i.element),void this.registerArrow(e,t,i,c)}let c=this.findFreeIndex(r,l);if(-1===c){let n=this.nextAnchor(e);if(l.index<n){let s=l.index;for(;s<n;)s=this.nextAnchor(t);return this.accept(e,t,i)}}n=r.indexes[c],s=l.indexes[c],i.setLine(n,s),i.definitions&&this.definitionsArea.append(i.definitions),this.arrowsArea.append(i.element),i.decorator&&(this.createDecorator(i),this.placeDecorator(i,n,s,i.decorator.parentNode.parentNode)),this.registerArrow(e,t,i,c)},acceptAscending(e,t,i){i.register(this.orderRef);let n,s,a=i.get(this.orderRef);g(a)||(n=this.findAnchorIndex(e,a),s=this.findAnchorIndex(t,a),i.setLine(n,s),i.definitions&&this.definitionsArea.append(i.definitions),i.decorator&&(this.createDecorator(i),this.placeDecorator(i,n,s,i.decorator.parentNode.parentNode)),this.arrowsArea.append(i.element),this.registerArrowOrder(e,t,i,a))},modifyAscending(e,t,i){let n=i.get(this.orderRef);if(g(n))return void i.remove();let s=this.findAnchorIndex(e,n),a=this.findAnchorIndex(t,n);i.setLine(s,a),i.definitions&&this.definitionsArea.append(i.definitions),this.arrowsArea.append(i.element),this.registerArrowOrder(e,t,i,n),this.placeDecorator(i,s,a,i.decorator.parentNode.parentNode)},acceptMinMax(e,t,i){i.register(this.orderRef);let n,s,a,r=i.get(this.orderRef);if(!g(r)){if(g(this.orderRanking))this.orderRanking=[{value:r,arrow:i}],n=0;else{let e=this.injectOrderMinMax(r,i);n=e.index,e.move&&this.moveAfterMinMax(e.index)}if(e===t)return s=this.findAnchorIndex(e,n),i.setPath("M "+s.x+" "+s.y+"l 30 0 l 0 20 l -30 0"),this.arrowsArea.append(i.element),i.definitions&&this.definitionsArea.append(i.definitions),void this.registerArrowOrder(e,t,i,n);s=this.findAnchorIndex(e,n),a=this.findAnchorIndex(t,n),i.setLine(s,a),i.definitions&&this.definitionsArea.append(i.definitions),i.decorator&&(this.createDecorator(i),this.placeDecorator(i,s,a,i.decorator.parentNode.parentNode)),this.arrowsArea.append(i.element),this.registerArrowOrder(e,t,i,n)}},injectOrderMinMax(e,t){let i=0;for(;i<this.orderRanking.length&&this.orderRanking[i].value<e;)i++;return i===this.orderRanking.length?(this.orderRanking.push({value:e,arrow:t}),{index:i,move:!1}):(this.orderRanking.splice(i,0,{value:e,arrow:t}),{index:i,move:!0})},moveAfterMinMax(e){for(let t=e+1;t<this.orderRanking.length;t++){let e,i,n=this.orderRanking[t],s=this.arrowInventory.get(n.arrow.source.id),a=n.arrow,r=this.anchors.get(s.source),o=this.anchors.get(s.target);for(;r.index<t;)this.nextAnchor(s.source),r=this.anchors.get(s.source);if(s.source===s.target)r.indexes[t],a.setPath("M "+e.x+" "+e.y+"l 30 0 l 0 20 l -30 0");else{for(;o.index<t;)this.nextAnchor(s.target),o=this.anchors.get(s.target);e=r.indexes[t],i=o.indexes[t],a.setLine(e,i),a.decorator&&this.placeDecorator(a,e,i,a.decorator.parentNode.parentNode)}s.index=t}},moveBeforeMinMax(e,t){for(let i=e-1;i>=t;i--){let e,t,n=this.orderRanking[i],s=this.arrowInventory.get(n.arrow.source.id),a=n.arrow,r=this.anchors.get(s.source);if(s.source===s.target)r.indexes[i],a.setPath("M "+e.x+" "+e.y+"l 30 0 l 0 20 l -30 0");else{let n=this.anchors.get(s.target);e=r.indexes[i],t=n.indexes[i],a.setLine(e,t),a.decorator&&this.placeDecorator(a,e,t,a.decorator.parentNode.parentNode)}s.index=i}},modifyMinMax(e,t,i){let n=i.get(this.orderRef);if(1===this.orderRanking.length)return;let s=0;for(;s<this.orderRanking.length&&this.orderRanking[s].arrow.id!==i.id;)s++;this.orderRanking.splice(s,1);let a=this.injectOrderMinMax(n,i);a.index<this.orderRanking.length-1&&this.moveAfterMinMax(a.index),a.index>s&&this.moveBeforeMinMax(a.index,s);let r=this.anchors.get(e),o=this.anchors.get(t);for(;r.index<a.index;)this.nextAnchor(e),r=this.anchors.get(e);if(e===t){let s=r.indexes[a.index];return i.setPath("M "+s.x+" "+s.y+"l 30 0 l 0 20 l -30 0"),void this.registerArrowOrder(e,t,i,n)}for(;o.index<a.index;)this.nextAnchor(t),o=this.anchors.get(t);let l=r.indexes[a.index],c=o.indexes[a.index];i.setLine(l,c),i.decorator&&this.placeDecorator(i,l,c,i.decorator.parentNode.parentNode),this.registerArrowOrder(e,t,i,n)},findAnchorIndex(e,t){let i=this.anchors.get(e);if(i.indexes.length<=t){for(let n=i.indexes.length;n<=t;n++)this.nextAnchor(e);i=this.anchors.get(e)}return i.indexes[t]},acceptAsChild(e,t,i,n){let s=this.childAnchors.get(n),a=s.get(e),r=s.get(t),o=this.findFreeIndex(a,r);if(-1===o){let i=this.nextAnchorChild(e,n);for(;r.index<i;)this.nextAnchorChild(t,n),s=this.childAnchors.get(n),r=s.get(t);s=this.childAnchors.get(n),a=s.get(e),r=s.get(t),o=i}let l=a.indexes[o],c=r.indexes[o];i.setLine(l,c),i.definitions&&this.definitionsArea.append(i.definitions),this.arrowsArea.append(i.element),this.checkForChildGrowth(n,l,a.next),this.registerAnchorOccupationChild(e,n,o),this.registerAnchorOccupationChild(t,n,o)},modifyArrow(e,t,i,n){let s,a,r,o,l,c,h=this.arrowInventory.get(i.source.id);if((h.source!==e||h.target!==t)&&!h.order){if(this.freeAnchor(h.source,n),this.freeAnchor(h.target,n),s=this.anchors.get(e),a=this.anchors.get(t),r=this.findFreeIndex(s,a),-1===r){for(r=this.nextAnchor(e),o=a.index;o<r;)o=this.nextAnchor(t);s=this.anchors.get(e),a=this.anchors.get(t)}return l=s.indexes[r],c=a.indexes[r],i.setLine(l,c),this.arrowInventory.set(i.source.id,{source:e,target:t,index:r,projID:i.id}),this.registerAnchorOccupation(e,r),this.registerAnchorOccupation(t,r),void this.placeDecorator(i,l,c,i.decorator.parentNode.parentNode)}h.order&&this.modifyOrder(e,t,i,n)},registerArrow(e,t,i,n){this.arrowInventory.set(i.source.id,{source:e,target:t,index:n,projID:i.id}),this.registerAnchorOccupation(e,n),e!==t&&this.registerAnchorOccupation(t,n)},registerArrowOrder(e,t,i,n){this.arrowInventory.set(i.source.id,{source:e,target:t,index:n,projID:i.id,order:!0})},createDecorator(e){let t=this.createHolder(e.decorator);this.patternArea.append(t),this.adaptForeign(e.decorator.parentNode,e.decorator),this.adaptRatioSVG(e.decorator.parentNode.parentNode,e.decorator.parentNode,e.ratio)},placeDecorator(e,t,i,n){let s,a,r;switch(r=t.x<i.x?t:i,e.base){case"center":let e=t.x-i.x,o=t.y-i.y,l=Math.sqrt(e*e+o*o);s=r.x+l/2-Number(n.getAttribute("width"))/2,a=r.y-Number(n.getAttribute("height"));break;case"left":s=r.x+3,a=r.y-Number(n.getAttribute("height"));break;case"right":r=t.x>i.x?t:i,s=r.x-3-Number(n.getAttribute("width")),a=r.y-Number(n.getAttribute("height"))}n.setAttribute("x",s),n.setAttribute("y",a)},freeAnchor(e,t){let i=this.anchors.get(e),n=i.free;n.push(t),this.anchors.set(e,{current:i.current,next:i.next,index:i.index,free:n,indexes:i.indexes})},registerAnchorOccupation(e,t){let i,n=this.anchors.get(e),s=n.free;for(let e=0;e<s.length;e++)if(s[e]===t){i=e;break}s.splice(i,1),this.anchors.set(e,{current:n.current,next:n.next,index:n.index,free:s,indexes:n.indexes})},registerAnchorOccupationChild(e,t,i){let n,s=this.childAnchors.get(t),a=s.get(e),r=a.free;for(let e=0;e<r.length;e++)if(r[e]===i){n=e;break}r.splice(n,1),s.set(e,{current:a.current,next:a.next,index:a.index,free:r,indexes:a.indexes}),this.childAnchors.set(s)},findFreeIndex(e,t){for(let i=0;i<e.free.length;i++){let n=e.free[i];if(t.free.includes(n))return n}return-1},removeArrow(e){e.element.remove(),e.decorator&&e.decorator.parentNode.parentNode.remove();let t=this.arrowInventory.get(e.source.id);g(t)||(this.freeAnchor(t.source,t.index),this.freeAnchor(t.target,t.index),this.arrowInventory.delete(e.source.id))},registerWaiter(e){this.targetWaiter=e,this.attributes[0].addEventListener("click",(t=>{this.exit(e)})),this.attributes[1].addEventListener("click",(t=>{this.exit(e)}))},setValues(){g(this.source.getAttributeByName("to").target.value)||(this.valTarget=this.source.getAttributeByName("to").target.value),g(this.source.getAttributeByName("from").target.value)||(this.valSource=this.source.getAttributeByName("from").target.value)},exit(e){this.setValues(),this.tryToExit(e)},joinSvgArea(e,t,i){console.log("Exiting"),console.log(e),console.log(t),console.log(i);let n=e.element;n.svgArea.remove();let s=this.createHolder(n.container),a=this.anchors.get(t),r=this.anchors.get(i),o=this.findFreeIndex(a,r);if(-1===o){let e=this.nextAnchor(t);if(r.index<e){let t=r.index;for(;t<e;)t=this.nextAnchor(i)}o=e,a=this.anchors.get(t),r=this.anchors.get(i)}let l=a.indexes[o],c=r.indexes[o],h=l.x-c.x,u=l.y-c.y,d=Math.sqrt(h*h+u*u);s.setAttribute("x",Math.min(l.x,c.x)),s.setAttribute("y",l.y),s.setAttribute("width",d);let p=n.container.parentNode;p.setAttribute("width",d),this.svgArea.append(s);let m=n.container.getBoundingClientRect();p.setAttribute("height",m.height),s.setAttribute("height",m.height)},setChildAnchors(e,t,i,n){g(this.childAnchors)&&(this.childAnchors=new Map);let s,a,r=[],o=new Map;for(let e=0;e<this.patterns.length;e++)this.patterns[e]===t&&(s=e),this.patterns[e]===i&&(a=e);for(let e=Math.min(a,s);e<=Math.max(a,s);e++)r.push(this.patterns[e]);r.forEach((t=>{let i=this.anchors.get(t);o.set(t,{current:{x:i.indexes[e].x+(Math.max(a,s)-Math.min(a,s)+1)*i.next.x,y:i.indexes[e].y+(Math.max(a,s)-Math.min(a,s)+1)*i.next.y},next:i.next,index:0,free:[0],indexes:[{x:i.indexes[e].x+(Math.max(a,s)-Math.min(a,s)+1)*i.next.x,y:i.indexes[e].y+(Math.max(a,s)-Math.min(a,s)+1)*i.next.y}]})})),this.childAnchors.set(n,o)},place(){this.container.prepend(this.interactionsArea)},notifyValue(e){console.log(e);for(let t=0;t<this.waiting.length;t++)if(this.waiting[t].projection===e){let i=e.element.source.getAttributeByName(this.waiting[t].from).target.value,n=e.element.source.getAttributeByName(this.waiting[t].to).target.value;if(console.log(e.element.source),!g(i)&&!g(n))return this.waiting.splice(t,1),void this.joinSvgArea(e,i,n)}}},Vs=Object.assign({},Rs,Fs);var $s=0;const Bs=()=>"algo"+$s++,Hs={force:(e,t,i)=>Object.create(Ms,{object:{value:"algorithm"},name:{value:"force-algorithm"},type:{value:"force"},id:{value:Bs()},model:{value:e},schema:{value:t},projection:{value:i},source:{value:i.concept,writable:!0}}),pattern:(e,t,i)=>Object.create(Vs,{object:{value:"algorithm"},name:{value:"pattern-algorithm"},type:{value:"pattern"},id:{value:Bs()},model:{value:e},schema:{value:t},projection:{value:i},source:{value:i.concept,writable:!0}})},Us={createAlgo(e,t,i){const{type:n}=t,s=Hs[n];if(g(s))throw new TypeError(`Missing handler: The '${n}' algo could not be handled`);const a=s(e,t,i);if(g(a))throw new Error(`Bad request: The '${n}' algo could not be created`);return a.createAlgo=this.createAlgo,g(a.id)&&(a.id=Bs()),a}};var Ws=0;const qs={createProjection(e,t,i,n){var s=Object.create(zs,{id:{value:r(t.id,"projection"+Ws++)},model:{value:e},schema:{value:t,writable:!0},environment:{value:n}});return s.concept=i,s}},zs={handlers:null,init(e={}){return this.containers=new Map,this.attributes=[],this.params=[],this.handlers={},this.args=e,this.concept.register(this),this},schema:null,concept:null,environment:null,parent:null,containers:null,placeholder:null,element:null,attributes:null,params:null,index:0,editing:!1,optional:!1,searchable:!1,focusable:!0,get hasMultipleViews(){return this.schema.length>1},get isReadOnly(){return r(this.getSchema().readonly,!1)},isRoot(){return g(this.parent)},getSchema(e){return this.schema[r(e,this.index)]},getContainer(e){return this.containers.get(r(e,this.index))},getStyle(){const{style:e}=this.getSchema();return e},addParam(e){this.params.push(...Array.isArray(e)?e:[e])},getParam(e){let t=this.params.find((t=>t.name===e));if(g(t))return;const{type:i="string",value:n}=t;let s=r(n,t.default);return g(s)?null:"string"===i?s.toString():"number"===i?+s:"boolean"===i?T(s):void 0},getParent(){return this.isRoot()?null:this.parent},getAttributes(e){return this.attributes.filter((t=>t.name===e))},getField(e){return this.environment.getField(e)},getStatic(e){return this.environment.getStatic(e)},getLayout(e){return this.environment.getLayout(e)},resolveElement(e){return this.environment.resolveElement(e)},getHandlers(e){return r(this.handlers[e],[])},update(e,t,i){if(o(this.containers))return;if("delete"===e)return void this.delete();const n=this.getHandlers(e);switch(o(n)||n.forEach((e=>{e(t,i)})),e){case"attribute.added":return void this.getAttributes(t.name).forEach((e=>{const{schema:i}=e,n=this.model.createProjection(t.target,i.tag).init();n.parent=this,n.optional=!0;const s=n.render();xi.call(this,s,i.style),n.element.parent=e.parent,e.element=s,e.placeholder&&(e.placeholder.after(s),qe(e.placeholder))}));case"attribute.removed":return void this.getAttributes(t.name).forEach((e=>{e.element&&(Ae(e.element).remove(),e.element=null),e.placeholder&&We(e.placeholder)}))}},delete(){return this.concept&&this.concept.unregister(this),this.placeholder&&this.getContainer().after(this.placeholder),this.containers.forEach((e=>{if(Ae(e),L(e)&&e.remove(),"path"===e.tagName){console.log(e);let t=this.environment.resolveElement(e);console.log(t),t.projection.parent.removeArrow(t)}})),this.model.removeProjection(this.id),!0},registerHandler(e,t){return Array.isArray(this.handlers[e])||(this.handlers[e]=[]),this.handlers[e].push(t),!0},unregisterHandler(e,t){if(!k(this.handlers,e))return!1;for(let i=0;i<this.handlers[e].length;i++)if(this.handlers[e][i]===t)return this.handlers[e].splice(i,1),!0;return!1},focus(){this.element.focus()},render(){const e=this.getSchema();if(g(e))return null;const{type:t,projection:i,content:n,sibling:s={},rtags:a=[]}=e;var l=null;if("layout"===t?(this.element=Os.createLayout(this.model,r(i,n),this).init(this.args),this.model.registerLayout(this.element)):"field"===t?(this.element=Dn.createField(this.model,r(i,n),this).init(this.args),this.model.registerField(this.element)):"static"===t?(this.element=ts.createStatic(this.model,r(i,n),this).init(this.args),this.model.registerStatic(this.element)):"algorithm"===t?(this.element=Us.createAlgo(this.model,r(i,n),this).init(this.args),this.model.registerAlgorithm(this.element)):"dynamic"===t&&(this.element=ts.createStatic(this.model,r(i,n),this).init(this.args),this.model.registerStatic(this.element)),this.isRoot()&&(this.element.focusable=!0),this.focusable||(this.element.focusable=!1),this.readonly&&(this.element.readonly=!0),l=this.element.render(),this.element.focusable||(l.tabIndex=-1),!A(l))throw new Error("Projection element container could not be created");if(l.classList.add("projection"),Object.assign(l.dataset,{projection:this.id,concept:this.concept.id,object:this.concept.object}),this.optional){let e=ce({class:["btn","structure__btn-delete","projection__btn-delete"],title:`Delete ${this.concept.name}`,tabindex:-1,dataset:{action:"delete",projection:this.id}});e.addEventListener("click",(e=>{let t=this.getContainer(),i=Ee(t,(e=>0===e.tabIndex));this.environment.save(this.concept.getParent(),t.cloneNode(!0)),this.concept.delete();let n=this.environment.resolveElement(i);g(n)||n.focus()})),l.dataset.deletable=!0,l.classList.add("has-toolbar"),l.prepend(e)}return this._style&&xi.call(this,l,this._style),this.containers.set(this.index,l),g(s.tag)||g(s.receiver)||this.createSibling(this.concept,s),o(a)||(this.rtags=a,this.environment.registerReceiver(this.element,a[0])),l},refresh(){this.editing?this.containers.forEach((e=>{e.tabIndex=0})):this.containers.forEach((e=>{e.tabIndex=null}))},createSibling(e,t){const{tag:i,receiver:n}=t;let s=this.model.createProjection(e,i).init();s.render();let a=this.environment.getActiveReceiver(n);s.parent=a,s.element.refresh()},changeView(e){if(!this.hasMultipleViews)return void this.environment.notify("There is no alternative projection for this concept");let t=this.getContainer();this.index=r(e,(this.index+1)%this.schema.length);let i=this.getContainer();return L(i)||(this.params=[],i=this.render()),t.replaceWith(i),this.element=this.resolveElement(i),"svg"===this.element.type&&this.element.update(),this.focus(),this},getInformations(e){let t=this.index;this.index=r(e,(this.index+1)%this.schema.length);let i=this.getContainer();return L(i)||(this.params=[],i=this.render()),this.index=t,this.resolveElement(i)},export(){return{id:this.id,root:this.isRoot(),concept:{id:this.concept.id,name:this.concept.name}}},bindEvents(){}},Xs=[{concept:{name:"set"},type:"field",tags:[],content:{type:"list"}},{concept:{name:"boolean"},type:"field",tags:[],content:{type:"binary"}},{concept:{name:"string"},type:"field",tags:[],content:{type:"text"}},{concept:{name:"number"},type:"field",tags:[],content:{type:"text",input:{type:"number"}}},{concept:{name:"reference"},type:"field",tags:[],content:{type:"choice"}}];function Gs(e,t){return Object.create(Js,{schema:{value:[...e,...Xs],writable:!0},environment:{value:t}})}const Js={projections:null,fields:null,statics:null,layouts:null,algos:null,init(e){return this.projections=[],this.fields=new Map,this.statics=new Map,this.layouts=new Map,this.algos=new Map,this},setSchema(e){return this.schema=[...e,...Xs],this},done(){for(;!o(this.projections);)this.projections[0].delete();return this.projections=[],this.fields.clear(),this.layouts.clear(),this.statics.clear(),this},createProjection(e,t){const i=this.getProjectionSchema(e,t);o(i)&&this.environment.notify(`Missing projection (#${t}) for ${e.name}`,Ye.WARNING);const n=qs.createProjection(this,i,e,this.environment);return n.tag=t,this.addProjection(n),n},getProjections(){return this.projections.slice()},getProjection(e){return Number.isInteger(e)?this.projections[e]:this.projections.find((t=>t.id===e))},addProjection(e){if(g(e))throw new TypeError("Bad request: The 'projection' argument must be a Projection");return this.projections.push(e),this},removeProjection(e){var t=this.projections.findIndex((t=>t.id===e));return-1!==t&&(this.projections.splice(t,1),!0)},registerField(e){return e.environment=this.environment,this.fields.set(e.id,e),this},unregisterField(e){var t=this.fields.get(e.id);return t&&(t.environment=null,this.fields.delete(t.id)),this},getField(e){return this.fields.get(e)},registerStatic(e){return e.environment=this.environment,this.statics.set(e.id,e),this},unregisterStatic(e){var t=this.statics.get(e.id);return t&&(t.environment=null,this.statics.delete(t.id)),this},getStatic(e){return this.statics.get(e)},registerLayout(e){return e.environment=this.environment,this.layouts.set(e.id,e),this},unregisterLayout(e){var t=this.layouts.get(e.id);return t&&(t.environment=null,this.layouts.delete(t.id)),this},getLayout(e){return this.layouts.get(e)},registerAlgorithm(e){return e.environment=this.environment,this.algos.set(e.id,e),this},unregisterAlgorithm(e){var t=this.algos.get(e.id);return t&&(t.environment=null,this.algos.delete(t.id)),this},getAlgo(e){return this.algos.get(e)},getMetadata(e){let t=this.schema.find((t=>t.id===e));return t?t.metadata:null},hasConceptProjection(e,t){const i=e=>!["template","rule","style","g-fragment"].includes(e);let n=null;return n=c(e)?this.schema.filter((t=>i(t.type)&&t.concept.name===e)):this.schema.filter((t=>{return i(t.type)&&((t=>t&&(t===e.name||e.schema&&t===e.schema.base))(t.concept.name)||!g(n=t.concept.prototype)&&"prototype"!==e.nature&&e.hasPrototype(n));var n})),d(t)&&!o(t)?-1!==n.findIndex((e=>(e=>Array.isArray(e.tags)&&e.tags.includes(t))(e))):!o(n)},getSchema(){return this.schema},getProjectionSchema(e,t){if(g(e))throw new TypeError("Bad parameter: concept");var i=null;const n=e=>!["template","rule","style","g-fragment"].includes(e);return i=c(e)?this.schema.filter((t=>n(t.type)&&t.concept.name===e)):this.schema.filter((t=>{return n(t.type)&&((t=>t&&(t===e.name||e.schema&&t===e.schema.base))(t.concept.name)||!g(i=t.concept.prototype)&&"prototype"!==e.nature&&e.hasPrototype(i));var i})),d(t)&&!o(t)?i.filter((e=>e.tags&&e.tags.includes(t))):i},getTemplateSchema(e){let t=this.schema.find((t=>"template"===t.type&&t.name===e));return g(t)?null:dt(t)},getGFragmentSchema(e){let t=this.schema.find((t=>"g-fragment"===t.type&&t.name===e));return g(t)?null:dt(t)},getRuleSchema(e){let t=this.schema.find((t=>"rule"===t.type&&t.name===e));return g(t)?null:dt(t)},getStyleSchema(e){let t=this.schema.find((t=>"style"===t.type&&t.name===e));return g(t)?null:dt(t)},hasProjectionSchema(e,t){if(g(e))throw new TypeError("Bad parameter: concept");let i=[];const n=e=>!["template","rule","style","g-fragment"].includes(e);return i=c(e)?this.schema.filter((t=>n(t.type)&&t.concept.name===e)):this.schema.filter((t=>{return n(t.type)&&((t=>t&&(t===e.name||e.schema&&t===e.schema.base))(t.concept.name)||!g(i=t.concept.prototype)&&"prototype"!==e.nature&&e.hasPrototype&&e.hasPrototype(i));var i})),d(t)&&!o(t)?i.some((e=>e.tags&&e.tags.includes(t))):!o(i)},export(){const e=[];return this.getProjections().forEach((t=>{e.push(t.export())})),e}},Ys={container:null,menu:null,schema:null,isOpen:!1,visible:!0,btnStart:null,modelFileIO:null,projectionFileIO:null,init(e){return e&&(this.schema=e),this},get isRendered(){return L(this.container)},show(){return We(this.container),this.visible=!0,this},hide(){return qe(this.container),this.visible=!1,this},toggle(){return ze(this.container),this.visible=!this.visible,this},open(){return this.container.classList.add("open"),this.show(),this.isOpen=!0,this},close(){return this.container.classList.remove("open"),this.hide(),this.isOpen=!1,this},clear(){return Ae(this.container),this},update(){},render(){const e=$();return L(this.container)||(this.container=z({class:["editor-home"]})),L(this.menu)||(this.menu=Ks.call(this),e.append(this.menu)),e.hasChildNodes()&&(this.container.append(e),this.bindEvents()),this.refresh(),this.container},refresh(){const{hasConceptModel:e,hasProjectionModel:t}=this.editor;return e&&t||this.show(),this.modelFileIO.setFile(e?"file":null),this.projectionFileIO.setFile(t?"file":null),this.btnStart.disabled=!(e&&t),this},bindEvents(){}};function Ks(){const e=H({class:["editor-home-section","editor-home-section--model"]});W({class:["title","editor-home-section__title","font-ui"]},"Modelling activity");let t=z({class:["editor-home-section__content","editor-home-section--model__content"]});this.modelFileIO=Qs.call(this,"model"),this.projectionFileIO=Qs.call(this,"projection");let i=z({class:["editor-home-section__menu","editor-home-section__menu--concept"]},[this.modelFileIO.render()]),n=z({class:["editor-home-section__menu","editor-home-section__menu--projection"]},[this.projectionFileIO.render()]);return t.append(i,n),this.btnStart=ce({class:["btn","editor-home-section--model__button","editor-home-section__button--start"],dataset:{action:"close",context:"home"}},"Start"),e.append(t,this.btnStart),e}function Qs(e,t){const i=Object.create(Zs,{editor:{value:this.editor}});return i.init(e,t),i}const Zs={file:null,type:null,title:null,status:null,container:null,btnLoad:null,btnUnload:null,btnDownload:null,btnReLoad:null,init(e,t){return this.type=e,this.title=r(t,e),this},get hasFile(){return!g(this.file)},getFile(){return this.file},setFile(e){this.file=e,this.refresh()},refresh(){return this.hasFile?this.container.classList.remove("empty"):this.container.classList.add("empty"),this.btnReLoad.disabled=!this.hasFile,this.btnUnload.disabled=!this.hasFile,this.btnDownload.disabled=!this.hasFile,this},render(){this.container=z({class:["drop-area","editor-home-section__drop-area",`editor-home-section__drop-area--${this.type}`],dataset:{type:this.type}});let e=z({class:["drop-area__file-section"]}),t=ie({class:["icon","file-section__icon"]},`${this.type}`),i=z({class:["file-section__actionbar"]});var n;this.btnUnload=ce({class:["btn","file-section__actionbar-button","file-section__actionbar-button--remove"],title:`Unload the ${this.type}`,dataset:{action:`unload-${this.type}`}},"UN.load"),this.btnReLoad=ce({class:["btn","file-section__actionbar-button","file-section__actionbar-button--reload"],title:`Reload the ${this.type}`,dataset:{action:`reload-${this.type}`}},"RE.load"),this.btnDownload=ce({class:["btn","file-section__actionbar-button","file-section__actionbar-button--download"],title:`Download the ${this.type}`,dataset:{action:`download-${this.type}`}},"Download"),i.append(this.btnUnload,this.btnReLoad,this.btnDownload),e.append(t,i),this.btnLoad=ce({class:["btn","drop-area__button","drop-area__button--open"],title:`Load the ${this.type}`,dataset:{action:`load-${this.type}`}},`Select ${n=this.title.charAt(0),n&&["a","e","i","o","u"].includes(n.toLowerCase())?"an":"a"} ${this.title}`);let s=X({class:["drop-area__instruction"]},[this.btnLoad,"or drop it here"]);return this.container.append(e,s),this.bindEvents(),this.refresh(),this.container},bindEvents(){this.container.addEventListener("dragenter",(e=>{this.container.classList.add("highlight"),e.preventDefault(),e.stopPropagation()}),!1),this.container.addEventListener("dragleave",(e=>{this.container.classList.remove("highlight"),e.preventDefault(),e.stopPropagation()}),!1),this.container.addEventListener("dragover",(e=>{this.container.classList.add("highlight"),e.preventDefault(),e.stopPropagation()}),!1),this.container.addEventListener("drop",(e=>{this.container.classList.remove("highlight");let t=e.dataTransfer.files[0];if(!t.name.endsWith(".json"))return void this.notify("This file is not supported. Please use a .json file");let i=new FileReader;i.onload=e=>{this.editor.load(i.result,this.type)},i.readAsText(t),e.preventDefault(),e.stopPropagation()}),!1)}};function ea(e,t){const{name:i,object:n,id:s}=t,a=Y({class:["selector-concept",`selector-concept--${e}`],title:t.getName(),dataset:{concept:s,object:n}});var r=ee({class:["selector-concept-content"]},t.getName());a.append(r),"ancestor"===e&&r.classList.add("fit-content");const o=ie({class:["selector-concept-status"]});if(t.hasError){o.classList.add("error");let e=J({class:["bare-list","selector-concept-status__errors"]});t.errors.forEach((t=>{let i=Y({class:["selector-concept-status__error"]},t);i.style.minWidth=`${Math.min(.5*t.length,30)}em`,e.append(i)})),o.append(e),a.classList.add("error")}else o.classList.add("valid"),a.classList.add("valid");return a.append(o),a.addEventListener("mouseenter",(e=>{let t=we(`.projection[data-concept="${s}"]`,this.editor.body);t&&this.editor.highlight(t)})),a.addEventListener("mouseleave",(e=>{this.editor.unhighlight()})),a.addEventListener("click",(e=>{let t=we(`.projection[data-concept="${s}"]`,this.editor.body);t&&t.focus()})),a}const ta={container:null,title:null,visible:!0,conceptList:null,header:null,body:null,get isRendered(){return L(this.container)},init(e={}){return this.schema=e,this},show(){return We(this.container),this.visible=!0,this},hide(){return qe(this.container),this.visible=!1,this},toggle(){return ze(this.container),this.visible=!this.visible,this},update(){},refresh(){const{activeInstance:e,activeConcept:t,hasActiveInstance:i,hasActiveConcept:n}=this.editor;if(!i||!n)return Ae(this.conceptList),this;const s=e.concept,a=$();let r=ea.call(this,"root",s);if(a.append(r),s===t&&r.classList.add("selector-concept--active"),s===t)return Ae(this.conceptList).append(a),this;if(!t.hasParent())return Ae(this.conceptList).append(a),this;let o=t.getParent(),l=[];for(;o&&o!==s;)l.unshift(o),o=o.getParent();return l.forEach((e=>{a.append(ea.call(this,"ancestor",e))})),r=ea.call(this,"active",t),a.append(r),Ae(this.conceptList).append(a),this},render(){const e=$();L(this.container)||(this.container=z({class:["editor-breadcrumb"]})),L(this.notification)||(this.notification=z({class:["notification","breadcrumb-notification"]}),e.append(this.notification));const t=ee({class:["breadcrumb-title","hidden"],dataset:{ignore:"all"}},"Breadcrumb");return e.append(t),L(this.conceptList)||(this.conceptList=J({class:["bare-list","selector-concepts"]}),e.append(this.conceptList)),e.hasChildNodes()&&(this.container.append(e),this.bindEvents()),this.update(),this.refresh(),this.container},bindEvents(){}},ia={container:null,schema:null,isOpen:!1,visible:!0,btnStart:null,modelFileIO:null,projectionFileIO:null,get isRendered(){return L(this.container)},init(e){return e&&(this.schema=e),this},show(){return We(this.container),this.visible=!0,this},hide(){return qe(this.container),this.visible=!1,this},toggle(){return ze(this.container),this.visible=!this.visible,this},open(){return this.container.classList.add("open"),this.show(),this.isOpen=!0,this},close(){return this.container.classList.remove("open"),this.hide(),this.isOpen=!1,this},clear(){return Ae(this.container),this},update(){},render(){const e=$();return L(this.container)||(this.container=z({class:["editor-style"]})),e.hasChildNodes()&&(this.container.append(e),this.bindEvents()),this.close(),this.refresh(),this.container},refresh(){return this},bindEvents(){}},na={container:null,schema:null,isOpen:!1,visible:!0,btnStart:null,logList:null,init(e){return e&&(this.schema=e),this},get isRendered(){return L(this.container)},show(){return We(this.container),this.visible=!0,this},hide(){return qe(this.container),this.visible=!1,this},toggle(){return ze(this.container),this.visible=!this.visible,this},open(){return this.container.classList.add("open"),this.show(),this.isOpen=!0,this},close(){return this.container.classList.remove("open"),this.hide(),this.isOpen=!1,this},add(e,t,i="normal"){if(!Array.isArray(e))return;let n=J({class:["bare-list","log-item-messages"]});e.forEach((e=>n.append(Y({class:["log-item-message"]},e))));let s=Y({class:["log-item",`log-item--${i}`]}),a=ce({class:["btn","btn-delete"],dataset:{action:"delete",target:"parent"}},"✖"),o=ee({class:["log-item__name"],dataset:{action:"delete",target:"parent"}},`${r(t,"Log")} (${y(Date.now())})`);return s.append(a,o,n),this.logList.append(s),this.refresh(),this},clear(){return Ae(this.logList),this},update(){},render(){const e=$();return L(this.container)||(this.container=z({class:["editor-log"]})),L(this.logList)||(this.logList=J({class:["bare-list","log-list"]}),e.append(this.logList)),e.hasChildNodes()&&(this.container.append(e),this.bindEvents()),this.refresh(),this.container},refresh(){return this.logList.hasChildNodes()?this.show():this.hide(),this},bindEvents(){}},sa={container:null,list:null,editor:null,dataList:null,fetch:null,init(e){return this.fetch=e,this},render(){const e=$();return L(this.container)||(this.container=z({class:["container","container--editor-selectors"]})),L(this.list)||(this.list=J({class:["bare-list","editor-selectors","font-ui"]}),e.append(this.list)),e.hasChildNodes()&&(this.container.append(e),this.bindEvents()),this.refresh(),this.container},refresh(){return this},update(){return this.dataList=this.fetch(),Ae(this.list),this.dataList.forEach((e=>{const{concept:t,accept:i}=e;let n=q({class:["title","editor-selector__title"]},`${e.name||e.type}`);t&&n.append(ee({class:["editor-selector__title-concept"]},(t.name||t.prototype).replace(" ","-").toLowerCase())),i&&n.append(ee({class:["editor-selector__title-accept"]},i.name));let s=ce({class:["btn","editor-selector__header-button","editor-selector__header-button--info"],title:`View ${e.name||e.type} info`,dataset:{action:"collapse",rel:"parent",target:"selector"}},"i"),a=B({class:["title","editor-selector__header"],title:`Expand/Collapse ${this.type}`},[n,s]),r=aa[this.type],o=z({class:["editor-selector__preview"]},r.call(this,e)),l=ra[this.type],c=z({class:["editor-selector__action-bar"]},l.call(this,e)),h=Y({class:["editor-selector","collapsed","font-ui"],tabindex:0,dataset:{type:this.type,alias:`${e.name||e.type}`,name:"selector",projection:e.id}},[a,o,c]);this.list.append(h)})),this.refresh(),this},show(){return We(this.container),this},hide(){return qe(this.container),this},bindEvents(){}},aa={projection:function(e){const{concept:t,tags:i=[]}=e,n=$();let s=ee({class:["editor-selector__preview-concept"]},t.name||t.prototype),a=J({class:["bare-list","editor-selector__preview-tags"]});return i.forEach((e=>a.append(Y({class:["editor-selector__preview-tag"]},e)))),n.append(s,a),n},value:function(e){if(g(e))return te({class:["editor-selector__preview-null"]},"null");const{name:t,nature:i,value:n,attributes:s}=e;if(["string","number","boolean"].includes(t))return ee({class:["editor-selector__preview-text"]},n);if("set"===t){let e=J({class:["bare-list","editor-selector__preview-list"]});return Array.isArray(n)&&n.forEach((t=>{let i=Y({class:["editor-selector__preview-list-item"]},aa.value(t));e.append(i)})),e}if("prototype"===i){let e=$(),t=ee({class:["editor-selector__preview-text"]},n.name);return e.append(t,aa.value(n)),e}if(s){let e=J({class:["bare-list","editor-selector__preview-attributes"]});return s.forEach((t=>{const{name:i,value:n}=t;let s=ee({class:["editor-selector__preview-text","editor-selector__preview-text--attribute"]},i),a=Y({class:["editor-selector__preview-attribute"]},[s,aa.value(n)]);e.append(a)})),e}return n?aa.value(n):e.toString()},concept:function(e){const t=$();if(Array.isArray(e.attributes)){let i=J({class:["bare-list","editor-selector__attributes"]});e.attributes.forEach((e=>{const{name:t,required:n,target:s={}}=e;let a=ee({class:["editor-selector__preview-text","editor-selector__preview-text--attribute"]},t),r=ee({class:["editor-selector__preview-text","editor-selector__preview-text--target"]},s.name);s.accept&&s.accept.name&&r.append(ee({class:["editor-selector__preview-text--target-accept"]},s.accept.name));let o=Y({class:["editor-selector__attribute"]},[a,r]);n&&(o.classList.add("required"),ie({class:["editor-selector__badge"]})),i.append(o)})),t.append(i)}return t},resource:function(e){return $()}},ra={projection:function(e){const t=$();let i=ce({class:["btn","editor-selector__action-bar-button","editor-selector__action-bar-button","editor-selector__action-bar-button--clone"],dataset:{action:"edit:projection",id:e.id}},"Edit");return t.append(i),t},value:function(e){const t=$();let i=ce({class:["btn","editor-selector__action-bar-button","editor-selector__action-bar-button--clone"],dataset:{action:"create-instance:value",id:e.id}},ie({class:["ico","ico-plus","btn-content"],dataset:{ignore:"all"}},"+")),n=ce({class:["btn","editor-selector__action-bar-button","editor-selector__action-bar-button--clone"],dataset:{action:"copy:value",id:e.id}},ie({class:["ico","ico-copy","btn-content"],dataset:{ignore:"all"}})),s=ce({class:["btn","editor-selector__action-bar-button","editor-selector__action-bar-button--delete"],dataset:{action:"delete:value",id:e.id}},ie({class:["ico","ico-delete","btn-content"],dataset:{ignore:"all"}},"✖"));return t.append(s,n,i),t},concept:function(e){const t=$();let i=this.editor.projectionModel.hasProjectionSchema(e),n=ce({class:["btn","editor-selector__action-bar-button","editor-selector__action-bar-button--clone"],disabled:!i,title:`Create an instance of "${e.name}"`,dataset:{action:"create-instance",concept:e.name}},ie({class:["ico","ico-plus","btn-content"],dataset:{ignore:"all"}},"+"));return i||(n.title=`The concept ${e.name} has no projection`),t.append(n),t},resource:function(e){const{name:t,type:i,required:n}=e,s=$();let a=ce({class:["btn","editor-selector__action-bar-button","editor-selector__action-bar-button--add"],dataset:{action:"load-resource",id:t}},ie({class:["ico","ico-plus","btn-content"],dataset:{ignore:"all"}},"+")),r=ce({class:["btn","editor-selector__action-bar-button","editor-selector__action-bar-button--delete"],dataset:{action:"delete:resource",id:t}},ie({class:["ico","ico-delete","btn-content"],dataset:{ignore:"all"}},"✖"));return this.editor.getResource(t)?s.append(r):s.append(a),s}},oa={editor:null,valueCount:0,fileCount:0,container:null,title:null,visible:!0,tabs:null,tabConcept:null,tabValue:null,tabProjection:null,tabResource:null,tabConceptNotification:null,tabValueNotification:null,tabProjectionNotification:null,tabResourceNotification:null,activeTab:null,activeTabValue:null,menu:null,header:null,body:null,btnHome:null,btnSave:null,get isRendered(){return L(this.container)},init(e){return e&&(this.editor=e),this._conceptSelector=function(e,t,i){return Object.create(sa,{object:{value:"selector"},model:{value:void 0},type:{value:"concept"},editor:{value:t}})}(0,this.editor).init((()=>{if(!this.editor.isReady)return[];const{conceptModel:e}=this.editor;let t=this.editor.getConfig("concepts");return g(t)&&(t=e.getSchema("concrete")),t.filter((t=>e.isConcept(t.name))).map((t=>e.getCompleteModelConcept(t)))})),this},render(){const e=$();L(this.container)||(this.container=z({class:["editor-header"],dataset:{name:"editor-header",alias:"header"}})),L(this.title)||(this.title=ee({class:["editor-header-title"]},"Editor")),L(this.menu)||(this.menu=z({class:["editor-header-left"]},[this.title])),this.btnSave=ce({class:["btn","editor-toolbar__button","editor-toolbar__button--save"],title:"Export your model",dataset:{action:"export"}}),this.btnHome=ce({class:["btn","editor-toolbar__button","editor-toolbar__button--home"],title:"Toggle the home menu",dataset:{action:"home"}});let t=z({class:["editor-toolbar"]},[this.btnSave,this.btnHome]);return L(this.header)||(this.header=z({class:["editor-header-menu"]},[this.menu,t]),e.append(this.header)),L(this.body)||(this.body=z({class:["editor-header-main"]}),e.append(this.body)),L(this.btnCollapse)||(this.btnCollapse=ce({class:["btn","editor-header__button","editor-header__button--collapse"],title:`Collapse ${this.container.dataset.alias}`,dataset:{action:"collapse",rel:"parent",target:this.container.dataset.name}}),e.append(this.btnCollapse)),L(this._conceptSelector.container)||this.body.append(this._conceptSelector.render()),this.btnCollapse.dataset.state=this.container.classList.contains("collapsed")?"ON":"OFF",e.hasChildNodes()&&(this.container.append(e),this.bindEvents()),this.refresh(),this.container},refresh(){let e=this.editor.getConfig("name"),t=r(this.editor.getConfig("settings"),!0);return e&&(this.title.textContent=e),this.editor.hasConceptModel?(this._conceptSelector.update(),We(this.body),We(this.btnCollapse)):(qe(this.body),qe(this.btnCollapse)),this.btnHome.disabled=!this.editor.isReady,this.btnSave.disabled=!this.editor.hasInstances,!1===t&&qe(this.btnHome),this},show(){return We(this.container),this.visible=!0,this},hide(){return qe(this.container),this.visible=!1,this},toggle(){return ze(this.container),this.visible=!this.visible,this},bindEvents(){}};var la=0;const ca={createInstance(e,t,i){if(g(e))return this.notify("The concept is not valid",Ye.ERROR),!1;let n="concept"===e.type?e:this.createConcept(e),s=t;g(s)&&this.hasProjectionModel&&(s=this.createProjection(n).init());let a=Object.create(ha,{id:{value:"instance"+la++},object:{value:"environment"},name:{value:"editor-instance"},type:{value:"instance"},concept:{value:n},projection:{value:s,writable:!0},editor:{value:this}});const r=Object.assign({type:"concept",minimize:!0,resize:!0,maximize:!0,close:"DELETE-CONCEPT"},i);return a.init(r),this.addInstance(a),a},getInstance(e){return this.instances.get(e)},addInstance(e){e.isRendered||this.instanceSection.append(e.render()),this.instances.set(e.id,e),"tab"===this.status.view&&this.status.addView(e);let t=this.resolveElement(e.body);return t.source.notify("displayed"),"algorithm"===e.body.getAttribute("data-nature")&&t.branch(),this.updateActiveInstance(e),this.refresh(),this},removeInstance(e){let t=this.getInstance(e);return!g(t)&&(t===this.activeInstance&&(this.activeInstance=null),t.view&&Ae(t.view).remove(),this.instances.delete(e),this.refresh(),!0)},moveInstance(e,t){return this.instanceSection.children[t].before(e),this},swapInstance(e,t){let i=Array.from(this.instanceSection.children);const n=i.indexOf(e),s=i.indexOf(t);return this.moveInstance(t,n),this.moveInstance(e,s),this}},ha={window:null,container:null,title:null,visible:!0,menu:null,header:null,body:null,btnCollapse:null,btnMaximize:null,btnClose:null,size:1,fullscreen:!1,collapsed:!1,schema:null,ctype:null,get isRendered(){return L(this.container)},init(e={}){return this.ctype=r(e.type,"concept"),this.schema=e,this},collapse(){var e;return e=this.container,L(e)&&e.classList.add($e),this.collapsed=!0,this.fullscreen=!1,this.size="normal",this.refresh(),this},expand(){var e;return e=this.container,L(e)&&e.classList.remove($e),this.collapsed=!1,this.refresh(),this},changeSize(e){this.size=e,"fullscreen"===e?(this.fullscreen=!0,this.container.style.removeProperty("width"),this.container.style.removeProperty("height")):this.fullscreen=!1,this.refresh()},show(){return We(this.container),this.visible=!0,this},hide(){return qe(this.container),this.visible=!1,this},toggle(){return ze(this.container),this.visible=!this.visible,this},refresh(){return this.container.dataset.size=`${this.size}`,g(this.projection)&&(this.body.textContent="No projection found"),Array.from(this.editor.instances).some((e=>e.fullscreen))?this.editor.instanceSection.classList.add("fullscreen"):this.editor.instanceSection.classList.remove("fullscreen"),this},render(){const e=$(),{name:t}=this.concept,i=t.toLowerCase();L(this.container)||(this.container=z({class:["editor-concept",`editor-concept--${this.ctype}`],tabindex:0,dataset:{nature:"concept-container",type:this.ctype,size:1}})),L(this.header)||(this.header=B({title:"concept"===this.schema.type?`Instance of "${i}"`:`Linked instance of "${i}"`,class:["editor-concept-header"]}),e.append(this.header)),L(this.btnClose)||(this.btnClose=ce({class:["btn","editor-concept-toolbar__btn-delete"],title:`Delete the instance "${i}"`,dataset:{action:"close",context:this.type,id:this.id}}),"projection"===this.schema.type&&(this.btnClose.title=`Close the linked instance "${i}"`)),L(this.btnCollapse)||(this.btnCollapse=ce({class:["btn","editor-concept-toolbar__btn-collapse"],title:`Collapse ${t.toLowerCase()}`,dataset:{action:"collapse",context:this.type,id:this.id}})),L(this.btnMaximize)||(this.btnMaximize=ce({class:["btn","editor-concept-toolbar__btn-maximize"],title:`Maximize ${t.toLowerCase()}`,dataset:{action:"maximize",context:this.type,id:this.id}})),this.title=W({class:["title","editor-concept-title","fit-content"],dataset:{nature:"editable",id:this.id}},t);let n=z({class:["editor-concept-toolbar"]},[this.btnCollapse,this.btnMaximize,this.btnClose]);return Ae(this.header).append(this.title,n),this.body&&this.body.remove(),this.projection?this.body=this.projection.render():this.body=X(),e.append(this.body),e.hasChildNodes()&&(this.container.appendChild(e),this.bindEvents()),function(e,t={}){const i=ut(e);if(!L(i))return null;const n=Object.assign({horizontal:!0,vertical:!0,minWidth:60,minHeight:60},t),s=function(){let e=z({class:["resizers"]});return["horizontal","vertical"].forEach((t=>{e.append(z({class:["resizer",`${t}`],dataset:{dir:t}}))})),e}();i.prepend(s),n.horizontal&&n.vertical?i.dataset.resizable="both":n.horizontal?i.dataset.resizable="horizontal":n.vertical&&(i.dataset.resizable="vertical");const{minWidth:a,minHeight:o}=getComputedStyle(i),l=r(tt(a),n.minWidth),c=r(tt(o),n.minHeight);let h=0,u=null;function d(e){const{dir:t}=u.dataset,{width:n,height:s}=getComputedStyle(i);let a="horizontal"===t?e.pageX:e.pageY;if("horizontal"===t){const e=tt(n)+(a-h);e>l&&(i.style.width=`${e}px`)}else if("vertical"===t){const e=tt(s)+(a-h);e>c&&(i.style.height=`${e}px`)}h=a}for(let e=0;e<s.childElementCount;e++){const t=s.children[e];t.addEventListener("mousedown",(function(e){e.preventDefault(),u=t;const{dir:i}=u.dataset;h="horizontal"===i?e.pageX:e.pageY,document.body.addEventListener("mousemove",d),document.body.addEventListener("mouseup",(()=>{document.body.removeEventListener("mousemove",d)}))}))}}(this.container),this.refresh(),this.container},actionHandler(e){switch(e){case"collapse":this.collapsed?this.expand():this.collapse();break;case"maximize":this.fullscreen?this.changeSize("normal"):this.changeSize("fullscreen");break;case"close":this.delete()}},delete(){switch(this.schema.close){case"DELETE-CONCEPT":if(!this.concept.delete(!0))return this.editor.notify("The concept could not be deleted",Ye.ERROR),this;break;case"DELETE-PROJECTION":if(this.projection&&!this.projection.delete())return this.notify("The projection could not be deleted",Ye.ERROR),this}Ae(this.container).remove(),this.editor.removeInstance(this.id),this.window&&this.window.removeInstance(this)},bindEvents(){this.container.addEventListener("focusin",(e=>{this.editor.updateActiveInstance(this)})),this.header.addEventListener("focusout",(e=>{f(this.title.textContent)&&(this.title.textContent=this.concept.name)}))}};var ua=0;const da={createWindow(e){let t=Object.create(pa,{id:{value:"window"+ua++},object:{value:"environment"},name:{value:"editor-window"},type:{value:"window"},editor:{value:this}});return t.refname=e,t.init(),this.addWindow(t),t},getWindow(e){return this.windows.get(e)},findWindow(e){return Array.from(this.windows.values()).find((t=>t.refname===e))},addWindow(e){return e.isRendered||this.body.append(e.render()),this.windows.set(e.id,e),"tab"===this.status.view&&this.status.addView(e),this.refresh(),this},removeWindow(e){let t=this.getWindow(e);return!g(t)&&(t===this.activeWindow&&(this.activeWindow=null),t.view&&Ae(t.view).remove(),this.windows.delete(e),this.refresh(),!0)},moveWindow(e,t){return this.body.children[t].before(e),this},swapWindow(e,t){let i=Array.from(this.body.children);const n=i.indexOf(e),s=i.indexOf(t);return this.moveWindow(t,n),this.moveWindow(e,s),this}},pa={container:null,title:null,visible:!0,instances:null,menu:null,header:null,body:null,btnClose:null,maxInstance:1,get isRendered(){return L(this.container)},init(e={}){return this.ctype=r(e.type,"concept"),this.schema=e,this.instances=new Set,this},isEmpty(){return 0===this.instances.size},show(){return We(this.container),this.visible=!0,this},hide(){return qe(this.container),this.visible=!1,this},toggle(){return ze(this.container),this.visible=!this.visible,this},close(){Ae(this.container).remove(),this.editor.removeWindow(this.id)},refresh(){return this.isEmpty()?this.hide():this.show(),this},render(){const e=$();L(this.container)||(this.container=z({class:["editor-window"],tabindex:-1})),L(this.header)||(this.header=B({class:["editor-window-header"]}),e.append(this.header)),L(this.title)||(this.title=W({class:["title","editor-window-title","fit-content"]})),L(this.btnClose)||(this.btnClose=ce({class:["btn","editor-window-header__btn-delete"],title:"Close the window",dataset:{action:"close",context:this.type,id:this.id}}));let t=z({class:["editor-window-toolbar"]},[this.btnClose]);return Ae(this.header).append(this.title,t),e.hasChildNodes()&&(this.container.appendChild(e),this.bindEvents()),this.refresh(),this.container},addInstance(e){if(!g(e)&&!this.instances.has(e))return this.instances.add(e),e.window=this,this.container.append(e.container),this.refresh(),!0},removeInstance(e){if(!g(e)&&this.instances.has(e))return this.instances.delete(e),this.refresh(),!0},actionHandler(e){switch(e){case"close":this.close()}},bindEvents(){}},ma={conceptModel:null,projectionModel:null,concept:null,projection:null,container:null,title:null,visible:!0,menu:null,header:null,body:null,btnClose:null,schema:null,get isRendered(){return L(this.container)},init(e={}){this.schema=e;const{concept:t,projection:i,handlers:n}=this.element.design();return this.conceptModel=bi.createModel(t).init(),this.projectionModel=Gs(i,this).init(),this.concept=this.conceptModel.createConcept(this.element.name),this.projection=this.projectionModel.createProjection(this.concept).init(),this.concept.getAttributes().forEach((e=>{if(n[e.name]){let t={update:n[e.name]};e.target.register(t)}})),this},show(){return We(this.container),this.visible=!0,this},hide(){return qe(this.container),this.visible=!1,this},toggle(){return ze(this.container),this.visible=!this.visible,this},refresh(){return this},render(){const e=$();L(this.container)||(this.container=z({class:["editor-element"],dataset:{nature:"concept-container",size:1}}));const{name:t}=this.element;L(this.header)||(this.header=B({class:["editor-element-header"]}),e.append(this.header)),L(this.btnClose)||(this.btnClose=ce({class:["btn","editor-element-toolbar__btn-delete"],title:`Delete ${t.toLowerCase()}`,dataset:{action:"close",context:this.type,id:this.id}}));let i=W({class:["title","editor-concept-title","fit-content"]},t),n=z({class:["editor-concept-toolbar"]},[this.btnClose]);return Ae(this.header).append(i,n),e.append(this.projection.render()),e.hasChildNodes()&&(this.container.appendChild(e),this.bindEvents()),this.refresh(),this.container},getField(e){if(!L(e))return console.warn("Field error: Bad argument"),null;const{id:t,nature:i}=e.dataset;return g(t)?(console.warn("Field error: Missing id attribute on field"),null):["field","field-component"].includes(i)?this.projectionModel.getField(t):(console.warn("Field error: Unknown nature attribute on field"),null)},getStatic(e){if(!L(e))return console.warn("Static error: Bad argument"),null;const{id:t,nature:i}=e.dataset;return g(t)?(console.warn("Static error: Missing id attribute on field"),null):["static"].includes(i)?this.projectionModel.getStatic(t):(console.warn("Static error: Unknown nature attribute on field"),null)},getLayout(e){if(!L(e))return console.warn("Layout error: Bad argument"),null;const{id:t,nature:i}=e.dataset;return g(t)?(console.warn("Layout error: Missing id attribute on field"),null):["layout","layout-component"].includes(i)?this.projectionModel.getLayout(t):(console.warn("Layout error: Unknown nature attribute on field"),null)},resolveElement(e){if(!L(e))return null;const{nature:t}=e.dataset;if(g(t))return null;let i=null;switch(t){case"field":case"field-component":i=this.getField(e);break;case"layout":case"layout-component":i=this.getLayout(e);break;case"static":i=this.getStatic(e)}return i&&(i.environment=this),i},updateActiveElement(e){return this.activeElement&&this.activeElement===e||(this.activeElement=e),this},actionHandler(e){},bindEvents(){var e=null;this.container.addEventListener("click",(e=>{var t=Qe(e.target);const{action:i,context:n,id:s,handler:a}=t.dataset;this.activeElement&&this.activeElement.clickHandler(t)}),!0),this.container.addEventListener("keydown",(t=>{const{target:i}=t,{nature:n}=i.dataset;var s=!1;switch(t.key){case Je.backspace:this.activeElement&&e!==Je.ctrl&&!0===this.activeElement.backspaceHandler(i)&&t.preventDefault();break;case Je.ctrl:case Je.shift:t.preventDefault(),s=!0;break;case Je.delete:this.activeElement&&e!==Je.ctrl&&this.activeElement.deleteHandler(i)&&t.preventDefault();break;case Je.spacebar:this.activeElement&&e!==Je.ctrl&&this.activeElement.spaceHandler(i)&&t.preventDefault();break;case Je.alt:t.preventDefault();break;case Je.enter:this.activeElement?!0===this.activeElement.enterHandler(i)&&t.preventDefault():"BUTTON"===i.tagName?(i.click(),t.preventDefault()):t.preventDefault();break;case Je.escape:this.activeElement&&!0===this.activeElement.escapeHandler(i)&&t.preventDefault();break;case Je.insert:this.activeElement&&t.preventDefault();break;case Je.up_arrow:this.activeElement&&![Je.ctrl,Je.shift,Je.alt].includes(e)&&!0===this.activeElement.arrowHandler("up",i)&&t.preventDefault();break;case Je.down_arrow:this.activeElement&&![Je.ctrl,Je.shift,Je.alt].includes(e)&&!0===this.activeElement.arrowHandler("down",i)&&t.preventDefault();break;case Je.right_arrow:this.activeElement&&![Je.ctrl,Je.shift,Je.alt].includes(e)&&!0===this.activeElement.arrowHandler("right",i)&&t.preventDefault();break;case Je.left_arrow:this.activeElement&&![Je.ctrl,Je.shift,Je.alt].includes(e)&&!0===this.activeElement.arrowHandler("left",i)&&t.preventDefault();break;case"s":e===Je.ctrl&&(this.activeConcept.copy(),t.preventDefault());break;case"e":e===Je.ctrl&&this.activeConcept&&(this.createInstance(this.activeConcept,this.activeProjection,{type:"projection",close:"DELETE-PROJECTION"}),t.preventDefault())}s&&(e=t.key)}),!1),this.container.addEventListener("keyup",(t=>{var i=t.target;switch(t.key){case Je.spacebar:this.activeElement&&e===Je.ctrl&&this.activeElement._spaceHandler(i);break;case Je.delete:this.activeElement&&e===Je.ctrl&&this.activeElement.delete(i);break;case Je.alt:this.activeElement&&e===Je.ctrl&&this.design(this.activeElement);break;case Je.up_arrow:this.activeElement&&e===Je.ctrl&&!0===this.activeElement._arrowHandler("up",i)&&t.preventDefault(),this.activeElement&&e===Je.shift&&!0===this.activeElement.shiftHandler("up",i)&&t.preventDefault();break;case Je.down_arrow:this.activeElement&&e===Je.ctrl&&!0===this.activeElement._arrowHandler("down",i)&&t.preventDefault();break;case Je.right_arrow:this.activeElement&&e===Je.ctrl&&!0===this.activeElement._arrowHandler("right",i)&&t.preventDefault();break;case Je.left_arrow:this.activeElement&&e===Je.ctrl&&!0===this.activeElement._arrowHandler("left",i)&&t.preventDefault()}e===t.key&&(e=-1)}),!1),this.container.addEventListener("focusin",(e=>{const{target:t}=e,i=this.resolveElement(t);if(i&&i.projection.focusable&&i.focusable){if(this.activeElement&&this.activeElement!==i&&(this.activeElement.focusOut(),this.activeElement=null),g(i)||i===this.activeElement)return void(this.activeElement&&this.activeElement._focusIn(t));this.updateActiveElement(i),this.activeElement.focusIn(t)}else i||(this.activeElement&&this.activeElement.focusOut(t),this.activeElement=null)}))}},fa={modelstatus:null,editorstatus:null,notification:null,views:null,view:"grid",viewContainer:null,viewList:null,viewItem:null,activeViewItem:null,groupList:null,groupItem:null,activeGroupItem:null,visible:!0,container:null,get isRendered(){return L(this.container)},init(){return this.views=new Map,this},show(){return We(this.container),this.visible=!0,this},hide(){return qe(this.container),this.visible=!1,this},toggle(){return ze(this.container),this.visible=!this.visible,this},updateActiveView(){"tab"===this.view&&(this.editor.instances.forEach((e=>{e!==this.editor.activeInstance&&(e.view.classList.remove("active"),e.hide())})),this.editor.activeInstance.view.classList.add("active"),this.editor.activeInstance.show()),this.editor.refresh()},addView(e){if(g(e))return!1;let t=e.title.textContent,i=ie({class:["ico","ico-delete"]},"✖"),n=ce({class:["btn","btn-close"]},i),s=z({class:[`editor-view-${this.view}list-item__content`,"fit-content"]},t),a=Y({class:[`editor-view-${this.view}list-item`],title:e.title.textContent},[s,n]);e.view=a,a.addEventListener("click",(t=>{if(function(e){const t=e=>e===a||e===n;return t(e)?e:Ee(e,(e=>t(e)),5)}(t.target)===n){let t=a.previousSibling||a.nextSibling;e.delete(),null===this.editor.activeInstance&&t&&t.click()}else this.editor.updateActiveInstance(e)})),this.tabView.append(a)},changeView(e){if(e===this.view)return this;var t;this.view=e,t=this.viewItem,L(t)&&t.classList.remove(Ue),this.viewItem=this.views.get(this.view),function(e){L(e)&&e.classList.add(Ue)}(this.viewItem),Ae(this.editor.viewSection),"tab"===e?(this.tabView=J({class:["bare-list","editor-view-tablist"]}),Ae(this.tabView),this.editor.instances.forEach((e=>{e.expand(),this.addView(e)})),this.editor.viewSection.append(this.tabView)):("grid"===e||"row"===e||"col"===e)&&this.editor.instances.forEach((e=>{e.show()})),this.updateActiveView()},addGroup(){Y({class:["editor-footer-group"]})},notify(e,t=4500){let i=e;const n="open";if(this.notification.classList.contains(n))return!1;this.notification.appendChild(i),setTimeout((()=>{this.notification.classList.add(n),this.container.classList.add("menu--notifying")}),50),setTimeout((()=>{this.notification.classList.remove(n),this.container.classList.remove("menu--notifying"),setTimeout((()=>{Ae(this.notification)}),500)}),t)},refresh(){const{conceptModel:e}=this.editor;if(this.editor.isReady){if(e.hasError){this.modelstatusBadge.classList.add("error"),this.modelstatusBadge.classList.remove("valid"),this.container.classList.add("error");let t=e.concepts.filter((e=>e.hasError)).length;this.modelstatusInfo.textContent=`${t} ${function(e,t,i){if(1===i)return e;let n="s".split("|");return 1===n.length?e+n[0]:e.substring(0,e.lastIndexOf(n[0]))+n[1]}("error",0,t)}`}else this.modelstatusBadge.classList.add("valid"),this.modelstatusBadge.classList.remove("error"),this.container.classList.remove("error"),Ae(this.modelstatusInfo),this.editor.logs.clear();if(this.editor.hasError){this.editorstatusBadge.classList.add("error"),this.editorstatusBadge.classList.remove("valid"),this.container.classList.add("error");let e=this.editor.errors.length;this.editorstatusInfo.textContent=`${e}`}else this.editorstatusBadge.classList.add("valid"),this.editorstatusBadge.classList.remove("error"),this.container.classList.remove("error"),Ae(this.editorstatusInfo),this.editor.logs.clear()}},render(){const e=$();if(L(this.container)||(this.container=z({class:["editor-statusbar"]})),L(this.badgeContainer)||(this.badgeContainer=z({class:["editor-statusbar-badge-container"]}),e.appendChild(this.badgeContainer)),L(this.modelstatus)||(this.modelstatus=z({class:["editor-statusbar-model"]}),this.modelstatusBadge=ie({class:["editor-statusbar-model-badge"]}),this.modelstatusInfo=z({class:["editor-statusbar-model-info"]}),this.modelstatus.append(this.modelstatusBadge,this.modelstatusInfo),this.badgeContainer.appendChild(this.modelstatus)),L(this.editorstatus)||(this.editorstatus=z({class:["editor-statusbar-global"]}),this.editorstatusBadge=ie({class:["editor-statusbar-global-badge"]}),this.editorstatusInfo=z({class:["editor-statusbar-global-info"]}),this.editorstatus.append(this.editorstatusBadge,this.editorstatusInfo),this.badgeContainer.appendChild(this.editorstatus)),L(this.viewContainer)||(this.viewContainer=z({class:["editor-statusbar-viewer-container"]}),e.appendChild(this.viewContainer)),!L(this.btnGroup)){let e=ie({class:["ico","ico-plus","btn-content"],title:"Add a group",dataset:{ignore:"all"}},"+");this.btnGroup=ce({class:["editor-statusbar-viewer__button-add"],dataset:{action:"add-group"}},e)}return L(this.groupContainer)||(this.groupContainer=z({class:["editor-footer-group"]})),L(this.viewList)||(this.viewList=J({class:["bare-list","editor-statusbar-viewers"]}),this.viewContainer.appendChild(this.viewList)),["tab","grid","row"].forEach((e=>{let t=Y({class:["editor-statusbar-viewer"],dataset:{type:"viewer",action:"change-view",value:e}},e);this.views.set(e,t),this.viewList.append(t)})),this.viewItem=this.views.get(this.view),this.viewItem.classList.add("selected"),e.hasChildNodes()&&(this.container.append(e),this.bindEvents()),this.refresh(),this.container},bindEvents(){function e(e,t){let i=te({class:["link","error-message__link"]},e);const n=`.projection[data-concept="${t}"]`;return i.addEventListener("mouseenter",(e=>{let t=we(n,this.editor.body);t&&this.editor.highlight(t)})),i.addEventListener("mouseleave",(e=>{this.editor.unhighlight()})),i.addEventListener("click",(e=>{let t=this.editor.resolveElement(we(n,this.editor.body));t&&t.focus()})),i}this.modelstatus.addEventListener("click",(t=>{if(!this.editor.conceptModel.hasError)return;let i=[];this.editor.conceptModel.concepts.forEach((t=>{t.hasError&&i.push(...t.errors.map((i=>{let n=e.call(this,t.getName(),t.id);return ee({class:["error-message"]},[n,`: ${i}`])})))})),this.editor.logs.clear(),this.editor.logs.add(i,"Validation error",Ke)})),this.editorstatus.addEventListener("click",(e=>{if(!this.editor.hasError)return;let t=[];t.push(...this.editor.errors.map((e=>ee({class:["error-message"]},[`${e.message}`])))),this.editor.logs.clear(),this.editor.logs.add(t,"Validation error",Ke)})),this.editor.registerHandler("editor.instance@active:updated",(()=>{this.updateActiveView()}))}};var va=0;const ga=()=>"value"+va++;function ba(){return Object.create(oa,{object:{value:"environment"},name:{value:"editor-header"},editor:{value:this}})}function ya(){return Object.create(ta,{object:{value:"environment"},name:{value:"editor-breadcrumb"},type:{value:"breadcrumb"},editor:{value:this}})}function wa(){return Object.create(Ys,{object:{value:"environment"},name:{value:"editor-home"},type:{value:"home"},editor:{value:this}})}function ka(){return Object.create(ia,{object:{value:"environment"},name:{value:"editor-style"},type:{value:"style"},editor:{value:this}})}function xa(){return Object.create(fa,{object:{value:"environment"},name:{value:"editor-status"},type:{value:"status"},editor:{value:this}})}function Ea(){return Object.create(na,{object:{value:"environment"},name:{value:"editor-log"},type:{value:"log"},editor:{value:this}})}const Ta={conceptModel:null,projectionModel:null,concept:null,activeConcept:null,activeProjection:null,activeInstance:null,activeReceiver:{},receivers:{},container:null,header:null,body:null,instanceSection:null,designSection:null,navigationSection:null,valueWindow:null,valueList:null,breadcrumb:null,filter:null,home:null,style:null,logs:null,status:null,group:null,input:null,copyValue:null,states:null,activeElement:null,decoratedElements:null,config:null,active:!1,visible:!1,frozen:!1,handlers:null,instances:null,windows:null,values:null,resources:null,models:null,errors:null,init(e={}){const{conceptModel:t,projectionModel:i,config:n={},handlers:s={}}=e;this.config=n,this.handlers=new Map,this.instances=new Map,this.windows=new Map,this.values=new Map,this.resources=new Map,this.models=new Map,this.errors=[],Object.assign(this,ca,da),this.states=[],this.decoratedElements=new Set;for(const e in s){const t=s[e];this.registerHandler(e,t)}return this.header=ba.call(this).init(),this.home=wa.call(this).init(),this.breadcrumb=ya.call(this).init(),this.style=ka.call(this).init(),this.logs=Ea.call(this).init(),this.status=xa.call(this).init(),this.render(),t&&this.loadConceptModel(t),i&&this.loadProjectionModel(i),this.isReady&&(this.conceptModel.getRootConcepts().forEach((e=>{this.createInstance(e)})),this.open()),this},setConfig(e){return!g(e)&&(this.config=e,this.refresh(),this)},getConfig(e){return g(e)?this.config:this.config[e]},getName(){return r(this.config.name,`editor${(new Date).getTime()}`)},get hasConceptModel(){return!g(this.conceptModel)},get hasProjectionModel(){return!g(this.projectionModel)},get hasInstances(){return this.instances.size>0},get hasWindows(){return this.windows.size>0},get hasValues(){return this.values.size>0},get isReady(){return this.hasConceptModel&&this.hasProjectionModel},get hasActiveConcept(){return!g(this.activeConcept)},get hasActiveProjection(){return!g(this.activeProjection)},get hasActiveInstance(){return!g(this.activeInstance)},get hasError(){return!o(this.errors)},createConcept(e){if(g(e))throw new TypeError("Missing argument: The 'name' is required to create a concept");return this.conceptModel.isConcept(e)?this.conceptModel.createConcept(e):(this.notify(`The concept '${e}' is not defined in the model`,Ye.ERROR),!1)},addConcept(e){let t=e.concept||e;Array.isArray(t)?this.conceptModel.schema.push(...t):this.conceptModel.schema.push(t),this.refresh()},createProjection(e,t){if(g(e))throw new TypeError("Missing argument: The 'concept' is required to create a projection");return this.projectionModel.hasConceptProjection(e,t)?this.projectionModel.createProjection(e,t).init():(this.notify(`The projection for the concept '${e.name}' is not defined in the model`,Ye.ERROR),!1)},addProjection(e){let t=e.projection||e;Array.isArray(t)?this.projectionModel.schema.push(...t):this.projectionModel.schema.push(t),this.refresh()},getField(e){if(!L(e)&&"path"!=e.tagName)return console.warn("Field error: Bad argument"),null;const{id:t,nature:i}=e.dataset;return g(t)?(console.warn("Field error: Missing id attribute on field"),null):["field","field-component"].includes(i)?this.projectionModel.getField(t):(console.warn("Field error: Unknown nature attribute on field"),null)},getStatic(e){if(!L(e))return console.warn("Static error: Bad argument"),null;const{id:t,nature:i}=e.dataset;return g(t)?(console.warn("Static error: Missing id attribute on field"),null):["static","static-component"].includes(i)?this.projectionModel.getStatic(t):(console.warn("Static error: Unknown nature attribute on field"),null)},getLayout(e){if(!L(e))return console.warn("Layout error: Bad argument"),null;const{id:t,nature:i}=e.dataset;return g(t)?(console.warn("Layout error: Missing id attribute on field"),null):["layout","layout-component"].includes(i)?this.projectionModel.getLayout(t):(console.warn("Layout error: Unknown nature attribute on field"),null)},getAlgo(e){if(!L(e))return console.warn("Algorithm error: Bad argument"),null;const{id:t,nature:i}=e.dataset;return g(t)?(console.warn("Algorithm error: Missing id attribute on field"),null):["algorithm","algorithm-component"].includes(i)?this.projectionModel.getAlgo(t):(console.warn("Layout error: Unknown nature attribute on field"),null)},resolveElement(e){if(!L(e)&&"path"!=e.tagName)return null;const{nature:t}=e.dataset;if(g(t))return null;let i=null;switch(t){case"field":case"field-component":i=this.getField(e);break;case"layout":case"layout-component":i=this.getLayout(e);break;case"static":case"static-component":i=this.getStatic(e);break;case"algorithm":i=this.getAlgo(e)}return i&&(i.environment=this),i},download(e,t,i){const n="application/json";window.URL=window.webkitURL||window.URL;var s=K({class:["bare-link","download-item__link"]},"Download");f(s.href)||window.URL.revokeObjectURL(s.href);var a=new Blob([JSON.stringify(e)],{type:n});return Object.assign(s,{download:`${r(t,(new Date).getTime())}.jsoncp`,href:window.URL.createObjectURL(a)}),s.dataset.downloadurl=[n,s.download,s.href].join(":"),s.click(),setTimeout((()=>{window.URL.revokeObjectURL(s.href),s.remove()}),1500),e},export(e=!1){const t="application/json";window.URL=window.webkitURL||window.URL;var i=K({});this.container.append(i),f(i.href)||window.URL.revokeObjectURL(i.href);const n={concept:this.conceptModel.schema,values:this.conceptModel.export(),editor:this.config,meta:{date:y(),device:navigator.userAgent}};var s=new Blob([JSON.stringify(n)],{type:t});return Object.assign(i,{download:"model.jsoncp",href:window.URL.createObjectURL(s)}),i.dataset.downloadurl=[t,i.download,i.href].join(":"),e?(Ce(JSON.stringify(n)),this.notify("The model has been copied to clipboard",Ye.SUCCESS)):(i.click(),this.notify("The model has been downloaded",Ye.SUCCESS)),setTimeout((()=>{window.URL.revokeObjectURL(i.href),i.remove()}),1500),n},createState(e,t){const{id:i,name:n}=e;let s=ga(),a=JSON.stringify(e.clone()),r=(b(new Date,"hh:dd"),ie({class:["ico","ico-delete"]},"✖")),o=ce({class:["btn","btn-delete"],title:`Delete ${n} state`},r),l=z({class:["model-state-preview"],title:`Preview ${n}`},t),c=ee({class:["model-state-content","fit-content"]},`${e.getName()}`),h=Y({class:["model-state"],title:`Restore ${n} state`,dataset:{id:s,concept:i}},[o,c,l]);h.addEventListener("click",(e=>{let t=function(e){const t=e=>e===h||e===o;return t(e)?e:Ee(e,(e=>t(e)),5)}(e.target);if(this.unhighlight(),t===o)this.removeState(s);else{let e=this.restore(a);this.removeState(s);let t=we(`.projection[data-concept="${e.id}"]`,this.body);t&&t.focus()}}));let u=`.projection[data-concept="${i}"]`;if(h.addEventListener("mouseenter",(e=>{let t=we(u,this.body);t&&this.highlight(t)})),h.addEventListener("mouseleave",(e=>{this.unhighlight()})),this.states.length>8){let{id:e}=this.stateList.lastChild.dataset;this.removeValue(e)}let d=Object.create({},{id:{value:s},object:{value:"value"},type:{value:"state"},element:{value:h},concept:{value:e},value:{value:a}});return this.addState(d),d},getState(e){if(!g(e)&&!o(this.states))return this.states[e]},addState(e){return this.stateList.append(e.element),this.states.push(e),this.refresh(),e},removeState(e){if(g(e))return;const t=this.states.findIndex((t=>t.id===e));if(-1===t)return null;let i=this.states.splice(t,1)[0],{element:n}=i;return Ae(n).remove(),this.refresh(),this},save(e,t){this.createState(e,t),this.refresh()},restore(e){let t=JSON.parse(e),i=this.conceptModel.getConcept(t.id);return i.restore(t),this.refresh(),i},undo(){if(o(this.states))return void this.notify("There are no previous state",Ye.NORMAL,2e3);let e=function(e){if(!Array.isArray(e))throw new TypeError("Bad argument");if(!o(e))return e[e.length-1]}(this.states);this.restore(e.value),this.removeState(e.id)},notify(e,t,i=4500){let n=X({class:["notify"],html:e});const s="open";t&&n.classList.add(t),this.container.append(n),setTimeout((()=>{n.classList.add(s)}),50),setTimeout((()=>{n.classList.remove(s),setTimeout((()=>{n.remove()}),500)}),i)},addResource(e,t){let i=r(t,e.name.split(".")[0]);this.resources.set(i,e);let n=new FileReader;return n.onload=e=>{this.addModel(i,n.result)},n.readAsText(e),this.refresh(),e},getResource(e){return this.resources.get(e)},hasResource(e){return this.resources.has(e)},removeResource(e){return this.resources.delete(e),this.triggerEvent({name:"resource.removed"}),this.refresh(),!0},addError(e){return this.errors.push(e),this.refresh(),Xe(this.status.editorstatusBadge),e},removeError(e){return this.errors.pop(),this.refresh(),!0},clearError(e){return this.errors=[],this.refresh(),!0},getModel(e){let t=this.models.get(e);return g(t)?null:JSON.parse(t)},addModel(e,t){this.models.set(e,t)},removeModel(e){return this.triggerEvent({name:"model.remove@pre",args:[e]},(()=>{this.models.delete(e),this.refresh(),this.triggerEvent({name:"model.remove@post"})}),!1),!0},hasModel(e){return this.models.has(e)},getValue(e){if(this.values.has(e))return this.values.get(e)},addValue(e){let t=ga(),i=ie({class:["ico","ico-copy"]}),n=ie({class:["ico","ico-delete"]},"✖"),s=ce({class:["btn","btn-copy","fit-content"],title:`Copy ${e.name}`},[i,e.name]),a=ce({class:["btn","btn-delete"]},n),r=Y({class:["model-value"],dataset:{id:t}},[s,a]);if(s.addEventListener("click",(t=>{this.copy(e)})),a.addEventListener("click",(e=>{this.removeValue(t)})),this.values.size>5){let{id:e}=this.valueList.lastChild.dataset;this.removeValue(e)}return this.valueList.prepend(r),this.values.set(t,{element:r,value:e}),this.refresh(),e},removeValue(e){if(g(e)||!this.values.has(e))return;let{element:t}=this.values.get(e);return Ae(t).remove(),this.values.delete(e),this.refresh(),this},copy(e,t=!1){return g(e)||(this.copyValue=e,Ce(JSON.stringify(e)),t&&this.addValue(e),this.notify(`${e.name} copied`,Ye.NORMAL)),this},paste(e,t){let i=r(t,this.copyValue);if(!g(i)){if(g(e)){let e=this.createConcept(i.name).init();e.setValue(i),this.createInstance(e)}else"prototype"===i.nature?e.setValue(i.value):e.setValue(i);return this}},show(){return this.triggerEvent({name:"editor.show@pre"},(()=>{We(this.container),this.visible=!0,this.triggerEvent({name:"editor.show@post"})}),!1),this},hide(){return this.triggerEvent({name:"editor.hide@pre"},(()=>{qe(this.container),this.visible=!1,this.triggerEvent({name:"editor.hide@post"})}),!1),this},toggle(){return this.triggerEvent({name:"editor.toggle@pre"},(()=>{ze(this.container),this.visible=!this.visible,this.triggerEvent({name:"editor.toggle@post"})}),!1),this},open(){return this.triggerEvent({name:"editor.open@pre"},(()=>{this.show(),this.active=!0,this.isReady&&this.home.close(),this.triggerEvent({name:"editor.open@post"})}),!1),this},close(){return this.triggerEvent({name:"editor.close@pre"},(()=>{this.hide(),this.active=!1,this.done(),this.clear(),this.triggerEvent({name:"editor.close@post"})}),!1),this},destroy(){return this.triggerEvent({name:"editor.destroy@pre"},(()=>{this.hide(),this.done(),this.instances.forEach((e=>e.delete())),Ae(this.container).remove()}),!1),!0},freeze(){return this.triggerEvent({name:"editor.freeze@pre"},(()=>{this.frozen=!0,this.refresh(),this.triggerEvent({name:"editor.freeze@post"})}),!1),this},unfreeze(){return this.frozen=!1,this.refresh(),this},done(){return this.conceptModel&&this.conceptModel.done(),this.projectionModel&&this.projectionModel.done(),this},highlight(e){return L(e)?(function(e){L(e)&&e.classList.add(Be)}(e),this.decoratedElements.add(e),this):this},unhighlight(e){return L(e)?(Ge(e),this.decoratedElements.delete(e),this):(this.decoratedElements.forEach((e=>Ge(e))),this.decoratedElements.clear(),this)},createWindow(){let e=z({class:["editor-window"],tabindex:0});this.body.append(e)},unloadConceptModel(){return this.hasConceptModel&&(this.conceptModel.done(),this.conceptModel=null,this.refresh()),this},loadConceptModel(e,t){let i=e.concept||e,n=r(t,e.values);return Array.isArray(i)?o(i)?(this.notify("The concept model is empty",Ye.ERROR),!1):(this.unloadConceptModel(),this.clear(),this.conceptModel=bi.createModel(i,this).init(n),g(this.conceptModel),this.hasProjectionModel&&this.projectionModel.done(),this.conceptModel.getRootConcepts().forEach((e=>{this.createInstance(e)})),this.refresh(),this):(this.notify("Invalid concept model",Ye.ERROR),!1)},unloadProjectionModel(){return this.hasProjectionModel&&(this.projectionModel.done(),this.projectionModel=null,this.refresh()),this},loadProjectionModel(e,t){let i=e.projection||e,n=r(t,e.views);return Array.isArray(i)?o(i)?(this.notify("The projection model is empty",Ye.WARNING),!1):(this.unloadProjectionModel(),this.activeElement=null,this.activeInstance=null,this.activeConcept=null,this.activeProjection=null,g(this.projectionModel)&&(this.projectionModel=Gs(i,this).init(n)),this.projectionModel.setSchema(i),g(this.projectionModel),this.instances.forEach((e=>{e.projection=this.projectionModel.createProjection(e.concept).init(),e.render()})),this.refresh(),this):(this.notify("Invalid projection model",Ye.ERROR),!1)},load(e,t,i){let n=new FileReader;if("model"===t)n.onload=e=>{const t=JSON.parse(n.result);if(Array.isArray(t))this.loadConceptModel(t);else{const{concept:e,values:i=[],editor:n}=t;this.loadConceptModel(e,i),n&&this.setConfig(n)}},n.readAsText(e);else if("projection"===t)n.onload=e=>{const t=JSON.parse(n.result);if(Array.isArray(t))this.loadProjectionModel(t);else{const{projection:e,views:i=[]}=t;this.loadProjectionModel(e,i)}},n.readAsText(e);else{if("resource"!==t)return this.notify(`File type '${t}' is not handled`,Ye.WARNING),!1;this.addResource(e,i)}return!0},unload(){return this.unloadConceptModel(),this.unloadProjectionModel(),this.clear(),this},clear(){return this.triggerEvent({name:"editor.clear@pre"},(()=>{this.instances.forEach((e=>e.delete())),this.instances.clear(),this.resources.clear(),this.models.clear(),this.states.forEach((e=>e.element.remove())),this.states=[],this.activeElement=null,this.activeInstance=null,this.activeConcept=null,this.activeProjection=null,this.refresh(),this.triggerEvent({name:"editor.clear@post"})}),!1),this},design(e,t){if(g(e))return!1;let i=Object.create(ma,{id:{value:this.id},object:{value:"environment"},name:{value:"editor-instance"},type:{value:"instance"},element:{value:e},editor:{value:this}});const n=Object.assign({minimize:!0,close:!0},t);return i.init(n),this.designSection.append(i.render())},update(e,t,i){this.triggerEvent({name:e})},render(e){const t=$();if(this.home.isRendered||t.append(this.home.render()),this.style.isRendered||t.append(this.style.render()),this.header.isRendered||t.append(this.header.render()),L(this.navigationSection)||(this.navigationSection=H({class:["model-navigation-section"]}),this.viewSection=U({class:["model-view-section"]}),this.navigationSection.append(this.viewSection),t.append(this.navigationSection)),!L(this.body)){this.body=z({class:["editor-body"],tabindex:0});let e=z({class:["editor-body-main"],tabindex:0});this.instanceSection=H({class:["model-concept-section"]}),e.append(this.instanceSection),this.body.append(e),t.append(this.body)}return L(this.timeline)||(this.timeline=z({class:["editor-timeline"]}),this.stateList=J({class:["bare-list","model-state-list"]}),this.timeline.append(this.stateList),t.append(this.timeline)),this.logs.isRendered||t.append(this.logs.render()),this.breadcrumb.isRendered||this.navigationSection.append(this.breadcrumb.render()),L(this.valueSection)||(this.valueSection=z({class:["model-value-window"]}),this.valueList=J({class:["bare-list","model-value-list"]}),this.valueSection.append(this.valueList),this.navigationSection.append(this.valueSection)),this.status.isRendered||t.append(this.status.render()),L(this.input)||(this.input=ne({type:"file",class:["hidden"],accept:".json,.jsoncp"}),t.append(this.input)),t.hasChildNodes()&&(this.container.append(t),this.bindEvents()),L(e)&&e.append(this.container),this.refresh(),this.container},refresh(e=!1){return this.frozen&&!e||(this.hasConceptModel?this.container.classList.remove("no-concept-model"):this.container.classList.add("no-concept-model"),this.hasProjectionModel?this.container.classList.remove("no-projection-model"):this.container.classList.add("no-projection-model"),this.hasValues?We(this.valueWindow):qe(this.valueWindow),this.header.refresh(),this.breadcrumb.refresh(),this.home.refresh(),this.style.refresh(),this.logs.refresh(),this.status.refresh(),this.instanceSection.dataset.view=this.status.view,["grid","row"].includes(this.status.view)?qe(this.viewSection):["tab"].includes(this.status.view)&&We(this.viewSection),o(this.states)?qe(this.timeline):(We(this.timeline),this.states.forEach((e=>{this.conceptModel.hasConcept(e.concept.id)?this.hasActiveConcept&&this.activeConcept===e.concept?e.element.classList.add("active"):e.element.classList.remove("active"):this.removeState(e.id)})))),this},updateActiveElement(e){return this.activeElement&&this.activeElement===e||(this.triggerEvent({name:"editor.element@active:updated"}),this.activeElement=e),this},updateActiveConcept(e){return this.hasActiveConcept&&this.activeConcept===e||(this.activeConcept=e,this.triggerEvent({name:"editor.concept@active:updated"}),this.refresh()),this},updateActiveProjection(e){if(this.activeProjection&&this.activeProjection===e)return this;let t=ke(".active-parent",this.body);for(let e=0;e<t.length;e++)t[e].classList.remove("active-parent");this.activeProjection=e;let i=this.activeProjection.parent;for(;i;)i.getContainer().classList.add("active-parent"),i=i.parent;return this.triggerEvent({name:"editor.projection@active:updated"}),this.refresh(),this},updateActiveInstance(e){if(this.activeInstance){if(this.activeInstance===e)return this;this.activeInstance,this.activeInstance.container.classList.remove("active")}return this.activeInstance=e,this.activeInstance.container.classList.add("active"),this.triggerEvent({name:"editor.instance@active:updated"}),this.refresh(),this},getHandlers(e){return r(this.handlers.get(e),[])},triggerEvent(e,t,i=!0){const{name:n,options:s,args:a}=e,r=this.getHandlers(n),o=h(t);let l=!1;return r.forEach((e=>{let n=e.call(this,a,s);!1!==n?i&&o&&t.call(this,n):l=!0})),!l&&(!i&&o&&t.call(this),!0)},registerHandler(e,t){return this.hasHanlder(e)||this.handlers.set(e,[]),this.handlers.get(e).push(t),!0},unregisterHandler(e,t){if(!this.hasHanlder(e))return!1;let i=this.getHandlers(e);for(let e=0;e<i.length;e++)if(i[e]===t)return i.splice(e,1),!0;return!1},hasHanlder(e){return this.handlers.has(e)},registerReceiver(e,t){console.log("REGISTERING RECEIVER"),g(this.activeReceiver[t])&&(this.activeReceiver[t]=e),g(this.receivers[t])&&(this.receivers[t]={root:e,projections:[]},e.isRoot=!0),this.receivers[t].projections.push(e)},getActiveReceiver(e){return this.activeReceiver[e]},setActiveReceiver(e,t){this.activeReceiver[t]=e},getRootReceiver(e){return this.receivers[e].root},findReceiverInstance(e,t){let i=this.receivers[t].projections;for(let t=0;t<i.length;t++){let n=i[t].instances.get(e);if(L(n))return{container:i[t],instance:n}}alert("Not Found")},bindEvents(){var e=null,t=null,i=null;const n={open:e=>{const{context:t}=e.dataset;t?this[t].open():this.open()},close:e=>{const{context:t,id:i,type:n}=e.dataset;t?this[t].close():this.close()},collapse:e=>{const{rel:t,target:i}=e.dataset;if("parent"===t){let t=Ee(e,(e=>e.dataset.name===i));if(L(t)){const{alias:i=""}=t.dataset;t.classList.toggle("collapsed");let n=t.classList.contains("collapsed");e.dataset.state=n?"ON":"OFF",e.title=n?`Expand ${i.toLowerCase()}`:`Collapse ${i.toLowerCase()}`}}},delete:e=>{const{target:t}=e.dataset;if("parent"===t){let t=e.parentElement;Ae(t),t.remove()}},"delete:value":e=>{const{id:t}=e.dataset;this.conceptModel.removeValue(t),this.header._valueSelector.update()},"delete:resource":e=>{const{id:t}=e.dataset;this.removeResource(t)},"change-view":e=>{const{value:t}=e.dataset;this.status.changeView(t)},"add-group":e=>{this.status.addGroup()},style:e=>{this.style.toggle()},home:e=>{this.home.toggle()},logs:e=>{this.logs.toggle()},export:e=>{this.export()},"export--copy":e=>{this.export(!0)},"create-instance":e=>{const{concept:t}=e.dataset;let i=this.createConcept(t);this.createInstance(i)},"create-instance:value":e=>{const{id:t}=e.dataset;let i=this.conceptModel.getValue(t),n=this.createConcept(i.name);n.initValue(i),this.createInstance(n)},"copy:value":e=>{const{id:t}=e.dataset;let i=this.conceptModel.getValue(t);this.copy(i)},"load-model":e=>{let i=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});t="model",this.input.dispatchEvent(i)},save:e=>{this.save()},undo:e=>{this.undo()},"unload-model":e=>{this.unloadConceptModel()},"reload-model":e=>{const{schema:t,values:i}=this.conceptModel;this.loadConceptModel(t,i)},"download-model":e=>{const{schema:t,values:i}=this.conceptModel;let n=this.getName().toLowerCase().replace(/\s+/g," ").replace(" ","_");this.download({concept:t},`${n}_model`)},"load-projection":e=>{let i=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});t="projection",this.input.dispatchEvent(i)},"unload-projection":e=>{this.unloadProjectionModel()},"reload-projection":e=>{const{schema:t,views:i}=this.projectionModel;this.loadProjectionModel(t,i)},"download-projection":e=>{const{schema:t,views:i}=this.projectionModel;let n=this.getName().toLowerCase().replace(/\s+/g," ").replace(" ","_");this.download({projection:t},`${n}_projection`)}},s={[Je.up_arrow]:"up",[Je.right_arrow]:"right",[Je.down_arrow]:"down",[Je.left_arrow]:"left"};this.container.addEventListener("click",(e=>{var t=Qe(e.target);const{action:i,context:s,id:a}=t.dataset;if("instance"===s)return void this.getInstance(a).actionHandler(i);this.activeElement&&this.activeElement.clickHandler(t);const r=n[i];h(r)?(r(t),t.blur()):i&&this.triggerEvent({name:i})}),!0),this.input.addEventListener("change",(e=>{let n=this.input.files[0];this.load(n,t,i),t=null,this.input.value=""})),this.body.addEventListener("copy",(e=>{if(!et(e.target)){let t=this.activeConcept.copy(!1);this.copy(t,!0),e.preventDefault()}})),this.body.addEventListener("paste",(e=>{if(g(e.clipboardData))return this.paste(this.activeConcept),void e.preventDefault();if(et(e.target))return;let t=e.clipboardData.getData("text");t=JSON.parse(t),this.paste(this.activeConcept,t),e.preventDefault()})),this.body.addEventListener("keydown",(t=>{const{target:i}=t,{nature:n}=i.dataset;var a=!1;switch(t.key){case Je.backspace:this.activeElement&&e!==Je.ctrl&&!0===this.activeElement.backspaceHandler(i)&&t.preventDefault();break;case Je.ctrl:case Je.shift:t.preventDefault(),a=!0;break;case Je.delete:this.activeElement&&e!==Je.ctrl&&!et(i)&&this.activeElement.deleteHandler(i)&&t.preventDefault();break;case Je.spacebar:this.activeElement&&e!==Je.ctrl&&this.activeElement.spaceHandler(i)&&t.preventDefault();break;case Je.alt:t.preventDefault();break;case Je.enter:this.activeElement?!0===this.activeElement.enterHandler(i)&&t.preventDefault():"concept-container"===n?this.activeInstance.projection.focus():"editable"===n?i.blur():"BUTTON"===i.tagName?(i.click(),t.preventDefault()):t.preventDefault();break;case Je.escape:this.activeElement&&(!0===this.activeElement.escapeHandler(i)?t.preventDefault():Ee(i,(e=>0===e.tabIndex)).focus());break;case Je.insert:this.activeElement&&t.preventDefault();break;case Je.up_arrow:case Je.right_arrow:case Je.down_arrow:case Je.left_arrow:if(this.activeElement&&![Je.ctrl,Je.shift,Je.alt].includes(e))!0===this.activeElement.arrowHandler(s[t.key],i)&&t.preventDefault();else if("concept-container"===n&&![Je.ctrl,Je.shift,Je.alt].includes(e)){let e=rt(i,s[t.key],this.instanceSection);if(!L(e))return!1;e.focus()}break;case"s":e===Je.ctrl&&(this.activeConcept.copy(),this.header.valueCount++,this.refresh(),t.preventDefault());break;case"c":if(e===Je.ctrl){let e=new ClipboardEvent("copy");this.body.dispatchEvent(e)}break;case"v":if(e===Je.ctrl){let e=new ClipboardEvent("paste");this.body.dispatchEvent(e)}break;case"e":e===Je.ctrl&&this.activeConcept&&(this.createInstance(this.activeConcept,this.activeProjection,{type:"projection",close:"DELETE-PROJECTION"}),t.preventDefault());break;case"f":break;case"z":e===Je.ctrl&&(et(i)||(this.undo(),t.preventDefault()))}a&&(e=t.key)}),!1),this.body.addEventListener("keyup",(t=>{var i=t.target;const{nature:n}=i.dataset;switch(t.key){case Je.spacebar:this.activeElement&&e===Je.ctrl&&this.activeElement._spaceHandler(i);break;case Je.delete:this.activeElement&&e===Je.ctrl&&this.activeElement.delete(i);break;case Je.alt:break;case Je.up_arrow:case Je.down_arrow:case Je.right_arrow:case Je.left_arrow:if(this.activeElement&&e===Je.ctrl)!0===this.activeElement._arrowHandler(s[t.key],i)&&t.preventDefault();else if("concept-container"===n&&e===Je.ctrl){let n=rt(i,s[t.key],this.instanceSection);if(!L(n))return!1;this.swapInstance(i,n,!0),i.focus(),e=Je.ctrl}}e===t.key&&(e=-1)}),!1),this.body.addEventListener("focusin",(t=>{const{target:i}=t,n=this.resolveElement(i);if(e=-1,n?(this.activeElement&&this.activeElement!==n&&(this.activeElement.focusOut(),this.activeElement=null),this.updateActiveElement(n),this.activeElement.focusIn(i)):(this.activeElement&&this.activeElement.focusOut(i),this.activeElement=null),this.activeElement){let e=this.activeElement.projection;this.updateActiveProjection(e),this.updateActiveConcept(e.concept)}else this.activeConcept=null,this.activeProjection=null;this.refresh()})),this.registerHandler("export",(()=>this.export())),this.registerHandler("value.changed",(()=>this.refresh())),this.registerHandler("value.added",(()=>this.refresh())),this.registerHandler("value.removed",(()=>this.refresh())),this.registerHandler("open-style",(()=>console.log("hello"))),this.registerHandler("load-resource",(e=>{let n=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});t="resource",i=e[0],this.input.dispatchEvent(n)}))}},Na="editor";function Aa(e){const t=ut(e),i=(e=>L(e)&&k(e.dataset,"gentleman"))(t)?[t]:ke("[data-gentleman]",t),n=[];return i.forEach((e=>{let t=r(e.dataset.gentleman,Na);switch(t){case Na:n.push(Ca(e));break;default:console.warn(`Gentleman does not support this environment ${t}`)}})),n}function Ca(e){let t=ut(e);return L(e)||(t=z({tabindex:-1})),t.classList.add("gentleman-editor"),t.dataset.gentleman=Na,Object.create(Ta,{object:{value:"environment"},type:{value:Na},name:{value:"gentleman editor"},container:{value:t}})}})(),n})()}));
=======
/*! For license information please see gentleman.core.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Gentleman=t():e.Gentleman=t()}(self,(function(){return(()=>{"use strict";var e={835:(e,t,i)=>{function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(e){return function(e){if(Array.isArray(e))return a(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||r(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(e,t){if(e){if("string"==typeof e)return a(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?a(e,t):void 0}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,s=new Array(t);i<t;i++)s[i]=e[i];return s}function l(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return i?v(e)?t:e:b(e)?t:e}function o(e){return p(e)&&0===e.length}function c(e){return e instanceof Date||"object"===s(e)&&"[object Date]"===Object.prototype.toString.call(e)}function h(e){return"string"==typeof e||e instanceof String}function u(e){return"function"==typeof e}function d(e){return!b(e)&&"object"===s(e)}function p(e){return!b(e)&&"function"==typeof e[Symbol.iterator]}function m(e){return p(e)&&!h(e)}function f(e){return null===e}function g(e){return!e||h(e)&&(0===e.length||/^\s*$/.test(e))}function v(e){return void 0===e}function b(e){return f(e)||v(e)}function y(e){if(!Array.isArray(e))throw new TypeError("Bad argument");if(!o(e))return e[e.length-1]}function w(e,t){var i=e.getDate(),s=e.getMonth()+1,n=e.getFullYear().toString(),r=e.getHours(),a=e.getMinutes(),l=e.getSeconds(),o=function(e){return e<10?"0".concat(e):e};return t.replace("yyyy",n).replace("yy",n.slice(-2)).replace("mm",o(s)).replace("m",s).replace("dd",o(i)).replace("d",i).replace("hh",o(r)).replace("h",r).replace("MM",o(a)).replace("M",a).replace("ss",o(l)).replace("s",l)}function E(e){return w(function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(b(e))return new Date;if(c(e))return e;var i=new Date(e),s=i.getTime();return Number.isNaN(s)?new Date:t?new Date(s+6e4*i.getTimezoneOffset()):i}(e,!1),"yyyy-mm-dd hh:MM")}i.d(t,{fm:()=>x,kI:()=>L,jC:()=>Ae,WA:()=>He,cH:()=>te,Pi:()=>W,K$:()=>se,ax:()=>me,wC:()=>K,DZ:()=>Z,UF:()=>ae,rX:()=>q,_N:()=>U,mg:()=>G,dc:()=>F,oL:()=>le,Bi:()=>ie,Ju:()=>oe,_:()=>he,HV:()=>ee,qm:()=>Q,vB:()=>z,kQ:()=>ne,u4:()=>re,W_:()=>fe,uI:()=>be,Ss:()=>Ce,tH:()=>ye,ZL:()=>ve,zI:()=>Ee,ui:()=>we,nE:()=>ce,w_:()=>Y,wr:()=>Ve,p6:()=>w,sb:()=>xe,$3:()=>Re,t4:()=>Ie,RI:()=>j,Bv:()=>k,xb:()=>o,mf:()=>u,Re:()=>S,TW:()=>p,UG:()=>O,le:()=>b,hr:()=>g,Kn:()=>d,HD:()=>h,Z$:()=>y,Ho:()=>R,ep:()=>Te,iG:()=>E,sw:()=>I,XI:()=>l});var C=Object.prototype.hasOwnProperty,j=(Object.prototype.isPrototypeOf,function(e,t){return C.call(e,t)});function L(e){if(b(e)||!d(e))return e;var t=e.constructor();for(var i in e)j(e,i)&&(e.isActiveClone=null,t[i]=L(e[i]),delete e.isActiveClone);return t}function x(e){return g(e)?e:e.charAt(0).toUpperCase()+e.slice(1)}function R(e){return g(e)?e:function(e){return g(e)?e:e.toLowerCase().replace(/\b\w/g,(function(e){return e.toUpperCase()}))}(e.replace(/[_-]+/g," ").replace(/\s+/g," ").trim()).replace(/\s+/g,"")}function I(e){var t=l(e,!1);return h(t)&&"true"===t.toLowerCase()||Number.isInteger(t)&&1===t||!0===t}var A=function(e){return!b(e)&&e.nodeType===Node.ELEMENT_NODE},O=function(e){return e instanceof Node},V=function(e){return A(e)&&e instanceof Element},S=function(e,t){return!!(A(e)&&e instanceof HTMLElement)&&(!p(t)||(i=e,s=Array.isArray(t)?t:[t],n=function(e){return i instanceof e},a=function(e){return i.tagName===e.toUpperCase()},l=function(e){return Array.isArray(e)?e.includes(i.type):i.type===e},s.some((function(e){if(!p(e))return!1;var t,i,s=e,c=null;if(Array.isArray(e)){var h=(i=2,function(e){if(Array.isArray(e))return e}(t=e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var i=[],s=!0,n=!1,r=void 0;try{for(var a,l=e[Symbol.iterator]();!(s=(a=l.next()).done)&&(i.push(a.value),!t||i.length!==t);s=!0);}catch(e){n=!0,r=e}finally{try{s||null==l.return||l.return()}finally{if(n)throw r}}return i}}(t,i)||r(t,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}());s=h[0],c=h[1]}s=s.toLowerCase();var u="HTML".concat(j(_,s)?_[s]:R(s),"Element");return!(!n(window[u])&&!a(s))&&(!(m(c)&&!o(c))||l(c))}))));var i,s,n,a,l},_={a:"Anchor",br:"BR",dl:"DList",datalist:"DataList",fieldset:"FieldSet",frameset:"FrameSet",hr:"HR",h1:"Heading",h2:"Heading",h3:"Heading",h4:"Heading",h5:"Heading",h6:"Heading",li:"LI",ol:"OList",optgroup:"OptGroup",p:"Paragraph",q:"Quote",blockquote:"Quote",caption:"TableCaption",td:"TableCell",th:"TableCell",col:"TableCol",tr:"TableRow",tbody:"TableSection",thead:"TableSection",tfoot:"TableSection",textarea:"TextArea",ul:"UList"},T=function(e){return function(e){return!b(e)&&e.nodeType===Node.DOCUMENT_FRAGMENT_NODE}(e)&&e instanceof DocumentFragment};function H(e,t){if(!h(t))return null;var i=document.createElement("template");return i.innerHTML=t.trim(),i.content[e]}var k=H.bind(null,"firstChild");function M(e,t,i){e[t]=i}function $(e,t,i){e.setAttribute(t,i)}H.bind(null,"childNodes");var P="accesskey,autocapitalize,class,dataset,editable,draggable,hidden,id,inputmode,lang,html,style,tabindex,text,title",N={accesskey:[M,"accessKey"],autocapitalize:[M,"autocapitalize"],class:[function(e,t){var i;if(!S(e))throw new Error("Bad argument: The passed `element` argument is not a valid HTML Element");return(i=e.classList).add.apply(i,n(Array.isArray(t)?t:[t])),e}],dataset:[function(e,t,i){Object.assign(e[t],i)},"dataset"],draggable:[M,"draggable"],editable:[M,"contentEditable"],hidden:[M,"hidden"],id:[M,"id"],inputmode:[M,"inputMode"],lang:[M,"lang"],html:[M,"innerHTML"],style:[M,"style"],tabindex:[M,"tabIndex"],text:[M,"textContent"],title:[M,"title"],data:[M,"data"],cite:[M,"cite"],download:[M,"download"],ping:[M,"ping"],target:[M,"target"],coords:[M,"coords"],shape:[M,"shape"],autoplay:[M,"autoplay"],buffered:[M,"buffered"],controls:[M,"controls"],loop:[M,"loop"],muted:[M,"muted"],playsinline:[$,"playsinline"],poster:[M,"poster"],preload:[M,"preload"],crossorigin:[M,"crossOrigin"],decoding:[M,"decoding"],height:[M,"height"],ismap:[M,"isMap"],loading:[M,"loading"],srcset:[M,"srcset"],width:[M,"width"],alt:[M,"alt"],as:[M,"as"],media:[M,"media"],rel:[M,"rel"],src:[M,"src"],sizes:[M,"sizes"],reversed:[M,"reversed"],start:[M,"start"],accept:[M,"accept"],"accept-charset":[M,"acceptCharset"],action:[M,"action"],autocomplete:[M,"autocomplete"],autofocus:[M,"autofocus"],capture:[M,"capture"],checked:[M,"checked"],cols:[M,"cols"],disabled:[M,"disabled"],dirname:[M,"dirName"],enctype:[M,"enctype"],for:[M,"for"],form:[M,"form"],formaction:[M,"formAction"],formenctype:[M,"formEnctype"],formmethod:[M,"formMethod"],formnovalidate:[M,"formNoValidate"],formtarget:[M,"formTarget"],high:[M,"high"],label:[M,"label"],list:[M,"list"],low:[M,"low"],max:[M,"max"],maxlength:[M,"maxLength"],method:[M,"method"],min:[M,"min"],minlength:[M,"minLength"],multiple:[M,"multiple"],name:[M,"name"],novalidate:[M,"noValidate"],optimum:[M,"optimum"],pattern:[M,"pattern"],placeholder:[M,"placeholder"],readonly:[M,"readOnly"],required:[M,"required"],rows:[M,"rows"],selected:[M,"selected"],size:[M,"size"],spellcheck:[$,"spellcheck"],step:[M,"step"],wrap:[M,"wrap"],default:[M,"default"],kind:[M,"kind"],srclang:[M,"srclang"],abbr:[M,"abbr"],colspan:[M,"colSpan"],span:[M,"span"],rowspan:[M,"rowSpan"],scope:[M,"scope"],href:[M,"href"],hreflang:[M,"hreflang"],datetime:[M,"dateTime"],type:[M,"type"],value:[M,"value"],usemap:[M,"useMap"]};function D(e,t,i){var s=document.createElement(e);return S(s)?(d(i)&&function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(!S(e))throw new Error("Bad argument: The given element argument is not a valid HTML Element");if(!d(t))return e;for(var s=function(e){return P.includes(e)||i.includes(e)},r=0,a=Object.keys(t);r<a.length;r++){var l=a[r];if(s(l)){var o=t[l],c=N[l].slice(0);c.shift().apply(void 0,[e].concat(n(c),[o]))}}}(s,i,l(t,"")),s):null}function B(e,t,i,s){var n=D(e,t,i);return S(n)?(b(s)||je(n,s),n):null}function X(e,t,i,s,n){var r=D(e,t,s);return S(r)?(b(n)||je(r,n,i),r):null}function Z(e){var t=document.createDocumentFragment();return b(e)||je(t,e),t}D.bind(null,"link","as,crossorigin,disabled,href,hreflang,media,rel,sizes,type"),B.bind(null,"template","");var F=B.bind(null,"header",""),z=(B.bind(null,"footer",""),B.bind(null,"main",""),B.bind(null,"article",""),B.bind(null,"section","")),W=(B.bind(null,"nav",""),B.bind(null,"aside","")),q=(B.bind(null,"h1",""),B.bind(null,"h2","")),U=B.bind(null,"h3",""),G=B.bind(null,"h4",""),K=(B.bind(null,"h5",""),B.bind(null,"h6",""),B.bind(null,"div","")),Q=(B.bind(null,"object","data,height,name,type,usemap,width"),D.bind(null,"embed","height,src,type,width"),D.bind(null,"br",""),D.bind(null,"hr",""),B.bind(null,"p","")),J=(B.bind(null,"blockquote","cite"),function(e){return S(e,"li")?e:ee(null,e)}),Y=X.bind(null,"ul","",J),ee=(X.bind(null,"ol","reversed,start,type",J),B.bind(null,"li","value")),te=(B.bind(null,"dl",""),B.bind(null,"dt",""),B.bind(null,"dd",""),B.bind(null,"a","download,href,hreflang,ping,rel,target,type")),ie=(D.bind(null,"area","alt,coords,download,href,hreflang,media,ping,rel,shape,target"),D.bind(null,"base","href,target"),D.bind(null,"img","alt,crossorigin,decoding,height,ismap,loading,sizes,src,srcset,usemap,width")),se=B.bind(null,"audio","autoplay,controls,crossorigin,loop,muted,preload,src"),ne=(B.bind(null,"video","autoplay,controls,crossorigin,height,loop,muted,playsinline,poster,preload,src,width"),D.bind(null,"source","media,sizes,src,srcset,type"),D.bind(null,"track","default,kind,label,src,srclang"),B.bind(null,"picture",""),B.bind(null,"figure",""),B.bind(null,"figcaption",""),B.bind(null,"span","")),re=B.bind(null,"strong",""),ae=B.bind(null,"em",""),le=(B.bind(null,"mark",""),B.bind(null,"samp",""),B.bind(null,"sub",""),B.bind(null,"sup",""),B.bind(null,"del","cite,datetime"),B.bind(null,"ins","cite,datetime"),B.bind(null,"q","cite"),B.bind(null,"abbr",""),B.bind(null,"b",""),B.bind(null,"i","")),oe=(B.bind(null,"s",""),B.bind(null,"u",""),B.bind(null,"cite",""),B.bind(null,"time","datetime"),B.bind(null,"code",""),B.bind(null,"form","accept-charset,action,autocomplete,enctype,method,name,novalidate,rel,target"),D.bind(null,"input","accept,alt,autocomplete,autofocus,capture,checked,dirname,disabled,height,max,maxlength,minlength,min,multiple,name,pattern,placeholder,readonly,required,size,src,step,type,value,width")),ce=B.bind(null,"textarea","autocomplete,autofocus,cols,disabled,maxlength,minlength,name,placeholder,readonly,required,rows,spellcheck,value,wrap"),he=B.bind(null,"label","for"),ue=(X.bind(null,"select","autocomplete,autofocus,disabled,multiple,name,required,size",(function(e){return S(e,["option","optgroup"])?e:Array.isArray(e)?pe(null,e):ue(null,e)})),B.bind(null,"option","disabled,label,selected,value")),de=function(e){return S(e,"option")?e:ue(null,e)},pe=X.bind(null,"optgroup","disabled,label",de),me=(B.bind(null,"fieldset","disabled,name"),B.bind(null,"legend",""),X.bind(null,"datalist","",de),B.bind(null,"meter","high,low,max,min,optimum,value"),B.bind(null,"progress","max,value"),B.bind(null,"output","name,value"),B.bind(null,"button","autofocus,disabled,formaction,formenctype,formmethod,formnovalidate,formtarget,name,type,value")),fe=B.bind(null,"table",""),ge=(B.bind(null,"caption",""),function(e){return S(e,"tr")?e:we(null,e)}),ve=X.bind(null,"thead","",ge),be=X.bind(null,"tbody","",ge),ye=X.bind(null,"tfoot","",ge),we=(D.bind(null,"col","span"),X.bind(null,"colgroup","span",(function(e){return S(e,"col")?e:null})),X.bind(null,"tr","",(function(e){return S(e,["th","td"])?e:Ce(null,e)}))),Ee=B.bind(null,"th","abbr,colspan,rowspan,scope"),Ce=B.bind(null,"td","colspan,rowspan");function je(e,t,i){var s=Array.isArray(t)?t:[t];return u(i)&&(s=s.map((function(e){return i(e)}))),function(e,t){if(!O(e))throw new TypeError("Bad argument: The given `parent` is not a valid Node");if(!(t instanceof HTMLCollection||m(t)))throw new TypeError("Bad argument: The given `children` is not a valid HTMLCollection/HTMLElement array");var i=T(e)?e:document.createDocumentFragment();Array.from(t).forEach((function(e){var t;b(e)||i.appendChild(O(e)?e:(t=e.toString(),document.createTextNode(t.toString())))})),e!==i&&e.appendChild(i)}(e,s),e}var Le=function(e){return/^\.[a-zA-Z0-9_-]+$/.test(e)};function xe(e,t){var i=l(t,document);return g(e)?null:T(i)?i.querySelector(e):function(e){return/^#[a-zA-Z0-9_-]+$/.test(e)}(e)?document.getElementById(e.substring(1)):Le(e)?i.getElementsByClassName(e.substring(1))[0]:i.querySelector(e)}function Re(e,t){var i=l(t,document);return g(e)?null:T(i)?i.querySelectorAll(e):Le(e)?i.getElementsByClassName(e.substring(1)):i.querySelectorAll(e)}function Ie(e,t){return"content"in document.createElement("template")?xe(e,t):null}function Ae(e,t){return e?document.importNode(e.content,l(t,!0)):e}function Oe(e,t,i){if(!S(t))return null;var s=t[e];if(u(i))for(;V(s)&&!i(s);)s=s[e];return s}function Ve(e,t,i){if(!V(e))throw new TypeError("Bad argument: The given target parameter is not a valid HTML Element");if(!u(t))throw new TypeError("Bad argument: The given pred parameter is not a valid Function");var s=e.parentElement;return i>0?_e(s,t,i-1):Se(s,t)}function Se(e,t){return b(e)?null:t(e)?e:Se(e.parentElement,t)}function _e(e,t,i){return b(e)||0===i?null:t(e)?e:_e(e.parentElement,t,i-1)}function Te(e,t){if(!O(e))throw new TypeError("Bad argument: The given `node` is not a valid Node");return u(t)?(Array.from(e.childNodes).forEach((function(i){t(i)&&e.removeChild(i)})),e):function(e){for(;e.hasChildNodes();)e.removeChild(e.lastChild);return e}(e)}function He(e){if(b(e))return!1;var t=ce({value:S(e)?e.textContent:e.toString(),readonly:!0});return!!S(t)&&(document.body.appendChild(t),t.select(),document.execCommand("copy"),t.remove(),!0)}Oe.bind(null,"previousElementSibling"),Oe.bind(null,"nextElementSibling");var ke=function(e){return e.dataset.state},Me=function(e,t){return e.dataset.state=t},$e=function(e,t){return Me(e,l(t,"checked"))},Pe=function(e,t){return Me(e,l(t,"unchecked"))},Ne={name:"form-selector",container:null,items:null,selectedIndex:null,selectedItem:null,beforeChange:null,afterChange:null,get value(){return this.selectedItem.value},setSelectedItem:function(e){return this.items.includes(e)?(this.selectedItem&&this.selectedItem.setChecked(!1),this.selectedItem=e,this.selectedItem.setChecked(!0),!0):null},init:function(){for(var e=this.container.dataset.value,t=null,i=0;i<this.items.length;i++){var s=this.items[i];s.isChecked()&&this.setSelectedItem(s),s.value===e&&(t=s)}return f(this.selectedItem)&&!f(t)&&this.setSelectedItem(t),this.bindEvents(),this},bindEvents:function(){var e=this;this.container.addEventListener("change",(function(t){var i=t.target,s=!1;if(u(e.beforeChange)&&(s=!1===e.beforeChange(e,t)),s)return i.checked=!1,void e.items[e.selectedIndex].setChecked(!0);var n=e.items.find((function(e){return e.index===+l(i.dataset.selectorIndex,-1)}));b(n)||(e.setSelectedItem(n),u(e.afterChange)&&e.afterChange(e,t))}))}},De=function(e){return'[data-type="'.concat(e.name,'"]')},Be={BaseSelector:De({name:"selector",container:null,items:null,selectedIndex:null,selectedItem:null,beforeChange:null,afterChange:null,get value(){return this.selectedItem.value},setSelectedItem:function(e){return this.items.includes(e)?(this.selectedItem&&this.selectedItem.setChecked(!1),this.selectedItem=e,this.selectedItem.setChecked(!0),!0):null},init:function(){for(var e=this.container.dataset.value,t=null,i=0;i<this.items.length;i++){var s=this.items[i];s.isChecked()&&this.setSelectedItem(s),s.value===e&&(t=s)}return f(this.selectedItem)&&!f(t)&&this.setSelectedItem(t),this.bindEvents(),this},bindEvents:function(){var e=this;this.container.addEventListener("click",(function(t){var i=t.target;if(j(i.dataset,"selector")){var s=!1;if(u(e.beforeChange)&&(s=!1===e.beforeChange(e,t)),!s){var n=e.items.find((function(e){return e.index===+l(i.dataset.selectorIndex,-1)}));b(n)||(e.setSelectedItem(n),u(e.afterChange)&&e.afterChange(e,t))}}}))}}),FormSelector:De(Ne)};new Error("Missing container: A selector requires a container"),new Error("Missing input: FormSelector requires an input in the container"),[Be.BaseSelector,Be.FormSelector].join(","),new Error("Missing container: A switch requires a container"),new Error("Missing input: FormSwitch requires an input in the container");var Xe="on",Ze=function(e){return'[data-type="'.concat(e.name,'"]')},Fe={name:"form-switch",container:null,input:null,beforeChange:null,afterChange:null,get value(){return this.input.value},isChecked:function(){return ke(this.container)===Xe},setChecked:function(e){return!b(e)&&(this.input.checked=e,e?$e(this.container,Xe):Pe(this.container,"off"),!0)},toggle:function(){this.isChecked()?this.setChecked(!1):this.setChecked(!0)},init:function(e){return Object.assign(this,e),this.input.checked&&this.setChecked(!0),this.bindEvents(),this},bindEvents:function(){var e=this;this.input.addEventListener("change",(function(t){var i=!1;u(e.beforeChange)&&(i=!1===e.beforeChange(e,t)),i?e.input.checked=!e.input.checked:(e.toggle(),u(e.afterChange)&&e.afterChange(e,t))}))}};[Ze({name:"switch",container:null,beforeChange:null,afterChange:null,get value(){return this.container.dataset.value},isChecked:function(){return ke(this.container)===Xe},setChecked:function(e){return!b(e)&&(e?$e(this.container,Xe):Pe(this.container,"off"),!0)},toggle:function(){this.isChecked()?this.setChecked(!1):this.setChecked(!0)},init:function(e){return Object.assign(this,e),this.isChecked()&&$e(this.container,Xe),this.bindEvents(),this},bindEvents:function(){var e=this;this.container.addEventListener("click",(function(t){var i=!1;u(e.beforeChange)&&(i=!1===e.beforeChange(e,t)),i||(e.toggle(),u(e.afterChange)&&e.afterChange(e,t))}))}}),Ze(Fe)].join(","),new Error("Missing container: A collapsible requires a container"),new Error("Missing container: An accordion requires a container"),encodeURIComponent},943:(e,t,i)=>{function s(e){let t=0;if(R(e))return e.selectionStart;if(0!==window.getSelection().rangeCount){const i=window.getSelection().getRangeAt(0),s=i.cloneRange();s.selectNodeContents(e),s.setEnd(i.endContainer,i.endOffset),t=s.toString().length}return t}i.d(t,{D3:()=>j,sr:()=>w,hi:()=>C,k$:()=>E,wo:()=>b,p$:()=>B,jn:()=>y,GV:()=>P,qO:()=>s,As:()=>H,NI:()=>L,EE:()=>M,GF:()=>$,Sd:()=>k,sB:()=>T,Cp:()=>u,CH:()=>m,xj:()=>x,u7:()=>R,QE:()=>I,n2:()=>D,a2:()=>A,fP:()=>N,Ys:()=>g,lL:()=>p,$Z:()=>h,ZN:()=>d,HW:()=>f,hF:()=>v});var n=i(835);const r="hidden",a="collapsed",l="highlighted",o="shake",c="selected";function h(e){return(0,n.Re)(e)?(e.classList.remove(r),e):e}function u(e){return(0,n.Re)(e)?(e.classList.add(r),e):e}function d(e){return(0,n.Re)(e)?(e.classList.toggle(r),e):e}function p(e){e.classList.contains(o)||(e.classList.add(o),setTimeout((()=>{e.classList.remove(o)}),1e3))}function m(e){return(0,n.Re)(e)?(e.classList.add(l),e):e}function f(e){return(0,n.Re)(e)?(e.classList.remove(l),e):e}function g(e){return(0,n.Re)(e)?(e.classList.add(c),e):e}function v(e){return(0,n.Re)(e)?(e.classList.remove(c),e):e}function b(e){return(0,n.Re)(e)&&e.classList.add(a),e}function y(e){return(0,n.Re)(e)&&e.classList.remove(a),e}const w={backspace:"Backspace",tab:"Tab",enter:"Enter",ctrl:"Control",shift:"Shift",alt:"Alt",escape:"Escape",spacebar:" ",page_up:"PageUp",page_down:"PageDown",insert:"Insert",end:"End",home:"Home",left_arrow:"ArrowLeft",up_arrow:"ArrowUp",right_arrow:"ArrowRight",down_arrow:"ArrowDown",delete:"Delete",period:"."},E={NORMAL:"normal",WARNING:"warning",SUCCESS:"success",ERROR:"error"},C={NORMAL:"normal",WARNING:"warning",SUCCESS:"success",ERROR:"error"},j={"audio/aac":"aac","application/octet-stream":"bin","image/jpeg":"jpeg","application/json":"json","audio/mpeg":"mp3","application/pdf":"pdf","image/svg+xml":"svg","text/plain":"txt","text/xml":"xml","application/zip":"zip"};function L(e){const t=e=>!(0,n.RI)(e.dataset,"ignore");return t(e)?e:(0,n.wr)(e,t,10)}function x(e){if(!n.Re)throw new TypeError("Bad parameter");return e.hidden||"none"===window.getComputedStyle(e).display}const R=e=>(0,n.Re)(e,["input","textarea"]),I=e=>R(e)||"true"===e.contentEditable,A=e=>+e.substring(0,e.indexOf("px")),O={top:e=>e.marginTop,right:e=>e.marginRight,bottom:e=>e.marginBottom,left:e=>e.marginLeft},V={top:e=>e.paddingTop,right:e=>e.paddingRight,bottom:e=>e.paddingBottom,left:e=>e.paddingLeft},S={top:e=>e.borderTopWidth,right:e=>e.borderRightWidth,bottom:e=>e.borderBottomWidth,left:e=>e.borderLeftWidth};function _(e,t,i){const s=window.getComputedStyle(e),n=window.getComputedStyle(t),r=O[i](s),a=V[i](n),l=S[i](n);return o=e.getBoundingClientRect()[i]+A(r),c=t.getBoundingClientRect()[i]-A(a)-A(l),Math.abs(o-c)<2;var o,c}function T(e){for(let t=0;t<e.children.length;t++){const i=e.children[t];if(!x(i))return i}return null}function H(e,t,i,s){return"up"===t?function(e,t,i=!0){const s=t.children,{top:n,left:r}=e.getBoundingClientRect();if(i&&_(e,t,"top"))return null;let a=null,l=99999,o=99999;for(let t=0;t<s.length;t++){const i=s[t];if(x(i)||i.classList.contains("badge")||i===e)continue;const{bottom:c,left:h}=i.getBoundingClientRect();let u=Math.abs(n-c),d=Math.abs(r-h);n>=c-1&&(u<l||u===l&&d<o)&&(a=i,l=u,o=d)}return a}(e,i,s):"down"===t?function(e,t,i=!0){const s=t.children,{bottom:n,left:r}=e.getBoundingClientRect();if(i&&_(e,t,"bottom"))return null;let a=null,l=99999,o=99999;for(let t=0;t<s.length;t++){const i=s[t];if(x(i)||i.classList.contains("badge")||i===e)continue;const{top:c,left:h}=i.getBoundingClientRect();let u=Math.abs(n-c),d=Math.abs(r-h);n<=c+1&&(u<l||u===l&&d<o)&&(a=i,l=u,o=d)}return a}(e,i,s):"left"===t?function(e,t,i=!0){const s=t.children,{top:n,left:r}=e.getBoundingClientRect();if(i&&_(e,t,"left"))return null;let a=null,l=99999,o=99999;for(let t=0;t<s.length;t++){const i=s[t];if(x(i)||i.classList.contains("badge")||i===e)continue;const{top:c,right:h}=i.getBoundingClientRect();let u=Math.abs(n-c),d=Math.abs(r-h);r>=h-1&&(d<o||d===o&&u<l)&&(a=i,l=u,o=d)}return a}(e,i,s):"right"===t?function(e,t,i=!0){const s=t.children,{top:n,right:r}=e.getBoundingClientRect();if(i&&_(e,t,"right"))return null;let a=null,l=99999,o=99999;for(let t=0;t<s.length;t++){const i=s[t];if(x(i)||i.classList.contains("badge")||i===e)continue;const{top:c,left:h}=i.getBoundingClientRect();let u=Math.abs(n-c),d=Math.abs(r-h);r<=h+1&&(d<o||d===o&&u<l)&&(a=i,l=u,o=d)}return a}(e,i,s):(console.error("unknown direction",t),null)}function k(e,t){const i=e.children,{top:s,left:r}=e.getBoundingClientRect();if(0===i.length)return null;const a=(0,n.mf)(t);let l=null,o=99999,c=99999;for(let e=0;e<i.length;e++){const n=i[e];if(a&&!t(n))continue;if(x(n)||n.classList.contains("badge"))continue;const{top:h,left:u}=n.getBoundingClientRect();let d=Math.abs(s-h),p=Math.abs(r-u);s<=h+1&&(d<o||d===o&&p<c)&&(l=n,o=d,c=p)}return l}function M(e,t){const i=e.children,{top:s,left:r}=e.getBoundingClientRect();if(0===i.length)return null;const a=(0,n.mf)(t);let l=null,o=99999,c=99999;for(let e=0;e<i.length;e++){const n=i[e];if(a&&!t(n))continue;if(x(n)||n.classList.contains("badge"))continue;const{top:h,left:u}=n.getBoundingClientRect();let d=Math.abs(s-h),p=Math.abs(r-u);r<=u+1&&(p<c||p===c&&d<o)&&(l=n,o=d,c=p)}return l}function $(e,t){const i=e.children,{top:s,right:r}=e.getBoundingClientRect();if(0===i.length)return null;const a=(0,n.mf)(t);let l=null,o=99999,c=99999;for(let e=0;e<i.length;e++){const n=i[e];if(a&&!t(n))continue;if(x(n)||n.classList.contains("badge"))continue;const{top:h,right:u}=n.getBoundingClientRect();let d=Math.abs(s-h),p=Math.abs(r-u);r>=u-1&&(p<c||p===c&&d<o)&&(l=n,o=d,c=p)}return l}function P(e,t){const i=e.children,{bottom:s,left:r}=e.getBoundingClientRect();if(0===i.length)return null;const a=(0,n.mf)(t);let l=null,o=99999,c=99999;for(let e=0;e<i.length;e++){const n=i[e];if(a&&!t(n))continue;if(x(n)||n.classList.contains("badge"))continue;const{bottom:h,left:u}=n.getBoundingClientRect();let d=Math.abs(s-h),p=Math.abs(r-u);s>=h-1&&(d<o||d===o&&p<c)&&(l=n,o=d,c=p)}return l}function N(e){return(0,n.Re)(e)?e:(0,n.HD)(e)&&!(0,n.hr)(e)?(0,n.sb)(e):null}function D(e,t={}){const i=N(e);if(!(0,n.Re)(i))return null;const s=Object.assign({horizontal:!0,vertical:!0,minWidth:60,minHeight:60},t),r=function(){let e=(0,n.wC)({class:["resizers"]});return["horizontal","vertical"].forEach((t=>{e.append((0,n.wC)({class:["resizer",`${t}`],dataset:{dir:t}}))})),e}();i.prepend(r),s.horizontal&&s.vertical?i.dataset.resizable="both":s.horizontal?i.dataset.resizable="horizontal":s.vertical&&(i.dataset.resizable="vertical");const{minWidth:a,minHeight:l}=getComputedStyle(i),o=(0,n.XI)(A(a),s.minWidth),c=(0,n.XI)(A(l),s.minHeight);let h=0,u=null;function d(e){const{dir:t}=u.dataset,{width:s,height:n}=getComputedStyle(i);let r="horizontal"===t?e.pageX:e.pageY;if("horizontal"===t){const e=A(s)+(r-h);e>o&&(i.style.width=`${e}px`)}else if("vertical"===t){const e=A(n)+(r-h);e>c&&(i.style.height=`${e}px`)}h=r}for(let e=0;e<r.childElementCount;e++){const t=r.children[e];t.addEventListener("mousedown",(function(e){e.preventDefault(),u=t;const{dir:i}=u.dataset;h="horizontal"===i?e.pageX:e.pageY,document.body.addEventListener("mousemove",d),document.body.addEventListener("mouseup",(()=>{document.body.removeEventListener("mousemove",d)}))}))}return i}const B=e=>JSON.parse(JSON.stringify(e));i(914)},914:(e,t,i)=>{i.d(t,{h:()=>s});const s=function(){var e={},t=[];for(let e=0;e<256;e++)t[e]=e<16?"0"+e.toString(16):e.toString(16);return e.generate=function(){var e=4294967296*Math.random()>>>0,i=4294967296*Math.random()>>>0,s=4294967296*Math.random()>>>0,n=4294967296*Math.random()>>>0;return t[255&e]+t[e>>8&255]+t[e>>16&255]+t[e>>24&255]+"-"+t[255&i]+t[i>>8&255]+"-"+t[i>>16&15|64]+t[i>>24&255]+"-"+t[63&s|128]+t[s>>8&255]+"-"+t[s>>16&255]+t[s>>24&255]+t[255&n]+t[n>>8&255]+t[n>>16&255]+t[n>>24&255]},e}()}},t={};function i(s){if(t[s])return t[s].exports;var n=t[s]={exports:{}};return e[s](n,n.exports,i),n.exports}i.d=(e,t)=>{for(var s in t)i.o(t,s)&&!i.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var s={};return(()=>{i.r(s),i.d(s,{activateEditor:()=>ts,createEditor:()=>is});var e=i(835),t=i(943);const n={menu:null,schema:null,isOpen:!1,visible:!0,btnStart:null,fileIO:null,config:null,settings:null,init(e){return e&&(this.schema=e),this},get isRendered(){return(0,e.Re)(this.container)},clear(){return(0,e.ep)(this.container),this},update(){},render(){const t=(0,e.DZ)();if(!(0,e.Re)(this.container)){this.container=(0,e.wC)({class:["editor-home"]});let t=(0,e.rX)({class:["editor-title"]},"Settings");this.container.append(t)}return(0,e.Re)(this.menu)||(this.menu=r.call(this),t.append(this.menu)),(0,e.Re)(this.btnStart)||(this.btnStart=(0,e.ax)({class:["btn","editor-home-section--model__button","editor-home-section__button--start"],dataset:{action:"close",context:"home"}},"Done"),t.append(this.btnStart)),t.hasChildNodes()&&(this.container.append(t),this.bindEvents()),this.refresh(),this.container},refresh(){const{hasConceptModel:e,hasProjectionModel:t}=this.editor;return this.btnStart.disabled=!(e&&t),this},actionHandler(e,t){const{concept:i}=t.dataset;"open-concept"===e&&(this.config.selectItem(i),this.config.showInfo(i))},bindEvents(){this.editor.registerHandler("editor.load-concept@post",(e=>{this.editor.hasConceptModel&&this.fileIO.addFile("concept",e[0],e[1])})),this.editor.registerHandler("editor.load-projection@post",(e=>{this.editor.hasConceptModel&&this.fileIO.addFile("projection",e[0],e[1])})),this.editor.registerHandler("editor.unload-concept@post",(e=>{this.fileIO.removeFile("concept"),this.config.clear()})),this.editor.registerHandler("editor.unload-projection@post",(e=>{this.fileIO.removeFile("projection")})),this.editor.registerHandler("concept-model.updated",(()=>{this.config.clear(),this.editor.hasConceptModel&&this.editor.conceptModel.schema.filter((e=>e.root)).forEach((e=>{this.config.addItem(e)}))}))}};function r(){const t=(0,e.vB)({class:["editor-home-menu"]});let i=(0,e.wC)({class:["editor-home-menu-section","editor-home-menu-section--file"]}),s=(0,e.wC)({class:["editor-home-menu-section","editor-home-menu-section--config"]});return this.fileIO=l.call(this),this.config=h.call(this),i.append(this.fileIO.render(),a("Files")),s.append(this.config.render(),a("Configuration")),t.append(i,s),t}function a(t){return(0,e._N)({class:["title","editor-home-menu-title"]},t)}function l(e){const t=Object.create(o,{editor:{value:this.editor}});return t.init(),t}const o={file:null,title:null,status:null,container:null,mainView:null,infoView:null,files:null,btnLoad:null,btnUnload:null,btnDownload:null,btnEdit:null,selection:null,cache:null,init(){return this.cache=new Map,this},get hasFile(){return this.cache.size>0},get hasSelection(){return!(0,e.le)(this.selection)},getFile(){return this.file},setFile(e){this.file=e,this.refresh()},refresh(){return this.hasFile?(this.container.classList.remove("empty"),(0,t.$Z)(this.files)):(this.container.classList.add("empty"),(0,t.Cp)(this.files)),this.btnUnload.disabled=!this.hasFile,this.editor.isReady?((0,t.Cp)(this.placeholder),this.placeholder.classList.remove("error")):this.hasFile?(this.editor.hasConceptModel||(this.placeholder.innerHTML=`${c("Missing projections")}`),this.editor.hasProjectionModel||(this.placeholder.innerHTML=`${c("Missing projections")}`),this.placeholder.classList.add("error"),(0,t.$Z)(this.placeholder)):(this.placeholder.innerHTML=`Add your ${c("concepts")} and ${c("projections")} or load a previously saved ${c("model")}`,this.placeholder.classList.remove("error")),this.hasSelection||(0,t.Cp)(this.infoView),this},render(){this.container=(0,e.wC)({class:["editor-file"]});let t=(0,e.wC)({class:["drop-area","editor-file-main"]});this.files=(0,e.w_)({class:["bare-list","editor-file__list"]}),this.placeholder=(0,e.qm)({class:["editor-file-placeholder"],html:`Add your ${c("concepts")}, ${c("projections")} and all other ${c("resources")}`});let i=(0,e.wC)({class:["editor-file-actionbar"]});this.btnUnload=(0,e.ax)({class:["btn","editor-file-actionbar__button","editor-file-actionbar__btn-remove"],title:"Remove all files",dataset:{action:"unload"}}),i.append(this.btnUnload);let s=(0,e.wC)({class:["editor-file__browse"]}),n=(0,e.kQ)({class:["editor-file__browse-instruction"]},"Upload your files");return this.btnLoad=(0,e.ax)({class:["btn","editor-file__browse-button"],title:"Load file in editor",dataset:{action:"load"}},"Browse"),s.append(n,this.btnLoad),t.append(this.files,this.placeholder,s),this.container.append(i,t),this.bindEvents(),this.refresh(),this.container},clear(){(0,e.ep)(this.files)},selectItem(t){if(!this.cache.has(t))return null;let i=this.cache.get(t);(0,e.Re)(this.selection)&&this.selection.classList.remove("selected"),this.selection=i,this.selection.classList.add("selected"),this.displayInfo(t),this.refresh()},addFile(t,i,s){let n=(0,e.HV)({class:["editor-file__list-item",`editor-file__list-item--${t}`],dataset:{context:"menu",action:`open-${t}`,status:"active"}}),r=(0,e.oL)({class:["ico","ico-file","editor-file__list-item-icon"]}),a=(0,e.kQ)({class:["editor-file__list-item-type"]},(0,e.XI)(i,t)),l=(0,e.ax)({class:["editor-file__list-item__btn-remove"],dataset:{action:`unload-${t}`}},(0,e.oL)({class:["ico","ico-delete"],dataset:{ignore:"all"}},"✖"));n.append(r,a,l),this.files.append(n),this.cache.set(t,n),this.refresh()},removeFile(t,i){if(!this.cache.has(t))return;let s=this.cache.get(t);(0,e.ep)(s).remove(),this.cache.delete(t),this.refresh()},bindEvents(){this.editor.registerHandler("editor.load@post",(e=>{this.editor.hasConceptModel&&this.editor.hasProjectionModel})),this.container.addEventListener("dragenter",(e=>{this.container.classList.add("highlight"),e.preventDefault(),e.stopPropagation()}),!1),this.container.addEventListener("dragleave",(e=>{this.container.classList.remove("highlight"),e.preventDefault(),e.stopPropagation()}),!1),this.container.addEventListener("dragover",(e=>{this.container.classList.add("highlight"),e.preventDefault(),e.stopPropagation()}),!1),this.container.addEventListener("drop",(e=>{this.container.classList.remove("highlight");let t=e.dataTransfer.files[0];if(!t.name.endsWith(".json"))return void this.notify("This file is not supported. Please use a .json file");let i=new FileReader;i.onload=e=>{this.editor.load(i.result,this.type)},i.readAsText(t),e.preventDefault(),e.stopPropagation()}),!1)}};function c(t){return(0,e.u4)({class:["text-bf"]},t).outerHTML}function h(){const e=Object.create(u,{editor:{value:this.editor}});return e.init(),e}const u={file:null,title:null,status:null,container:null,mainView:null,infoView:null,conceptList:null,selection:null,placeholder:null,cache:null,init(){return this.cache=new Map,this},get hasFile(){return this.cache.size>0},get hasSelection(){return!(0,e.le)(this.selection)},refresh(){return this.hasFile?(this.container.classList.remove("empty"),(0,t.Cp)(this.placeholder),(0,t.$Z)(this.conceptList)):(this.container.classList.add("empty"),(0,t.$Z)(this.placeholder),(0,t.Cp)(this.conceptList)),this.hasSelection||(0,t.Cp)(this.infoView),this},render(){return this.container=(0,e.wC)({class:["editor-config"]}),this.mainView=(0,e.wC)({class:["editor-config-main"]}),this.infoView=(0,e.wC)({class:["editor-config-info"]}),this.conceptList=(0,e.w_)({class:["bare-list","editor-config__list"]}),this.placeholder=(0,e.qm)({class:["editor-config-placeholder"],html:`${c("No concept found")}. Please upload your files.`}),this.mainView.append(this.conceptList,this.placeholder),this.container.append(this.mainView,this.infoView),this.bindEvents(),this.refresh(),this.container},clear(){(0,e.ep)(this.conceptList),(0,e.ep)(this.infoView),this.cache.clear(),this.refresh()},selectItem(t){if(!this.cache.has(t))return null;let i=this.cache.get(t);return(0,e.Re)(this.selection)&&this.selection.classList.remove("selected"),this.selection=i,this.selection.classList.add("selected"),this.refresh(),t},showInfo(i){let s=d(this.editor.conceptModel.getCompleteModelConcept(i),(0,e.t4)("#concept-schema"));(0,e.ep)(this.infoView).append(s),(0,t.$Z)(this.infoView)},addItem(t){let i=(0,e.kQ)({class:["loaded-element-name","fit-content"]},t.name),s=(0,e.HV)({class:["loaded-element",`loaded-element--${this.type}`],dataset:{context:"menu",action:"open-concept",concept:t.name,status:"active"}}),n=(0,e.ax)({class:["btn","file-section__actionbar-button","file-section__actionbar-button--edit"],title:`Reload the ${this.type}`,dataset:{context:"menu",action:"open-concept",concept:t.name}});s.append(i,n),this.conceptList.append(s),this.cache.set(t.name,s),this.refresh()},bindEvents(){}};function d(t,i){if((0,e.le)(t))throw new TypeError("Bad argument: The 'schema' is missing");if(!(0,e.Re)(i))throw new TypeError("Bad argument: The given 'template' is not a valid HTML Element");const s=(0,e.jC)(i);return(0,e.$3)("[data-if]",s).forEach(((i,s)=>{let n=i.dataset.if;(0,e.RI)(t,n)||i.remove()})),(0,e.$3)("[data-name]",s).forEach(((e,i)=>{let s=e.dataset.name;e.textContent=t[s]})),(0,e.$3)("[data-attr]",s).forEach(((e,i)=>{let s=e.dataset.attr,[n,r]=s.split(":"),a=(e=>e.startsWith("$")?t[e.substring(1)]:e)(r);delete e.dataset.attr,e.dataset[n]=a})),(0,e.$3)("[data-bind]",s).forEach(((i,s)=>{let n=i.dataset.bind;if(!(0,e.RI)(t,n))return;let r=(0,e.sb)("[data-item]",i),a=r.dataset.item,l=(0,e.t4)(`#${a}`);t[n].forEach((e=>{r.append(d(e,l))}))})),s}function p(t,i){const{name:s,object:n,id:r}=i,a=(0,e.HV)({class:["selector-concept",`selector-concept--${t}`],title:i.getName(),dataset:{concept:r,object:n}});var l=(0,e.kQ)({class:["selector-concept-content"]},i.getName());a.append(l),"ancestor"===t&&l.classList.add("fit-content");const o=(0,e.oL)({class:["selector-concept-status"]});if(i.hasError){o.classList.add("error");let t=(0,e.w_)({class:["bare-list","selector-concept-status__errors"]});i.errors.forEach((i=>{let s=(0,e.HV)({class:["selector-concept-status__error"]},i);s.style.minWidth=`${Math.min(.5*i.length,30)}em`,t.append(s)})),o.append(t),a.classList.add("error")}else o.classList.add("valid"),a.classList.add("valid");return a.append(o),a.addEventListener("mouseenter",(t=>{let i=(0,e.sb)(`.projection[data-concept="${r}"]`,this.editor.body);i&&this.editor.highlight(i)})),a.addEventListener("mouseleave",(e=>{this.editor.unhighlight()})),a.addEventListener("click",(t=>{let i=(0,e.sb)(`.projection[data-concept="${r}"]`,this.editor.body);i&&i.focus()})),a}const m={container:null,title:null,conceptList:null,header:null,body:null,get isRendered(){return(0,e.Re)(this.container)},init(e={}){return this.schema=e,this},update(){},refresh(){const{activeInstance:t,activeConcept:i,hasActiveInstance:s,hasActiveConcept:n}=this.editor;if(!s||!n)return(0,e.ep)(this.conceptList),this;const r=t.concept,a=(0,e.DZ)();let l=p.call(this,"root",r);if(a.append(l),r===i&&l.classList.add("selector-concept--active"),r===i)return(0,e.ep)(this.conceptList).append(a),this;if(!i.hasParent())return(0,e.ep)(this.conceptList).append(a),this;let o=i.getParent(),c=[];for(;o&&o!==r;)c.unshift(o),o=o.getParent();return c.forEach((e=>{a.append(p.call(this,"ancestor",e))})),l=p.call(this,"active",i),a.append(l),(0,e.ep)(this.conceptList).append(a),this},render(){const t=(0,e.DZ)();(0,e.Re)(this.container)||(this.container=(0,e.wC)({class:["editor-breadcrumb"]})),(0,e.Re)(this.notification)||(this.notification=(0,e.wC)({class:["notification","breadcrumb-notification"]}),t.append(this.notification));const i=(0,e.kQ)({class:["breadcrumb-title","hidden"],dataset:{ignore:"all"}},"Breadcrumb");return t.append(i),(0,e.Re)(this.conceptList)||(this.conceptList=(0,e.w_)({class:["bare-list","selector-concepts"]}),t.append(this.conceptList)),t.hasChildNodes()&&(this.container.append(t),this.bindEvents()),this.update(),this.refresh(),this.container},bindEvents(){}},f={schema:null,isOpen:!1,visible:!0,btnStart:null,logList:null,init(e){return e&&(this.schema=e),this},get isRendered(){return(0,e.Re)(this.container)},add(i,s,n=t.hi.NORMAL){if(!Array.isArray(i))return;let r=(0,e.w_)({class:["bare-list","log-item-messages"]});i.forEach((t=>r.append((0,e.HV)({class:["log-item-message"]},t))));let a=(0,e.HV)({class:["log-item",`log-item--${n}`]}),l=(0,e.ax)({class:["btn","btn-delete"],dataset:{action:"delete",target:"parent"}},"✖"),o=(0,e.kQ)({class:["log-item__name"],dataset:{action:"delete",target:"parent"}},`${(0,e.XI)(s,"Log")} (${(0,e.iG)(Date.now())})`);return a.append(l,o,r),this.logList.append(a),this.refresh(),this},clear(){return(0,e.ep)(this.logList),this},update(){},render(){const t=(0,e.DZ)();return(0,e.Re)(this.container)||(this.container=(0,e.wC)({class:["editor-log"]})),(0,e.Re)(this.logList)||(this.logList=(0,e.w_)({class:["bare-list","log-list"]}),t.append(this.logList)),t.hasChildNodes()&&(this.container.append(t),this.bindEvents()),this.refresh(),this.container},refresh(){return this.logList.hasChildNodes()?this.show():this.hide(),this},bindEvents(){}},g={container:null,list:null,editor:null,dataList:null,fetch:null,init(e){return this.fetch=e,this},render(){const t=(0,e.DZ)();return(0,e.Re)(this.container)||(this.container=(0,e.wC)({class:["container","container--editor-selectors"]})),(0,e.Re)(this.list)||(this.list=(0,e.w_)({class:["bare-list","editor-selectors","font-ui"]}),t.append(this.list)),t.hasChildNodes()&&(this.container.append(t),this.bindEvents()),this.refresh(),this.container},refresh(){return this},update(){this.dataList=this.fetch(),(0,e.ep)(this.list);let t=(0,e.XI)(this.editor.getConfig("concept"),{});return this.dataList.forEach((i=>{const{concept:s,accept:n}=i;let r=(0,e.mg)({class:["title","editor-selector__title"]},`${a=i.name,(0,e.RI)(t,a)?t[a].name:a}`);var a;s&&r.append((0,e.kQ)({class:["editor-selector__title-concept"]},(s.name||s.prototype).replace(" ","-").toLowerCase())),n&&r.append((0,e.kQ)({class:["editor-selector__title-accept"]},n.name)),(0,e.ax)({class:["btn","editor-selector__header-button","editor-selector__header-button--info"],title:`View ${i.name||i.type} info`,dataset:{action:"collapse",rel:"parent",target:"selector"}},"i");let l=(0,e.dc)({class:["title","editor-selector__header"],title:`Expand/Collapse ${this.type}`},[r]),o=v[this.type],c=(0,e.wC)({class:["editor-selector__action-bar"]},o.call(this,i)),h=(0,e.HV)({class:["editor-selector","collapsed","font-ui"],tabindex:0,dataset:{type:this.type,alias:`${i.name||i.type}`,name:"selector",projection:i.id}},[l,c]);this.list.append(h)})),this.refresh(),this},show(){return(0,t.$Z)(this.container),this},hide(){return(0,t.Cp)(this.container),this},bindEvents(){}},v={projection:function(t){const i=(0,e.DZ)();let s=(0,e.ax)({class:["btn","editor-selector__action-bar-button","editor-selector__action-bar-button","editor-selector__action-bar-button--clone"],dataset:{action:"edit:projection",id:t.id}},"Edit");return i.append(s),i},value:function(t){const i=(0,e.DZ)();let s=(0,e.ax)({class:["btn","editor-selector__action-bar-button","editor-selector__action-bar-button--clone"],dataset:{action:"create-instance:value",id:t.id}},(0,e.oL)({class:["ico","ico-plus","btn-content"],dataset:{ignore:"all"}},"+")),n=(0,e.ax)({class:["btn","editor-selector__action-bar-button","editor-selector__action-bar-button--clone"],dataset:{action:"copy:value",id:t.id}},(0,e.oL)({class:["ico","ico-copy","btn-content"],dataset:{ignore:"all"}})),r=(0,e.ax)({class:["btn","editor-selector__action-bar-button","editor-selector__action-bar-button--delete"],dataset:{action:"delete:value",id:t.id}},(0,e.oL)({class:["ico","ico-delete","btn-content"],dataset:{ignore:"all"}},"✖"));return i.append(r,n,s),i},concept:function(t){const i=(0,e.DZ)();let s=this.editor.projectionModel.hasProjectionSchema(t),n=(0,e.ax)({class:["btn","editor-selector__action-bar-button","editor-selector__action-bar-button--clone"],disabled:!s,title:`Create an instance of "${t.name}"`,dataset:{action:"create-instance",concept:t.name}},(0,e.oL)({class:["ico","ico-plus","btn-content"],dataset:{ignore:"all"}},"+"));return s||(n.title=`The concept ${t.name} has no projection`),i.append(n),i},resource:function(t){const{name:i,type:s,required:n}=t,r=(0,e.DZ)();let a=(0,e.ax)({class:["btn","editor-selector__action-bar-button","editor-selector__action-bar-button--add"],dataset:{action:"load-resource",id:i}},(0,e.oL)({class:["ico","ico-plus","btn-content"],dataset:{ignore:"all"}},"+")),l=(0,e.ax)({class:["btn","editor-selector__action-bar-button","editor-selector__action-bar-button--delete"],dataset:{action:"delete:resource",id:i}},(0,e.oL)({class:["ico","ico-delete","btn-content"],dataset:{ignore:"all"}},"✖"));return this.editor.getResource(i)?r.append(l):r.append(a),r}},b={editor:null,valueCount:0,fileCount:0,container:null,title:null,visible:!0,tabs:null,tabConcept:null,tabValue:null,tabProjection:null,tabResource:null,tabConceptNotification:null,tabValueNotification:null,tabProjectionNotification:null,tabResourceNotification:null,activeTab:null,activeTabValue:null,menu:null,header:null,body:null,btnHome:null,btnSave:null,btnClose:null,get isRendered(){return(0,e.Re)(this.container)},init(e){return e&&(this.editor=e),this._conceptSelector=function(e,t,i){return Object.create(g,{object:{value:"selector"},model:{value:void 0},type:{value:"concept"},editor:{value:t}})}(0,this.editor).init((()=>this.editor.isReady?this.editor.conceptModel.getSchema("concrete").filter((e=>e.root)):[])),this},render(){const t=(0,e.DZ)();(0,e.Re)(this.container)||(this.container=(0,e.wC)({class:["editor-header"],dataset:{name:"editor-header",alias:"header"}})),(0,e.Re)(this.title)||(this.title=(0,e.kQ)({class:["editor-header-title"]},"Gentleman")),(0,e.Re)(this.menu)||(this.menu=(0,e.wC)({class:["editor-header-left"]},[this.title]));let i=(0,e.wC)({class:["editor-toolbar"]},this.editor.getConfig("toolbar").map((t=>(0,e.ax)({class:(0,e.XI)(t.class,[]),dataset:{name:t.name,action:t.action}},t.content))));return(0,e.Re)(this.header)||(this.header=(0,e.wC)({class:["editor-header-menu"]},[this.menu,i]),t.append(this.header)),(0,e.Re)(this.body)||(this.body=(0,e.wC)({class:["editor-header-main"]}),t.append(this.body)),(0,e.Re)(this._conceptSelector.container)||this.body.append(this._conceptSelector.render()),t.hasChildNodes()&&(this.container.append(t),this.bindEvents()),this.refresh(),this.container},refresh(){let i=(0,e.XI)(this.editor.getConfig("settings"),!0),s=(0,e.XI)(this.editor.getConfig("header"),!0);return this.editor.hasConceptModel?(this._conceptSelector.update(),(0,t.$Z)(this.body)):(0,t.Cp)(this.body),!1===i&&(0,t.Cp)(this.btnHome),!1===s&&(0,t.Cp)(this.body),this},show(i){if(!(0,e.Re)(this[i]))return(0,t.$Z)(this.container),this.visible=!0,this;(0,t.$Z)(this[i])},hide(i){if(!(0,e.Re)(this[i]))return(0,t.Cp)(this.container),this.visible=!1,this;(0,t.Cp)(this[i])},toggle(){return(0,t.ZN)(this.container),this.visible=!this.visible,this},bindEvents(){}};var y=0;const w={createInstance(i,s,n){if((0,e.le)(i))return this.notify("The concept is not valid",t.k$.ERROR),!1;let r="concept"===i.type?i:this.createConcept(i),a=s;(0,e.le)(a)&&this.hasProjectionModel&&(a=this.createProjection(r).init());let l=Object.create(E,{id:{value:"instance"+y++},object:{value:"environment"},name:{value:"editor-instance"},type:{value:"instance"},concept:{value:r,writable:!0},projection:{value:a,writable:!0},editor:{value:this}});const o=Object.assign({type:"concept",resize:!0,maximize:!0,close:"DELETE-CONCEPT"},n);return l.init(o),this.addInstance(l),l},getInstance(e){return this.instances.get(e)},addInstance(e){return e.isRendered||this.instanceSection.append(e.render()),this.instances.set(e.id,e),"tab"===this.status.view&&this.status.addView(e),this.updateActiveInstance(e),this.refresh(),this},removeInstance(t){let i=this.getInstance(t);return!(0,e.le)(i)&&(i===this.activeInstance&&(this.activeInstance=null),i.view&&(0,e.ep)(i.view).remove(),this.instances.delete(t),this.refresh(),!0)},moveInstance(e,t){return this.instanceSection.children[t].before(e),this},swapInstance(e,t){let i=Array.from(this.instanceSection.children);const s=i.indexOf(e),n=i.indexOf(t);return this.moveInstance(t,s),this.moveInstance(e,n),this}},E={window:null,container:null,title:null,visible:!0,menu:null,header:null,body:null,btnMaximize:null,btnClose:null,size:1,fullscreen:!1,collapsed:!1,schema:null,ctype:null,get isRendered(){return(0,e.Re)(this.container)},init(t={}){return this.ctype=(0,e.XI)(t.type,"concept"),this.schema=t,this},collapse(){return(0,t.wo)(this.container),this.collapsed=!0,this.fullscreen=!1,this.size="normal",this.refresh(),this},expand(){return(0,t.jn)(this.container),this.collapsed=!1,this.refresh(),this},changeSize(e){this.size=e,"fullscreen"===e?(this.fullscreen=!0,this.container.style.removeProperty("width"),this.container.style.removeProperty("height")):this.fullscreen=!1,this.refresh()},show(){return(0,t.$Z)(this.container),this.visible=!0,this},hide(){return(0,t.Cp)(this.container),this.visible=!1,this},toggle(){return(0,t.ZN)(this.container),this.visible=!this.visible,this},refresh(){return this.container.dataset.size=`${this.size}`,(0,e.le)(this.projection)&&(this.body.textContent="No projection found"),Array.from(this.editor.instances).some((e=>e.fullscreen))?this.editor.instanceSection.classList.add("fullscreen"):this.editor.instanceSection.classList.remove("fullscreen"),this},render(){const i=(0,e.DZ)(),{name:s}=this.concept,n=s.toLowerCase();(0,e.Re)(this.container)||(this.container=(0,e.wC)({class:["editor-concept",`editor-concept--${this.ctype}`],tabindex:0,dataset:{nature:"concept-container",type:this.ctype,size:1}})),(0,e.Re)(this.header)||(this.header=(0,e.dc)({title:"concept"===this.schema.type?`Instance of "${n}"`:`Linked instance of "${n}"`,class:["editor-concept-header"]}),i.append(this.header)),(0,e.Re)(this.btnClose)||(this.btnClose=(0,e.ax)({class:["btn","editor-concept-toolbar__btn-delete"],title:`Delete the instance "${n}"`,dataset:{action:"close",context:this.type,id:this.id}}),"projection"===this.schema.type&&(this.btnClose.title=`Close the linked instance "${n}"`)),(0,e.Re)(this.btnMaximize)||(this.btnMaximize=(0,e.ax)({class:["btn","editor-concept-toolbar__btn-maximize"],title:`Maximize ${s.toLowerCase()}`,dataset:{action:"maximize",context:this.type,id:this.id}})),this.title=(0,e._N)({class:["title","editor-concept-title","fit-content"],dataset:{nature:"editable",id:this.id}},(0,e.XI)(this.schema.title,s));let r=(0,e.wC)({class:["editor-concept-toolbar"]},[this.btnMaximize,this.btnClose]);return(0,e.ep)(this.header).append(this.title,r),this.body&&this.body.remove(),this.projection?this.body=this.projection.render():this.body=(0,e.qm)(),i.append(this.body),i.hasChildNodes()&&(this.container.appendChild(i),this.bindEvents()),(0,t.n2)(this.container),this.refresh(),this.container},clear(){},actionHandler(e){switch(e){case"collapse":this.collapsed?this.expand():this.collapse();break;case"maximize":this.fullscreen?this.changeSize("normal"):this.changeSize("fullscreen");break;case"close":this.delete()}},delete(){switch(this.schema.close){case"DELETE-CONCEPT":if(!this.concept.delete(!0))return this.editor.notify("The concept could not be deleted",t.k$.ERROR),this;break;case"DELETE-PROJECTION":if(this.projection&&!this.projection.delete())return this.notify("The projection could not be deleted",t.k$.ERROR),this}(0,e.ep)(this.container).remove(),this.editor.removeInstance(this.id),this.window&&this.window.removeInstance(this)},bindEvents(){this.container.addEventListener("focusin",(e=>{this.editor.updateActiveInstance(this)}))}};var C=0;const j={createWindow(e){let t=Object.create(L,{id:{value:"window"+C++},object:{value:"environment"},name:{value:"editor-window"},type:{value:"window"},editor:{value:this}});return t.refname=e,t.init(),this.addWindow(t),t},getWindow(e){return this.windows.get(e)},findWindow(e){return Array.from(this.windows.values()).find((t=>t.refname===e))},addWindow(e){return e.isRendered||this.body.append(e.render()),this.windows.set(e.id,e),"tab"===this.status.view&&this.status.addView(e),this.refresh(),this},removeWindow(t){let i=this.getWindow(t);return!(0,e.le)(i)&&(i===this.activeWindow&&(this.activeWindow=null),i.view&&(0,e.ep)(i.view).remove(),this.windows.delete(t),this.refresh(),!0)},moveWindow(e,t){return this.body.children[t].before(e),this},swapWindow(e,t){let i=Array.from(this.body.children);const s=i.indexOf(e),n=i.indexOf(t);return this.moveWindow(t,s),this.moveWindow(e,n),this}},L={container:null,title:null,visible:!0,instances:null,menu:null,header:null,body:null,btnClose:null,maxInstance:1,get isRendered(){return(0,e.Re)(this.container)},init(t={}){return this.ctype=(0,e.XI)(t.type,"concept"),this.schema=t,this.instances=new Set,this},isEmpty(){return 0===this.instances.size},show(){return(0,t.$Z)(this.container),this.visible=!0,this},hide(){return(0,t.Cp)(this.container),this.visible=!1,this},toggle(){return(0,t.ZN)(this.container),this.visible=!this.visible,this},close(){(0,e.ep)(this.container).remove(),this.editor.removeWindow(this.id)},refresh(){return this.isEmpty()?this.hide():this.show(),this},render(){const t=(0,e.DZ)();(0,e.Re)(this.container)||(this.container=(0,e.wC)({class:["editor-window"],tabindex:-1})),(0,e.Re)(this.header)||(this.header=(0,e.dc)({class:["editor-window-header"]}),t.append(this.header)),(0,e.Re)(this.title)||(this.title=(0,e._N)({class:["title","editor-window-title","fit-content"]})),(0,e.Re)(this.btnClose)||(this.btnClose=(0,e.ax)({class:["btn","editor-window-header__btn-delete"],title:"Close the window",dataset:{action:"close",context:this.type,id:this.id}}));let i=(0,e.wC)({class:["editor-window-toolbar"]},[this.btnClose]);return(0,e.ep)(this.header).append(this.title,i),t.hasChildNodes()&&(this.container.appendChild(t),this.bindEvents()),this.refresh(),this.container},getInstance(t){return(0,e.le)(t)?null:Array.from(this.instances).find((e=>e.id===t))},addInstance(t){if(!(0,e.le)(t)&&!this.instances.has(t))return this.instances.add(t),t.window=this,this.container.append(t.container),this.refresh(),!0},removeInstance(t){if(!(0,e.le)(t)&&this.instances.has(t))return this.instances.delete(t),this.refresh(),!0},actionHandler(e){switch(e){case"close":this.close()}},bindEvents(){}},x={modelstatus:null,editorstatus:null,notification:null,views:null,view:"grid",viewContainer:null,viewList:null,viewItem:null,activeViewItem:null,groupList:null,groupItem:null,activeGroupItem:null,visible:!0,container:null,get isRendered(){return(0,e.Re)(this.container)},init(){return this.views=new Map,this},show(){return(0,t.$Z)(this.container),this.visible=!0,this},hide(){return(0,t.Cp)(this.container),this.visible=!1,this},toggle(){return(0,t.ZN)(this.container),this.visible=!this.visible,this},updateActiveView(){"tab"===this.view&&(this.editor.instances.forEach((e=>{e!==this.editor.activeInstance&&(e.view.classList.remove("active"),e.hide())})),this.editor.activeInstance.view.classList.add("active"),this.editor.activeInstance.show()),this.editor.refresh()},addView(t){if((0,e.le)(t))return!1;let i=t.title.textContent,s=(0,e.oL)({class:["ico","ico-delete"]},"✖"),n=(0,e.ax)({class:["btn","btn-close"]},s),r=(0,e.wC)({class:[`editor-view-${this.view}list-item__content`,"fit-content"]},i),a=(0,e.HV)({class:[`editor-view-${this.view}list-item`],title:t.title.textContent},[r,n]);t.view=a,a.addEventListener("click",(i=>{if(function(t){const i=e=>e===a||e===n;return i(t)?t:(0,e.wr)(t,(e=>i(e)),5)}(i.target)===n){let e=a.previousSibling||a.nextSibling;t.delete(),null===this.editor.activeInstance&&e&&e.click()}else this.editor.updateActiveInstance(t)})),this.tabView.append(a)},changeView(i){if(i===this.view)return this;this.view=i,(0,t.hF)(this.viewItem),this.viewItem=this.views.get(this.view),(0,t.Ys)(this.viewItem),(0,e.ep)(this.editor.viewSection),"tab"===i?(this.tabView=(0,e.w_)({class:["bare-list","editor-view-tablist"]}),(0,e.ep)(this.tabView),this.editor.instances.forEach((e=>{e.expand(),this.addView(e)})),this.editor.viewSection.append(this.tabView)):"grid"===i&&this.editor.instances.forEach((e=>{e.show()})),this.updateActiveView()},addGroup(){(0,e.HV)({class:["editor-footer-group"]})},notify(t,i=4500){let s=t;const n="open";if(this.notification.classList.contains(n))return!1;this.notification.appendChild(s),setTimeout((()=>{this.notification.classList.add(n),this.container.classList.add("menu--notifying")}),50),setTimeout((()=>{this.notification.classList.remove(n),this.container.classList.remove("menu--notifying"),setTimeout((()=>{(0,e.ep)(this.notification)}),500)}),i)},refresh(){const{conceptModel:t}=this.editor;if(this.editor.isReady){if(t.hasError){this.modelstatusBadge.classList.add("error"),this.modelstatusBadge.classList.remove("valid"),this.container.classList.add("error");let e=t.concepts.filter((e=>e.hasError)).length;this.modelstatusInfo.textContent=`${e} ${function(e,t,i){if(1===i)return e;let s="s".split("|");return 1===s.length?e+s[0]:e.substring(0,e.lastIndexOf(s[0]))+s[1]}("error",0,e)}`}else this.modelstatusBadge.classList.add("valid"),this.modelstatusBadge.classList.remove("error"),this.container.classList.remove("error"),(0,e.ep)(this.modelstatusInfo),this.editor.logs.clear();if(this.editor.hasError){this.editorstatusBadge.classList.add("error"),this.editorstatusBadge.classList.remove("valid"),this.container.classList.add("error");let e=this.editor.errors.length;this.editorstatusInfo.textContent=`${e}`}else this.editorstatusBadge.classList.add("valid"),this.editorstatusBadge.classList.remove("error"),this.container.classList.remove("error"),(0,e.ep)(this.editorstatusInfo),this.editor.logs.clear()}},render(){const t=(0,e.DZ)();if((0,e.Re)(this.container)||(this.container=(0,e.wC)({class:["editor-statusbar"]})),(0,e.Re)(this.badgeContainer)||(this.badgeContainer=(0,e.wC)({class:["editor-statusbar-badge-container"]}),t.appendChild(this.badgeContainer)),(0,e.Re)(this.modelstatus)||(this.modelstatus=(0,e.wC)({class:["editor-statusbar-model"]}),this.modelstatusBadge=(0,e.oL)({class:["editor-statusbar-model-badge"]}),this.modelstatusInfo=(0,e.wC)({class:["editor-statusbar-model-info"]}),this.modelstatus.append(this.modelstatusBadge,this.modelstatusInfo),this.badgeContainer.appendChild(this.modelstatus)),(0,e.Re)(this.editorstatus)||(this.editorstatus=(0,e.wC)({class:["editor-statusbar-global"]}),this.editorstatusBadge=(0,e.oL)({class:["editor-statusbar-global-badge"]}),this.editorstatusInfo=(0,e.wC)({class:["editor-statusbar-global-info"]}),this.editorstatus.append(this.editorstatusBadge,this.editorstatusInfo),this.badgeContainer.appendChild(this.editorstatus)),(0,e.Re)(this.viewContainer)||(this.viewContainer=(0,e.wC)({class:["editor-statusbar-viewer-container"]}),t.appendChild(this.viewContainer)),!(0,e.Re)(this.btnGroup)){let t=(0,e.oL)({class:["ico","ico-plus","btn-content"],title:"Add a group",dataset:{ignore:"all"}},"+");this.btnGroup=(0,e.ax)({class:["editor-statusbar-viewer__button-add"],dataset:{action:"add-group"}},t)}return(0,e.Re)(this.groupContainer)||(this.groupContainer=(0,e.wC)({class:["editor-footer-group"]})),(0,e.Re)(this.viewList)||(this.viewList=(0,e.w_)({class:["bare-list","editor-statusbar-viewers"]}),this.viewContainer.appendChild(this.viewList)),["grid","tab"].forEach((t=>{let i=(0,e.HV)({class:["editor-statusbar-viewer"],dataset:{type:"viewer",action:"change-view",value:t}},t);this.views.set(t,i),this.viewList.append(i)})),this.viewItem=this.views.get(this.view),this.viewItem.classList.add("selected"),t.hasChildNodes()&&(this.container.append(t),this.bindEvents()),this.refresh(),this.container},bindEvents(){function i(t,i){let s=(0,e.UF)({class:["link","error-message__link"]},t);const n=`.projection[data-concept="${i}"]`;return s.addEventListener("mouseenter",(t=>{let i=(0,e.sb)(n,this.editor.body);i&&this.editor.highlight(i)})),s.addEventListener("mouseleave",(e=>{this.editor.unhighlight()})),s.addEventListener("click",(t=>{let i=this.editor.resolveElement((0,e.sb)(n,this.editor.body));i&&i.focus()})),s}this.modelstatus.addEventListener("click",(s=>{if(!this.editor.conceptModel.hasError)return;let n=[];this.editor.conceptModel.concepts.forEach((t=>{t.hasError&&n.push(...t.errors.map((s=>{let n=i.call(this,t.getName(),t.id);return(0,e.kQ)({class:["error-message"]},[n,`: ${s}`])})))})),this.editor.logs.clear(),this.editor.logs.add(n,"Validation error",t.hi.ERROR)})),this.editorstatus.addEventListener("click",(i=>{if(!this.editor.hasError)return;let s=[];s.push(...this.editor.errors.map((t=>(0,e.kQ)({class:["error-message"]},[`${t.message}`])))),this.editor.logs.clear(),this.editor.logs.add(s,"Validation error",t.hi.ERROR)})),this.editor.registerHandler("editor.instance@active:updated",(()=>{this.updateActiveView()}))}},R={container:null,isOpen:!1,visible:!0,show(){return(0,t.$Z)(this.container),this.visible=!0,this},hide(){return(0,t.Cp)(this.container),this.visible=!1,this},toggle(){return(0,t.ZN)(this.container),this.visible=!this.visible,this},open(){return this.container.classList.add("open"),this.show(),this.isOpen=!0,this.editor.refresh(),this},close(){return this.container.classList.remove("open"),this.hide(),this.isOpen=!1,this.editor.refresh(),this}};function I(){return Object.create(b,{object:{value:"environment"},name:{value:"editor-header"},editor:{value:this}})}function A(){return Object.create(m,{object:{value:"environment"},name:{value:"editor-breadcrumb"},type:{value:"breadcrumb"},editor:{value:this}})}function O(){return Object.assign(Object.create(R,{object:{value:"environment"},name:{value:"editor-home"},type:{value:"home"},editor:{value:this}}),n)}function V(){return Object.create(x,{object:{value:"environment"},name:{value:"editor-status"},type:{value:"status"},editor:{value:this}})}function S(){return Object.assign(Object.create(R,{object:{value:"environment"},name:{value:"editor-log"},type:{value:"log"},editor:{value:this}}),f)}const _={getHandlers(t){return(0,e.XI)(this.handlers.get(t),[])},triggerEvent(t,i,s=!0){const{name:n,options:r,args:a}=t,l=this.getHandlers(n),o=(0,e.mf)(i);let c=!1;return l.forEach((e=>{let t=e.call(this,a,r);!1!==t?s&&o&&i.call(this,t):c=!0})),!c&&(!s&&o&&i.call(this),!0)},registerHandler(e,t){return this.hasHanlder(e)||this.handlers.set(e,[]),this.handlers.get(e).push(t),!0},unregisterHandler(e,t){if(!this.hasHanlder(e))return!1;let i=this.getHandlers(e);for(let e=0;e<i.length;e++)if(i[e]===t)return i.splice(e,1),!0;return!1},hasHanlder(e){return this.handlers.has(e)}};var T=i(914);const H={create(e,t){const i=Object.create(this);return i.concept=e,i.schema=t,i},model:null,schema:null,source:null,id:null,value:null,object:"structure",init(e){throw new Error("This function has not been implemented")}};Object.defineProperty(H,"model",{get(){return this.concept.model}}),Object.defineProperty(H,"name",{get(){return this.schema.name}}),Object.defineProperty(H,"required",{get(){return(0,e.XI)(this.schema.required,!0)}});const k={object:"attribute",target:null,init(t){return this.target=this.model.createConcept(this.schema.target,{value:(0,e.XI)(t,this.schema.value),parent:this.concept,ref:this}),this},getValue(){return this.target.getValue()},hasValue(){return this.target.hasValue()},setValue(e){this.target.setValue(e)},getTarget(){return this.target},copy(){return this.target.hasValue()?this.target.copy(!1):null},clone(){return this.target.hasValue()?this.target.clone():null},export(){return this.target.hasValue()?{id:this.target.id,name:this.target.name}:null},toString(){return{[`attribute.${this.name}`]:this.target.toString()}},toXML(){return this.target.hasValue()?this.target.toXML():""}},M=Object.assign(Object.create(H),k),$={attributes:null,attributes_created:null,initAttribute(){return this.attributes=[],this.attributes_created=new Set,this.attributes_updated=new Set,this.attributes_deleted=new Set,Array.isArray(this.attributeSchema)&&this.attributeSchema.filter((t=>(0,e.XI)(t.required,!0))).forEach((e=>this.createAttribute(e.name))),this},getAttributes(){return this.attributes},getAttribute(t){if((0,e.le)(t))throw new TypeError("Bad argument");return this.getAttributeByName(t)},getAttributeSchema(t){if((0,e.hr)(t))throw new TypeError("Bad argument");if(!this.hasAttribute(t))throw new Error(`Attribute '${t}' does not exist`);return(0,e.kI)(this.attributeSchema.find((e=>e.name===t)))},getAttributeByName(t){if((0,e.hr)(t))throw new TypeError("Bad argument");var i=this.attributes.find((e=>e.name===t));return(0,e.le)(i)&&(i=this.createAttribute(t)),i},createAttribute(e,t){if(!this.hasAttribute(e))throw new Error(`Attribute not found: The concept '${this.name}' does not contain an attribute named '${e}'`);if(this.isAttributeCreated(e)){let i=this.getAttributeByName(e);if(t){let e=this.model.getValue(t);i.target.initValue(e)}return i}const i=this.getAttributeSchema(e);let s=this.model.getValue(t);var n=M.create(this,i).init(s);return this.addAttribute(n),n},addAttribute(t){if((0,e.le)(t)||"attribute"!==t.object)throw new Error("Bad argument: 'attribute' must be an attribute object");return this.attributes.push(t),this.attributes_created.add(t.name),this.notify("attribute.added",t),this},hasAttributes(){return!(0,e.xb)(this.attributeSchema)||!(0,e.xb)(this.attributes)},hasAttribute(e){return-1!==this.attributeSchema.findIndex((t=>t.name===e))},isAttributeRequired(t){const i=this.getAttributeSchema(t);return(0,e.XI)(i.required,!0)},isAttributeCreated(e){return this.attributes_created.has(e)},listAttributes(){const e=[];return this.attributeSchema.forEach((t=>{e.push({type:"attribute",name:t.name,target:t.target,accept:t.accept,required:this.isAttributeRequired(name),created:this.isAttributeCreated(name)})})),e},removeAttribute(e){if(this.isAttributeRequired(e))return{message:`The attribute '${e}' is required.`,success:!1};var t=this.attributes.findIndex((t=>t.name===e));if(-1===t)return{message:`The attribute '${e}' was not found.`,success:!1};var i=this.attributes.splice(t,1)[0];return this.attributes_created.delete(e),this.notify("attribute.removed",i),{message:`The attribute '${e}' was successfully removed.`,success:!0}}},P={listeners:null,initObserver(){return this.listeners=[],this},register(e){return this.listeners.includes(e)||this.listeners.push(e),!0},unregister(e){var t=this.listeners.indexOf(e);return-1!==t&&(this.listeners.splice(t,1),!0)},unregisterAll(){this.listeners=[]},notify(e,t){this.listeners.forEach((i=>{i.update(e,t,this)}))}},N={model:null,schema:null,source:null,id:null,name:null,ref:null,actions:null,operations:null,accept:null,parent:null,references:null,errors:null,value:null,values:null,action:null,shadows:null,watchers:null,kind:"concept",init(t={}){return this.accept=t.accept,this.parent=t.parent,this.ref=t.ref,this.properties=(0,e.XI)(this.schema.properties,[]),Array.isArray(t.properties)&&this.properties.push(...t.properties),this.default=(0,e.XI)(this.schema.default,null),this.values=(0,e.XI)(t.values,(0,e.XI)(this.schema.values,[])),this.src=(0,e.XI)(this.schema.src,[]),this.constraint=this.schema.constraint,this.watchers=new Map,this.errors=[],this.initObserver(),this.initAttribute(),this.initValue(t.value),this},isRoot(){return(0,e.le)(this.parent)},initValue(){throw new Error("This function has not been implemented")},getName(){return this.ref&&"attribute"===this.ref.object?this.ref.name:this.name},getCandidates(){return this.values.forEach((t=>{(0,e.Kn)(t)&&(t.type="value")})),this.values},getStructure(){return[...this.listAttributes()]},getProperty(t,i){if("refname"===t){if((0,e.le)(this.ref))return;return this.ref.name}if("name"===t)return this.name;if("value"===t)return this.value;if(!this.hasProperty(t))return;let s=this.properties.find((e=>e.name===t));const{type:n,value:r}=s;return"string"===n?D.call(this,r):"number"===n?+r:"boolean"===n?(0,e.sw)(r):r},hasProperty(t){return!!["refname","name","value"].includes(t)||-1!==(0,e.XI)(this.schema.properties,[]).findIndex((e=>e.name===t))},getConstraint(e){if(this.hasConstraint(e))return this.constraint[e]},hasConstraint(t){return!(0,e.le)(this.constraint)&&(!!(0,e.le)(t)||(0,e.RI)(this.constraint,t))},hasParent(){return!this.isRoot()},getParent(t){if(this.isRoot())return null;if((0,e.hr)(t))return this.parent;const i=this.parent;return i.name===t?i:i.getParent(t)},getParentWith(t){if(this.isRoot())return null;if((0,e.hr)(t))return this.parent;const i=this.parent;return i.hasPrototype(t)?i:i.getParentWith(t)},getPrototype(){return(0,e.le)(this.prototype)?null:this.prototype},hasPrototype(t){if((0,e.le)(this.schema.prototype))return!1;if((0,e.le)(t))return!0;let i=this.model.getConceptSchema(this.schema.prototype);for(;!(0,e.le)(i);){if(i.name===t)return!0;i=this.model.getConceptSchema(i.prototype)}return!1},getAncestor(e){const t=[];for(var i=this.getParent(e);i;)t.push(i),i=i.getParent(e);return t},getChildren(t){const i=[];return(0,e.le)(t)?this.getAttributes().forEach((e=>{i.push(e.target)})):this.getAttributes().forEach((e=>{e.target.name===t?i.push(e.target):i.push(...e.target.getChildren(t))})),i},getDescendant(e){const t=[];return this.getChildren(e).forEach((i=>{t.push(i),t.push(...i.getDescendant(e))})),t},propagate(e,t,i){this.watchers.has(e)&&this.signal(e,t,i),this.hasParent()&&this.getParent().propagate(e,t,i)},watch(e,t){this.watchers.has(e)||this.watchers.set(e,[]),this.watchers.get(e).push(t)},signal(e,t,i){this.watchers.has(e)&&this.watchers.get(e).forEach((e=>e(t,this)))},unwatch(t,i){if((0,e.le)(t)||!this.watchers.has(t))return!1;if(!(0,e.mf)(i))return this.watchers.delete(t),!0;let s=this.watchers.get(t).findIndex((e=>e===i));return-1!==s&&(this.watchers.splice(s,1),!0)},done(){this.unregisterAll(),this.watchers.clear()},delete(e=!1){if(!e){const{object:e}=this.ref;let t={success:!0};if("concept"===e?t=this.getParent().removeValue(this):"attribute"===e&&(t=this.getParent().removeAttribute(this.ref.name)),!t.success)return t}this.getChildren().forEach((e=>{e&&e.delete(!0)}));try{this.model.removeConcept(this.id)&&this.notify("delete")}catch(e){return console.error(this),{message:"Concept not found",success:!1}}return{message:`The concept '${this.name}' was successfully deleted.`,success:!0}},copy(e=!0){const t={name:this.name,nature:this.nature};var i=[];return this.getAttributes().forEach((e=>{i.push({name:e.name,value:e.copy(!1)})})),t.attributes=i,e&&this.model.addValue(t),t},clone(){const e={id:this.id,name:this.name};var t=[];return this.getAttributes().forEach((e=>{t.push({name:e.name,value:e.clone()})})),e.attributes=t,e},export(){const e={id:this.id,root:this.isRoot(),name:this.name};var t=[];return this.getAttributes().forEach((e=>{t.push({name:e.name,value:e.export()})})),e.attributes=t,e},toString(){var e={};return this.attributes.forEach((t=>{Object.assign(e,t.toString())})),e},toXML(){let e=this.getName().replace(" ","-");return`<${e} id="${this.id}">`+this.attributes.map((e=>e.toXML())).join("")+`</${e}>`}};function D(t){if((0,e.HD)(t))return t;const{type:i}=t;switch(i){case"concat":return X.call(this,t.concat)}}function B(e,t){const{type:i}=e;return"string"===i?D.call(this,e.value):"property"===i?this.getProperty(e.name):t||e}function X(e,t=""){if(!Array.isArray(e))throw new TypeError("Terms need to be an array");return e.length<2?B.call(this,e[0]):e.map((e=>B.call(this,e))).join(t)}const Z=Object.assign(N,P,$);Object.defineProperty(Z,"attributeSchema",{get(){return this.schema.attributes}}),Object.defineProperty(Z,"_prototype",{get(){return this.schema.prototype}}),Object.defineProperty(Z,"hasError",{get(){return this.errors&&!(0,e.xb)(this.errors)}});const F={nature:"primitive",init(t={}){return this.parent=t.parent,this.ref=t.ref,this.default=(0,e.XI)(this.schema.default,!0),this.constraint=this.schema.constraint,this.errors=[],this.initObserver(),this.initAttribute(),this.initValue(t.value),this},initValue(t){if((0,e.le)(t))return this.value=this.default,this;if((0,e.Kn)(t)){const{id:e="",value:i}=t;e.length>10&&(this.id=e),this.setValue(i)}else this.setValue(t);return this},hasValue(){return!(0,e.le)(this.value)},getValue(){return this.value},setValue(t){let i=(0,e.Kn)(t)?t.value:t;return 200!==this.validate(i)?{success:!1,message:"Validation failed: The value could not be updated."}:(this.value=(0,e.sw)(i),this.notify("value.changed",i),{success:!0,message:"The value has been successfully updated."})},restore(e){const{value:t}=e;this.setValue(t)},update:(e,t)=>!0,getCandidates:()=>[!0,!1],getChildren:e=>[],validate(t){return this.errors=[],(0,e.HD)(t)&&["true","false"].includes(t.toLowerCase())||Number.isInteger(t)&&[1,0].includes(t)||[!0,!1].includes(t)?200:400},copy(e=!0){if(!this.hasValue())return null;const t={name:this.name,nature:this.nature,value:this.getValue()};return e&&this.model.addValue(t),t},clone(){return{id:this.id,name:this.name,value:this.getValue()}},export(){return{id:this.id,name:this.name,root:this.isRoot(),value:this.getValue()}},toString(){return this.value},toXML(){let e=this.getName();return`<${e} id="${this.id}">`+this.getValue()+`</${e}>`}},z=Object.assign(Object.create(Z),F);function W(e,t){switch(e){case 400:return{success:!1,message:"The value is not a number."};case 401:return{success:!1,message:`Valid values: ${t}`};case 403:return{success:!1,message:`Maximum allowed: ${t.value}.`};case 402:return{success:!1,message:`Minimum allowed: ${t.value}.`};case 404:return{success:!1,message:`Value allowed: ${t.value}.`}}}const q={nature:"primitive",initValue(t){if((0,e.le)(t))return this.value=this.default,this;if((0,e.Kn)(t)){const{id:e="",value:i}=t;e.length>10&&(this.id=e),this.setValue(i)}else this.setValue(t);return this},hasValue(){return"number"==typeof this.value&&!isNaN(this.value)},getValue(){return this.hasValue()?+this.value:null},setValue(t){let i=(0,e.Kn)(t)?t.value:t;const{code:s,ctx:n}=this.validate(i);return this.value!==i&&(this.value=(0,e.hr)(i)?null:+i,this.notify("value.changed",i),this.propagate("value.changed",i,this)),200!==s?{success:!1,message:"Validation failed."}:{success:!0,message:"The value has been successfully updated."}},removeValue(){return this.value=null,this.notify("value.changed",this.value),{success:!0,message:"The value has been successfully updated."}},restore(e){const{value:t}=e;this.setValue(t)},getCandidates(){return this.values.forEach((t=>{(0,e.Kn)(t)&&(t.type="value")})),this.values},getChildren:e=>[],update:(e,t)=>!0,validate(t){if(this.errors=[],isNaN(t)){let e=400;return this.errors.push(W.call(this,e).message),{code:e}}if(!this.hasConstraint())return{code:200};if(this.hasConstraint("value")){let e=this.getConstraint("value");const{type:i}=e;if("range"===i){const{min:s,max:n}=e[i];if(s&&+t<s.value){let e=402;return this.errors.push(W.call(this,e,s).message),{code:e,ctx:s}}if(n&&+t>n.value){let e=403;return this.errors.push(W.call(this,e,n).message),{code:e,ctx:n}}}else if("fixed"===i){const{value:s}=e[i];if(t!==s){let t=404;return this.errors.push(W.call(this,t,e[i]).message),{code:t,ctx:e[i]}}}}if(this.hasConstraint("values")){let i=this.getConstraint("values").map((e=>U.call(this,e))).flat(),s=!1;for(let n=0;!s&&n<i.length;n++){const r=i[n];s=(0,e.Kn)(r)?r.value===t:r===t}if(!s){let e=401;return this.errors.push(W.call(this,e,i).message),{code:e,ctx:i}}}return{code:200}},copy(e=!0){if(!this.hasValue())return null;const t={name:this.name,nature:this.nature,value:this.getValue()};return e&&this.model.addValue(t),t},clone(){return{id:this.id,name:this.name,value:this.getValue()}},export(){return{id:this.id,name:this.name,root:this.isRoot(),value:this.getValue()}},toString(){return this.value},toXML(){let e=this.getName();return`<${e} id="${this.id}">`+this.getValue()+`</${e}>`}};function U(e){if("reference"===e.type){let e=[];return this.model.isPrototype("model concept")&&(e=this.model.getConceptsByPrototype("model concept")),e.map((e=>e.getChildren(this.name))).flat().map((e=>e.value))}return e}const G=Object.assign(Object.create(Z),q),K={nature:"primitive",reference:null,path:null,init(t={}){return this.parent=t.parent,this.ref=t.ref,this.accept=this.schema.accept,this.path=this.schema.path,this.values=(0,e.XI)(this.schema.values,[]),this.constraint=this.schema.constraint,this.errors=[],this.initObserver(),this.initAttribute(),this.initValue(t.value),this},initValue(t){return(0,e.le)(t)||this.setValue(t.value),this},restore(e){const{value:t}=e;this.setValue(t)},hasValue(){return!(0,e.hr)(this.value)},getValue(t=!1){return(0,e.le)(this.value)?null:t?this.reference:this.value},removeValue(){return this.reference&&this.reference.unregister(this),this.reference=null,this.value=null,this.notify("value.changed",this.value),{success:!0,message:"The value has been successfully updated."}},getReference(){return(0,e.le)(this.reference)?null:this.reference},setValue(t,i=!0){let s=(0,e.Kn)(t)?t.id:t;return 200!==this.validate(s)?{success:!1,message:"Validation failed: The value could not be updated."}:(0,e.le)(s)||this.value===s?{success:!0,message:"The value has been ignored."}:(this.reference&&this.reference.unregister(this),this.value=s,this.reference=this.model.getConcept(s),(0,e.le)(this.reference)&&i?setTimeout((()=>this.setValue(t,!1)),20):(this.reference.register(this),this.notify("value.changed",this.reference)),{success:!0,message:"The value has been successfully updated."})},getCandidates(){if((0,e.le)(this.accept))throw new Error("Bad reference: 'accept' property is not defined");var t=Q.call(this,this.accept);return this.path&&J(this,this.path).map((e=>({type:this.accept.type,value:e}))),t},getChildren(t){return(0,e.le)(this.reference)||t&&this.reference.name!==t?[]:[this.reference]},delete(e=!1){if(!e){const{object:e}=this.ref;let t={success:!0};if("concept"===e?t=this.getParent().removeValue(this):"attribute"===e&&(t=this.getParent().removeAttribute(this.ref.name)),!t.success)return t}return this.reference&&this.reference.unregister(this),this.model.removeConcept(this.id),this.notify("delete"),{message:`The concept '${name}' was successfully deleted.`,success:!0}},update(e,t){switch(e){case"delete":this.reference.unregister(this),this.value=null,this.reference=null,this.notify("value.changed",this.reference)}return!0},validate(t){return this.errors=[],(0,e.le)(t)||this.model.hasConcept(t)?200:(this.errors.push("This element is not valid"),401)},copy(e=!0){if(!this.hasValue())return null;const t={name:this.name,nature:this.nature,value:this.getValue()};return e&&this.model.addValue(t),t},clone(){return{id:this.id,name:this.name,value:this.getValue()}},export(){return{id:this.id,name:this.name,root:this.isRoot(),value:this.getValue()}},toString(){var e=[];return this.value.forEach((t=>{e.push(t.toString())})),e},toXML(){let e=this.getName();return`<${e} id="${this.id}">`+this.getValue()+`</${e}>`}};function Q(e){const{name:t,scope:i,rel:s}=e;return"parent"===s?this.getParent(i).getChildren(t):"children"===s?this.getChildren(t):this.model.isPrototype(t)?this.model.getConceptsByPrototype(t):this.model.getConcepts(t)}function J(t,i){if((0,e.le)(i))return t;const{target:s,value:n,rel:r}=i;var a=[];return"parent"===r?a.push(t.getParentWith(s)):"children"===r?a.push(...t.getChildren(s)):"property"===r&&a.push(t.getProperty(s)),a.map((e=>J(e,n))).flat()}const Y=Object.assign({},Z,K),ee={SUCCESS:200,INVALID_VALUE:401,MIN_CARDINALITY_ERROR:402,MAX_CARDINALITY_ERROR:403,FIX_CARDINALITY_ERROR:404};function te(e,t){switch(e){case ee.INVALID_VALUE:return{success:!1,message:`Valid values: ${t}`};case ee.MAX_CARDINALITY_ERROR:return{success:!1,message:`Maximum cardinality: ${this.value.length}/${t.value}.`};case ee.MIN_CARDINALITY_ERROR:return{success:!1,message:`Minimum cardinality: ${this.value.length}/${t.value}.`};case ee.FIX_CARDINALITY_ERROR:return{success:!1,message:`Fixed cardinality: ${t.value}.`};case ee.PATTERN_ERROR:return{success:!1,message:"The value is not valid."}}}const ie={nature:"primitive",init(t={}){return this.parent=t.parent,this.ref=t.ref,this.accept=this.schema.accept,this.ordered=(0,e.XI)(this.schema.ordered,!0),this.constraint=this.schema.constraint,this.watchers=new Map,this.value=[],this.initObserver(),this.initAttribute(),this.initValue(t.value),this},initValue(t){this.removeAllElement();let i=se.call(this);if((0,e.le)(t)){let e=i;for(let t=0;t<e;t++)this.createElement();return this}const{id:s="",name:n,value:r}=t;s.length>10&&(this.id=s);for(let e=0;e<r.length;e++)this.createElement(r[e]);let a=i-r.length;for(let e=0;e<a;e++)this.createElement();return this},hasValue(){return!(0,e.xb)(this.value)},getValue(e=!1){const t=this.value.map((e=>this.model.getConcept(e)));return e?t.map((e=>e.getValue())):t},removeValue(e){return this.hasValue()?(this.removeElement(e),{success:!0,message:"The value has been successfully updated."}):{success:!0,message:"The value has been successfully updated."}},isValidElement(t){const{name:i,accept:s}=this.accept;return this.model.isPrototype(i)?(0,e.le)(s)?this.model.hasPrototype(t.name,i):Array.isArray(s)?s.some((e=>e.name===t.name)):s.name===t.name:this.accept.name===t.name},setValue(e){let t=e.value||e;if(Array.isArray(t)){this.removeAllElement();for(let e=0;e<t.length;e++)this.createElement(t[e])}else this.isValidElement(t)&&this.createElement(t)},restore(e){const{value:t}=e;t.forEach(((e,t)=>{this.value.includes(e.id)||this.createElement(e)}))},getElements(){return this.value.map((e=>this.model.getConcept(e)))},getElement(t){var i=this.value.find((e=>e===t));if(!(0,e.le)(i))return this.model.getConcept(i)},getElementAt(e){if(!(e<0||e>=this.value.length))return this.model.getConcept(this.value[e])},getFirstElement(){return this.getElementAt(0)},getLastElement(){return this.getElementAt(this.count-1)},addElement(t){return!(0,e.le)(t)&&(this.value.push(t.id),t.index=this.value.length-1,this.validate(),this.notify("value.added",t),this.propagate("value.changed",t,this),!0)},addElementAt(t,i=0){return(0,e.le)(t)&&(t=this.createElement()),this.value.splice(i,0,t.id),this.validate(),this.notify("value.added",t),this.propagate("value.changed",t,this),this},swapElement(e,t){if(!this.ordered)return this;let i=this.value[e];this.value[e]=this.value[t],this.value[t]=i;let s=this.getElementAt(e);s.index=+e;let n=this.getElementAt(t);return n.index=+t,this.notify("value.swapped",[s,n]),this},removeElement(t){let i=(0,e.XI)(t.index,this.value.indexOf(t.id));return-1!==i&&this.removeElementAt(i)},removeElementAt(t){let i=this.getElementAt(t);if((0,e.le)(i))return{message:`The element at index '${t}' was not found.`,success:!1};i.delete(!0),this.value.splice(t,1);const s=this.getValue();for(let e=t;e<s.length;e++)s[e].index=e;return this.validate(),this.notify("value.removed",i),this.propagate("value.changed",i,this),{message:`The element '${i.name}' was successfully removed.`,success:!0}},removeAllElement(){return this.value.forEach((e=>{this.model.removeConcept(e)})),this.value=[],this.notify("value.changed",this.value),this.propagate("value.changed",this.value,this),this},createElement(e){const t={value:this.model.getValue(e),parent:this,ref:this},i=this.model.createConcept(this.accept,t);return this.addElement(i),i},getProperty(t,i){if("refname"===t)return this.ref.name;if("name"===t)return this.name;if("value"===t)return this.value;if("length"===t||"cardinality"===t)return this.value.length;let s=this.properties.find((e=>e.name===t));if((0,e.le)(s))return;const{type:n,value:r}=s;return"string"===n?r:"number"===n?+r:"boolean"===n?(0,e.sw)(r):r},hasProperty(e){return!!["refname","name","value","length","cardinality"].includes(e)||-1!==this.properties.findIndex((t=>t.name===e))},getCandidates(){return ne.call(this,this.accept)},getChildren(t){if(!this.hasValue())return[];const i=this.getElements();return(0,e.le)(t)?i:i.filter((e=>e.name===t))},validate(){if(this.errors=[],!this.hasConstraint())return{code:ee.SUCCESS};if(this.hasConstraint("cardinality")){let e=this.getConstraint("cardinality");const{type:t}=e;if("range"===t){const{min:i,max:s}=e[t];if(i&&this.value.length<i.value){let e=ee.MIN_CARDINALITY_ERROR;return this.errors.push(te.call(this,e,i).message),{code:e,ctx:i}}if(s&&this.value.length>s.value){let e=ee.MAX_CARDINALITY_ERROR;return this.errors.push(te.call(this,e,s).message),{code:e,ctx:s}}}else if("fixed"===t){const{value:i}=e[t];if(this.value.length!==i){let i=ee.FIX_CARDINALITY_ERROR;return this.errors.push(te.call(this,i,e[t]).message),{code:i,ctx:e[t]}}}}return{code:ee.SUCCESS}},copy(e=!0){if(!this.hasValue())return null;const t={name:this.name,nature:this.nature,value:this.getValue().map((e=>e.copy(!1)))};return e&&this.model.addValue(t),t},clone(){return{id:this.id,name:this.name,value:this.getValue().map((e=>e.clone()))}},export(){return{id:this.id,name:this.name,root:this.isRoot(),value:this.value}},toString(){return this.getValue().map((e=>e.toString()))},toXML(){let e=this.getName();return`<${e} id="${this.id}">`+this.getValue().map((e=>e.toXML())).join("")+`</${e}>`}};function se(){if(!this.hasConstraint("cardinality"))return 0;const e=this.getConstraint("cardinality"),{type:t}=e;if("range"===t){const{min:i}=e[t];return i.value}if("fixed"===t){const{value:i}=e[t];return i}return 0}function ne(e){return this.model.getConceptSchema(e)}const re=Object.assign(Object.create(Z),ie);Object.defineProperty(re,"count",{get(){return this.value.length}}),Object.defineProperty(re,"canAddValue",{get:()=>!0});const ae=200,le=405;function oe(e,t){switch(e){case 401:return{success:!1,message:`Valid values: ${t}`};case 403:return{success:!1,message:`Maximum length: ${t.value}.`};case 402:return{success:!1,message:`Minimum length: ${t.value}.`};case 404:return{success:!1,message:`Fixed length: ${t.value}.`};case le:return{success:!1,message:"The value is not valid."};case 406:return{success:!1,message:"The value is already used."}}}const ce={nature:"primitive",initValue(t){if((0,e.le)(t))return this.value=this.default,this;if((0,e.Kn)(t)){const{id:e="",value:i}=t;e.length>10&&(this.id=e),this.setValue(i)}else this.setValue(t);return this},restore(e){const{value:t}=e;this.setValue(t)},hasValue(){return!(0,e.hr)(this.value)},getValue(){return this.value},removeValue(){return this.value=null,this.notify("value.changed",this.value),{success:!0,message:"The value has been successfully updated."}},setValue(t){let i=(0,e.Kn)(t)?t.value:t;var{code:s,ctx:n}=this.validate(i);return this.value!==i&&(this.value=i,this.notify("value.changed",i),this.propagate("value.changed",i,this)),s!==ae?{success:!1,message:"Validation failed."}:{success:!0,message:"The value has been successfully updated."}},getProperty(t,i){if("refname"===t)return this.ref.name;if("name"===t)return this.name;if("value"===t)return this.value;if("length"===t)return this.value.length;let s=this.properties.find((e=>e.name===t));if((0,e.le)(s))return;const{type:n,value:r}=s;return"string"===n?r:"number"===n?+r:"boolean"===n?(0,e.sw)(r):r},hasProperty(e){return!!["refname","name","value","length"].includes(e)||-1!==this.properties.findIndex((t=>t.name===e))},getCandidates(){let i=(0,e.XI)(this.getConstraint("values"),[]);return(0,e.xb)(i)?[...this.src.map((i=>{if("reference"===i.type){const{source:s,target:n}=i;let r=this.model.environment.getModel(s.name||s);if((0,e.le)(r))return null;let a=r.concept||r;if(!Array.isArray(a))return null;if(a.forEach((i=>{const s=function(i,s){var n=s;const r=[],a=s=>{let n=i.find((e=>e.name===s));if(!(0,e.le)(n))return(0,t.p$)(n)};for(;!(0,e.le)(n);){const t=(0,e.XI)(a(n),{});l=t.attributes,Array.isArray(l)&&l.forEach((t=>{const i=r.find((e=>e.name===t.name));(0,e.le)(i)?r.push(t):t.required&&(i.required=t.required)})),n=t.prototype}var l;return{attributes:r}}(a,i.prototype);i.attributes.push(...s.attributes)})),(0,e.le)(n.rel))return a.map((e=>e[n.value]));let l=ue.call(this,n,a);return(0,e.le)(l)?[]:l}if("concept"===i.type){const{concept:e,value:t}=i;let s=this.model.getConceptsByPrototype(e.prototype);return console.log(s),"attribute"===t.type?s.map((e=>e.getAttribute(t.name).getValue())):[]}return i}))].flat().filter((t=>!(0,e.le)(t))):i.map((e=>he.call(this,e))).flat().filter((t=>!(0,e.hr)(t)))},getChildren:e=>[],update:(e,t)=>!0,validate(t){if(this.errors=[],(0,e.hr)(t))return{code:ae};if(!this.hasConstraint())return{code:ae};if(this.hasConstraint("length")){let e=this.getConstraint("length");const{type:i}=e;if("range"===i){const{min:s,max:n}=e[i];if(s&&t.length<s.value){let e=402;return this.errors.push(oe.call(this,e,s).message),{code:e,ctx:s}}if(n&&t.length>n.value){let e=403;return this.errors.push(oe.call(this,e,n).message),{code:e,ctx:n}}}else if("fixed"===i){const{value:s}=e[i];if(t.length!==s){let t=404;return this.errors.push(oe.call(this,t,e[i]).message),{code:t,ctx:e[i]}}}}if(this.hasConstraint("value")){let e=this.getConstraint("value");const{type:i}=e;if("pattern"===i){const{value:i,insensitive:s=!0,global:n=!0}=e.pattern;let r="";if(s&&(r+="g"),n&&(r+="i"),!new RegExp(i,r).test(t)){let t=le;return this.errors.push(oe.call(this,t,e.pattern).message),{code:t,ctx:e.pattern}}}else if(i==="match".startsWith){const{start:s,end:n}=e[i];if(s&&!t.startsWith<s.value){let t=le;return this.errors.push(oe.call(this,t,e.match).message),{code:t,ctx:e.match}}if(n&&t.length>n.value){let t=le;return this.errors.push(oe.call(this,t,e.match).message),{code:t,ctx:e.match}}}else if("unique"===i){const{rel:i="parent",prototype:s}=e.unique;let n=this.getParent(),r=[];if(s?(n.hasPrototype()||(r=[]),r=this.model.getConceptsByPrototype(n._prototype)):r=this.model.getConcepts(n.name),r.some((e=>e!==n&&pe(e,this.ref.name)===t))){let t=406;return this.errors.push(oe.call(this,t,e.unique).message),{code:t,ctx:e.unique}}}}if(this.hasConstraint("values")){let i=this.getConstraint("values").map((e=>he.call(this,e))).flat(),s=!1;for(let n=0;!s&&n<i.length;n++){const r=i[n];s=(0,e.Kn)(r)?r.value===t:r===t}if(!s){let e=401;return this.errors.push(oe.call(this,e,i).message),{code:e,ctx:i}}}return{code:ae}},copy(e=!0){if(!this.hasValue())return null;const t={name:this.name,nature:this.nature,value:this.getValue()};return e&&this.model.addValue(t),t},clone(){return{id:this.id,name:this.name,value:this.getValue()}},export(){return{id:this.id,name:this.name,root:this.isRoot(),value:this.getValue()}},toString(){return this.value},toXML(){let e=this.getName();return`<${e} id="${this.id}">`+this.getValue()+`</${e}>`}};function he(e){if("reference"===e.type){let e=[];return this.model.isPrototype("model concept")&&(e=this.model.getConceptsByPrototype("model concept")),e.map((e=>e.getChildren(this.name))).flat().map((e=>e.value))}if("meta-reference"===e.type){let e=[];return this.model.isPrototype("model concept")&&(e=this.model.getConceptsByPrototype("model concept")),e.map((e=>e.getChildren(this.name))).flat().map((e=>e.value))}return e}function ue(t,i){const{name:s,rel:n,scope:r,value:a}=t;let l=null;if("parent"===n){let t=this.getParent(s);if((0,e.le)(a))return t;if("reference"===a.type)return ue.call(t,a);if("attribute"===a.type)return t.getAttributeByName(a.name).getValue()}if("children"===n){let t=this.getChildren(s);if((0,e.le)(a))return t;if("reference"===a.type)return t.map((e=>ue.call(e,a)));if("attribute"===a.type)return t.filter((e=>fe(e,a.name)&&me(e,a.name))).map((e=>pe(e,a.name)))}if(t.source){const{type:e,value:i}=t.source;l="reference"===e?ue.call(this,t.source):i}if((0,e.le)(l))return i.map((e=>e[s].map((e=>e[a]))));if((0,e.TW)(l)&&(0,e.xb)(l))return[];let o=i.find((e=>Array.isArray(l)?l.includes(e.name):e.name===l));return(0,e.le)(o)||!(0,e.RI)(o,s)?[]:o[s].map((e=>e[a]))}const de=(e,t)=>e.getAttributeByName(t).target,pe=(e,t)=>de(e,t).getValue(),me=(e,t)=>de(e,t).hasValue(),fe=(e,t)=>e.isAttributeCreated(t),ge=Object.assign(Object.create(Z),ce),ve={nature:"concrete",initValue(t){if((0,e.le)(t))return!1;const{id:i="",attributes:s=[]}=t;return i.length>10&&(this.id=i),s.forEach((e=>{const{name:t,id:i,value:s}=e;this.createAttribute(t,s)})),!0},restore(e){const{attributes:t}=e;t.forEach((e=>{const{name:t,id:i,value:s}=e;this.isAttributeCreated(t)||this.createAttribute(t,s)}))},hasValue:()=>!0,getValue(){return{name:this.name,attributes:this.getAttributes().map((e=>({name:e.name,value:e.copy(!1)})))}},setValue(e){const{attributes:t=[]}=e;return t.forEach((e=>{const{name:t,id:i,value:s}=e;this.hasAttribute(t)&&this.createAttribute(t,s)})),!0}},be=Object.assign(Object.create(Z),ve),ye=200;function we(e){switch(e){case 401:return{success:!1,message:"The value is not included in the list of valid values."}}}const Ee={name:"prototype",nature:"prototype",initValue(t){if((0,e.le)(t)){if(this.default){let e=this.createConcept(this.default);this.setValue(e)}return this}const{id:i="",value:s}=t;i.length>10&&(this.id=i);let n=null;return s?(n=this.createConcept(s.name,s),this.setValue(n)):t.name&&t.attributes&&(n=this.createConcept(t.name,t),this.setValue(n)),this},getValue(t=!1){return(0,e.le)(this.value)?null:t?this.target:this.value},getTarget(){return this.target},restore(t){const{value:i}=t;if((0,e.le)(i))return;let s=this.createConcept(i.name,i);this.setValue(s)},setValue(t){let i=t.name||t;if(this.validate(i)!==ye)return{success:!1,message:"Validation failed: The value could not be updated."};let s=t;if(t&&"concept"===t.object&&(0,e.RI)(t,"id")||(s=t.attributes?this.createConcept(i,t):this.createConcept(i)),this.target){let e=this.target.copy(!1);this.target.delete(!0),s.setValue(e)}return this.target=s,this.value=i,this.notify("value.changed",this.getCandidates().find((e=>e.name===this.value))),{success:!0,message:"The value has been successfully updated."}},removeValue(){return(0,e.le)(this.value)||(this.value=null,this.notify("value.changed",this.value)),{success:!0,message:"The value has been successfully updated."}},hasValue(){return!(0,e.le)(this.value)},getCandidates(){return this.candidates||(this.candidates=Ce.call(this,this.schema.accept).map((e=>({type:"meta-concept",name:e.name,concept:Object.create(je,{object:{value:"meta-concept"},type:{value:"meta-concept"},name:{value:e.name},model:{value:this.model},schema:{value:e}})})))),this.candidates},getChildren(t){if(!this.hasValue())return[];const i=[];return((0,e.le)(t)||this.target.name===t)&&i.push(this.target),i},createConcept(e,t){let i=this.model.getValue(t);const s={parent:this,ref:this};i&&(s.value=i);const n=this.model.createConcept(e,s);return n.prototype=this,n},validate(t){if((0,e.hr)(t))return ye;if((0,e.xb)(this.values))return ye;var i=!1;for(let s=0;!i&&s<this.values.length;s++){const n=this.values[s];i=(0,e.Kn)(n)?n.value===t:n===t}if(!i){let e=401;return this.errors.push(we.call(this,e).message),e}return ye},copy(e=!0){if(!this.hasValue())return null;const t={name:this.name,nature:this.nature,value:this.target.copy(!1)};return e&&this.model.addValue(t),t},clone(){let e=null;return this.hasValue()&&(e=this.target.clone()),{id:this.id,name:this.name,value:e}},export(){let e=null;return this.hasValue()&&(e={id:this.target.id,name:this.target.name}),{id:this.id,name:this.name,root:this.isRoot(),value:e}},toXML(){if(!this.hasValue())return"";let e=this.getName();return`<${e} id="${this.id}">`+this.target.attributes.map((e=>e.toXML())).join("")+`</${e}>`}};function Ce(t){const i=this.model.getConcreteConcepts(this.name);return(0,e.le)(t)?i:Array.isArray(t)?i.filter((e=>t.some((t=>t.name===e.name)))):i.filter((e=>t===e.name))}const je={getProperty(t,i){if("refname"===t)return this.name;if("name"===t)return this.name;let s=this.properties.find((e=>e.name===t));if((0,e.le)(s))return;const{type:n,value:r}=s;return"string"===n?r:"number"===n?+r:"boolean"===n?(0,e.sw)(r):r},hasPrototype(t){if((0,e.le)(this.schema.prototype))return!1;let i=this.model.getConceptSchema(this.schema.prototype);for(;!(0,e.le)(i);){if(i.name===t)return!0;i=this.model.getConceptSchema(i.prototype)}return!1}},Le=Object.assign({},Z,Ee);function xe(e){switch(e){case 401:return{success:!1,message:"The value is not included in the list of valid values."}}}const Re={name:"meta",reference:null,initValue(t){return(0,e.le)(t)||this.setValue(t.value),this},hasValue(){return!(0,e.hr)(this.value)},getValue(){return(0,e.le)(this.value)?null:this.value},getProperty(t){const i=this.schema[t];if((0,e.Kn)(i)){const e=[];for(const t in i){const s=i[t];e.push(Object.assign({},{name:t},s))}return e}return i},setValue(t){var i=this.validate(t);return 200!==i?{success:!1,message:"Validation failed: The value could not be updated.",errors:[xe(i).message]}:(0,e.le)(t)||this.value===t?void 0:(this.reference&&this.reference.unregister(this),this.reference=this.model.getConcept(t),this.reference.register(this),this.value=t,this.notify("value.changed",this.reference),{success:!0,message:"The value has been successfully updated."})},getChildren:e=>[],delete(e=!1){if(!e){let e=this.getParent().remove(this);if(!e.success)return e}return this.reference&&this.reference.unregister(this),this.model.removeConcept(this.id),this.notify("delete"),{message:`The concept '${name}' was successfully deleted.`,success:!0}},update(e,t){switch(e){case"delete":this.reference.unregister(this),this.value=null,this.reference=null,this.notify("value.changed",this.reference)}return!0},validate(t){return(0,e.hr)(t)||(0,e.xb)(this.values),200},export(){return{id:this.id,name:this.name,value:this.value}},toString(){var e=[];return this.value.forEach((t=>{e.push(t.toString())})),e}},Ie=Object.assign({},Z,Re);function Ae(e,t){return{object:{value:"concept"},type:{value:"concept"},model:{value:e},name:{value:t.name},base:{value:t.base},schema:{value:t,writable:!0}}}const Oe={boolean:(e,t)=>Object.create(z,Ae(e,t)),number:(e,t)=>Object.create(G,Ae(e,t)),reference:(e,t)=>Object.create(Y,Ae(e,t)),set:(e,t)=>Object.create(re,Ae(e,t)),string:(e,t)=>Object.create(ge,Ae(e,t)),meta:(e,t)=>Object.create(Ie,Ae(e,t))},Ve={primitive:(e,t)=>Oe[t.name](e,t),prototype:(e,t)=>Object.create(Le,Ae(e,t)),concrete:(e,t)=>Object.create(be,Ae(e,t)),derivative:(e,t)=>Oe[t.base](e,t)},Se={createConcept(t,i,s){const{name:n,nature:r}=i,a=Ve[r];if((0,e.le)(a))throw new Error(`Missing handler: The '${n}' concept could not be handled`);const l=a(t,i);if((0,e.le)(l))throw new Error(`Bad request: The '${n}' concept could not be created`);return l.init(s),(0,e.le)(l.id)&&(l.id=T.h.generate()),l}};var _e=0;const Te={concepts:null,values:null,listeners:null,get hasError(){return this.concepts.some((e=>e.hasError))},init(e){return this.concepts=[],this.values=[],this.listeners=[],Array.isArray(e)&&(this.values=e,e.filter((e=>e.root)).forEach((e=>{this.createConcept({name:e.name},{value:e})})),this.values=e.filter((e=>e.id.startsWith("value")))),this},done(){return this.concepts.forEach((e=>{e.done()})),this.concepts=[],!0},createConcept(e,t){const i=this.getCompleteModelConcept(e);var s=Se.createConcept(this,i,t);return this.addConcept(s),s},getConcepts(t){if((0,e.TW)(t)){const e=Array.isArray(t)?e=>t.includes(e.name):e=>e.name===t;return this.concepts.filter((t=>e(t)))}return this.concepts.slice()},getRootConcepts(){return this.concepts.filter((e=>e.isRoot()))},getConceptsByPrototype(e){return this.concepts.filter((t=>t.hasPrototype(e)))},getConcept(t){if(!(0,e.HD)(t)||(0,e.xb)(t))throw new TypeError("Bad request: The 'id' argument must be a non-empty string");return this.concepts.find((e=>e.id===t))},addConcept(t){if((0,e.le)(t))throw new TypeError("Bad request: The 'concept' argument must be a Concept");return this.concepts.push(t),t.register(this.environment),this},removeConcept(t){if(!(0,e.Kn)(t)&&!(0,e.HD)(t))throw new TypeError("Bad request: The 'id' argument must be a non-empty string");var i=this.concepts.findIndex((e=>e.id===t));return-1===i?null:this.concepts.splice(i,1)[0]},hasConcept(t){if(!(0,e.Kn)(t)&&!(0,e.HD)(t))throw new TypeError("Bad request: The 'id' argument must be a non-empty string");if((0,e.xb)(this.concepts))return!1;let i=t.id||t;return t.name,this.concepts.some((e=>e.id===i))},getValues(t){if((0,e.TW)(t)){const e=Array.isArray(t)?e=>t.includes(e.name):e=>e.name===t;return this.values.filter((t=>e(t)))}return this.values.slice()},getValue(t){return(0,e.le)(t)?null:(0,e.RI)(t,"value")||(0,e.RI)(t,"attributes")?t:(0,e.RI)(t,"id")?this.values.find((e=>e.id===t.id)):this.values.find((e=>e.id===t))},addValue(t){if((0,e.le)(t))throw new TypeError("Bad request: The 'value' argument must be a Value");return this.values.some((e=>{return s=t,(i=e).name===s.name&&(i.value?i.value===s.value:JSON.stringify(i.attributes)===JSON.stringify(s.attributes));var i,s}))||(t.id="value"+_e++,this.values.push(t),this.notify("value.added",t)),this},removeValue(t){if(!(0,e.Kn)(t)&&!(0,e.HD)(t))throw new TypeError("Bad request: The 'id' argument must be a non-empty string");var i=this.values.findIndex((e=>e.id===t));if(-1===i)return null;let s=this.values.splice(i,1)[0];return this.notify("value.removed",s),s},register(e){return this.listeners.includes(e)||this.listeners.push(e),!0},unregister(e){let t=this.listeners.indexOf(e);return-1!==t&&(this.listeners.splice(t,1),!0)},unregisterAll(){this.listeners=[]},notify(e,t){this.listeners.forEach((i=>{i.update(e,t)}))},isConcept(t){return!!(0,e.HD)(t)&&-1!==this.schema.findIndex((e=>e.name===t))},isConcrete(t){if(!(0,e.HD)(t))return!1;const i=this.schema.find((e=>e.name===t));return!(0,e.le)(i)&&"concrete"===i.nature},isPrototype(t){if(!(0,e.HD)(t))return!1;const i=this.schema.find((e=>e.name===t));return!(0,e.le)(i)&&"prototype"===i.nature},hasPrototype(t,i){if(!this.isConcept(t))return!1;let s=this.getConceptSchema(t);for(;!(0,e.le)(s);){if(s.prototype===i)return!0;s=this.model.getConceptSchema(s.prototype)}return!1},addConceptSchema(e){return this.schema.push(...e),this.environment.update("concept-model.updated"),!0},getSchema(t){if((0,e.TW)(t)){const e=Array.isArray(t)?e=>t.includes(e.nature):e=>e.nature===t;return this.schema.filter((t=>e(t)))}return this.schema.slice()},getConceptSchema(i){const s=Me(this.schema,i);if(!(0,e.le)(s))return(0,t.p$)(s)},getCompleteModelConcept(t){let i=t;(0,e.HD)(t)&&(i={name:t});const s=this.getConceptSchema(i.name);if((0,e.le)(s))return;Object.assign(s,i),(0,e.RI)(s,"attributes")||(s.attributes=[]);const n=He.call(this,s.prototype);return s.attributes.push(...n.attributes),s},getConcreteConcepts(t){const i=i=>{for(var s=i.prototype;!(0,e.le)(s);){if(s===t)return!0;s=(0,e.XI)(Me(this.schema,s),{}).prototype}return!1},s=this.schema.filter((e=>"concrete"===e.nature));return t?s.filter((e=>i(e))):s},getDerivedConcepts(t){if((0,e.le)(t))throw new TypeError("Bad argument");return this.schema.filter((e=>e.base===t))},export(){const e=[];return this.getConcepts().forEach((t=>{e.push(t.export())})),e.push(...this.getValues()),e},toString(){return JSON.stringify({[this.root.name]:this.root.toString()})},toXML(){return"<model:gentleman>"+this.getRootConcepts().map((e=>e.toXML())).join("")+"</model:gentleman>"}};function He(t){var i=t;const s=[];for(;!(0,e.le)(i);){const t=(0,e.XI)(this.getConceptSchema(i),{});n=t.attributes,Array.isArray(n)&&n.forEach((t=>{const i=s.find((e=>e.name===t.name));(0,e.le)(i)?s.push(t):t.required&&(i.required=t.required)})),i=t.prototype}var n;return{attributes:s}}const ke=[{name:"string",nature:"primitive"},{name:"number",nature:"primitive"},{name:"boolean",nature:"primitive"},{name:"reference",nature:"primitive"},{name:"set",nature:"primitive"}];function Me(t,i){let s=t.find((e=>e.name===i));return(0,e.le)(s)&&(s=ke.find((e=>e.name===i))),s}const $e=[],Pe={createModel(t,i){var s=Object.create(Te,{schema:{value:(0,e.XI)(t,[])},environment:{value:i}});return $e.push(s),s}};function Ne(t){const{type:i}=t;let s=this.concept||this.source;return"property"===i?(0,e.XI)(s.getProperty(t.name),""):"param"===i?this.projection.getParam(t.name):t}const De={css:function(t,i){return(0,e.TW)(i)?(ze(t,i),t):t},ref:function(t,i){return(0,e.TW)(i)?(i.forEach((i=>{const{style:s={}}=(0,e.XI)(this.model.getStyleSchema(i),{});s.gss?Xe.call(this,t,s):Ze.call(this,t,s)})),t):t},gss:Ze,text:Fe,box:Ge,html:function(t,i){return(0,e.TW)(i)?(i.forEach((i=>{let s=`style${(0,e.fm)(i.name)}`;t.dataset[s]=Ne.call(this,i.value),"property"===i.value.type&&this.registerHandler("value.changed",(e=>{t.dataset[s]=Ne.call(this,i.value)}))})),t):t}},Be={text:Fe,box:Ge};function Xe(t,i){if(!(0,e.Kn)(i))return t;for(const s in i){const n=i[s];let r=De[s];(0,e.mf)(r)&&r.call(this,t,n)}return t}function Ze(t,i){if(!(0,e.Kn)(i))return t;for(const s in i){const n=i[s];let r=Be[s];(0,e.mf)(r)&&r.call(this,t,n)}return t}function Fe(e,t){for(const i in t){const s=t[i];if(!1!==s)switch(i){case"bold":e.style.fontWeight=qe(s);break;case"italic":e.style.fontStyle="italic";break;case"underline":e.style.textDecoration="underline";break;case"strikethrough":e.style.textDecoration="line-through";break;case"color":e.style.color=We(s);break;case"font":e.style.fontFamily=s.toString();break;case"size":e.style.fontSize=Ue(s);break;case"transform":e.style.textTransform=s}}return e}function ze(t,i){if(Array.isArray(i))t.classList.add(...i);else{let s=i.replace(/\s+/g," ").trim();(0,e.hr)(t.className)?t.className=s:ze(t,s.split(" "))}return t}function We(t){if((0,e.le)(t))return"";const{type:i,value:s}=t;switch(i){case"rgb":return(0,e.Kn)(s)?`rgb(${s.red}, ${s.green}, ${s.blue})`:s;case"rgba":return(0,e.Kn)(s)?`rgba(${s.red}, ${s.green}, ${s.blue}, ${s.opacity/100})`:s;case"name":case"hexadecimal":return s;default:return s||t}}function qe(t){if((0,e.le)(t))return"";const{type:i,value:s}=t;return Number.isInteger(t)?`${t}`:"bold"}function Ue(t){if((0,e.le)(t))return"";const{value:i,unit:s}=t;return(0,e.le)(i)?"":`${i}${s}`}function Ge(e,t){for(const i in t){const s=t[i];if(!1!==s)switch(i){case"inner":Ke.call(this,e,s,"padding");break;case"outer":Ke.call(this,e,s,"margin");break;case"border":Ye.call(this,e,s);break;case"corner":et.call(this,e,s);break;case"background":Qe.call(this,e,s);break;case"width":e.style.width=Ue.call(this,s);break;case"height":e.style.height=Ue.call(this,s);break;case"opacity":e.style.opacity=s/100;break;case"shadow":Je.call(this,e,s,"shadow")}}return e}function Ke(t,i,s){if(!(0,e.le)(i))for(const e in i){const n=i[e];switch(e){case"all":t.style[`${[s]}`]=Ue.call(this,n);break;case"top":t.style[`${[s]}Top`]=Ue.call(this,n);break;case"right":t.style[`${[s]}Right`]=Ue.call(this,n);break;case"bottom":t.style[`${[s]}Bottom`]=Ue.call(this,n);break;case"left":t.style[`${[s]}Left`]=Ue.call(this,n)}}}function Qe(t,i){if((0,e.le)(i))return;const{color:s,image:n}=i;s&&(t.style.backgroundColor=We.call(this,s)),n&&(t.style.backgroundImage=`url(${n})`)}function Je(t,i){if((0,e.le)(i))return null;const{offsetX:s,offsetY:n,blur:r,spread:a,inset:l=!1,color:o}=i;if((0,e.le)(s)||(0,e.le)(n))return null;let c=Ue.call(this,s),h=Ue.call(this,n),u=Ue.call(this,r),d=Ue.call(this,a),p=We.call(this,o);t.style.boxShadow=l?`inset ${c} ${h} ${u} ${d} ${p}`.trim():`${c} ${h} ${u} ${d} ${p}`.trim()}function Ye(t,i){if(!(0,e.le)(i))for(const s in i){const n=i[s];switch(s){case"all":t.style.borderStyle=(0,e.XI)(n.type,"solid"),t.style.borderWidth=Ue.call(this,n.width),t.style.borderColor=We.call(this,n.color);break;case"top":t.style.borderTopStyle=(0,e.XI)(n.type,"solid"),t.style.borderTopWidth=Ue.call(this,n.width),t.style.borderTopColor=We.call(this,n.color);break;case"right":t.style.borderRightStyle=(0,e.XI)(n.type,"solid"),t.style.borderRightWidth=Ue.call(this,n.width),t.style.borderRightColor=We.call(this,n.color);break;case"bottom":t.style.borderBottomStyle=(0,e.XI)(n.type,"solid"),t.style.borderBottomWidth=Ue.call(this,n.width),t.style.borderBottomColor=We.call(this,n.color);break;case"left":t.style.borderLeftStyle=(0,e.XI)(n.type,"solid"),t.style.borderLeftWidth=Ue.call(this,n.width),t.style.borderLeftColor=We.call(this,n.color)}}}function et(t,i){if((0,e.le)(i))return null;for(const e in i){const s=i[e];switch(e){case"all":t.style.borderRadius=Ue.call(this,s);break;case"top-left":t.style.borderTopLeftRadius=Ue.call(this,s);break;case"top-right":t.style.borderTopRightRadius=Ue.call(this,s);break;case"bottom-right":t.style.borderBottomRightRadius=Ue.call(this,s);break;case"bottom-left":t.style.borderBottomLeftRadius=Ue.call(this,s)}}}function tt(t,i){if(!Array.isArray(i))return!1;t.currentState=null;for(let s=0;s<i.length;s++){const n=i[s],{rule:r,result:a}=n;if((0,e.le)(r))return a;let l=!1,o=it[r.type];if((0,e.mf)(o)&&(l=o.call(this,r[r.type])),l)return t.currentState=s,a}return null}const it={ref:function(t){const{rule:i={}}=(0,e.XI)(this.model.getRuleSchema(t),{});let s=it[i.type];return!!(0,e.mf)(s)&&s.call(this,i[i.type])},eq:function(e){if(!Array.isArray(e))throw new TypeError("Terms need to be an array");if(e.length<2)return null;return st.call(this,e[0])==st.call(this,e[1])},ne:function(e){if(!Array.isArray(e))throw new TypeError("Terms need to be an array");if(e.length<2)return null;return st.call(this,e[0])!=st.call(this,e[1])},lt:function(e){if(!Array.isArray(e))throw new TypeError("Terms need to be an array");if(e.length<2)return null;return st.call(this,e[0])<st.call(this,e[1])},le:function(e){if(!Array.isArray(e))throw new TypeError("Terms need to be an array");if(e.length<2)return null;return st.call(this,e[0])<=st.call(this,e[1])},gt:function(e){if(!Array.isArray(e))throw new TypeError("Terms need to be an array");if(e.length<2)return null;return st.call(this,e[0])>st.call(this,e[1])},ge:function(e){if(!Array.isArray(e))throw new TypeError("Terms need to be an array");if(e.length<2)return null;return st.call(this,e[0])>=st.call(this,e[1])},and:function(e){return nt.call(this,e[0])&&nt.call(this,e[1])},or:function(e){return nt.call(this,e[0])||nt.call(this,e[1])},not:function(e){return!nt.call(this,e[0])},no:function(t){let i=st.call(this,t);return(0,e.TW)(i)?(0,e.xb)(i):(0,e.le)(i)}};function st(t,i){if(t&&"property"===t.type){const{name:i}=t;let s=`get${(0,e.Ho)(i)}`;return this[s]?this[s]():this[i]}if(t&&"param"===t.type){const{name:e}=t;return this.projection.getParam(e)}if((0,e.Kn)(t)){let i=`get${(0,e.Ho)(t.prop)}`;return this[i]?this[i]():this[t.prop]}return i||t}function nt(t){let i=it[t.type];return(0,e.mf)(i)?i.call(this,t[t.type]):(0,e.sw)(st.call(this,t))}const rt={init(){throw new Error("This function has not been implemented")},element:null,statusElement:null,attached:null,children:null,readonly:!1,visible:!1,disabled:!1,active:!1,focused:!1,get hasError(){return this.source.hasError},get hasAttached(){return!(0,e.xb)(this.attached)},attach(e,t){this.attached.push(e)},detach(e){this.attached.slice(this.attached.indexOf(e),1)},getAttached(t){return(0,e.mf)(t)?this.attached.filter((e=>t(e))):this.attached},show(){return(0,t.$Z)(this.element),this.visible=!0,this.active=!0,this},hide(){return(0,t.Cp)(this.element),this.visible=!1,this},toggle(){return(0,t.ZN)(this.container),this.visible=!this.visible,this},focus(e){return this.element.contentEditable=!1,this.element.focus(),this.focused=!0,this},getContainer(){return this.element},notify(e,i,s){(0,t.lL)(this.element),this.environment.notify(e,i)},append(t){if(!(0,e.Re)(t))throw new TypeError("Bad argument: The 'element' argument must be an HTML Element");return this.element.append(t),this},_focusIn:e=>!1,enable(){return this.disabled=!1,this},disable(){return this.disabled=!0,this},clear:()=>!0,delete(){var i=this.source.delete();i.success?(this.clear(),(0,e.ep)(this.element),this.element.remove()):(this.environment.notify(i.message),(0,t.lL)(this.element))},spaceHandler(e){return console.warn(`SPACE_HANDLER NOT IMPLEMENTED FOR ${this.name}`),!1},_spaceHandler(e){return console.warn(`CTRL_SPACE_HANDLER NOT IMPLEMENTED FOR ${this.name}`),!1},escapeHandler(e){return console.warn(`ESCAPE_HANDLER NOT IMPLEMENTED FOR ${this.name}`),!1},enterHandler(e){this.focusOut()},deleteHandler(i){if(this.projection.element!==this)return(0,t.lL)(i),!1;if(!this.projection.optional)return(0,t.lL)(this.element),!1;let s=(0,e.wr)(i,(e=>0===e.tabIndex)),n=this.container.cloneNode(!0);this.source.hasParent()&&this.environment.save(this.source.getParent(),n),this.source.delete();let r=this.environment.resolveElement(s);return(0,e.le)(r)||r.focus(),!1},backspaceHandler(e){return console.warn(`BACKSPACE_HANDLER NOT IMPLEMENTED FOR ${this.name}`),!1},arrowHandler(e,t){return console.warn(`ARROW_HANDLER NOT IMPLEMENTED FOR ${this.name}`),!1},_arrowHandler(e,t){return console.warn(`CTRL_ARROW_HANDLER NOT IMPLEMENTED FOR ${this.name}`),!1},clickHandler(e){return console.warn(`CLICK_HANDLER NOT IMPLEMENTED FOR ${this.name}`),!1},controlHandler(e){this.toolbar&&this.toolbar.remove()},shiftHandler(e,t){return console.warn(`SHIFT_HANDLER NOT IMPLEMENTED FOR ${this.name}`),!1}},at=Object.assign(rt);function lt(t){const{type:i}=t;return"property"===i?(this.hasProperty=!0,(0,e.XI)(this.source.getProperty(t.name),"")):"param"===i?this.projection.getParam(t.name):"html"===i?(0,e.Bv)(t.html):"raw"===i?(0,e.Bv)(t.raw):t}const ot={input:null,label:null,value:"",state:null,init(){const{focusable:e=!0}=this.schema;return this.focusable=e,this.children=[],this},refresh(){if((0,e.XI)(tt.call(this,this.schema,this.schema.state),this.schema),this.schema.state){let t=this.schema.state[this.getValue().toString()];if(t&&t.content){const{style:i,content:s,value:n}=t;let r=(0,e.DZ)();s.forEach((e=>{r.append(ji.call(this,e))})),(0,e.ep)(this.label).append(r),Xe.call(this.projection,this.label,i)}}this.input.checked?this.element.dataset.state="on":this.element.dataset.state="off",this.hasError?(this.element.classList.add("error"),this.input.classList.add("error")):(this.element.classList.remove("error"),this.input.classList.remove("error"))},render(){const i=(0,e.DZ)(),{checkbox:s}=this.schema;var n;if((0,e.Re)(this.element)||(this.element=(n=this.id,(0,e.wC)({id:n,class:["field","field--binary"],tabindex:-1,dataset:{nature:"field",view:"binary",id:n}})),this.readonly&&this.element.classList.add("readonly"),Xe.call(this.projection,this.element,this.schema.style)),!(0,e.Re)(this.input)){if(this.input=function(t){return(0,e.Ju)({id:`checkbox${t}`,type:"checkbox",class:["field--binary__input"],tabindex:0,dataset:{nature:"field-component",view:"binary",id:t}})}(this.id),this.input.checked=this.source.getValue(),this.value=this.input.checked,this.readonly&&(this.input.classList.add("readonly"),this.input.disabled=!0),s){const{style:e}=s;Xe.call(this.projection,this.input,e)}else(0,t.Cp)(this.input);i.append(this.input)}if(!(0,e.Re)(this.label)){if(this.label=(0,e._)({class:["field--checkbox__label"],for:this.input.id,tabindex:0,dataset:{nature:"field-component",view:"binary",id:this.id}}),this.label.htmlFor=this.input.id,s&&s.label){const{content:t}=s.label;if(Array.isArray(t))t.forEach((t=>{let i=lt.call(this,t),s=(0,e.kQ)({class:["field--checkbox__label-content"],dataset:{ignore:"all"}},i);Xe.call(this.projection,s,t.style),this.label.append(s)}));else{let e=lt.call(this,t);this.label.append(e)}Xe.call(this.projection,this.label,s.label.style)}i.append(this.label)}return i.hasChildNodes()&&(this.element.append(i),this.bindEvents()),this.refresh(),this.element},focusIn(){return this.focused=!0,this.value=this.input.checked,this.element.classList.add("active"),this},focusOut(){if(!this.readonly)return this.hasChanges()&&this.setValue(this.input.checked),this.messageElement&&((0,t.Cp)(this.messageElement),(0,e.ep)(this.messageElement)),this.choice&&(0,t.Cp)(this.choice),this.input.blur(),this.element.classList.remove("active"),this.refresh(),this.focused=!1,this},hasChanges(){return this.value!==this.input.checked},hasValue(){return this.input.checked},getValue(){return this.input.checked},setValue(e,t=!1){var i;(i=t?this.source.setValue(e):{success:!0}).success||this.environment.notify(i.message,"error"),this.input.checked=e,this.value=e,this.refresh()},getCandidates(){return this.source.getCandidates()},enable(){this.input.disabled=!1,this.input.tabIndex=0,this.disabled=!1},disable(){this.input.disabled=!0,this.input.tabIndex=-1,this.disabled=!0},escapeHandler(i){let s=!0;if(this.messageElement&&!(0,t.xj)(this.messageElement)&&((0,t.Cp)(this.messageElement),s=!1),s){let t=(0,e.wr)(i,(e=>0===e.tabIndex));return this.environment.resolveElement(t).focus(t),!0}},backspaceHandler(e){return this.arrowHandler("left",e)},enterHandler(e){this.setValue(!this.input.checked,!0)},arrowHandler(e,t){return!!this.parent&&this.parent.arrowHandler(e,this.element)},bindEvents(){this.element.addEventListener("change",(e=>{this.setValue(this.getValue(),!0)})),this.projection.registerHandler("value.changed",(e=>{this.setValue(e)}))}},ct=Object.assign(Object.create(at),ot);function ht(t){const i=e=>e.parentElement===this.choices;return i(t)?t:(0,e.wr)(t,i,5)}function ut(e){const{type:t}=e.dataset;return t}function dt(e){const{type:t,value:i}=e.dataset;return"concept"===t?this.values.find((e=>e.id===i)).id:"meta-concept"===t?this.values.find((e=>e.name===i)).name:"value"===t?i:"placeholder"===t?null:i}const pt=(e,t)=>"concept"===e.type?pt(e.id,t):"concept"===t.type?pt(e,t.id):"meta-concept"===e.type?pt(e.name,t):"meta-concept"===t.type?pt(e,t.name):e===t,mt={value:null,placeholder:null,expanded:null,values:null,choices:null,input:null,items:null,selection:null,selectList:null,selectListValue:null,icoToggle:null,init(t={}){Object.assign(this.schema,t);const{focusable:i=!0,placeholder:s=!1,expanded:n=!0}=this.schema;return this.items=new Map,this.focusable=i,this.expanded=n,this.placeholder=s,this.children=[],(0,e.RI)(this.schema,"choice")||(this.schema.choice={}),(0,e.RI)(this.schema.choice,"option")||(this.schema.choice.option={}),this},hasChanges(){return this.value!=this.source.getValue()},reset(){this.source.removeValue()},hasValue(){return!(0,e.le)(this.value)},getValue(){return this.selection},setValue(i,s=!1){var n=null;if(s)return(n=this.source.setValue(i)).success||this.environment.notify(n.message,t.k$.ERROR),!0;(0,e.le)(i)?(this.selection&&this.selection.classList.remove("selected"),this.expanded||(0,e.ep)(this.selectListValue),this.selection=null):this.setChoice(i),(0,e.le)(i)?this.value=null:"concept"===i.type?this.value=i.id:"meta-concept"===i.type?this.value=i.name:this.value=i;const{template:r={}}=this.schema.choice.option;if(this.selection&&!this.expanded&&i)if((0,e.ep)(this.selectListValue),"meta-concept"===i.type){let t=this.model.getProjectionSchema(i.concept,(0,e.XI)(r.tag))[0],s=t.type,n={type:s,[s]:t.content||t.projection},a=ji.call(this,n,i.concept,{focusable:!1,meta:i.name});this.selectListValue.append(a)}else if("concept"===i.type){let e=this.model.createProjection(i,r.tag).init({focusable:!1});e.readonly=!0,e.focusable=!1,e.parent=this.projection,this.selectListValue.append(e.render())}else this.selectListValue.append(i.toString());this.refresh()},refresh(){return this.hasValue()?(this.element.classList.remove("empty"),this.element.dataset.value=this.value.name||this.value):(this.element.classList.add("empty"),this.element.dataset.value="",!this.expanded&&this.placeholder&&(0,e.ep)(this.selectListValue).append(this.placeholder)),this.input&&(this.element.dataset.input=this.input.value),this.element.classList.remove("querying"),this.hasError?(this.element.classList.add("error"),this.input&&this.input.classList.add("error")):(this.element.classList.remove("error"),this.input&&this.input.classList.remove("error")),this},render(){const t=(0,e.DZ)(),{choice:i,input:s,style:n}=this.schema;if((0,e.Re)(this.element)||(this.element=(0,e.wC)({id:this.id,class:["field","field--choice"],tabindex:-1,dataset:{nature:"field",view:"choice",input:"",id:this.id}})),!(0,e.Re)(this.input)&&s){const{placeholder:i="",type:n,style:r}=s;let a=Ei.call(this,i);this.input=(0,e.Ju)({class:["field--choice__input"],type:(0,e.XI)(n,"text"),placeholder:a,title:a,dataset:{nature:"field-component",view:this.type,id:this.id}}),Xe.call(this,this.input,r),t.append(this.input)}if(!(0,e.Re)(this.choices)){const{style:s}=i;this.choices=(0,e.w_)({class:["bare-list","field--choice__choices"],tabindex:-1,dataset:{nature:"field-component",view:"choice",id:this.id}}),Xe.call(this,this.choices,s),t.append(this.choices)}if(!this.expanded){let i=(0,e.wC)({class:["field--choice__select-wrapper"],tabindex:-1,dataset:{nature:"field-component",view:"choice",id:this.id}});this.selectListValue=(0,e.wC)({class:["field--choice__select-value"],tabindex:-1,dataset:{nature:"field-component",view:"choice",id:this.id}}),this.icoToggle=(0,e.oL)({class:["field--choice__select-icon"],dataset:{nature:"field-component",view:"choice",id:this.id}}),i.append(this.selectListValue,this.icoToggle),this.selectList=(0,e.wC)({class:["field--choice__select-list","hidden"],dataset:{nature:"field-component",view:"choice",id:this.id}}),this.input&&this.selectList.append(this.input),this.selectList.append(this.choices),t.append(i),t.append(this.selectList)}if(Xe.call(this,this.element,n),t.hasChildNodes()&&(this.element.append(t),this.bindEvents()),(0,e.ep)(this.choices),this.placeholder){const{style:t}=this.schema.choice.option;let i=(0,e.HV)({class:["field--choice__choice","field--choice__choice--placeholder"],tabindex:0,dataset:{nature:"field-component",view:"choice",id:this.id,type:"placeholder"}},this.placeholder);this.choices.append(i),Xe.call(this,i,t)}return this.values=this.source.getCandidates(),this.values.forEach((e=>{this.choices.append(this.createChoiceOption(e))})),this.source.hasValue()&&this.setValue(this.source.getValue()),this.refresh(),this.element},focus(e){if(this.expanded)if(this.choices.hasChildNodes()){let e=(0,t.sB)(this.choices);e&&e.focus()}else this.input&&!(0,t.xj)(this.input)?this.input.focus():this.selection&&this.selection.focus();else this.input&&!(0,t.xj)(this.input)?this.input.focus():this.selectListValue.focus();return this.element.classList.add("active"),this},navigate(i,s,n){let r=null;if("up"===i?r=(0,t.GV)(this.element):"down"===i?r=(0,t.Sd)(this.element):"left"===i?r=(0,t.GF)(this.element):"right"===i&&(r=(0,t.EE)(this.element)),(0,e.le)(r))return!1;r.focus()},focusIn(){this.focused=!0,this.element.classList.add("active");const i=(0,e.DZ)();return this.source.getCandidates().filter((e=>!this.values.some((t=>pt(t,e))))).forEach((e=>{i.append(this.createChoiceOption(e)),this.values.push(e)})),this.choices.append(i),this.expanded||((0,t.$Z)(this.selectList),this.selectList.dataset.state="open"),this},focusOut(){if(this.readonly)return;this.input&&(0,e.hr)(this.input.value)&&(this.input.value=""),this.messageElement&&((0,t.Cp)(this.messageElement),(0,e.ep)(this.messageElement)),this.input&&this.input.blur(),this.element.classList.remove("active"),this.element.classList.remove("querying");const{children:i}=this.choices;for(let e=0;e<i.length;e++){const s=i[e];(0,t.$Z)(s),s.hidden=!1}return this.expanded||((0,t.Cp)(this.selectList),this.selectList.dataset.state="close"),this.focused=!1,this},showChoices(){const{children:e}=this.choices;for(let i=0;i<e.length;i++){const s=e[i];(0,t.$Z)(s),s.hidden=!1}},enable(){return this.input&&(this.input.disabled=!1,this.input.tabIndex=0),this.disabled=!1,this},disable(){return this.input&&(this.input.disabled=!0,this.input.tabIndex=-1),this.disabled=!0,this},filterChoice(i){const{children:s}=this.choices;if(this.element.dataset.input=i.trim(),(0,e.hr)(i)){for(let e=0;e<s.length;e++){const i=s[e];(0,t.$Z)(i),i.hidden=!1}return}this.element.classList.add("querying");let n=i.trim().toLowerCase().replace(/\s+/g," ").split(" ");for(let e=0;e<s.length;e++){const i=s[e];let r=i.textContent.toLowerCase(),a=r.replace(/[_-]+/g," ").replace(/\s+/g,"").trim();n.some((e=>r.includes(e)||a.includes(e)))?((0,t.$Z)(i),i.hidden=!1):((0,t.Cp)(i),i.hidden=!0)}return!0},createChoiceOption(t){const{template:i={},style:s}=this.schema.choice.option,n=(0,e.Kn)(t),r=(0,e.HV)({class:["field--choice__choice"],tabindex:0,dataset:{nature:"field-component",view:"choice",id:this.id,type:n?"concept":"value",value:n?t.id:t}});if(Xe.call(this,r,s),this.items.set(t.id,r),"meta-concept"===t.type){let s=this.model.getProjectionSchema(t.concept,(0,e.XI)(i.tag))[0],n=s.type,a={type:n,[n]:s.content||s.projection},l=ji.call(this,a,t.concept,{focusable:!1,meta:t.name});r.dataset.type="meta-concept",r.dataset.value=t.name,r.append(l)}else if(n){if(!this.model.hasProjectionSchema(t,i.tag))return r;let e=this.model.createProjection(t,i.tag).init({focusable:!1});e.readonly=!0,e.focusable=!1,e.parent=this.projection,r.append(e.render())}else r.append(t.toString());return r},setChoice(e){const{children:i}=this.choices;let s=!1;for(let n=0;n<i.length;n++){const r=i[n];let a=dt.call(this,r);a&&pt(a,e)?(r.classList.add("selected"),r.dataset.selected="selected",this.selection=r,(0,t.$Z)(r),s=!0):(r.classList.remove("selected"),delete r.dataset.selected)}return this},delete(){if(this.hasValue())this.reset();else{let i=this.source.delete();i.success?(this.clear(),(0,e.ep)(this.element),this.element.remove()):(this.environment.notify(i.message),(0,t.lL)(this.element))}},_spaceHandler(i){let s=this.source.getCandidates();if((0,e.xb)(s))return void this.notify("No candidates found.",t.k$.INFO);const n=(0,e.DZ)();if(s.forEach((e=>{n.append(this.createChoiceOption(e))})),(0,e.ep)(this.choices),this.placeholder){const{style:t}=this.schema.choice.option;let i=(0,e.HV)({class:["field--choice__choice","field--choice__choice--placeholder"],tabindex:0,dataset:{nature:"field-component",view:"choice",id:this.id,type:"placeholder"}},this.placeholder);this.choices.append(i),Xe.call(this,i,t)}this.choices.append(n),this.filterChoice(this.input.value),(0,t.$Z)(this.choices),this.element.classList.add("querying")},escapeHandler(i){let s=!0;if(this.messageElement&&!(0,t.xj)(this.messageElement)&&((0,t.Cp)(this.messageElement),s=!1),!this.expanded&&"open"===this.selectList.dataset.state)return(0,t.Cp)(this.selectList),this.selectList.dataset.state="close",!0;if(s){let t=(0,e.wr)(i,(e=>0===e.tabIndex));return this.environment.resolveElement(t).focus(t),!0}this.focus()},enterHandler(i){const s=ht.call(this,i);(0,e.Re)(s)&&this.selection!==s&&("placeholder"===ut(s)?this.source.removeValue():this.setValue(dt.call(this,s),!0),this.expanded||((0,t.Cp)(this.selectList),this.selectList.dataset.state="close",this.focus()))},backspaceHandler(e){ht.call(this,e)&&this.input&&this.input.focus()},clickHandler(i){const s=ht.call(this,i);(0,e.Re)(s)&&this.selection!==s?("placeholder"===ut(s)?this.source.removeValue():this.setValue(dt.call(this,s),!0),this.expanded||((0,t.Cp)(this.selectList),this.selectList.dataset.state="close")):i===this.selectListValue&&((0,t.$Z)(this.selectList),this.selectList.dataset.state="open")},arrowHandler(i,s){if(!(0,e.Re)(s))return!1;const{parentElement:n}=s,r=()=>!!this.parent&&this.parent.arrowHandler(i,this.element);if(!this.expanded&&s===this.selectListValue)return this.arrowHandler(i,this.selectListValue.parentElement);let a=ht.call(this,s);if(a){let s=(0,t.As)(a,i,this.choices,!1);return(0,e.Re)(s)?(s.focus(),!0):this.arrowHandler(i,this.choices)}if(this.expanded&&n!==this.element)return r();let l=(0,t.As)(s,i,n,!1);return(0,e.Re)(l)?(l===this.selectList&&(l=this.input||this.choices),l===this.choices&&this.choices.hasChildNodes()&&("up"===i?l=(0,t.GV)(this.choices):"down"===i?l=(0,t.Sd)(this.choices):"left"===i?l=(0,t.GF)(this.choices):"right"===i&&(l=(0,t.EE)(this.choices))),l.focus(),!0):r()},bindEvents(){(0,e.Re)(this.input)&&this.element.addEventListener("input",(e=>{this.filterChoice(this.input.value)})),this.projection.registerHandler("value.changed",((e,t)=>{this.setValue(e)}))}},ft=Object.assign(Object.create(at),mt),gt={content:[{type:"static",static:{type:"text",content:"+",focusable:!1}}]};function vt(t){if(!(0,e.Re)(t))return!1;const{nature:i,id:s}=t.dataset;return"field-component"===i&&s===this.id}function bt(t){const i=e=>e.parentElement===this.list;return i(t)?t:(0,e.wr)(t,i,3)}const yt={list:null,items:null,elements:null,selection:null,content:null,init(t){const{focusable:i=!0}=this.schema;return this.items=new Map,this.elements=new Map,this.children=[],this.focusable=i,(0,e.RI)(this.schema,"list")||(this.schema.list={item:{}}),this},hasChanges:()=>!1,hasValue(){return this.items.size>0},getValue(){return this.list.children},setValue(t,i=!1){i&&this.source.setValue(t),this.list&&((0,e.ep)(this.list),t.forEach((e=>{var t=this.createItem(e);this.list.append(t)}))),this.refresh()},clear(){this.items.clear(),this.list&&(0,e.ep)(this.list)},focus(i){if(this.hasValue()&&this.list)this.list.firstElementChild.focus();else{let i=(0,t.Sd)(this.element,(e=>e!==this.list));if(!(0,e.Re)(i))return this;i.focus()}return this},navigate(i,s,n){let r=null;if("up"===i?r=(0,t.GV)(this.element,(e=>e!==this.notification&&e.hasChildNodes())):"down"===i?r=(0,t.Sd)(this.element,(e=>e!==this.notification&&e.hasChildNodes())):"left"===i?r=(0,t.GF)(this.element,(e=>e!==this.notification&&e.hasChildNodes())):"right"===i&&(r=(0,t.EE)(this.element,(e=>e!==this.notification&&e.hasChildNodes()))),!(0,e.Re)(r))return!1;let a=this.environment.resolveElement(r);return!(0,e.le)(a)&&(a.focus(),!0)},focusIn(e){this.focused=!0,this.element.classList.add("active");const{component:t}=e.dataset},focusOut(){if(!this.readonly)return this.messageElement&&((0,t.Cp)(this.messageElement),(0,e.ep)(this.messageElement)),this.element.classList.remove("active"),this.refresh(),this.focused=!1,this},createElement(){return this.source.createElement()},getItem(t){return(0,e.le)(t)?null:(0,e.RI)(t,"id")?this.items.get(t.id):this.items.get(t)},getItemIndex:t=>(0,e.Re)(t)?t.dataset.index:null,createItem(e){const{template:t={},style:i}=this.schema.list.item;if(!this.model.hasProjectionSchema(e,t.tag))return"";let s=this.model.createProjection(e,t.tag);s.optional=!0,s.collapsible=!0,s.parent=this.projection;let n=s.init(t.options).render();return n.dataset.index=e.index,s.element.parent=this,s.registerHandler("view.changed",(e=>{Xe.call(this.projection,e,i)})),Xe.call(this.projection,n,i),this.items.set(e.id,n),n},addItem(t){if(!(0,e.Re)(this.list))return;const i=this.createItem(t);t.index?this.list.children[t.index-1].after(i):this.list.append(i),this.refresh()},removeItem(t){this.hasList&&!(0,e.le)(t)&&(this.items.delete(t.id),this.items.forEach(((e,t)=>{let i=this.source.getElement(t);i&&(e.dataset.index=i.index)})),this.refresh())},moveItem(e,t,i=!1){return this.list.children[t].before(e),e.dataset.index=t,i&&this.source.swapElement(+this.getItemIndex(e),+t),this},swapItem(e,t,i=!1){const s=this.getItemIndex(e),n=this.getItemIndex(t);return this.moveItem(t,s),this.moveItem(e,n),i&&this.source.swapElement(+s,+n),this},delete(e){if(e===this.element)return this.environment.save(this.source.getParent()),void this.source.remove();const{index:i}=e.dataset;var s=this.source.removeElementAt(+i);if(s.success)if(this.hasValue()){let e=+i<this.list.childElementCount?+i:this.list.childElementCount-1;this.list.children[e].focus()}else this.focus();else this.environment.notify(`This element cannot be deleted: ${s.message}`),(0,t.lL)(e)},refresh(){this.hasValue()?(this.element.classList.remove("empty"),this.list&&this.list.classList.remove("empty")):(this.element.classList.add("empty"),this.list&&this.list.classList.add("empty")),this.elements.forEach(((t,i)=>{if(!Array.isArray(i.state))return;const{currentState:s}=i,n=tt.call(this,i,i.state);if(s===i.currentState)return;let r=i.content;n&&(r=n.content);let a=(0,e.DZ)();r.forEach((e=>{let t=ji.call(this,e,null,{focusable:!1});a.append(t)})),(0,e.ep)(t).append(a)})),this.hasError?this.element.classList.add("error"):this.element.classList.remove("error")},render(){const t=(0,e.DZ)(),{list:i,style:s,action:n={}}=this.schema;if((0,e.Re)(this.element)||(this.element=(0,e.wC)({id:this.id,class:["field","field--list"],tabindex:-1,dataset:{nature:"field",view:"list",id:this.id}}),this.readonly&&this.element.classList.add("readonly"),Xe.call(this.projection,this.element,this.schema.style)),i&&!(0,e.Re)(this.list)){const{style:s}=i;this.list=(0,e.wC)({class:["field--list__list"],dataset:{nature:"field-component",view:"list",id:this.id}}),this.source.hasValue()||this.list.classList.add("empty"),i.currentState=null,this.elements.set(i,this.list),Xe.call(this.projection,this.list,s),t.append(this.list)}let r=(0,e.XI)(n.add,gt);if(r){const{position:i="after",content:s,help:n,style:a}=r;let l=(0,e.ax)({class:["field-action","field--list__add"],tabindex:0,title:n,dataset:{nature:"field-component",view:"list",component:"action",id:this.id,action:"add"}});s.forEach((e=>{let t=ji.call(this,e,null,{focusable:!1});l.append(t)})),r.currentState=null,this.elements.set(r,l),Xe.call(this.projection,l,a),"before"===i&&this.list?this.list.before(l):t.append(l)}return this.list&&this.source.getValue().forEach((e=>{var t=this.createItem(e);this.list.append(t)})),Xe.call(this.projection,this.element,s),t.hasChildNodes()&&(this.element.append(t),this.bindEvents()),this.refresh(),this.element},_spaceHandler(e){this.notify(`Add or remove ${this.source.accept.name}`)},spaceHandler(t){return!!(0,e.Re)(t)&&t.parentElement===this.list&&(this.createElement(),!0)},deleteHandler(e){return!(!vt.call(this,e)||e.parentElement!==this.list||(this.delete(e),0))},escapeHandler(i){let s=!0;if(this.messageElement&&!(0,t.xj)(this.messageElement)&&((0,t.Cp)(this.messageElement),s=!1),s){let t=(0,e.wr)(i,(e=>0===e.tabIndex));return this.environment.resolveElement(t).focus(t),!0}return this.focus(),!1},enterHandler(t){const i=(t=>vt.call(this,t)?t:(0,e.wr)(t,(e=>vt.call(this,e)),5))(t);if((0,e.le)(i))return this.focus(),!1;const{action:s,index:n,component:r}=i.dataset;return"add"===s?(this.createElement(),!0):"remove"===s&&(this.delete(i.parentElement),!0)},backspaceHandler:e=>!1,clickHandler(t){const i=(t=>vt.call(this,t)?t:(0,e.wr)(t,(e=>vt.call(this,e)),5))(t);if((0,e.le)(i))return;const{action:s,index:n,name:r}=i.dataset;"add"===s?this.createElement():"remove"===s&&this.delete(i.parentElement)},_arrowHandler(i,s){if(!(0,e.Re)(s))return!1;let n=bt.call(this,s);if(n){let s=(0,t.As)(n,i,this.list);return!!(0,e.Re)(s)&&(this.swapItem(n,s,!0),n.focus(),!0)}return!1},arrowHandler(i,s){if(!(0,e.Re)(s))return!1;const{parentElement:n}=s,r=()=>!!this.parent&&this.parent.arrowHandler(i,this.element);if(n===this.list){let n=(0,t.As)(s,i,this.list);return(0,e.Re)(n)?(this.environment.resolveElement(n).focus(),!0):this.arrowHandler(i,this.list)}if(n!==this.element)return r();let a=(0,t.As)(s,i,this.element);if(!(0,e.Re)(a))return r();if(a===this.notification)return this.arrowHandler(i,a);if(a===this.list){if(!this.list.hasChildNodes())return r();"up"===i?a=(0,t.GV)(this.list):"down"===i?a=(0,t.Sd)(this.list):"left"===i?a=(0,t.GF)(this.list):"right"===i&&(a=(0,t.EE)(this.list))}return a.focus(),!0},bindEvents(){this.projection.registerHandler("value.added",(e=>{this.addItem(e)})),this.projection.registerHandler("value.removed",(e=>{this.removeItem(e)})),this.projection.registerHandler("value.changed",(e=>{this.clear(),this.list&&this.source.getValue().forEach((e=>{let t=this.createItem(e);this.list.append(t)}))})),this.projection.registerHandler("value.swapped",(e=>{const[t,i]=e;let s=this.getItem(t),n=this.getItem(i),r=+this.getItemIndex(s);this.getItemIndex(n),r!==t.index&&this.swapItem(s,n)}))}},wt=Object.assign(Object.create(at),yt);Object.defineProperty(wt,"size",{get(){return this.items.size}}),Object.defineProperty(wt,"hasList",{get(){return(0,e.Re)(this.list)}});var Et=0;const Ct={content:{type:"static",static:{type:"text",content:"Add"}}},jt={content:{type:"static",static:{type:"text",content:"Remove"}}},Lt={table:null,header:null,body:null,footer:null,elements:null,contentElements:null,content:null,init(){const{content:e=[],template:t,focusable:i=!0}=this.schema;return this.elements=new Map,this.focusable=i,this.content=e,this.contentElements=new Map,this.template=this.model.getProjectionSchema(this.source.accept,t.tag)[0].projection,this},render(){const{content:t,action:i={}}=this.schema,{disposition:s}=this.template,n=(0,e.DZ)();if(!Array.isArray(t))throw new Error("Empty content for listfield");if((0,e.Re)(this.element)||(this.element=(0,e.wC)({class:["field","field--table"],id:this.id,tabindex:-1,dataset:{nature:"field",view:"table",id:this.id}}),this.readonly&&this.element.classList.add("readonly"),Xe.call(this.projection,this.element,this.schema.style)),t.forEach((t=>{if("table"===t.type){let i=(0,e.XI)(t.table,{});const{style:s,header:r,body:a={},footer:l}=i;if(this.table=(0,e.W_)({class:["field--table__table"],tabindex:0,dataset:{nature:"field-component",view:"table",id:this.id}}),r){const{style:t}=r;this.header=(0,e.ZL)({class:["field--table-header"],dataset:{nature:"field-component",view:"table",id:this.id}}),Xe.call(this.projection,this.header,t),this.table.append(this.header)}if(a){const{style:t}=a;this.body=(0,e.uI)({class:["field--table-body"],dataset:{nature:"field-component",view:"table",id:this.id}}),Xe.call(this.projection,this.body,t),this.table.append(this.body)}if(l){const{style:t}=l;this.footer=(0,e.tH)({class:["field--table-footer"],dataset:{nature:"field-component",view:"table",id:this.id}}),Xe.call(this.projection,this.footer,t),this.table.append(this.footer)}i.currentState=null,this.contentElements.set(i,this.table),Xe.call(this.projection,this.table,s),n.append(this.table)}else if("action"===t.type){let i=(0,e.XI)(t,Ct);const{content:s,style:r}=i;let a=ji.call(this,s,null),l=(0,e.ax)({class:["field-action","field--table__add"],tabindex:0,dataset:{nature:"field-component",view:"table",component:"action",id:this.id,action:"add"}},[a]);i.currentState=null,this.contentElements.set(i,l),Xe.call(this.projection,l,r),n.append(l)}else{let e=ji.call(this,t);this.contentElements.set(t,e),n.append(e)}})),this.header){let t=(0,e.ui)({class:["field--table-header-row"],tabindex:-1,dataset:{nature:"field-component",view:"table",id:this.id}});s.forEach((i=>{const{header:s}=i,{style:n,content:r}=s;var a=ji.call(this,r),l=(0,e.zI)({class:["field--table-header-cell"],dataset:{nature:"field-component",view:"table",id:this.id}},a);Xe.call(this.projection,l,n),t.append(l)}));let i=(0,e.Ss)({class:["field--table-header-cell","field--table-header-cell--action"]},"Action");t.append(i),this.header.append(t)}return this.source.hasValue()&&this.source.getValue().forEach((e=>{this.addRow(e)})),n.hasChildNodes()&&(this.element.append(n),this.bindEvents()),this.refresh(),this.element},hasChanges:()=>!1,hasValue(){return this.body.rows.length>0},getValue(){return this.body.rows},focusIn(){return this.focused=!0,this.element.classList.add("active"),this},focusOut(){if(!this.readonly)return this.messageElement&&((0,t.Cp)(this.messageElement),(0,e.ep)(this.messageElement)),this.element.classList.remove("active"),this.refresh(),this.focused=!1,this},refresh(){this.hasValue()?(this.element.classList.remove("empty"),this.table.classList.remove("empty")):(this.element.classList.add("empty"),this.table.classList.add("empty")),this.contentElements.forEach(((t,i)=>{if(!Array.isArray(i.state))return;const{currentState:s}=i,n=tt.call(this,i,i.state);if(s===i.currentState)return;let r=null;r=n?ji.call(this,n.content,null):ji.call(this,i.content,null),(0,e.ep)(t).append(r)})),this.hasError?this.element.classList.add("error"):this.element.classList.remove("error")},createElement(){return this.source.createElement()},addRow(t){const{action:i={},before:s={},after:n={}}=this.schema,{disposition:r}=this.template,a=(0,e.XI)(t.index,this.table.rows.length),l="row"+Et++,o=(0,e.ui)({class:["field--table-row"],tabindex:-1,dataset:{nature:"field-component",view:"table",id:this.id,index:a,elementId:l}});this.elements.set(l,o),r.forEach((i=>{const{body:s}=i,{style:n,content:r}=s;var a=ji.call(this,r,t),l=(0,e.Ss)({class:["field--table-cell"],dataset:{nature:"field-component",view:"table",id:this.id}},a);Xe.call(this.projection,l,n),o.append(l)}));var c=(0,e.Ss)({class:["field--table__cell-action"]}),{content:h,style:u}=(0,e.XI)(i.remove,jt),d=ji.call(this,h),p=(0,e.ax)({class:["btn","field--table__button"],dataset:{nature:"field-component",view:"list",component:"action",id:this.id,action:"remove",rowId:l}},d),m=(0,e.ax)({class:["btn","field--table__button"],dataset:{nature:"field-component",id:this.id,action:"move-up",rowId:l}},"Move up"),f=(0,e.ax)({class:["btn","field--table__button"],dataset:{nature:"field-component",id:this.id,action:"move-down",rowId:l}},"Move down");Xe.call(this.projection,p,u),c.append(p,m,f),o.append(c),this.body.append(o),this.refresh()},removeRow(t){var i=this.body.rows.item(t.index);if(!(0,e.Re)(i))throw new Error("Table error: Row not found");(0,e.ep)(i),i.remove();for(let e=t.index;e<this.body.rows.length;e++){const t=this.body.rows.item(e),{index:i}=t.dataset;t.dataset.index=+i-1}this.refresh()},removeElement(e){return this.source.removeElement(e)},delete(e){if(e===this.element||e===this.table)return void this.source.delete();const{index:i}=e.dataset;this.source.removeElementAt(+i)||(this.environment.notify("This element cannot be deleted"),(0,t.lL)(e))},bindEvents(){this.element.addEventListener("click",(t=>{const{target:i}=t,s=function(t){const i="field-component";return t.dataset.nature===i?t:(0,e.wr)(t,(e=>e.dataset.nature===i))}(i);if(!(0,e.Re)(s))return;const{id:n,action:r}=s.dataset;if(n===this.id)if("add"===r)this.createElement();else if("remove"===r){const{rowId:e}=s.dataset;let t=this.elements.get(e);this.delete(t)}else if("move-up"===r){const{rowId:e}=s.dataset;let t=this.elements.get(e),i=t.previousElementSibling;i&&i.before(t)}else if("move-down"===r){const{rowId:e}=s.dataset;let t=this.elements.get(e),i=t.nextElementSibling;i&&i.after(t)}}),!0),this.projection.registerHandler("value.added",(e=>{this.addRow(e)})),this.projection.registerHandler("value.removed",(e=>{this.removeRow(e)})),this.projection.registerHandler("value.changed",(t=>{(0,e.ep)(this.body),this.source.getValue().forEach((e=>{this.addRow(e)}))}))}},xt=Object.assign(Object.create(at),Lt),Rt=t=>(0,e.Re)(t,["input","textarea"]),It="error";function At(){return(0,e.Re)(this.choice)||(this.choice=(0,e.w_)({class:["bare-list","field--textbox__choices"],dataset:{nature:"field-component",view:"text",component:"choice",id:this.id}}),this.append(this.choice)),this.choice}function Ot(t){return(0,e.HV)({class:["field--textbox__choice"],tabindex:0,dataset:{nature:"field-component",view:"text",component:"choice-item",value:t,id:this.id}},t)}function Vt(t){return t.parentElement===this.choice?t:(0,e.wr)(t,(e=>e.parentElement===this.choice),3)}function St(t){const{placeholder:i="",type:s}=t;let n="";return n=this._placeholder?(0,e.XI)(Ei.call(this,this._placeholder),""):(0,e.XI)(Ei.call(this,i),""),this.readonly||this.resizable?(0,e.kQ)({class:["field--textbox__input","field--textbox__input-pseudo"],editable:!this.readonly,title:n,dataset:{placeholder:n,nature:"field-component",view:this.type,id:this.id}}):this.multiline?(0,e.nE)({class:["field--textbox__input"],placeholder:n,title:n,dataset:{nature:"field-component",view:this.type,id:this.id}}):(0,e.Ju)({class:["field--textbox__input"],type:(0,e.XI)(s,"text"),placeholder:n,title:n,dataset:{nature:"field-component",view:this.type,id:this.id}})}const _t={input:null,choice:null,value:"",placeholder:null,multiline:!1,resizable:!1,content:null,hasOwnSource:!1,init(t={}){Object.assign(this.schema,t);const{multiline:i=!1,placeholder:s="",resizable:n=!1,focusable:r=!0,source:a}=this.schema;if(this.multiline=i,this.focusable=r,this.resizable=n,this.children=[],this._placeholder=s,a){const e=this.projection.concept.getAttribute(a).getTarget();e.register(this),this.source=e,this.hasOwnSource=!0}return(0,e.RI)(this.schema,"choice")||(this.schema.choice={}),this},focus(e){return this.input.focus(),this},focusIn(){return this.focused=!0,this.value=this.getValue(),this.element.classList.add("active"),this.element.classList.add("focus"),this},focusOut(){return this.hasChanges()&&this.setValue(this.getValue(),!0),(0,e.hr)(this.getValue())&&(this.input.textContent=""),this.messageElement&&((0,t.Cp)(this.messageElement),(0,e.ep)(this.messageElement)),this.choice&&(0,t.Cp)(this.choice),this.input.blur(),this.element.classList.remove("active"),this.element.classList.remove("focus"),this.refresh(),this.focused=!1,this},hasChanges(){return this.value!=this.getValue()},hasValue(){return!(0,e.xb)(this.getValue())},getValue(){return Rt(this.input)?this.input.value:this.input.textContent},setValue(e,i=!1){var s;(s=i?this.source.setValue(e):{success:!0}).success||((0,t.lL)(this.element),this.environment.notify(s.message,"error")),this.setInputValue(e),this.value=e,this.refresh()},setInputValue(e){Rt(this.input)?this.input.value=e:this.input.textContent=e},getCandidates(){let e=this.source.getCandidates();return Array.isArray(e)?e:[]},enable(){return this.input.disabled=!1,this.input.tabIndex=0,this.disabled=!1,this.element.classList.add("disabled"),this},disable(){return this.input.disabled=!0,this.input.tabIndex=-1,this.disabled=!0,this.element.classList.remove("disabled"),this},refresh(){tt.call(this,this.schema,this.schema.state),this.hasValue()?this.element.classList.remove("empty"):this.element.classList.add("empty"),this.element.dataset.value=this.value,this.hasError?(this.element.classList.add(It),this.input.classList.add(It)):(this.element.classList.remove(It),this.input.classList.remove(It)),this.choice&&this.filterChoice(this.getValue())},render(){const t=(0,e.DZ)(),{container:i,input:s={},style:n}=this.schema;if((0,e.Re)(this.element)||(this.element=(0,e.wC)({id:this.id,class:["field","text-field","field--textbox"],dataset:{nature:"field",view:"text",id:this.id,disabled:this.disabled,readonly:this.readonly,value:""}}),this.readonly&&this.element.classList.add("readonly"),this.disabled&&this.element.classList.add("disabled"),Xe.call(this.projection,this.element,this.schema.style)),i){const{content:e=[],style:s}=i;e.forEach((e=>{if("input"===e.type){const{style:i}=e.input;this.input=St.call(this,e.input),this.disabled&&(this.input.disabled=!0),this.focusable?this.input.tabIndex=0:this.input.dataset.ignore="all",Xe.call(this.projection,this.input,i),this.multiline&&this.input.classList.add("field--textbox__input--multiline"),t.append(this.input)}else{let i=ji.call(this,e,null,{focusable:!1});t.append(i)}})),Xe.call(this.projection,this.element,s)}else{if(!(0,e.Re)(this.input)){const{style:e}=s;this.input=St.call(this,s),this.disabled&&(this.input.disabled=!0),this.focusable?this.input.tabIndex=0:this.input.dataset.ignore="all",Xe.call(this,this.input,e),this.multiline&&this.input.classList.add("field--textbox__input--multiline"),t.append(this.input)}Xe.call(this.projection,this.element,n)}return t.hasChildNodes()&&(this.element.append(t),this.bindEvents()),this.source.hasValue()&&this.setValue(this.source.getValue()),this.refresh(),this.element},filterChoice(i){const{children:s}=this.choice;if((0,e.hr)(i)){for(let e=0;e<s.length;e++){const i=s[e];(0,t.$Z)(i),i.hidden=!1}return!0}let n=i.trim().toLowerCase().replace(/\s+/g," ").split(" ");for(let e=0;e<s.length;e++){const i=s[e],{value:r}=i.dataset;n.some((e=>r.toLowerCase().includes(e)))?((0,t.$Z)(i),i.hidden=!1):((0,t.Cp)(i),i.hidden=!0)}return!0},selectChoice(i){if(!(0,e.Re)(i))return;const s=function(e){return e.dataset.value}(i);return this.setValue(s,!0),this.input.focus(),(0,t.Cp)(this.choice),this},update(e,t,i){"delete"!==e?"value.changed"===e&&this.setValue(t):this.delete()},_spaceHandler(i){const s=new Set(this.getCandidates());if(0===s.size)this.notify("Enter any text.",t.k$.INFO);else{At.call(this);const i=(0,e.DZ)();s.forEach((e=>i.append(Ot.call(this,e)))),(0,e.ep)(this.choice).append(i),this.filterChoice(this.getValue()),(0,t.$Z)(this.choice)}},escapeHandler(i){let s=!0;if(this.messageElement&&!(0,t.xj)(this.messageElement)&&((0,t.Cp)(this.messageElement),s=!1),this.choice&&!(0,t.xj)(this.choice)&&((0,t.Cp)(this.choice),s=!1),s){let t=(0,e.wr)(i,(e=>0===e.tabIndex)),s=this.environment.resolveElement(t);return s&&s.focus(t),!1}return this.input.focus(),!0},enterHandler(e){const t=Vt.call(this,e);return t?this.selectChoice(t):this.multiline||(e===this.input?this.setValue(this.getValue(),!0):this.focus()),!0},backspaceHandler(e){Vt.call(this,e)&&this.input.focus()},clickHandler(t){const i=Vt.call(this,t);(0,e.Re)(i)&&this.selectChoice(i)},arrowHandler(i,s){if(!(0,e.Re)(s))return!1;const{parentElement:n}=s,r=()=>!!this.parent&&this.parent.arrowHandler(i,this.element);let a=Vt.call(this,s);if((0,e.Re)(a)){let s=(0,t.As)(a,i,this.choice);return(0,e.Re)(s)?(s.focus(),!0):this.arrowHandler(i,this.choice)}if(n!==this.element)return r();let l=null;if("right"===i){if(s===this.input&&!(this.getValue().length<(0,t.qO)(this.input)+1))return!1;l=(0,t.As)(s,i,this.element,!1)}else if("left"===i){if(s===this.input&&0!==(0,t.qO)(this.input))return!1;l=(0,t.As)(s,i,this.element,!1)}else l=(0,t.As)(s,i,this.element,!1);return(0,e.Re)(l)&&l.dataset.id===this.id?("up"===i?l=(0,t.GV)(this.choice):"down"===i?l=(0,t.Sd)(this.choice):"left"===i?l=(0,t.GF)(this.choice):"right"===i&&(l=(0,t.EE)(this.choice)),l.focus(),!0):r()},bindEvents(){this.element.addEventListener("input",(e=>{this.hasError&&this.source.setValue(this.getValue(),!0),this.refresh()})),this.hasOwnSource||this.projection.registerHandler("value.changed",(e=>{this.setValue(e)}))}},Tt=Object.assign(Object.create(at),_t),Ht={binary:(e,t,i)=>Object.create(ct,{object:{value:"field"},name:{value:"binary-field"},type:{value:"binary"},id:{value:Mt()},model:{value:e},schema:{value:t},projection:{value:i},source:{value:i.concept}}),choice:(e,t,i)=>Object.create(ft,{object:{value:"field"},name:{value:"choice-field"},type:{value:"choice"},id:{value:Mt()},model:{value:e},schema:{value:t},projection:{value:i},source:{value:i.concept}}),list:(e,t,i)=>Object.create(wt,{object:{value:"field"},name:{value:"list-field"},type:{value:"list"},id:{value:Mt()},model:{value:e},schema:{value:t},projection:{value:i},source:{value:i.concept}}),table:(e,t,i)=>Object.create(xt,{object:{value:"field"},name:{value:"table-field"},type:{value:"table"},id:{value:Mt()},model:{value:e},schema:{value:t},projection:{value:i},source:{value:i.concept}}),text:(e,t,i)=>Object.create(Tt,{object:{value:"field"},name:{value:"text-field"},type:{value:"text"},id:{value:Mt()},model:{value:e},schema:{value:t},projection:{value:i},source:{value:i.concept,writable:!0}})};var kt=0;const Mt=()=>"field"+kt++,$t={createField(t,i,s){const{type:n}=i,r=Ht[n];if((0,e.le)(r))throw new Error(`Missing handler: The '${n}' field could not be handled`);var a=r(t,i,s);if((0,e.le)(a))throw new Error(`Bad request: The '${n}' field could not be created`);return a.errors=[],a.readonly=(0,e.XI)(i.readonly,!1),(0,e.le)(a.id)&&(a.id=Mt()),a}},Pt={init(){throw new Error("This function has not been implemented")},element:null,children:null,statusElement:null,attached:null,readonly:!1,visible:!1,disabled:!1,active:!1,focused:!1,get hasAttached(){return!(0,e.xb)(this.attached)},attach(e,t){this.attached.push(e)},detach(e){this.attached.slice(this.attached.indexOf(e),1)},getAttached(t){return(0,e.mf)(t)?this.attached.filter((e=>t(e))):this.attached},show(){return(0,t.$Z)(this.element),this.visible=!0,this.active=!0,this},hide(){return(0,t.Cp)(this.element),this.visible=!1,this},toggle(){return(0,t.ZN)(this.container),this.visible=!this.visible,this},focus(){return this.element.focus(),this.focused=!0,this.active=!0,this},_focusIn:e=>!1,navigate(e,t,i){return this.focusable?(this.element.focus(),!0):this.parent.arrowHandler(e,this.element)},clear:()=>!0,delete(){this.environment.notify("This element cannot be removed",t.k$.WARNING,1500),(0,t.lL)(this.element)},spaceHandler(e){return this.arrowHandler("right",e)},_spaceHandler(e){return this.environment.notify("Nothing do here.",t.k$.NORMAL,1500),!1},escapeHandler(t){let i=(0,e.wr)(t,(e=>0===e.tabIndex));return this.projection.resolveElement(i).focus(i),!0},enterHandler(e){this.element.click()},deleteHandler(e){return this.environment.notify("This element cannot be removed",t.k$.WARNING,1500),(0,t.lL)(this.element),!1},backspaceHandler(e){return this.arrowHandler("left",e)},arrowHandler(e,t){return!!this.parent&&this.parent.arrowHandler(e,t)},clickHandler:e=>(console.warn("CLICK_HANDLER NOT IMPLEMENTED"),!1),controlHandler:e=>(console.warn("CONTROL NOT IMPLEMENTED"),!1)},Nt=Object.assign(Pt),Dt={init(){return this.children=[],this},render(){const t=(0,e.DZ)(),{help:i,style:s,content:n}=this.schema;return(0,e.Re)(this.element)||(this.element=(0,e.K$)({class:["static","audio-static"],src:n,dataset:{nature:"static",static:"audio",id:this.id,ignore:"all"}})),(0,e.le)(i)||(this.element.title=i),Xe.call(this.projection,this.element,s),t.hasChildNodes()&&(this.element.append(t),this.bindEvents()),this.refresh(),this.element},focusIn(){return this.focused=!0,this.element.classList.add("active"),this},focusOut(){return this.messageElement&&((0,t.Cp)(this.messageElement),(0,e.ep)(this.messageElement)),this.element.classList.remove("active"),this.refresh(),this.focused=!1,this},refresh(){return this},bindEvents(){}},Bt=Object.assign(Object.create(Nt),Dt);function Xt(t,i){let s=t.param.find((e=>e.name===i));if((0,e.le)(s))return;const{type:n="string",value:r}=s;let a=(0,e.XI)(r,s.default);return(0,e.le)(a)?null:"string"===n?a.toString():"number"===n?+a:void 0}function Zt(t){if((0,e.le)(t))return"";const{type:i}=t;return"property"===i?(this.hasProperty=!0,(0,e.XI)(this.source.getProperty(t.name),"")):"param"===i?Xt.call(this,this.schema.template,t.name):"raw"===i?(0,e.Bv)(t.raw):t}function Ft(t){return(0,e.hr)(t)?"":t.startsWith("http://")||t.startsWith("https://")?new URL(t).href:Ft(`https://${t}`)}const zt={url:null,alt:null,width:null,height:null,init(){const{url:e,width:t,height:i,alt:s}=this.schema;return this.width=t,this.height=i,this.alt=s,this},render(){let t=!1;const{help:i,style:s,url:n}=this.schema;return this.url=Ft(Zt.call(this,n)),(0,e.Re)(this.element)||(this.element=(0,e.Bi)({class:["static","image-static"],src:this.url,alt:this.alt,dataset:{nature:"static",static:"image",id:this.id,ignore:"all"}}),t=!0),(0,e.le)(this.width)||isNaN(this.width)||(this.element.width=this.width),(0,e.le)(this.height)||isNaN(this.height)||(this.element.height=this.height),(0,e.le)(i)||(this.element.title=i),Xe.call(this.projection,this.element,s),t&&this.bindEvents(),this.refresh(),this.element},focusIn(){return this.focused=!0,this.element.classList.add("active"),this},focusOut(){return this.messageElement&&((0,t.Cp)(this.messageElement),(0,e.ep)(this.messageElement)),this.element.classList.remove("active"),this.refresh(),this.focused=!1,this},refresh(){return(0,e.hr)(this.url)?this.element.classList.add("empty"):this.element.classList.remove("empty"),this},update(){const{url:e}=this.schema;return this.element.src=Ft(Zt.call(this,e)),this},bindEvents(){this.hasProperty&&(this.projection.registerHandler("value.changed",(e=>{this.update()})),this.projection.registerHandler("value.added",(e=>{this.update()})),this.projection.registerHandler("value.removed",(e=>{this.update()})))}},Wt=Object.assign(Object.create(Nt),zt),qt={email:e=>`mailto:${e}`,phone:e=>`tel:${e}`,link:e=>`${e}`};function Ut(t,i){let s=t.param.find((e=>e.name===i));if((0,e.le)(s))return;const{type:n="string",value:r}=s;let a=(0,e.XI)(r,s.default);return(0,e.le)(a)?null:"string"===n?a.toString():"number"===n?+a:void 0}function Gt(t){if((0,e.le)(t))return"";const{type:i}=t;return"property"===i?(this.hasProperty=!0,(0,e.XI)(this.source.getProperty(t.name),"")):"param"===i?Ut.call(this,this.schema.template,t.name):"raw"===i?(0,e.Bv)(t.raw):t}const Kt={url:null,urlType:null,href:null,hrefHandler:null,content:null,init(){const{content:t=[],urlType:i="link"}=this.schema;if(this.content=t,this.urlType=i,this.children=[],this.hrefHandler=qt[this.urlType],!(0,e.mf)(this.hrefHandler))throw new TypeError("type not handled");return this},render(){let t=!1;const i=(0,e.DZ)(),{help:s,style:n,url:r}=this.schema;return this.href=this.hrefHandler(Gt.call(this,r)),(0,e.Re)(this.element)||(this.element=(0,e.cH)({class:["static","link"],href:this.href,dataset:{nature:"static",static:"link",id:this.id,ignore:"all"}}),"link"===this.urlType&&(this.element.target="_blank"),t=!0),this.content.forEach((e=>{let t=ji.call(this,e,this.projection.concept,{focusable:!1});i.append(t)})),(0,e.le)(s)||(this.element.title=s),Xe.call(this.projection,this.element,n),i.hasChildNodes()&&this.element.append(i),t&&this.bindEvents(),this.refresh(),this.element},focusIn(){return this.focused=!0,this.element.classList.add("active"),this},focusOut(){return this.messageElement&&((0,t.Cp)(this.messageElement),(0,e.ep)(this.messageElement)),this.element.classList.remove("active"),this.refresh(),this.focused=!1,this},refresh(){return this},update(){const{url:t}=this.schema;return this.element.href=this.hrefHandler(Gt.call(this,t)),(0,e.ep)(this.element),this.content.forEach((e=>{this.element.append(ji.call(this,e,this.projection.concept,{focusable:!1}))})),this},bindEvents(){this.hasProperty&&(this.projection.registerHandler("value.changed",(e=>{this.update()})),this.projection.registerHandler("value.added",(e=>{this.update()})),this.projection.registerHandler("value.removed",(e=>{this.update()})))}},Qt=Object.assign(Object.create(Nt),Kt);function Jt(t,i){let s=t.param.find((e=>e.name===i));if((0,e.le)(s))return;const{type:n="string",value:r}=s;let a=(0,e.XI)(r,s.default);return(0,e.le)(a)?null:"string"===n?a.toString():"number"===n?+a:void 0}function Yt(t){if((0,e.le)(t))return"";const{type:i}=t;return"property"===i?(this.hasProperty=!0,(0,e.XI)(this.source.getProperty(t.name),"")):"param"===i?Jt.call(this,this.schema.template,t.name):"html"===i?(0,e.Bv)(t.html):"raw"===i?(0,e.Bv)(t.raw):t}const ei={editable:null,focusable:null,hasProperty:!1,asHTML:!1,init(e={}){Object.assign(this.schema,e);const{content:t,editable:i=!1,focusable:s=!1}=this.schema;return this.children=[],this._content=t,this.editable=i,this.focusable=s,this},render(){let t=!1;const{content:i,help:s,style:n}=this.schema;if(!(0,e.Re)(this.element)){if(this.element=(0,e.kQ)({class:["text","static","text-static"],editable:this.editable,dataset:{nature:"static",view:"text",static:"text",id:this.id,ignore:"all"}}),this.focusable&&(this.element.tabIndex=0),Array.isArray(i))i.forEach((t=>{let i=Yt.call(this,t),s=(0,e.kQ)({class:["text","static","text-static"],dataset:{nature:"static-component",view:"text",static:"text",content:i,id:this.id,ignore:"all"}},i);Xe.call(this.projection,s,t.style),this.element.append(s)}));else{let e=Yt.call(this,i);this.element.append(e),this.element.content=e}t=!0}return(0,e.le)(s)||(this.element.title=s),Xe.call(this.projection,this.element,n),t&&this.bindEvents(),this.refresh(),this.element},focusIn(){return this.focused=!0,this.element.classList.add("active"),this},focusOut(){return this.messageElement&&((0,t.Cp)(this.messageElement),(0,e.ep)(this.messageElement)),this.element.classList.remove("active"),this.refresh(),this.focused=!1,this},getLength(){return this.element.textContent.length},backspaceHandler(e){return this.arrowHandler("left",e)},arrowHandler(e,i){if(!this.editable&&this.parent)return this.parent.arrowHandler(e,i);if("right"===e){if(this.getLength()<(0,t.qO)(this.element)+1&&this.parent)return this.parent.arrowHandler(e,i)}else if("left"===e){if(0===(0,t.qO)(this.element)&&this.parent)return this.parent.arrowHandler(e,i)}else if(this.parent)return this.parent.arrowHandler(e,i);return!1},escapeHandler(t){let i=(0,e.wr)(t,(e=>0===e.tabIndex));this.projection.resolveElement(i).focus(i)},update(){const{content:t}=this.schema;return(0,e.ep)(this.element),Array.isArray(t)?t.forEach((t=>{this.element.append((0,e.kQ)({class:["text","static","text-static"],dataset:{nature:"static-component",view:"text",static:"text",id:this.id,ignore:"all"}},Yt.call(this,t)))})):this.element.append(Yt.call(this,t)),this},refresh(){return this},bindEvents(){this.hasProperty&&(this.projection.registerHandler("value.changed",(e=>{this.update()})),this.projection.registerHandler("value.added",(e=>{this.update()})),this.projection.registerHandler("value.removed",(e=>{this.update()})))}},ti=Object.assign(Object.create(Nt),ei),ii={contentType:null,editable:null,focusable:null,init(e={}){Object.assign(this.schema,e);const{focusable:t=!0}=this.schema;return this.children=[],this.focusable=t,this},render(){const t=(0,e.DZ)(),{help:i,style:s,content:n}=this.schema;return(0,e.Re)(this.element)||(this.element=(0,e.ax)({class:["btn","static"],dataset:{nature:"static",view:"plink",static:"plink",id:this.id,ignore:"all"}}),this.focusable&&(this.element.tabIndex=0)),n.forEach((e=>{let i=ji.call(this,e,this.projection.concept,{focusable:!1});t.append(i)})),(0,e.le)(i)||(this.element.title=i),Xe.call(this.projection,this.element,s),t.hasChildNodes()&&(this.element.append(t),this.bindEvents()),this.refresh(),this.element},focusIn(){return this.focused=!0,this.element.classList.add("active"),this},focusOut(){return this.messageElement&&((0,t.Cp)(this.messageElement),(0,e.ep)(this.messageElement)),this.element.classList.remove("active"),this.refresh(),this.focused=!1,this},arrowHandler(e,t){return(!this.editable&&this.parent||!!this.parent)&&this.parent.arrowHandler(e,t)},escapeHandler(t){let i=(0,e.wr)(t,(e=>0===e.tabIndex));this.environment.resolveElement(i).focus(i)},enterHandler(e){const t=this.projection.schema.findIndex((e=>e.tags.includes(this.schema.tag)));return this.projection.changeView(t),!1},clickHandler(e){let t=this.projection.findView(this.schema.tag);return-1===t||this.projection.changeView(t),!1},refresh(){return this},bindEvents(){}},si=Object.assign(Object.create(Nt),ii),ni={template:null,selector:null,content:null,init(){return this.selector=this.schema.selector,this.template=(0,e.t4)(this.selector),this},render(){const{style:t,content:i}=this.schema;return(0,e.UG)(this.element)||(this.element=(0,e.jC)(this.template)),this.refresh(),this.element},focusIn(){return this.focused=!0,this.element.classList.add("active"),this},focusOut(){return this.element.classList.remove("active"),this.refresh(),this.focused=!1,this},refresh(){return this}},ri=Object.assign(Object.create(Nt),ni);function ai(t,i){let s=t.param.find((e=>e.name===i));if((0,e.le)(s))return;const{type:n="string",value:r}=s;let a=(0,e.XI)(r,s.default);return(0,e.le)(a)?null:"string"===n?a.toString():"number"===n?+a:void 0}const li={contentType:null,editable:null,focusable:null,disabled:null,init(e={}){Object.assign(this.schema,e);const{focusable:t=!0,disabled:i=!1}=this.schema;return this.children=[],this.focusable=t,this.disabled=i,this},render(){const t=(0,e.DZ)(),{help:i,style:s,content:n}=this.schema;return(0,e.Re)(this.element)||(this.element=(0,e.ax)({class:["btn","static"],dataset:{nature:"static",view:"button",static:"button",id:this.id,ignore:"all"}}),this.focusable&&(this.element.tabIndex=0)),n.forEach((e=>{let i=ji.call(this,e,this.projection.concept,{template:this.schema.template,focusable:!1});t.append(i)})),(0,e.le)(i)||(this.element.title=i),Xe.call(this.projection,this.element,s),t.hasChildNodes()&&(this.element.append(t),this.bindEvents()),this.refresh(),this.element},focusIn(){return this.focused=!0,this.element.classList.add("active"),this},focusOut(){return this.messageElement&&((0,t.Cp)(this.messageElement),(0,e.ep)(this.messageElement)),this.element.classList.remove("active"),this.refresh(),this.focused=!1,this},arrowHandler(e,t){return(!this.editable&&this.parent||!!this.parent)&&this.parent.arrowHandler(e,t)},escapeHandler(t){let i=(0,e.wr)(t,(e=>0===e.tabIndex));this.environment.resolveElement(i).focus(i)},enterHandler(e){const t=this.projection.schema.findIndex((e=>e.tags.includes(this.schema.tag)));return this.projection.changeView(t),!1},clickHandler(t){let i=this.source;if(this.schema.bind&&(i=this.source.getValue(!0)),this.schema.action){const{type:t,value:s,target:n}=this.schema.action;if((0,e.le)(n)&&i.createElement(),(0,e.Kn)(s))for(const e in s){const t=s[e];"param"===t.type&&(s[e]=ai.call(this,this.schema.template,t.name))}return"attribute"===n.type&&i.getAttribute(n.name).target.createElement({value:s}),!1}return this.environment.triggerEvent({name:this.schema.trigger,args:[i]}),!1},refresh(){return this},bindEvents(){}},oi=Object.assign(Object.create(Nt),li);var ci=0;const hi=()=>"static"+ci++,ui={audio:(e,t,i)=>Object.create(Bt,{object:{value:"static"},name:{value:"audio-static"},type:{value:"audio"},id:{value:hi()},model:{value:e},schema:{value:t},projection:{value:i}}),plink:(e,t,i)=>Object.create(si,{object:{value:"static"},name:{value:"plink-static"},type:{value:"plink"},id:{value:hi()},model:{value:e},schema:{value:t},projection:{value:i}}),image:(e,t,i)=>Object.create(Wt,{object:{value:"static"},name:{value:"image-static"},type:{value:"image"},id:{value:hi()},model:{value:e},schema:{value:t},projection:{value:i}}),link:(e,t,i)=>Object.create(Qt,{object:{value:"field"},name:{value:"link-static"},type:{value:"link"},id:{value:hi()},model:{value:e},schema:{value:t},projection:{value:i}}),text:(e,t,i)=>Object.create(ti,{object:{value:"static"},name:{value:"text-static"},type:{value:"text"},id:{value:hi()},model:{value:e},schema:{value:t},projection:{value:i}}),html:(e,t,i)=>Object.create(ri,{object:{value:"static"},name:{value:"html-static"},type:{value:"html"},id:{value:hi()},model:{value:e},schema:{value:t},projection:{value:i}}),button:(e,t,i)=>Object.create(oi,{object:{value:"static"},name:{value:"button-static"},type:{value:"button"},id:{value:hi()},model:{value:e},schema:{value:t},projection:{value:i}})},di={createStatic(t,i,s){const{type:n}=i,r=ui[n];if((0,e.le)(r))throw new Error(`Missing handler: The '${n}' static could not be handled`);var a=r(t,i,s);if((0,e.le)(a))throw new Error(`Bad request: The '${n}' static could not be created`);return(0,e.le)(a.id)&&(a.id=hi()),a}},pi={focusable:null,readonly:!1,visible:!1,editable:!1,active:!1,container:null,elements:null,children:null,editing:!1,getStyle(){return this.schema.style},setStyle(e){return this.schema.style=e,Xe.call(this.projection,this.container,e),this.refresh(),!0},getContainer(){return this.container},isRoot(){return(0,e.le)(this.parent)},getField(e){return this.projection.getField(e)},getStatic(e){return this.projection.getStatic(e)},getLayout(e){return this.environment.getLayout(e)},show(){return(0,t.$Z)(this.element),this.visible=!0,this.active=!0,this},hide(){return(0,t.Cp)(this.element),this.visible=!1,this},toggle(){return(0,t.ZN)(this.container),this.visible=!this.visible,this},_focusIn:e=>!1,spaceHandler(t){return t===this.container&&!(0,e.le)(this.parent)&&this.parent.spaceHandler(this.container)},_spaceHandler(e){return console.warn(`CTRL_SPACE_HANDLER NOT IMPLEMENTED FOR ${this.name}`),!1},escapeHandler(t){if(this.isRoot())return!1;let i=(0,e.wr)(t,(e=>0===e.tabIndex)),s=this.environment.resolveElement(i);return!(0,e.le)(s)&&(s.focus(i),!0)},enterHandler(t){let i=(0,e.sb)('[tabindex]:not([tabindex="-1"])',this.container),s=this.environment.resolveElement(i);return!(0,e.le)(s)&&(s.focus(),!0)},delete(){var e=this.source.delete();e.success||this.environment.notify(e.message)},deleteHandler(i){if(this.projection.element!==this)return!1;if(!this.projection.optional)return(0,t.lL)(this.container),!1;let s=(0,e.wr)(i,(e=>0===e.tabIndex)),n=this.container.cloneNode(!0);this.source.hasParent()&&this.environment.save(this.source.getParent(),n),this.source.delete();let r=this.environment.resolveElement(s);return(0,e.le)(r)||r.focus(),!1},backspaceHandler(e){return console.warn(`BACKSPACE_HANDLER NOT IMPLEMENTED FOR ${this.name}`),!1},arrowHandler(i,s){if(s===this.container)return!(0,e.le)(this.parent)&&this.parent.arrowHandler(i,this.container);let n=(0,t.As)(s,i,this.container);if(!(0,e.Re)(n))return!(0,e.le)(this.parent)&&"layout"===this.parent.object&&this.parent.arrowHandler(i,this.container);let r=this.environment.resolveElement(n);return r&&((0,e.mf)(r.navigate)?r.navigate(i):r.focus()),!0},shiftHandler(e,i){if("up"===e){let e=(0,t.a2)(window.getComputedStyle(this.container).marginTop);this.container.style.marginTop=`${e+1}px`}return!0},_arrowHandler(e,t){return console.warn(`CTRL_ARROW_HANDLER NOT IMPLEMENTED FOR ${this.name}`),!1},clickHandler(e){return console.warn(`CLICK_HANDLER NOT IMPLEMENTED FOR ${this.name}`),!1},controlHandler(e){this.toolbar&&this.toolbar.remove()}},mi={ROW:"row",COLUMN:"column"},fi={start:"flex-start",end:"flex-end","flex-start":"flex-start","flex-end":"flex-end",center:"center",stretch:"stretch",baseline:"baseline"},gi={start:"flex-start",end:"flex-end","flex-start":"flex-start","flex-end":"flex-end",center:"center","space-between":"space-between","space-around":"space-around","space-evenly":"space-evenly"};var vi=0;function bi(e,t,i){return Object.create(wi,{object:{value:"layout"},name:{value:"flex-layout"},type:{value:"flex"},id:{value:"layout"+vi++},model:{value:e},schema:{value:t},projection:{value:i},source:{value:i.concept,writable:!0}})}const yi={orientation:null,wrappable:null,alignItems:null,justifyContent:null,args:null,init(e={}){const{editable:t=!0,focusable:i=!1}=this.schema,{orientation:s=mi.ROW,wrappable:n=!0,alignItems:r,justifyContent:a}=this.schema.layout;return this.orientation=s,this.wrappable=n,this.alignItems=r,this.justifyContent=a,this.focusable=i,this.editable=t,this.elements=[],this.children=[],this.args=e,Object.assign(this,e),this},getOrientation(){return this.orientation},setOrientation(t){(0,e.RI)(mi,t)&&(this.orientation=t,this.refresh())},collapse(t=!1){if(!this.collapsed||t)return this.collapseContainer=(0,e.wC)({class:"layout-container-collapse"},this.elements),this.btnCollapse.after(this.collapseContainer),this.collapsed=!0,this.refresh(),this},expand(t=!1){if(!this.collapsed&&!t)return;let i=(0,e.DZ)(Array.from(this.collapseContainer.children));return this.btnCollapse.after(i),this.collapseContainer.remove(),this.collapsed=!1,this.refresh(),this},render(){const{label:t,content:i,style:s,help:n}=this.schema,r=(0,e.DZ)();(0,e.Re)(this.container)||(this.container=(0,e.wC)({class:["layout-container"],dataset:{nature:"layout",layout:"flex",id:this.id}})),n&&(this.container.title=n);for(let e=0;e<i.length;e++){let t=ji.call(this,i[e],null,this.args),s=this.environment.resolveElement(t);s&&(s.parent=this),this.elements.push(t),r.append(t)}return this.focusable?this.container.tabIndex=0:this.container.dataset.ignore="all",Xe.call(this.projection,this.container,s),r.hasChildNodes()&&(this.container.append(r),this.bindEvents()),this.collapsed&&this.collapse(!0),this.container.style.display="flex",this.refresh(),this.container},refresh(){return this.container.style.flexDirection=this.orientation,this.container.style.justifyContent=gi[this.justifyContent],this.container.style.alignItems=fi[this.alignItems],this.wrappable?this.container.style.flexWrap="wrap":this.container.style.flexWrap="nowrap",this},focus(t){if(this.focusable)this.container.focus();else{let t=(0,e.sb)('[tabindex]:not([tabindex="-1"])',this.container);if((0,e.le)(t))return!1;let i=this.environment.resolveElement(t);i&&i.focus(t)}},focusIn(){return this.focused=!0,this.container.classList.add("active"),this.container.classList.add("focus"),this},focusOut(){return this.container.classList.remove("active"),this.container.classList.remove("focus"),this.focused=!1,this},bindEvents(){this.container.addEventListener("change",(e=>{const{target:t}=e,{prop:i}=t.dataset;"orientation"===i&&this.setOrientation(t.value)})),this.projection.registerHandler("view.changed",((e,t)=>{t&&t.parent===this.projection&&(e.parent=this)})),this.btnCollapse&&this.btnCollapse.addEventListener("click",(e=>{this.collapsed?this.expand():this.collapse()}))}},wi=Object.assign({},pi,yi);function Ei(e){return"property"===e.type?this.projection.concept.getProperty(e.name):e}function Ci(i,s,n){const{tag:r,placeholder:a={},style:l,options:o}=s;if(!n.hasAttribute(i)){let s=`Attribute '${i}' does not exist in the concept '${n.name}'`;return this.environment.notify(s,t.k$.ERROR),this.environment.addError({source:"projection",code:"attribute_not_found",message:s}),(0,e.oL)({hidden:!0},i)}(0,e.XI)(s.required,n.isAttributeRequired(i))&&!n.isAttributeCreated(i)&&n.createAttribute(i);const c={name:i,get created(){return n.isAttributeCreated(i)},schema:s,placeholder:(0,e.oL)({class:["projection-element"],hidden:!0},i),parent:this,projection:this.projection,element:null};if(this.projection.attributes.push(c),!c.created){const{content:t}=a;return c.placeholder=t?ji.call(this,t,n,{focusable:!0}):(0,e.oL)({class:["projection-element","projection-element--placeholder"],tabindex:0,dataset:{object:"attribute",id:i}},`Add ${i}`),c.placeholder.addEventListener("click",(e=>{n.createAttribute(i),this.projection.resolveElement(c.element).focus()})),c.placeholder}{const{target:t,schema:s}=n.getAttributeByName(i);let a=this.projection.model.createProjection(t,r).init(o);if(a.parent=this.projection,a._style=l,c.element=a.render(),(0,e.le)(c.element))return(0,e.oL)({hidden:!0},i);a.element.parent=this}return c.element}function ji(t,i,s={}){if(t.kind)return Li.call(this,t,i,s);const n=(0,e.XI)(i,this.projection.concept);if("container"===t.type){let e=bi(this.model,t,this.projection);return e.source=n,e.parent=this,e.init(s),this.model.registerLayout(e),e.render()}if("layout"===t.type){let e=Bi.createLayout(this.model,t.layout,this.projection);return e.source=n,e.parent=this,e.init(s),this.model.registerLayout(e),e.render()}if("field"===t.type){let e=$t.createField(this.model,t.field,this.projection);return e.parent=this,e.init(s),this.model.registerField(e),e.render()}if("static"===t.type){let e=di.createStatic(this.model,t.static,this.projection);return e.source=n,e.parent=this,e.init(s),this.model.registerStatic(e),e.render()}if("dynamic"===t.type)return ji.call(this,t.dynamic,i,s);if("attribute"===t.type)return Ci.call(this,t.name,t,n);if("template"===t.type){let n=t.name;"param"===n.type&&(n=this.projection.getParam(n.name));let r=this.model.getTemplateSchema(n);r.param&&(t.param&&r.param.forEach((e=>{Object.assign(e,t.param.find((t=>t.name===e.name)))})),this.projection.addParam(r.param));const a=(0,e.DZ)();let l=Object.assign({template:r},s);return r.content.forEach((e=>{a.append(ji.call(this,e,i,l))})),a}if("projection"===t.type){const{tag:i,style:s,src:r,required:a=!1}=t;if(r&&"attribute"===r.type)return Ci.call(this,r.name,t,n);const l={schema:t,placeholder:(0,e.oL)({class:["projection-element"],hidden:!0}),parent:this,projection:this.projection,element:null};return l.update=function(t,r,a){if(l.element&&(l.element.remove(),l.element=null),n.hasValue()){let t=n.getValue(!0),r=this.projection.model.createProjection(t,i).init();r.placeholder=l.placeholder,r.parent=this.projection,l.element=r.render(),l.placeholder&&l.placeholder.after(l.element),(0,e.Re)(l.element)&&Xe.call(this.projection,l.element,s),r.element.parent=this.projection.element}},n.register(l),l.update(),l.element||l.placeholder}if("property"===t.type){const{name:e}=t;return this.projection.concept.getProperty(e)}if("html"===t.type){const{html:i}=t;return(0,e.Bv)(i)}if("raw"===t.type){const{raw:e}=t;return e}if("state"===t.type){let e={},n=tt.call(this,e,t.state);return ji.call(this,n.content,i,s)}throw console.error(t),new TypeError("Bad argument: The type is not recognized")}function Li(t,i,s={}){const n=(0,e.XI)(i,this.projection.concept),{kind:r}=t;if("container"===r){let e=bi(this.model,t,this.projection);return e.source=n,e.parent=this,e.init(s),this.model.registerLayout(e),e.render()}if("layout"===r){let e=Bi.createLayout(this.model,t,this.projection);return e.source=n,e.parent=this,e.init(s),this.model.registerLayout(e),e.render()}if("field"===r){let e=$t.createField(this.model,t,this.projection);return e.parent=this,e.init(s),this.model.registerField(e),e.render()}if("static"===r){let e=di.createStatic(this.model,t,this.projection);return e.source=n,e.parent=this,e.init(s),this.model.registerStatic(e),e.render()}if("dynamic"===r)return ji.call(this,t,i,s);if("attribute"===r)return Ci.call(this,t.name,t,n);if("template"===r){let n=t.name;"param"===n.type&&(n=this.projection.getParam(n.name));let r=this.model.getTemplateSchema(n);r.param&&(t.param&&r.param.forEach((e=>{Object.assign(e,t.param.find((t=>t.name===e.name)))})),this.projection.addParam(r.param));const a=(0,e.DZ)();return r.content.forEach((e=>{a.append(ji.call(this,e,i,s))})),a}if("projection"===r){const{tag:i,style:s,required:r=!1}=t,a={schema:t,placeholder:(0,e.oL)({class:["projection-element"],hidden:!0}),parent:this,projection:this.projection,element:null};return a.update=function(t,r,l){if(a.element&&(a.element.remove(),a.element=null),n.hasValue()){let t=n.getValue(!0),r=this.projection.model.createProjection(t,i).init();r.placeholder=a.placeholder,r.parent=this.projection,a.element=r.render(),a.placeholder&&a.placeholder.after(a.element),(0,e.Re)(a.element)&&Xe.call(this.projection,a.element,s),r.element.parent=this.projection.element}},n.register(a),a.update(),a.element||a.placeholder}if("property"===r){const{name:e}=t;return this.projection.concept.getProperty(e)}if("html"===r){const{html:i}=t;return(0,e.Bv)(i)}if("raw"===r){const{raw:e}=t;return e}if("state"===r){let e={},n=tt.call(this,e,t.state);return ji.call(this,n.content,i,s)}throw console.error(t),new TypeError("Bad argument: The type is not recognized")}const xi={HORIZONTAL:"horizontal",VERTICAL:"vertical"},Ri=[{concept:{name:"stack-layout"},type:"layout",tags:[],projection:{type:"stack",orientation:"vertical",disposition:[{type:"attribute",name:"orientation"}]}}],Ii={orientation:null,args:null,init(e={}){const{orientation:t=xi.HORIZONTAL,editable:i=!0,focusable:s=!1}=this.schema;return this.orientation=t,this.focusable=s,this.editable=i,this.elements=[],this.children=[],this.args=e,Object.assign(this,e),this},getOrientation(){return this.orientation},setOrientation(e){this.orientation=e,this.refresh()},render(){const{disposition:t,style:i,help:s}=this.schema;if(!Array.isArray(t))throw new SyntaxError("Bad disposition");const n=(0,e.DZ)();(0,e.Re)(this.container)||(this.container=(0,e.wC)({class:["layout-container","stack-layout"],title:s,dataset:{nature:"layout",layout:"stack",id:this.id}}));for(let e=0;e<t.length;e++){let i=ji.call(this,t[e],null,this.args),s=this.environment.resolveElement(i);s&&(s.parent=this),this.elements.push(i),n.append(i)}return this.focusable?this.container.tabIndex=0:this.container.dataset.ignore="all",Xe.call(this.projection,this.container,i),n.hasChildNodes()&&(this.container.append(n),this.bindEvents()),this.container.style.display="flex",this.container.style.flexWrap="nowrap",this.refresh(),this.container},design(){return{concept:[{name:"stack-layout",nature:"concrete",attributes:[{name:"orientation",target:{name:"string",default:this.orientation,constraint:{values:["horizontal","vertical"]}}}]}],projection:Ri,handlers:{orientation:(e,t)=>{this.setOrientation(t)}}}},refresh(){return this.orientation===xi.VERTICAL?this.container.style.flexDirection="column":this.orientation===xi.HORIZONTAL&&(this.container.style.flexDirection="row"),this},focus(t){if(this.focusable)this.container.focus();else{let t=(0,e.sb)('[tabindex]:not([tabindex="-1"])',this.container);if((0,e.le)(t))return!1;let i=this.environment.resolveElement(t);i&&i.focus(t)}},focusIn(){return this.focused=!0,this.container.classList.add("active"),this.container.classList.add("focus"),this},focusOut(){return this.container.classList.remove("active"),this.container.classList.remove("focus"),this.focused=!1,this},bindEvents(){this.container.addEventListener("change",(e=>{const{target:t}=e,{prop:i}=t.dataset;"orientation"===i&&this.setOrientation(t.value)})),this.projection.registerHandler("view.changed",((e,t)=>{t&&t.parent===this.projection&&(e.parent=this)}))}},Ai=Object.assign({},pi,Ii),Oi={args:null,init(e={}){const{editable:t=!0,focusable:i=!1}=this.schema;return this.focusable=i,this.editable=t,this.elements=[],this.children=[],this.args=e,Object.assign(this,e),this},render(){const{disposition:t,style:i,help:s}=this.schema;if(!Array.isArray(t))throw new SyntaxError("Bad disposition");const n=(0,e.DZ)();(0,e.Re)(this.container)||(this.container=(0,e.wC)({class:["layout-container"],title:s,dataset:{nature:"layout",layout:"wrap",id:this.id}}));for(let e=0;e<t.length;e++){let i=ji.call(this,t[e],this.source,this.args),s=this.environment.resolveElement(i);s&&(s.parent=this),this.elements.push(i),n.append(i)}return this.focusable?this.container.tabIndex=0:this.container.dataset.ignore="all",Xe.call(this.projection,this.container,i),n.hasChildNodes()&&(this.container.append(n),this.bindEvents()),this.collapsed&&this.collapse(!0),this.container.style.display="inline-flex",this.container.style.alignItems="baseline",this.refresh(),this.container},refresh(){return this.collapsed?this.container.classList.add("collapsed"):this.container.classList.remove("collapsed"),this},focusIn(){return this.focused=!0,this.container.classList.add("active"),this.container.classList.add("focus"),this},focusOut(){return this.container.classList.remove("active"),this.container.classList.remove("focus"),this.focused=!1,this},focus(t){if(this.focusable)this.container.focus();else{let t=(0,e.sb)('[tabindex]:not([tabindex="-1"])',this.container);if((0,e.le)(t))return!1;let i=this.environment.resolveElement(t);i&&i.focus(t)}},bindEvents(){this.projection.registerHandler("view.changed",((e,t)=>{t&&t.parent===this.projection&&(e.parent=this)}))}},Vi=Object.assign({},pi,Oi),Si={elements:null,edit:!1,btnEdit:!1,btnCollapse:!1,menu:!1,collapsed:!1,init(e={}){const{editable:t=!0,collapsible:i=!1,focusable:s=!1}=this.schema;return this.focusable=s,this.collapsible=i,this.editable=t,this.elements=[],this.children=[],Object.assign(this,e),this},collapse(t){if(!this.collapsed)return this.collapseContainer=(0,e.wC)({class:"layout-container-collapse"},this.elements),this.btnCollapse.after(this.collapseContainer),this.collapsed=!0,this.refresh(),this},expand(t){if(!this.collapsed)return;let i=(0,e.DZ)(Array.from(this.collapseContainer.children));return this.btnCollapse.after(i),this.collapseContainer.remove(),this.collapsed=!0,this.refresh(),this},refresh(){return this.collapsed?this.container.classList.add("collapsed"):this.container.classList.remove("collapsed"),this},render(){const{disposition:t,style:i,help:s}=this.schema;if(!Array.isArray(t))throw new SyntaxError("Bad disposition");const n=(0,e.DZ)();(0,e.Re)(this.container)||(this.container=(0,e.wC)({class:["layout-container"],dataset:{nature:"layout",layout:"table"}})),this.focusable?this.container.tabIndex=-1:this.container.dataset.ignore="all";for(let i=0;i<t.length;i++){let s=t[i],r=(0,e.wC)({class:["table-row"]});r.style.display="table-row";for(let t=0;t<s.length;t++){const i=s[t];let n=(0,e.wC)({class:["table-cell"]},ji.call(this,i.content));n.style.display="table-cell",Xe.call(this.projection,n,i.style),r.append(n)}n.append(r)}return Xe.call(this.projection,this.container,i),n.hasChildNodes()&&(this.container.append(n),this.bindEvents()),this.container.style.display="table",this.refresh(),this.container},bindEvents(){this.projection.registerHandler("view.changed",((e,t)=>{t&&t.parent===this.projection&&(e.parent=this)})),this.btnCollapse&&this.btnCollapse.addEventListener("click",(e=>{this.collapsed?this.expand():this.collapse()}))}},_i=Object.assign({},pi,Si),Ti={ROW:"row",COLUMN:"column"},Hi={start:"flex-start",end:"flex-end","flex-start":"flex-start","flex-end":"flex-end",center:"center",stretch:"stretch",baseline:"baseline"},ki={start:"flex-start",end:"flex-end","flex-start":"flex-start","flex-end":"flex-end",center:"center","space-between":"space-between","space-around":"space-around","space-evenly":"space-evenly"},Mi={orientation:null,wrappable:null,alignItems:null,justifyContent:null,args:null,init(e={}){const{orientation:t=Ti.ROW,wrappable:i=!0,alignItems:s,justifyContent:n,editable:r=!0,focusable:a=!1}=this.schema;return this.orientation=t,this.wrappable=i,this.alignItems=s,this.justifyContent=n,this.focusable=a,this.editable=r,this.elements=[],this.children=[],this.args=e,Object.assign(this,e),this},getOrientation(){return this.orientation},setOrientation(t){(0,e.RI)(Ti,t)&&(this.orientation=t,this.refresh())},collapse(t=!1){if(!this.collapsed||t)return this.collapseContainer=(0,e.wC)({class:"layout-container-collapse"},this.elements),this.btnCollapse.after(this.collapseContainer),this.collapsed=!0,this.refresh(),this},expand(t=!1){if(!this.collapsed&&!t)return;let i=(0,e.DZ)(Array.from(this.collapseContainer.children));return this.btnCollapse.after(i),this.collapseContainer.remove(),this.collapsed=!1,this.refresh(),this},render(){const{disposition:t,style:i,help:s}=this.schema;if(!Array.isArray(t))throw new SyntaxError("Bad disposition");const n=(0,e.DZ)();(0,e.Re)(this.container)||(this.container=(0,e.wC)({class:["layout-container"],dataset:{nature:"layout",layout:"flex",id:this.id}})),s&&(this.container.title=s);for(let e=0;e<t.length;e++){let i=ji.call(this,t[e],null,this.args),s=this.environment.resolveElement(i);s&&(s.parent=this),this.elements.push(i),n.append(i)}return this.focusable?this.container.tabIndex=0:this.container.dataset.ignore="all",Xe.call(this.projection,this.container,i),n.hasChildNodes()&&(this.container.append(n),this.bindEvents()),this.collapsed&&this.collapse(!0),this.container.style.display="flex",this.refresh(),this.container},refresh(){return this.container.style.flexDirection=this.orientation,this.container.style.justifyContent=ki[this.justifyContent],this.container.style.alignItems=Hi[this.alignItems],this.wrappable?this.container.style.flexWrap="wrap":this.container.style.flexWrap="nowrap",this},focus(t){if(this.focusable)this.container.focus();else{let t=(0,e.sb)('[tabindex]:not([tabindex="-1"])',this.container);if((0,e.le)(t))return!1;let i=this.environment.resolveElement(t);i&&i.focus(t)}},focusIn(){return this.focused=!0,this.container.classList.add("active"),this.container.classList.add("focus"),this},focusOut(){return this.container.classList.remove("active"),this.container.classList.remove("focus"),this.focused=!1,this},bindEvents(){this.container.addEventListener("change",(e=>{const{target:t}=e,{prop:i}=t.dataset;"orientation"===i&&this.setOrientation(t.value)})),this.projection.registerHandler("view.changed",((e,t)=>{t&&t.parent===this.projection&&(e.parent=this)})),this.btnCollapse&&this.btnCollapse.addEventListener("click",(e=>{this.collapsed?this.expand():this.collapse()}))}},$i=Object.assign({},pi,Mi);var Pi=0;const Ni=()=>"layout"+Pi++,Di={stack:(e,t,i)=>Object.create(Ai,{object:{value:"layout"},name:{value:"stack-layout"},type:{value:"stack"},id:{value:Ni()},model:{value:e},schema:{value:t},projection:{value:i},source:{value:i.concept,writable:!0}}),wrap:(e,t,i)=>Object.create(Vi,{object:{value:"layout"},name:{value:"wrap-layout"},type:{value:"wrap"},id:{value:Ni()},model:{value:e},schema:{value:t},projection:{value:i},source:{value:i.concept,writable:!0}}),table:(e,t,i)=>Object.create(_i,{object:{value:"layout"},name:{value:"table-layout"},type:{value:"table"},id:{value:Ni()},model:{value:e},schema:{value:t},projection:{value:i},source:{value:i.concept,writable:!0}}),flex:(e,t,i)=>Object.create($i,{object:{value:"layout"},name:{value:"flex-layout"},type:{value:"flex"},id:{value:Ni()},model:{value:e},schema:{value:t},projection:{value:i},source:{value:i.concept,writable:!0}})},Bi={createLayout(t,i,s){const{type:n}=i,r=Di[n];if((0,e.le)(r))throw new TypeError(`Missing handler: The '${n}' layout could not be handled`);const a=r(t,i,s);if((0,e.le)(a))throw new Error(`Bad request: The '${n}' layout could not be created`);return a.createLayout=this.createLayout,(0,e.le)(a.id)&&(a.id=Ni()),a}};var Xi=0;const Zi={createProjection(t,i,s,n){var r=Object.create(Fi,{id:{value:(0,e.XI)(i.id,"projection"+Xi++)},model:{value:t},schema:{value:i,writable:!0},environment:{value:n}});return r.concept=s,r}},Fi={handlers:null,init(e={}){return this.containers=new Map,this.attributes=[],this.params=[],this.templates=[],this.handlers={},this.args=e,this.concept.register(this),this},schema:null,concept:null,environment:null,parent:null,containers:null,placeholder:null,element:null,attributes:null,params:null,index:0,editing:!1,optional:!1,collapsible:!1,searchable:!1,focusable:!0,get hasMultipleViews(){return this.schema.length>1},get isReadOnly(){return(0,e.XI)(this.getSchema().readonly,!1)},isRoot(){return(0,e.le)(this.parent)},getSchema(t){return this.schema[(0,e.XI)(t,this.index)]},hasSchema(e){return-1!==this.schema.findIndex((t=>t.tags.includes(e)))},getContainer(t){return this.containers.get((0,e.XI)(t,this.index))},getStyle(){const{style:e}=this.getSchema();return e},addTemplate(e){this.templates.push(e)},addParam(e){this.params.push(...Array.isArray(e)?e:[e])},getParam(t,i){let s=this.params.find((e=>e.name===t));if((0,e.le)(s))return;const{type:n="string",value:r}=s;let a=(0,e.XI)(r,s.default);return(0,e.le)(a)?null:"string"===n?a.toString():"number"===n?+a:"boolean"===n?(0,e.sw)(a):void 0},getParent(){return this.isRoot()?null:this.parent},getAttributes(e){return this.attributes.filter((t=>t.name===e))},getField(e){return this.environment.getField(e)},getStatic(e){return this.environment.getStatic(e)},getLayout(e){return this.environment.getLayout(e)},resolveElement(e){return this.environment.resolveElement(e)},getHandlers(t){return(0,e.XI)(this.handlers[t],[])},update(i,s,n){if((0,e.xb)(this.containers))return;if("delete"===i)return void this.delete();const r=this.getHandlers(i);switch((0,e.xb)(r)||r.forEach((e=>{e(s,n)})),i){case"attribute.added":return void this.getAttributes(s.name).forEach((e=>{const{schema:i}=e,n=this.model.createProjection(s.target,i.tag).init();n.parent=this,n.optional=!0;const r=n.render();Xe.call(this,r,i.style),n.element.parent=e.parent,e.element=r,e.placeholder&&(e.placeholder.after(r),(0,t.Cp)(e.placeholder))}));case"attribute.removed":return void this.getAttributes(s.name).forEach((i=>{i.element&&((0,e.ep)(i.element).remove(),i.element=null),i.placeholder&&(0,t.$Z)(i.placeholder)}))}},delete(){return this.concept&&this.concept.unregister(this),this.placeholder&&this.getContainer().after(this.placeholder),this.containers.forEach((t=>{(0,e.ep)(t),(0,e.Re)(t)&&t.remove()})),this.model.removeProjection(this.id),!0},registerHandler(e,t){return Array.isArray(this.handlers[e])||(this.handlers[e]=[]),this.handlers[e].push(t),!0},unregisterHandler(t,i){if(!(0,e.RI)(this.handlers,t))return!1;for(let e=0;e<this.handlers[t].length;e++)if(this.handlers[t][e]===i)return this.handlers[t].splice(e,1),!0;return!1},focus(){this.element.focus()},render(){const i=this.getSchema();if((0,e.le)(i))return null;const{type:s,projection:n,content:r,kind:a}=i;var l=null;if("layout"===s||"layout"===a)this.element=Bi.createLayout(this.model,(0,e.XI)(n,r),this).init(this.args),this.model.registerLayout(this.element);else if("field"===s||"field"===a){let t=(0,e.RI)(i,"field")?i.field:(0,e.XI)(n,r);this.element=$t.createField(this.model,t,this).init(this.args),this.model.registerField(this.element)}else"static"===s||"static"===a?(this.element=di.createStatic(this.model,(0,e.XI)(n,r),this).init(this.args),this.element.source=this.concept,this.model.registerStatic(this.element)):"dynamic"===s||"dynamic"===a?(this.element=di.createStatic(this.model,(0,e.XI)(n,r),this).init(this.args),this.model.registerStatic(this.element)):(this.element=bi(this.model,i.container,this).init(this.args),this.model.registerLayout(this.element));if(this.isRoot()&&(this.element.focusable=!0),this.focusable||(this.element.focusable=!1),this.readonly&&(this.element.readonly=!0),l=this.element.render(),"layout"!==s&&"container"!==s||(0,t.n2)(l),this.element.focusable||(l.tabIndex=-1),!(0,e.UG)(l))throw new Error("Projection element container could not be created");if(l.classList.add("projection"),Object.assign(l.dataset,{projection:this.id,concept:this.concept.id,object:this.concept.object}),this.optional){let t=(0,e.ax)({class:["btn","structure__btn-delete","projection__btn-delete"],title:`Delete ${this.concept.name}`,tabindex:-1,dataset:{action:"delete",projection:this.id}});t.addEventListener("click",(t=>{let i=this.getContainer(),s=(0,e.wr)(i,(e=>0===e.tabIndex));this.environment.save(this.concept.getParent(),i.cloneNode(!0)),this.concept.delete();let n=this.environment.resolveElement(s);(0,e.le)(n)||n.focus()})),l.dataset.deletable=!0,l.prepend(t)}if(this.collapsible){let t=(0,e.ax)({class:["btn","projection__btn-collapse"],title:`Collapse ${this.concept.name}`,tabindex:-1,dataset:{action:"collapse",projection:this.id}});t.addEventListener("click",(e=>{this.getContainer().classList.toggle("collapsed")})),l.dataset.collapsible=!0,l.prepend(t)}return this._style&&Xe.call(this,l,this._style),this.containers.set(this.index,l),l},refresh(){this.editing?this.containers.forEach((e=>{e.tabIndex=0})):this.containers.forEach((e=>{e.tabIndex=null}))},changeView(t){if(!this.hasMultipleViews)return void this.environment.notify("There is no alternative projection for this concept");let i=this.getContainer();this.index=(0,e.XI)(t,(this.index+1)%this.schema.length);let s=this.getContainer();(0,e.Re)(s)||(this.params=[],s=this.render()),i.replaceWith(s),this.element=this.resolveElement(s);const n=this.getHandlers("view.changed");return(0,e.xb)(n)||n.forEach((e=>e(s))),this.focus(),this},findView(e){if(!this.hasSchema(e)){if(!this.model.hasProjectionSchema(this.concept,e))return-1;let t=this.model.getProjectionSchema(this.concept,e);this.schema.push(...t)}return this.schema.findIndex((t=>t.tags.includes(e)))},export(){return{id:this.id,root:this.isRoot(),concept:{id:this.concept.id,name:this.concept.name}}},bindEvents(){}},zi=[{concept:{name:"set"},type:"field",tags:[],content:{type:"list"}},{concept:{name:"boolean"},type:"field",tags:[],content:{type:"binary"}},{concept:{name:"string"},type:"field",tags:[],content:{type:"text"}},{concept:{name:"number"},type:"field",tags:[],content:{type:"text",input:{type:"number"}}},{concept:{name:"reference"},type:"field",tags:[],content:{type:"choice"}}],Wi={projections:null,fields:null,statics:null,layouts:null,init(e){return this.projections=[],this.fields=new Map,this.statics=new Map,this.layouts=new Map,this},addSchema(e){return Array.isArray(e.projection)&&this.schema.projection.push(...e.projection),Array.isArray(e.template)&&this.schema.template.push(...e.template),Array.isArray(e.style)&&this.schema.style.push(...e.style),this.environment.update("concept-model.updated"),!0},setSchema(e){return this.schema=e,this.environment.update("projection-model.updated"),this},done(){for(;!(0,e.xb)(this.projections);)this.projections[0].delete();return this.projections=[],this.fields.clear(),this.layouts.clear(),this.statics.clear(),this},createProjection(i,s){const n=this.getProjectionSchema(i,s);(0,e.xb)(n)&&this.environment.notify(`Missing projection (#${s}) for ${i.name}`,t.k$.WARNING);const r=Zi.createProjection(this,n,i,this.environment);return r.tag=s,this.addProjection(r),r},getProjections(){return this.projections.slice()},getProjection(e){return Number.isInteger(e)?this.projections[e]:this.projections.find((t=>t.id===e))},addProjection(t){if((0,e.le)(t))throw new TypeError("Bad request: The 'projection' argument must be a Projection");return this.projections.push(t),this},removeProjection(e){var t=this.projections.findIndex((t=>t.id===e));return-1!==t&&(this.projections.splice(t,1),!0)},registerField(e){return e.environment=this.environment,this.fields.set(e.id,e),this},unregisterField(e){var t=this.fields.get(e.id);return t&&(t.environment=null,this.fields.delete(t.id)),this},getField(e){return this.fields.get(e)},registerStatic(e){return e.environment=this.environment,this.statics.set(e.id,e),this},unregisterStatic(e){var t=this.statics.get(e.id);return t&&(t.environment=null,this.statics.delete(t.id)),this},getStatic(e){return this.statics.get(e)},registerLayout(e){return e.environment=this.environment,this.layouts.set(e.id,e),this},unregisterLayout(e){var t=this.layouts.get(e.id);return t&&(t.environment=null,this.layouts.delete(t.id)),this},getLayout(e){return this.layouts.get(e)},getMetadata(e){let t=this.schema.find((t=>t.id===e));return t?t.metadata:null},hasConceptProjection(t,i){let s=null;return s=(0,e.HD)(t)?this.schema.projection.filter((e=>e.concept.name===t)):this.schema.projection.filter((i=>{return(e=>e&&(e===t.name||t.schema&&e===t.schema.base))(i.concept.name)||(s=i.concept.prototype,!(0,e.le)(s)&&"prototype"!==t.nature&&t.hasPrototype(s));var s})),(0,e.TW)(i)&&!(0,e.xb)(i)?-1!==s.findIndex((e=>(e=>Array.isArray(e.tags)&&e.tags.includes(i))(e))):!(0,e.xb)(s)},getSchema(){return this.schema},getProjectionSchema(t,i){if((0,e.le)(t))throw new TypeError("Bad parameter: concept");var s=null;return s=(0,e.HD)(t)?this.schema.projection.filter((e=>e.concept.name===t)):this.schema.projection.filter((i=>{return(e=>e&&(e===t.name||t.schema&&e===t.schema.base))(i.concept.name)||(s=i.concept.prototype,!(0,e.le)(s)&&"prototype"!==t.nature&&t.hasPrototype(s));var s})),(0,e.TW)(i)&&!(0,e.xb)(i)?s.filter((e=>e.tags&&e.tags.includes(i))):s},getTemplateSchema(i){let s=this.schema.template.find((e=>e.name===i));return(0,e.le)(s)?null:(0,t.p$)(s)},getRuleSchema(i){let s=this.schema.find((e=>"rule"===e.type&&e.name===i));return(0,e.le)(s)?null:(0,t.p$)(s)},getStyleSchema(i){let s=this.schema.style.find((e=>e.name===i));return(0,e.le)(s)?null:(0,t.p$)(s)},hasProjectionSchema(t,i){if((0,e.le)(t))throw new TypeError("Bad parameter: concept");let s=[];return s=(0,e.HD)(t)?this.schema.projection.filter((e=>e.concept.name===t)):this.schema.projection.filter((i=>{return(e=>e&&(e===t.name||t.schema&&e===t.schema.base))(i.concept.name)||(s=i.concept.prototype,!(0,e.le)(s)&&"prototype"!==t.nature&&t.hasPrototype&&t.hasPrototype(s));var s})),(0,e.TW)(i)&&!(0,e.xb)(i)?s.some((e=>e.tags&&e.tags.includes(i))):!(0,e.xb)(s)},export(){const e=[];return this.getProjections().forEach((t=>{e.push(t.export())})),e}},qi={unloadAllConcept(){return this.hasConceptModel&&(this.conceptModel.done(),this.conceptModel=null,this.refresh()),this.triggerEvent({name:"editor.unload-concept@post"}),this},unloadAllProjection(){return this.hasProjectionModel&&(this.projectionModel.done(),this.projectionModel=null,this.refresh()),this.triggerEvent({name:"editor.unload-projection@post"}),this},loadSession(){this.conceptModel.getRootConcepts().forEach((e=>{this.createInstance(e)}))},loadConcept(i,s){let n=i.concept||i,r=i.values;return Array.isArray(n)?(0,e.xb)(n)?(this.notify("The concept schema is empty",t.k$.ERROR),!1):((0,e.le)(this.conceptModel)&&(this.conceptModel=Pe.createModel(null,this).init()),this.conceptModel.addConceptSchema(n),this.conceptModel.init(r),this.triggerEvent({name:"editor.load-concept@post",args:[s,JSON.stringify(i)]}),this.refresh(),this):(this.notify("Invalid concept schema",t.k$.ERROR),!1)},loadProjection(t,i){return this.activeElement=null,this.activeInstance=null,this.activeConcept=null,this.activeProjection=null,(0,e.le)(this.projectionModel)&&(this.projectionModel=function(e,t){if(!Array.isArray(e.projection))throw new TypeError("Bad projection schema");return e.projection.push(...zi),Object.create(Wi,{schema:{value:e,writable:!0},environment:{value:t}})}(t,this).init()),this.projectionModel.addSchema(t),(0,e.le)(this.projectionModel),this.instances.forEach((e=>{e.projection=this.projectionModel.createProjection(e.concept).init(),e.render()})),this.triggerEvent({name:"editor.load-projection@post",args:[i,JSON.stringify(t)]}),this.refresh(),this},load(i,s){let n=i.type;if((0,e.hr)(n)){let e=i.name.indexOf(".")+1;n=i.name.substring(e)}else n=t.D3[n];"jsoncp"===n&&"json"===n||this.addResource(i,s);let r=new FileReader;return r.onload=e=>{const t=JSON.parse(r.result),{type:i}=t;"concept"===i?this.loadConcept(t,s):"projection"===i?this.loadProjection(t,s):"model"===i&&(this.loadConcept(t.concept,"model"),this.loadProjection(t.projection,"model"))},r.readAsText(i),!0},unload(){return this.unloadAllConcept(),this.unloadAllProjection(),this.clear(),this}},Ui={getField(t){if(!(0,e.Re)(t))return console.warn("Field error: Bad argument"),null;const{id:i,nature:s}=t.dataset;return(0,e.le)(i)?(console.warn("Field error: Missing id attribute on field"),null):["field","field-component"].includes(s)?this.projectionModel.getField(i):(console.warn("Field error: Unknown nature attribute on field"),null)},getStatic(t){if(!(0,e.Re)(t))return console.warn("Static error: Bad argument"),null;const{id:i,nature:s}=t.dataset;return(0,e.le)(i)?(console.warn("Static error: Missing id attribute on field"),null):["static","static-component"].includes(s)?this.projectionModel.getStatic(i):(console.warn("Static error: Unknown nature attribute on field"),null)},getLayout(t){if(!(0,e.Re)(t))return console.warn("Layout error: Bad argument"),null;const{id:i,nature:s}=t.dataset;return(0,e.le)(i)?(console.warn("Layout error: Missing id attribute on field"),null):["layout","layout-component"].includes(s)?this.projectionModel.getLayout(i):(console.warn("Layout error: Unknown nature attribute on field"),null)},resolveElement(t){if(!(0,e.Re)(t))return null;const{nature:i}=t.dataset;if((0,e.le)(i))return null;let s=null;switch(i){case"field":case"field-component":s=this.getField(t);break;case"layout":case"layout-component":s=this.getLayout(t);break;case"static":case"static-component":s=this.getStatic(t)}return s&&(s.environment=this),s}};var Gi=0;const Ki={createState(t,i){const{id:s,name:n}=t;let r="value"+Gi++,a=JSON.stringify(t.clone()),l=((0,e.p6)(new Date,"hh:dd"),(0,e.oL)({class:["ico","ico-delete"]},"✖")),o=(0,e.ax)({class:["btn","btn-delete"],title:`Delete ${n} state`},l),c=(0,e.wC)({class:["model-state-preview"],title:`Preview ${n}`},i),h=(0,e.kQ)({class:["model-state-content","fit-content"]},`${t.getName()}`),u=(0,e.HV)({class:["model-state"],title:`Restore ${n} state`,dataset:{id:r,concept:s}},[o,h,c]);u.addEventListener("click",(t=>{let i=function(t){const i=e=>e===u||e===o;return i(t)?t:(0,e.wr)(t,(e=>i(e)),5)}(t.target);if(this.unhighlight(),i===o)this.removeState(r);else{let t=this.restore(a);this.removeState(r);let i=(0,e.sb)(`.projection[data-concept="${t.id}"]`,this.body);i&&i.focus()}}));let d=`.projection[data-concept="${s}"]`;if(u.addEventListener("mouseenter",(t=>{let i=(0,e.sb)(d,this.body);i&&this.highlight(i)})),u.addEventListener("mouseleave",(e=>{this.unhighlight()})),this.states.length>8){let{id:e}=this.stateList.lastChild.dataset;this.removeValue(e)}let p=Object.create({},{id:{value:r},object:{value:"value"},type:{value:"state"},element:{value:u},concept:{value:t},value:{value:a}});return this.addState(p),p},getState(t){if(!(0,e.le)(t)&&!(0,e.xb)(this.states))return this.states[t]},addState(e){return this.stateList.append(e.element),this.states.push(e),this.refresh(),e},removeState(t){if((0,e.le)(t))return;const i=this.states.findIndex((e=>e.id===t));if(-1===i)return null;let s=this.states.splice(i,1)[0],{element:n}=s;return(0,e.ep)(n).remove(),this.refresh(),this}};var Qi=0;const Ji={conceptModel:null,projectionModel:null,concept:null,activeConcept:null,activeProjection:null,activeInstance:null,container:null,header:null,body:null,instanceSection:null,designSection:null,navigationSection:null,valueWindow:null,valueList:null,breadcrumb:null,filter:null,home:null,style:null,logs:null,status:null,group:null,input:null,copyValue:null,states:null,activeElement:null,decoratedElements:null,config:null,active:!1,visible:!1,frozen:!1,handlers:null,actions:null,attached:null,instances:null,windows:null,values:null,resources:null,models:null,errors:null,init(e={}){const{conceptModel:t,projectionModel:i,toolbar:s=[],config:n={},handlers:r={},actions:a={}}=e;this.config=Object.assign({},n),this.handlers=new Map,this.actions=new Map,this.attached=[],this.instances=new Map,this.windows=new Map,this.values=new Map,this.resources=new Map,this.models=new Map,this.errors=[],Object.assign(this,w,j),this.states=[],this.decoratedElements=new Set;for(const e in r){const t=r[e];this.registerHandler(e,t)}return this.header=I.call(this).init(),this.home=O.call(this).init(),this.breadcrumb=A.call(this).init(),this.logs=S.call(this).init(),this.status=V.call(this).init(),this.render(),t&&this.loadConcept(t),i&&this.loadProjection(i),this.isReady?(this.conceptModel.getRootConcepts().forEach((e=>{this.createInstance(e)})),this.open()):(this.home.open(),this.refresh()),this},setConfig(t){return!(0,e.le)(t)&&(this.config=t,this.refresh(),this)},getConfig(t){return(0,e.le)(t)?this.config:this.config[t]},getName(){return(0,e.XI)(this.config.name,`editor${(new Date).getTime()}`)},createConcept(i){if((0,e.le)(i))throw new TypeError("Missing argument: The 'name' is required to create a concept");return this.conceptModel.isConcept(i)?this.conceptModel.createConcept(i):(this.notify(`The concept '${i}' is not defined in the model`,t.k$.ERROR),!1)},addConcept(e){let t=e.concept||e;Array.isArray(t)?this.conceptModel.schema.push(...t):this.conceptModel.schema.push(t),this.refresh()},createProjection(i,s){if((0,e.le)(i))throw new TypeError("Missing argument: The 'concept' is required to create a projection");return this.projectionModel.hasConceptProjection(i,s)?this.projectionModel.createProjection(i,s).init():(this.notify(`The projection for the concept '${i.name}' is not defined in the model`,t.k$.ERROR),!1)},addProjection(e){Array.isArray(e)?this.projectionModel.schema.projection.push(...e):this.projectionModel.addSchema(e),this.refresh()},download(t,i,s){const n="application/jsoncp";window.URL=window.webkitURL||window.URL;var r=(0,e.cH)({class:["bare-link","download-item__link"]},"Download");(0,e.hr)(r.href)||window.URL.revokeObjectURL(r.href);var a=new Blob([JSON.stringify(t)],{type:n});return Object.assign(r,{download:`${(0,e.XI)(i,(new Date).getTime())}.jsoncp`,href:window.URL.createObjectURL(a)}),r.dataset.downloadurl=[n,r.download,r.href].join(":"),r.click(),setTimeout((()=>{window.URL.revokeObjectURL(r.href),r.remove()}),1500),t},export(i=!1){const s="application/jsoncp";window.URL=window.webkitURL||window.URL;var n=(0,e.cH)({});this.container.append(n),(0,e.hr)(n.href)||window.URL.revokeObjectURL(n.href);const r={concept:this.conceptModel.schema,values:this.conceptModel.export(),editor:this.config};var a=new Blob([JSON.stringify(r)],{type:s});return Object.assign(n,{download:"model.jsoncp",href:window.URL.createObjectURL(a)}),console.log(a.type),n.dataset.downloadurl=[s,n.download,n.href].join(":"),i?((0,e.WA)(JSON.stringify(r)),this.notify("The model has been copied to clipboard",t.k$.SUCCESS)):(n.click(),this.notify("The model has been downloaded",t.k$.SUCCESS)),setTimeout((()=>{window.URL.revokeObjectURL(n.href),n.remove()}),1500),r},save(e,t){this.createState(e,t),this.refresh()},restore(e){let t=JSON.parse(e),i=this.conceptModel.getConcept(t.id);return i.restore(t),this.refresh(),i},undo(){if((0,e.xb)(this.states))return void this.notify("There are no previous state",t.k$.NORMAL,2e3);let i=(0,e.Z$)(this.states);this.restore(i.value),this.removeState(i.id)},notify(t,i,s=4500){let n=(0,e.qm)({class:["notify"],html:t});const r="open";i&&n.classList.add(i),this.container.append(n),setTimeout((()=>{n.classList.add(r)}),50),setTimeout((()=>{n.classList.remove(r),setTimeout((()=>{n.remove()}),500)}),s)},addResource(t,i){let s=(0,e.XI)(i,t.name.split(".")[0]);this.resources.set(s,t);let n=new FileReader;return n.onload=e=>{this.addModel(s,n.result)},n.readAsText(t),this.refresh(),t},getResource(e){return this.resources.get(e)},hasResource(e){return this.resources.has(e)},removeResource(e){return this.resources.delete(e),this.triggerEvent({name:"resource.removed"}),this.refresh(),!0},addError(e){return this.errors.push(e),this.refresh(),(0,t.lL)(this.status.editorstatusBadge),e},removeError(e){return this.errors.pop(),this.refresh(),!0},clearError(e){return this.errors=[],this.refresh(),!0},getModel(t){let i=this.models.get(t);return(0,e.le)(i)?null:JSON.parse(i)},addModel(e,t){this.models.set(e,t)},removeModel(e){return this.triggerEvent({name:"model.remove@pre",args:[e]},(()=>{this.models.delete(e),this.refresh(),this.triggerEvent({name:"model.remove@post"})}),!1),!0},hasModel(e){return this.models.has(e)},getValue(e){if(this.values.has(e))return this.values.get(e)},addValue(t){let i="value"+Qi++,s=(0,e.oL)({class:["ico","ico-copy"]}),n=(0,e.oL)({class:["ico","ico-delete"]},"✖"),r=(0,e.ax)({class:["btn","btn-copy","fit-content"],title:`Copy ${t.name}`},[s,t.name]),a=(0,e.ax)({class:["btn","btn-delete"]},n),l=(0,e.HV)({class:["model-value"],dataset:{id:i}},[r,a]);if(r.addEventListener("click",(e=>{this.copy(t)})),a.addEventListener("click",(e=>{this.removeValue(i)})),this.values.size>5){let{id:e}=this.valueList.lastChild.dataset;this.removeValue(e)}return this.valueList.prepend(l),this.values.set(i,{element:l,value:t}),this.refresh(),t},removeValue(t){if((0,e.le)(t)||!this.values.has(t))return;let{element:i}=this.values.get(t);return(0,e.ep)(i).remove(),this.values.delete(t),this.refresh(),this},copy(i,s=!1){return(0,e.le)(i)||(this.copyValue=i,(0,e.WA)(JSON.stringify(i)),s&&this.addValue(i),this.notify(`${i.name} copied`,t.k$.NORMAL)),this},paste(t,i){let s=(0,e.XI)(i,this.copyValue);if(!(0,e.le)(s)){if((0,e.le)(t)){let e=this.createConcept(s.name).init();e.setValue(s),this.createInstance(e)}else"prototype"===s.nature?t.setValue(s.value):t.setValue(s);return this}},show(){return this.triggerEvent({name:"editor.show@pre"},(()=>{(0,t.$Z)(this.container),this.attached.forEach((e=>e.show())),this.visible=!0,this.triggerEvent({name:"editor.show@post"})}),!1),this},hide(){return this.triggerEvent({name:"editor.hide@pre"},(()=>{(0,t.Cp)(this.container),this.attached.forEach((e=>e.hide())),this.visible=!1,this.triggerEvent({name:"editor.hide@post"})}),!1),this},toggle(){return this.triggerEvent({name:"editor.toggle@pre"},(()=>{(0,t.ZN)(this.container),this.visible=!this.visible,this.triggerEvent({name:"editor.toggle@post"})}),!1),this},open(){return this.triggerEvent({name:"editor.open@pre"},(()=>{this.show(),this.active=!0,this.isReady&&this.home.close(),this.triggerEvent({name:"editor.open@post"})}),!1),this},close(){return this.triggerEvent({name:"editor.close@pre"},(()=>{this.hide(),this.active=!1,this.done(),this.clear(),this.triggerEvent({name:"editor.close@post"})}),!1),this},destroy(){return this.triggerEvent({name:"editor.destroy@pre"},(()=>{this.hide(),this.done(),this.instances.forEach((e=>e.delete())),(0,e.ep)(this.container).remove()}),!1),!0},freeze(){return this.triggerEvent({name:"editor.freeze@pre"},(()=>{this.frozen=!0,this.refresh(),this.triggerEvent({name:"editor.freeze@post"})}),!1),this},unfreeze(){return this.frozen=!1,this.refresh(),this},done(){return this.conceptModel&&this.conceptModel.done(),this.projectionModel&&this.projectionModel.done(),this},highlight(i){return(0,e.Re)(i)?((0,t.CH)(i),this.decoratedElements.add(i),this):this},unhighlight(i){return(0,e.Re)(i)?((0,t.HW)(i),this.decoratedElements.delete(i),this):(this.decoratedElements.forEach((e=>(0,t.HW)(e))),this.decoratedElements.clear(),this)},createWindow(){let t=(0,e.wC)({class:["editor-window"],tabindex:0});this.body.append(t)},clear(){return this.triggerEvent({name:"editor.clear@pre"},(()=>{this.instances.forEach((e=>e.delete())),this.instances.clear(),this.resources.clear(),this.models.clear(),this.states.forEach((e=>e.element.remove())),this.states=[],this.activeElement=null,this.activeInstance=null,this.activeConcept=null,this.activeProjection=null,this.refresh(),this.triggerEvent({name:"editor.clear@post"})}),!1),this},update(e,t,i){this.triggerEvent({name:e})},attach(e){this.attached.push(e)},detach(e){let t=this.attached.findIndex((t=>t===e));if(-1===t)return null;this.attached.splice(t,1)},render(t){const i=(0,e.DZ)();if(this.home.isRendered||i.append(this.home.render()),this.header.isRendered||i.append(this.header.render()),(0,e.Re)(this.navigationSection)||(this.navigationSection=(0,e.vB)({class:["model-navigation-section"]}),this.viewSection=(0,e.Pi)({class:["model-view-section"]}),this.navigationSection.append(this.viewSection),i.append(this.navigationSection)),!(0,e.Re)(this.body)){this.body=(0,e.wC)({class:["editor-body"],tabindex:0});let t=(0,e.wC)({class:["editor-body-main"],tabindex:0});this.instanceSection=(0,e.vB)({class:["model-concept-section"]}),t.append(this.instanceSection),this.body.append(t),i.append(this.body)}return(0,e.Re)(this.timeline)||(this.timeline=(0,e.wC)({class:["editor-timeline"]}),this.stateList=(0,e.w_)({class:["bare-list","model-state-list"]}),this.timeline.append(this.stateList),i.append(this.timeline)),this.logs.isRendered||i.append(this.logs.render()),this.breadcrumb.isRendered||this.navigationSection.append(this.breadcrumb.render()),(0,e.Re)(this.valueSection)||(this.valueSection=(0,e.wC)({class:["model-value-window"]}),this.valueList=(0,e.w_)({class:["bare-list","model-value-list"]}),this.valueSection.append(this.valueList),this.navigationSection.append(this.valueSection)),this.status.isRendered||i.append(this.status.render()),(0,e.Re)(this.input)||(this.input=(0,e.Ju)({type:"file",class:["hidden"],accept:".json,.jsoncp"}),i.append(this.input)),i.hasChildNodes()&&(this.container.append(i),this.bindEvents()),(0,e.Re)(t)&&t.append(this.container),this.refresh(),this.container},refresh(i=!1){return this.frozen&&!i||(this.home.isOpen?this.container.classList.add("unfocus"):this.container.classList.remove("unfocus"),this.hasValues?(0,t.$Z)(this.valueWindow):(0,t.Cp)(this.valueWindow),this.header.refresh(),this.breadcrumb.refresh(),this.home.refresh(),this.logs.refresh(),this.status.refresh(),this.instanceSection.dataset.view=this.status.view,["grid"].includes(this.status.view)?(0,t.Cp)(this.viewSection):["tab"].includes(this.status.view)&&(0,t.$Z)(this.viewSection),(0,e.xb)(this.states)?(0,t.Cp)(this.timeline):((0,t.$Z)(this.timeline),this.states.forEach((e=>{this.conceptModel.hasConcept(e.concept.id)?this.hasActiveConcept&&this.activeConcept===e.concept?e.element.classList.add("active"):e.element.classList.remove("active"):this.removeState(e.id)})))),this},updateActiveElement(e){return this.activeElement&&this.activeElement===e||(this.activeElement=e,this.triggerEvent({name:"editor.element@active:updated"})),this},updateActiveConcept(e){return this.hasActiveConcept&&this.activeConcept===e||(this.activeConcept=e,this.triggerEvent({name:"editor.concept@active:updated"}),this.refresh()),this},updateActiveProjection(t){if(this.activeProjection&&this.activeProjection===t)return this;let i=(0,e.$3)(".active-parent",this.body);for(let e=0;e<i.length;e++)i[e].classList.remove("active-parent");this.activeProjection=t;let s=this.activeProjection.parent;for(;s;)s.getContainer().classList.add("active-parent"),s=s.parent;return this.triggerEvent({name:"editor.projection@active:updated"}),this.refresh(),this},updateActiveInstance(e){if(this.activeInstance){if(this.activeInstance===e)return this;this.activeInstance,this.activeInstance.container.classList.remove("active")}return this.activeInstance=e,this.activeInstance.container.classList.add("active"),this.triggerEvent({name:"editor.instance@active:updated"}),this.refresh(),this},bindEvents(){var i=null,s=null;const n={open:e=>{const{context:t}=e.dataset;t?this[t].open():this.open()},close:e=>{const{context:t,id:i,type:s}=e.dataset;t?this[t].close():this.close()},collapse:t=>{const{rel:i,target:s}=t.dataset;if("parent"===i){let i=(0,e.wr)(t,(e=>e.dataset.name===s));if((0,e.Re)(i)){const{alias:e=""}=i.dataset;i.classList.toggle("collapsed");let s=i.classList.contains("collapsed");t.dataset.state=s?"ON":"OFF",t.title=s?`Expand ${e.toLowerCase()}`:`Collapse ${e.toLowerCase()}`}}},delete:t=>{const{target:i}=t.dataset;if("parent"===i){let i=t.parentElement;(0,e.ep)(i),i.remove()}},"delete:value":e=>{const{id:t}=e.dataset;this.conceptModel.removeValue(t),this.header._valueSelector.update()},"delete:resource":e=>{const{id:t}=e.dataset;this.removeResource(t)},"change-view":e=>{const{value:t}=e.dataset;this.status.changeView(t)},"add-group":e=>{this.status.addGroup()},style:e=>{this.style.toggle()},home:e=>{this.home.toggle()},logs:e=>{this.logs.toggle()},export:e=>{this.export()},"export--copy":e=>{this.export(!0)},"create-instance":e=>{const{concept:t}=e.dataset;let i=this.createConcept(t);this.createInstance(i)},"create-instance:value":e=>{const{id:t}=e.dataset;let i=this.conceptModel.getValue(t),s=this.createConcept(i.name);s.initValue(i),this.createInstance(s)},"copy:value":e=>{const{id:t}=e.dataset;let i=this.conceptModel.getValue(t);this.copy(i)},save:e=>{this.save()},undo:e=>{this.undo()},load:e=>{let t=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});this.input.dispatchEvent(t)},unload:e=>{this.unload()},"load-concept":e=>{let t=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});this.input.dispatchEvent(t)},"unload-concept":e=>{this.unloadAllConcept()},"download-concept":e=>{const{schema:t,values:i}=this.conceptModel;let s=this.getName().toLowerCase().replace(/\s+/g," ").replace(" ","_");this.download({concept:t},`${s}_model`)},"load-projection":e=>{let t=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});this.input.dispatchEvent(t)},"unload-projection":e=>{this.unloadAllProjection()},"download-projection":e=>{const{schema:t,views:i}=this.projectionModel;let s=this.getName().toLowerCase().replace(/\s+/g," ").replace(" ","_");this.download({projection:t},`${s}_projection`)}},r={[t.sr.up_arrow]:"up",[t.sr.right_arrow]:"right",[t.sr.down_arrow]:"down",[t.sr.left_arrow]:"left"};this.container.addEventListener("click",(i=>{var s=(0,t.NI)(i.target);const{action:r,context:a,id:l}=s.dataset;if("instance"===a)return void this.getInstance(l).actionHandler(r);if("menu"===a)return void this.home.actionHandler(r,s);if(this.activeElement&&this.activeElement.clickHandler(s),(0,e.le)(r))return;if(this.actions.has(r))return console.warn(r),this.actions.get(r).call(this,s),void s.blur();const o=n[r];(0,e.mf)(o)?(o(s),s.blur()):r&&this.triggerEvent({name:r})}),!0),this.input.addEventListener("change",(e=>{let t=this.input.files[0];this.load(t,s),this.input.value=""})),this.body.addEventListener("copy",(e=>{if(!(0,t.QE)(e.target)){let t=this.activeConcept.copy(!1);this.copy(t,!0),e.preventDefault()}})),this.body.addEventListener("keydown",(s=>{const{target:n}=s,{nature:a}=n.dataset;var l=!1;switch(s.key){case t.sr.backspace:this.activeElement&&i!==t.sr.ctrl&&!0===this.activeElement.backspaceHandler(n)&&s.preventDefault();break;case t.sr.ctrl:case t.sr.shift:s.preventDefault(),l=!0;break;case t.sr.delete:this.activeElement&&i!==t.sr.ctrl&&!(0,t.QE)(n)&&this.activeElement.deleteHandler(n)&&s.preventDefault();break;case t.sr.spacebar:this.activeElement&&i!==t.sr.ctrl&&this.activeElement.spaceHandler(n)&&s.preventDefault();break;case t.sr.alt:s.preventDefault();break;case t.sr.enter:this.activeElement?!0===this.activeElement.enterHandler(n)&&s.preventDefault():"concept-container"===a?this.activeInstance.projection.focus():"editable"===a?n.blur():"BUTTON"===n.tagName?(n.click(),s.preventDefault()):s.preventDefault();break;case t.sr.escape:this.activeElement&&(!0===this.activeElement.escapeHandler(n)?s.preventDefault():(0,e.wr)(n,(e=>0===e.tabIndex)).focus());break;case t.sr.insert:this.activeElement&&s.preventDefault();break;case t.sr.up_arrow:case t.sr.right_arrow:case t.sr.down_arrow:case t.sr.left_arrow:if(this.activeElement&&![t.sr.ctrl,t.sr.shift,t.sr.alt].includes(i))!0===this.activeElement.arrowHandler(r[s.key],n)&&s.preventDefault();else if("concept-container"===a&&![t.sr.ctrl,t.sr.shift,t.sr.alt].includes(i)){let i=(0,t.As)(n,r[s.key],this.instanceSection);if(!(0,e.Re)(i))return!1;i.focus()}break;case"s":i===t.sr.ctrl&&(this.activeConcept.copy(),this.header.valueCount++,this.refresh(),s.preventDefault());break;case"c":if(i===t.sr.ctrl){let e=new ClipboardEvent("copy");this.body.dispatchEvent(e)}break;case"v":if(i===t.sr.ctrl){if((0,t.QE)(n))return;this.paste(this.activeConcept,this.copyValue)}break;case"e":i===t.sr.ctrl&&this.activeConcept&&(this.createInstance(this.activeConcept,this.activeProjection,{type:"projection",close:"DELETE-PROJECTION"}),s.preventDefault());break;case"f":break;case"z":i===t.sr.ctrl&&((0,t.QE)(n)||(this.undo(),s.preventDefault()))}l&&(i=s.key)}),!1),this.body.addEventListener("keyup",(s=>{var n=s.target;const{nature:a}=n.dataset;switch(s.key){case t.sr.spacebar:this.activeElement&&i===t.sr.ctrl&&this.activeElement._spaceHandler(n);break;case t.sr.delete:this.activeElement&&i===t.sr.ctrl&&this.activeElement.delete(n);break;case t.sr.alt:break;case t.sr.up_arrow:case t.sr.down_arrow:case t.sr.right_arrow:case t.sr.left_arrow:if(this.activeElement&&i===t.sr.ctrl)!0===this.activeElement._arrowHandler(r[s.key],n)&&s.preventDefault();else if("concept-container"===a&&i===t.sr.ctrl){let a=(0,t.As)(n,r[s.key],this.instanceSection);if(!(0,e.Re)(a))return!1;this.swapInstance(n,a,!0),n.focus(),i=t.sr.ctrl}}i===s.key&&(i=-1)}),!1),this.body.addEventListener("focusin",(e=>{const{target:t}=e,s=this.resolveElement(t);if(i=-1,s?(this.activeElement&&this.activeElement!==s&&(this.activeElement.focusOut(),this.activeElement=null),this.updateActiveElement(s),this.activeElement.focusIn(t)):(this.activeElement&&this.activeElement.focusOut(t),this.activeElement=null),this.activeElement){let e=this.activeElement.projection;this.updateActiveProjection(e),this.updateActiveConcept(e.concept)}else this.activeConcept=null,this.activeProjection=null;this.refresh()})),this.registerHandler("export",(()=>this.export())),this.registerHandler("value.changed",(()=>this.refresh())),this.registerHandler("value.added",(()=>this.refresh())),this.registerHandler("value.removed",(()=>this.refresh())),this.registerHandler("load-resource",(e=>{let t=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});s=e[0],this.input.dispatchEvent(t)}))}},Yi=Object.assign(Ki,qi,Ui,_,Ji);Object.defineProperty(Yi,"hasConceptModel",{get(){return!(0,e.le)(this.conceptModel)}}),Object.defineProperty(Yi,"hasProjectionModel",{get(){return!(0,e.le)(this.projectionModel)}}),Object.defineProperty(Yi,"hasInstances",{get(){return this.instances.size>0}}),Object.defineProperty(Yi,"hasWindows",{get(){return this.windows.size>0}}),Object.defineProperty(Yi,"hasValues",{get(){return this.values.size>0}}),Object.defineProperty(Yi,"isReady",{get(){return this.hasConceptModel&&this.hasProjectionModel}}),Object.defineProperty(Yi,"hasActiveConcept",{get(){return!(0,e.le)(this.activeConcept)}}),Object.defineProperty(Yi,"hasActiveProjection",{get(){return!(0,e.le)(this.activeProjection)}}),Object.defineProperty(Yi,"hasActiveInstance",{get(){return!(0,e.le)(this.activeInstance)}}),Object.defineProperty(Yi,"hasError",{get(){return!(0,e.xb)(this.errors)}});const es="editor";function ts(i){const s=(0,t.fP)(i),n=(t=>(0,e.Re)(t)&&(0,e.RI)(t.dataset,"gentleman"))(a=s)&&a.dataset.gentleman===es?[s]:(0,e.$3)('[data-gentleman="editor"]',s),r=[];var a;return n.forEach((e=>{r.push(is(e))})),r}function is(i){let s=(0,t.fP)(i);return(0,e.Re)(i)||(s=(0,e.wC)({tabindex:-1})),s.classList.add("gentleman-editor"),s.dataset.gentleman=es,Object.create(Yi,{object:{value:"environment"},type:{value:es},name:{value:"gentleman editor"},container:{value:s}})}})(),s})()}));
>>>>>>> 4fa52361a28ed3a1b742c8a26a93a0bb513e021c
